(function($t,V){typeof exports=="object"&&typeof module<"u"?V(exports):typeof define=="function"&&define.amd?define(["exports"],V):V(($t=typeof globalThis<"u"?globalThis:$t||self).dhtmlxgantt={})})(this,function($t){"use strict";/** @license

dhtmlxGantt v.9.1.0 Standard

This version of dhtmlxGantt is distributed under GPL 2.0 license and can be legally used in GPL projects.

To use dhtmlxGantt in non-GPL projects (and get Pro version of the product), please obtain Individual, Commercial, Enterprise or Ultimate license on our site https://dhtmlx.com/docs/products/dhtmlxGantt/#licensing or contact us at info@dhtmlx.com

(c) XB Software

*/function V(t){var n=0,e=0,i=0,a=0;if(t.getBoundingClientRect){var s=t.getBoundingClientRect(),r=document.body,o=document.documentElement||document.body.parentNode||document.body,l=window.pageYOffset||o.scrollTop||r.scrollTop,d=window.pageXOffset||o.scrollLeft||r.scrollLeft,c=o.clientTop||r.clientTop||0,u=o.clientLeft||r.clientLeft||0;n=s.top+l-c,e=s.left+d-u,i=document.body.offsetWidth-s.right,a=document.body.offsetHeight-s.bottom}else{for(;t;)n+=parseInt(t.offsetTop,10),e+=parseInt(t.offsetLeft,10),t=t.offsetParent;i=document.body.offsetWidth-t.offsetWidth-e,a=document.body.offsetHeight-t.offsetHeight-n}return{y:Math.round(n),x:Math.round(e),width:t.offsetWidth,height:t.offsetHeight,right:Math.round(i),bottom:Math.round(a)}}function In(t){var n=!1,e=!1;if(window.getComputedStyle){var i=window.getComputedStyle(t,null);n=i.display,e=i.visibility}else t.currentStyle&&(n=t.currentStyle.display,e=t.currentStyle.visibility);return n!="none"&&e!="hidden"}function Mn(t){return!isNaN(t.getAttribute("tabindex"))&&1*t.getAttribute("tabindex")>=0}function Nn(t){return!{a:!0,area:!0}[t.nodeName.loLowerCase()]||!!t.getAttribute("href")}function Ln(t){return!{input:!0,select:!0,textarea:!0,button:!0,object:!0}[t.nodeName.toLowerCase()]||!t.hasAttribute("disabled")}function At(t){for(var n=t.querySelectorAll(["a[href]","area[href]","input","select","textarea","button","iframe","object","embed","[tabindex]","[contenteditable]"].join(", ")),e=Array.prototype.slice.call(n,0),i=0;i<e.length;i++)e[i].$position=i;for(e.sort(function(s,r){return s.tabIndex===0&&r.tabIndex!==0?1:s.tabIndex!==0&&r.tabIndex===0?-1:s.tabIndex===r.tabIndex?s.$position-r.$position:s.tabIndex<r.tabIndex?-1:1}),i=0;i<e.length;i++){var a=e[i];(Mn(a)||Ln(a)||Nn(a))&&In(a)||(e.splice(i,1),i--)}return e}function Me(){var t=document.createElement("div");t.style.cssText="visibility:hidden;position:absolute;left:-1000px;width:100px;padding:0px;margin:0px;height:110px;min-height:100px;overflow-y:scroll;",document.body.appendChild(t);var n=t.offsetWidth-t.clientWidth;return document.body.removeChild(t),Math.max(n,15)}function Z(t){if(!t)return"";var n=t.className||"";return n.baseVal&&(n=n.baseVal),n.indexOf||(n=""),oe(n)}function wt(t,n){n&&t.className.indexOf(n)===-1&&(t.className+=" "+n)}function jt(t,n){n=n.split(" ");for(var e=0;e<n.length;e++){var i=new RegExp("\\s?\\b"+n[e]+"\\b(?![-_.])","");t.className=t.className.replace(i,"")}}function re(t){return typeof t=="string"?document.getElementById(t)||document.querySelector(t)||document.body:t||document.body}var Wt;function Ne(t,n){Wt||(Wt=document.createElement("div")),Wt.innerHTML=n;var e=Wt.firstChild;return t.appendChild(e),e}function Le(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function Re(t,n){for(var e=t.childNodes,i=e.length,a=[],s=0;s<i;s++){var r=e[s];r.className&&r.className.indexOf(n)!==-1&&a.push(r)}return a}function yt(t){var n;return t.tagName?n=t:(n=(t=t||window.event).target||t.srcElement).shadowRoot&&t.composedPath&&(n=t.composedPath()[0]),n}function nt(t,n){if(n){for(var e=yt(t);e;){if(e.getAttribute&&e.getAttribute(n))return e;e=e.parentNode||e.host}return null}}function oe(t){return(String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")}).apply(t)}function ft(t,n,e){var i=yt(t),a="";for(e===void 0&&(e=!0);i;){if(a=Z(i)){var s=a.indexOf(n);if(s>=0){if(!e)return i;var r=s===0||!oe(a.charAt(s-1)),o=s+n.length>=a.length||!oe(a.charAt(s+n.length));if(r&&o)return i}}i=i.parentNode}return null}function at(t,n){var r;const e=document.documentElement,i=V(n),{clientX:a,clientY:s}=((r=t.touches)==null?void 0:r[0])??t;return{x:a+e.scrollLeft-e.clientLeft-i.x+n.scrollLeft,y:s+e.scrollTop-e.clientTop-i.y+n.scrollTop}}function Pe(t,n){const e=V(t),i=V(n);return{x:e.x-i.x,y:e.y-i.y}}function J(t,n){if(!t||!n)return!1;for(;t&&t!=n;)t=t.parentNode;return t===n}function dt(t,n){if(t.closest)return t.closest(n);if(t.matches||t.msMatchesSelector||t.webkitMatchesSelector){var e=t;if(!document.documentElement.contains(e))return null;do{if((e.matches||e.msMatchesSelector||e.webkitMatchesSelector).call(e,n))return e;e=e.parentElement||e.parentNode}while(e!==null&&e.nodeType===1);return null}return console.error("Your browser is not supported"),null}function He(t){for(;t;){if(t.offsetWidth>0&&t.offsetHeight>0)return t;t=t.parentElement}return null}function Oe(){return document.head.createShadowRoot||document.head.attachShadow}function le(){var t=document.activeElement;return t.shadowRoot&&(t=t.shadowRoot.activeElement),t===document.body&&document.getSelection&&(t=document.getSelection().focusNode||document.body),t}function bt(t){if(!t||!Oe())return document.body;for(;t.parentNode&&(t=t.parentNode);)if(t instanceof ShadowRoot)return t.host;return document.body}const Be=Object.freeze(Object.defineProperty({__proto__:null,addClassName:wt,closest:dt,getActiveElement:le,getChildNodes:Re,getClassName:Z,getClosestSizedElement:He,getFocusableNodes:At,getNodePosition:V,getRelativeEventPosition:at,getRelativeNodePosition:Pe,getRootNode:bt,getScrollSize:Me,getTargetNode:yt,hasClass:function(t,n){return"classList"in t?t.classList.contains(n):new RegExp("\\b"+n+"\\b").test(t.className)},hasShadowParent:function(t){return!!bt(t)},insertNode:Ne,isChildOf:J,isShadowDomSupported:Oe,locateAttribute:nt,locateClassName:ft,removeClassName:jt,removeNode:Le,toNode:re},Symbol.toStringTag,{value:"Module"})),Q=typeof window<"u"?window:global;let Rn=class{constructor(t){this._mouseDown=!1,this._touchStarts=!1,this._touchActive=!1,this._longTapTimer=!1,this._gantt=t,this._domEvents=t._createDomEventScope()}attach(t,n,e){const i=this._gantt,a=t.getViewPort();this._originPosition=Q.getComputedStyle(a).display,this._restoreOriginPosition=()=>{a.style.position=this._originPosition},this._originPosition==="static"&&(a.style.position="relative");const s=i.$services.getService("state");s.registerProvider("clickDrag",()=>({autoscroll:!1}));let r=null;const o=()=>{r&&(this._mouseDown=!0,t.setStart(i.copy(r)),t.setPosition(i.copy(r)),t.setEnd(i.copy(r)),r=null)};this._domEvents.attach(a,"mousedown",f=>{u(f)});const l=bt(i.$root)||document.body;function d(f){return f.changedTouches&&f.changedTouches[0]||f}this._domEvents.attach(l,"mouseup",f=>{h(f)}),this._domEvents.attach(a,"mousemove",f=>{_(f)}),this._domEvents.attach(a,"touchstart",f=>{this._touchStarts=!0,this._longTapTimer=setTimeout(()=>{this._touchStarts&&(u(d(f)),this._touchStarts=!1,this._touchActive=!0)},this._gantt.config.touch_drag)}),this._domEvents.attach(l,"touchend",f=>{this._touchStarts=!1,this._touchActive=!1,clearTimeout(this._longTapTimer),h(d(f))}),this._domEvents.attach(a,"touchmove",f=>{if(this._touchActive){let y=c();if(y&&i.utils.dom.closest(f.target,y))return;_(d(f)),f.preventDefault()}else this._touchStarts=!1,clearTimeout(this._longTapTimer)});const c=()=>{let f=".gantt_task_line, .gantt_task_link";return e!==void 0&&(f=e instanceof Array?e.join(", "):e),f},u=f=>{r=null;let y=c();y&&i.utils.dom.closest(f.target,y)||(s.registerProvider("clickDrag",()=>({autoscroll:this._mouseDown})),n&&f[n]!==!0||(r=this._getCoordinates(f,t)))},h=f=>{if(r=null,(!n||f[n]===!0)&&this._mouseDown===!0){this._mouseDown=!1;const y=this._getCoordinates(f,t);t.dragEnd(y)}},_=f=>{if(n&&f[n]!==!0)return;const y=this._gantt.ext.clickDrag,v=(this._gantt.config.drag_timeline||{}).useKey;if(y&&v&&!n&&f[v])return;let b=null;if(!this._mouseDown&&r)return b=this._getCoordinates(f,t),void(Math.abs(r.relative.left-b.relative.left)>5&&o());this._mouseDown===!0&&(b=this._getCoordinates(f,t),t.setEnd(b),t.render())}}detach(){const t=this._gantt;this._domEvents.detachAll(),this._restoreOriginPosition&&this._restoreOriginPosition(),t.$services.getService("state").unregisterProvider("clickDrag")}destructor(){this.detach()}_getCoordinates(t,n){const e=n.getViewPort(),i=e.getBoundingClientRect(),{clientX:a,clientY:s}=t;return{absolute:{left:a,top:s},relative:{left:a-i.left+e.scrollLeft,top:s-i.top+e.scrollTop}}}};var ze=function(){this._silent_mode=!1,this.listeners={}};ze.prototype={_silentStart:function(){this._silent_mode=!0},_silentEnd:function(){this._silent_mode=!1}};function st(t){var n=new ze;t.attachEvent=function(e,i,a){e="ev_"+e.toLowerCase(),n.listeners[e]||(n.listeners[e]=function(r){var o={},l=0,d=function(){var c=!0;for(var u in o){var h=o[u].apply(r,arguments);c=c&&h}return c};return d.addEvent=function(c,u){if(typeof c=="function"){var h;if(u&&u.id?h=u.id:(h=l,l++),u&&u.once){var _=c;c=function(){_(),d.removeEvent(h)}}return o[h]=c,h}return!1},d.removeEvent=function(c){delete o[c]},d.clear=function(){o={}},d}(this)),a&&a.thisObject&&(i=i.bind(a.thisObject));var s=e+":"+n.listeners[e].addEvent(i,a);return a&&a.id&&(s=a.id),s},t.attachAll=function(e){this.attachEvent("listen_all",e)},t.callEvent=function(e,i){if(n._silent_mode)return!0;var a="ev_"+e.toLowerCase(),s=n.listeners;return s.ev_listen_all&&s.ev_listen_all.apply(this,[e].concat(i)),!s[a]||s[a].apply(this,i)},t.checkEvent=function(e){return!!n.listeners["ev_"+e.toLowerCase()]},t.detachEvent=function(e){if(e){var i=n.listeners;for(var a in i)i[a].removeEvent(e);var s=e.split(":");if(i=n.listeners,s.length===2){var r=s[0],o=s[1];i[r]&&i[r].removeEvent(o)}}},t.detachAllEvents=function(){for(var e in n.listeners)n.listeners[e].clear()}}var je={second:1,minute:60,hour:3600,day:86400,week:604800,month:2592e3,quarter:7776e3,year:31536e3};function Ft(t){return je[t]||je.hour}function xt(t,n){if(t.forEach)t.forEach(n);else for(var e=t.slice(),i=0;i<e.length;i++)n(e[i],i)}function Pn(t,n){if(t.find)return t.find(n);for(var e=0;e<t.length;e++)if(n(t[e],e))return t[e]}function Vt(t,n){if(t.includes)return t.includes(n);for(var e=0;e<t.length;e++)if(t[e]===n)return!0;return!1}function de(t){return Array.isArray?Array.isArray(t):t&&t.length!==void 0&&t.pop&&t.push}function tt(t){return!(!t||typeof t!="object")&&!!(t.getFullYear&&t.getMonth&&t.getDate)}function St(t){return tt(t)&&!isNaN(t.getTime())}function ce(t,n){var e,i=function(){i.$cancelTimeout(),i.$pending=!0;var a=Array.prototype.slice.call(arguments);e=setTimeout(function(){t.apply(this,a),i.$pending=!1},n)};return i.$pending=!1,i.$cancelTimeout=function(){clearTimeout(e),i.$pending=!1},i.$execute=function(){var a=Array.prototype.slice.call(arguments);t.apply(this,a),i.$cancelTimeout()},i}function rt(t,n){return We(t)&&!We(n)&&(t="0"),t}function We(t){return t===0}function Tt(t,n){for(var e,i,a,s=0,r=t.length-1;s<=r;)if(i=+t[e=Math.floor((s+r)/2)],a=+t[e-1],i<n)s=e+1;else{if(!(i>n)){for(;+t[e]==+t[e+1];)e++;return e}if(!isNaN(a)&&a<n)return e-1;r=e-1}return t.length-1}class Hn{constructor(n,e,i){var a;this._el=document.createElement("div"),this.defaultRender=(s,r)=>{this._el||(this._el=document.createElement("div"));const o=this._el,l=Math.min(s.relative.top,r.relative.top),d=Math.max(s.relative.top,r.relative.top),c=Math.min(s.relative.left,r.relative.left),u=Math.max(s.relative.left,r.relative.left);if(this._singleRow){const h=this._getTaskPositionByTop(this._startPoint.relative.top);o.style.height=h.height+"px",o.style.top=h.top+"px"}else o.style.height=Math.abs(d-l)+"px",o.style.top=l+"px";return o.style.width=Math.abs(u-c)+"px",o.style.left=c+"px",o},this._gantt=e,this._view=i,this._viewPort=n.viewPort,this._el.classList.add(n.className),typeof n.callback=="function"&&(this._callback=n.callback),this.render=()=>{let s;s=n.render?n.render(this._startPoint,this._endPoint):this.defaultRender(this._startPoint,this._endPoint),s!==this._el&&(this._el&&this._el.parentNode&&this._el.parentNode.removeChild(this._el),this._el=s),n.className!==""&&this._el.classList.add(n.className),this.draw()},(a=this._viewPort).attachEvent&&a.detachEvent||st(this._viewPort),this._singleRow=n.singleRow,this._useRequestAnimationFrame=n.useRequestAnimationFrame}draw(){if(this._useRequestAnimationFrame)return requestAnimationFrame(()=>{this._viewPort.appendChild(this.getElement())});this._viewPort.appendChild(this.getElement())}clear(){if(this._useRequestAnimationFrame)return requestAnimationFrame(()=>{this._el.parentNode&&this._viewPort.removeChild(this._el)});this._el.parentNode&&this._viewPort.removeChild(this._el)}getElement(){return this._el}getViewPort(){return this._viewPort}setStart(n){const e=this._gantt;this._startPoint=n,this._startDate=e.dateFromPos(this._startPoint.relative.left),this._viewPort.callEvent("onBeforeDrag",[this._startPoint])}setEnd(n){const e=this._gantt;if(this._endPoint=n,this._singleRow){const i=this._getTaskPositionByTop(this._startPoint.relative.top);this._endPoint.relative.top=i.top}this._endDate=e.dateFromPos(this._endPoint.relative.left),this._startPoint.relative.left>this._endPoint.relative.left&&(this._positionPoint={relative:{left:this._endPoint.relative.left,top:this._positionPoint.relative.top},absolute:{left:this._endPoint.absolute.left,top:this._positionPoint.absolute.top}}),this._startPoint.relative.top>this._endPoint.relative.top&&(this._positionPoint={relative:{left:this._positionPoint.relative.left,top:this._endPoint.relative.top},absolute:{left:this._positionPoint.absolute.left,top:this._endPoint.absolute.top}}),this._viewPort.callEvent("onDrag",[this._startPoint,this._endPoint])}setPosition(n){this._positionPoint=n}dragEnd(n){const e=this._gantt;n.relative.left<0&&(n.relative.left=0),this._viewPort.callEvent("onBeforeDragEnd",[this._startPoint,n]),this.setEnd(n),this._endDate=this._endDate||e.getState().max_date,this._startDate.valueOf()>this._endDate.valueOf()&&([this._startDate,this._endDate]=[this._endDate,this._startDate]),this.clear();const i=e.getTaskByTime(this._startDate,this._endDate),a=this._getTasksByTop(this._startPoint.relative.top,this._endPoint.relative.top);this._viewPort.callEvent("onDragEnd",[this._startPoint,this._endPoint]),this._callback&&this._callback(this._startPoint,this._endPoint,this._startDate,this._endDate,i,a)}getInBounds(){return this._singleRow}_getTasksByTop(n,e){const i=this._gantt;let a=n,s=e;n>e&&(a=e,s=n);const r=this._getTaskPositionByTop(a).index,o=this._getTaskPositionByTop(s).index,l=[];for(let d=r;d<=o;d++)i.getTaskByIndex(d)&&l.push(i.getTaskByIndex(d));return l}_getTaskPositionByTop(n){const e=this._gantt,i=this._view,a=i.getItemIndexByTopPosition(n),s=e.getTaskByIndex(a);if(s){const r=i.getItemHeight(s.id);return{top:i.getItemTop(s.id)||0,height:r||0,index:a}}{const r=i.getTotalHeight();return{top:n>r?r:0,height:e.config.row_height,index:n>r?e.getTaskCount():0}}}}let ue=!1;class Ut{constructor(n){this._mouseDown=!1,this._calculateDirectionVector=()=>{if(this._trace.length>=10){const e=this._trace.slice(this._trace.length-10),i=[];for(let s=1;s<e.length;s++)i.push({x:e[s].x-e[s-1].x,y:e[s].y-e[s-1].y});const a={x:0,y:0};return i.forEach(s=>{a.x+=s.x,a.y+=s.y}),{magnitude:Math.sqrt(a.x*a.x+a.y*a.y),angleDegrees:180*Math.atan2(Math.abs(a.y),Math.abs(a.x))/Math.PI}}return null},this._applyDndReadyStyles=()=>{this._timeline.$task.classList.add("gantt_timeline_move_available")},this._clearDndReadyStyles=()=>{this._timeline.$task.classList.remove("gantt_timeline_move_available")},this._getScrollPosition=e=>{const i=this._gantt;return{x:i.$ui.getView(e.$config.scrollX).getScrollState().position,y:i.$ui.getView(e.$config.scrollY).getScrollState().position}},this._countNewScrollPosition=e=>{const i=this._calculateDirectionVector();let a=this._startPoint.x-e.x,s=this._startPoint.y-e.y;return i&&(i.angleDegrees<15?s=0:i.angleDegrees>75&&(a=0)),{x:this._scrollState.x+a,y:this._scrollState.y+s}},this._setScrollPosition=(e,i)=>{const a=this._gantt;requestAnimationFrame(()=>{a.scrollLayoutCell(e.$id,i.x,i.y)})},this._stopDrag=e=>{const i=this._gantt;if(this._trace=[],i.$root.classList.remove("gantt_noselect"),this._originalReadonly!==void 0&&this._mouseDown&&(i.config.readonly=this._originalReadonly,i.config.drag_timeline&&i.config.drag_timeline.render&&i.render()),this._originAutoscroll!==void 0&&(i.config.autoscroll=this._originAutoscroll),i.config.drag_timeline){const{useKey:a}=i.config.drag_timeline;if(a&&e[a]!==!0)return}this._mouseDown=!1,ue=!1},this._startDrag=e=>{const i=this._gantt;this._originAutoscroll=i.config.autoscroll,i.config.autoscroll=!1,ue=!0,i.$root.classList.add("gantt_noselect"),this._originalReadonly=i.config.readonly,i.config.readonly=!0,i.config.drag_timeline&&i.config.drag_timeline.render&&i.render(),this._trace=[],this._mouseDown=!0;const{x:a,y:s}=this._getScrollPosition(this._timeline);this._scrollState={x:a,y:s},this._startPoint={x:e.clientX,y:e.clientY},this._trace.push(this._startPoint)},this._gantt=n,this._domEvents=n._createDomEventScope(),this._trace=[]}static create(n){return new Ut(n)}static _isDragInProgress(){return ue}destructor(){this._domEvents.detachAll()}attach(n){this._timeline=n;const e=this._gantt;this._domEvents.attach(n.$task,"mousedown",i=>{if(!e.config.drag_timeline)return;const{useKey:a,ignore:s,enabled:r}=e.config.drag_timeline;if(r===!1)return;let o=".gantt_task_line, .gantt_task_link";s!==void 0&&(o=s instanceof Array?s.join(", "):s),o&&e.utils.dom.closest(i.target,o)||a&&i[a]!==!0||this._startDrag(i)}),this._domEvents.attach(document,"keydown",i=>{if(!e.config.drag_timeline)return;const{useKey:a}=e.config.drag_timeline;a&&i[a]===!0&&this._applyDndReadyStyles()}),this._domEvents.attach(document,"keyup",i=>{if(!e.config.drag_timeline)return;const{useKey:a}=e.config.drag_timeline;a&&i[a]===!1&&(this._clearDndReadyStyles(),this._stopDrag(i))}),this._domEvents.attach(document,"mouseup",i=>{this._stopDrag(i)}),this._domEvents.attach(e.$root,"mouseup",i=>{this._stopDrag(i)}),this._domEvents.attach(document,"mouseleave",i=>{this._stopDrag(i)}),this._domEvents.attach(e.$root,"mouseleave",i=>{this._stopDrag(i)}),this._domEvents.attach(e.$root,"mousemove",i=>{if(!e.config.drag_timeline)return;const{useKey:a}=e.config.drag_timeline;if(a&&i[a]!==!0)return;const s=this._gantt.ext.clickDrag,r=(this._gantt.config.click_drag||{}).useKey;if((!s||!r||a||!i[r])&&this._mouseDown===!0){this._trace.push({x:i.clientX,y:i.clientY});const o=this._countNewScrollPosition({x:i.clientX,y:i.clientY});this._setScrollPosition(n,o),this._scrollState=o,this._startPoint={x:i.clientX,y:i.clientY}}})}}var he,On={}.constructor.toString();function K(t){var n,e;if(t&&typeof t=="object")switch(!0){case tt(t):e=new Date(t);break;case de(t):for(e=new Array(t.length),n=0;n<t.length;n++)e[n]=K(t[n]);break;default:if(function(i){return i.constructor.toString()!==On}(t))e=Object.create(t);else{if(function(i){return i.$$typeof&&i.$$typeof.toString().includes("react.")}(t))return e=t;e={}}for(n in t)Object.prototype.hasOwnProperty.apply(t,[n])&&(e[n]=K(t[n]))}return e||t}function R(t,n,e){for(var i in n)(t[i]===void 0||e)&&(t[i]=n[i]);return t}function U(t){return t!==void 0}function ot(){return he||(he=new Date().valueOf()),++he}function O(t,n){return t.bind?t.bind(n):function(){return t.apply(n,arguments)}}function Fe(t,n,e,i){t.addEventListener?t.addEventListener(n,e,i!==void 0&&i):t.attachEvent&&t.attachEvent("on"+n,e)}function Ve(t,n,e,i){t.removeEventListener?t.removeEventListener(n,e,i!==void 0&&i):t.detachEvent&&t.detachEvent("on"+n,e)}const Bn=Object.freeze(Object.defineProperty({__proto__:null,bind:O,copy:K,defined:U,event:Fe,eventRemove:Ve,mixin:R,uid:ot},Symbol.toStringTag,{value:"Module"}));function qt(t){var n=t.date;return t.$services,{getSum:function(e,i,a){a===void 0&&(a=e.length-1),i===void 0&&(i=0);for(var s=0,r=i;r<=a;r++)s+=e[r];return s},setSumWidth:function(e,i,a,s){var r=i.width;s===void 0&&(s=r.length-1),a===void 0&&(a=0);var o=s-a+1;if(!(a>r.length-1||o<=0||s>r.length-1)){var l=e-this.getSum(r,a,s);this.adjustSize(l,r,a,s),this.adjustSize(-l,r,s+1),i.full_width=this.getSum(r)}},splitSize:function(e,i){for(var a=[],s=0;s<i;s++)a[s]=0;return this.adjustSize(e,a),a},adjustSize:function(e,i,a,s){a||(a=0),s===void 0&&(s=i.length-1);for(var r=s-a+1,o=this.getSum(i,a,s),l=a;l<=s;l++){var d=Math.floor(e*(o?i[l]/o:1/r));o-=i[l],e-=d,r--,i[l]+=d}i[i.length-1]+=e},sortScales:function(e){function i(s,r){var o=new Date(1970,0,1);return n.add(o,r,s)-o}e.sort(function(s,r){return i(s.unit,s.step)<i(r.unit,r.step)?1:i(s.unit,s.step)>i(r.unit,r.step)?-1:0});for(var a=0;a<e.length;a++)e[a].index=a},_prepareScaleObject:function(e){var i=e.format;return i||(i=e.template||e.date||"%d %M"),typeof i=="string"&&(i=t.date.date_to_str(i)),{unit:e.unit||"day",step:e.step||1,format:i,css:e.css,projection:e.projection||null,column_width:e.column_width||null}},primaryScale:function(e){const i=(e||t.config).scales[0],a={unit:i.unit,step:i.step,template:i.template,format:i.format,date:i.date,css:i.css||t.templates.scale_cell_class,projection:i.projection||null,column_width:i.column_width||null};return this._prepareScaleObject(a)},getAdditionalScales:function(e){return(e||t.config).scales.slice(1).map((function(i){return this._prepareScaleObject(i)}).bind(this))},prepareConfigs:function(e,i,a,s,r,o,l){for(var d=this.splitSize(s,e.length),c=a,u=[],h=e.length-1;h>=0;h--){var _=h==e.length-1,f=this.initScaleConfig(e[h],r,o);_&&this.processIgnores(f),_&&f.column_width&&(c=f.column_width*(f.display_count||f.count)),this.initColSizes(f,i,c,d[h]),this.limitVisibleRange(f),_&&(c=f.full_width),u.unshift(f)}for(h=0;h<u.length-1;h++)this.alineScaleColumns(u[u.length-1],u[h]);for(h=0;h<u.length;h++)l&&this.reverseScale(u[h]),this.setPosSettings(u[h]);return u},reverseScale:function(e){e.width=e.width.reverse(),e.trace_x=e.trace_x.reverse();var i=e.trace_indexes;e.trace_indexes={},e.trace_index_transition={},e.rtl=!0;for(var a=0;a<e.trace_x.length;a++)e.trace_indexes[e.trace_x[a].valueOf()]=a,e.trace_index_transition[i[e.trace_x[a].valueOf()]]=a;return e},setPosSettings:function(e){for(var i=0,a=e.trace_x.length;i<a;i++)e.left.push((e.width[i-1]||0)+(e.left[i-1]||0))},_ignore_time_config:function(e,i){if(t.config.skip_off_time){for(var a=!0,s=e,r=0;r<i.step;r++)r&&(s=n.add(e,r,i.unit)),a=a&&!this.isWorkTime(s,i.unit);return a}return!1},processIgnores:function(e){e.ignore_x={},e.display_count=e.count},initColSizes:function(e,i,a,s){var r=a;e.height=s;var o=e.display_count===void 0?e.count:e.display_count;o||(o=1);const l=!isNaN(1*e.column_width)&&1*e.column_width>0;if(l){const h=1*e.column_width;e.col_width=h,r=h*o}else e.col_width=Math.floor(r/o),i&&e.col_width<i&&(e.col_width=i,r=e.col_width*o);e.width=[];for(var d=e.ignore_x||{},c=0;c<e.trace_x.length;c++)if(d[e.trace_x[c].valueOf()]||e.display_count==e.count)e.width[c]=l?e.col_width:0;else{var u=1;e.unit=="month"&&(u=Math.round((n.add(e.trace_x[c],e.step,e.unit)-e.trace_x[c])/864e5)),e.width[c]=u}l||this.adjustSize(r-this.getSum(e.width),e.width),e.full_width=this.getSum(e.width)},initScaleConfig:function(e,i,a){var s=R({count:0,col_width:0,full_width:0,height:0,width:[],left:[],trace_x:[],trace_indexes:{},min_date:new Date(i),max_date:new Date(a)},e);return this.eachColumn(e.unit,e.step,i,a,function(r){s.count++,s.trace_x.push(new Date(r)),s.trace_indexes[r.valueOf()]=s.trace_x.length-1}),s.trace_x_ascending=s.trace_x.slice(),s},iterateScales:function(e,i,a,s,r){for(var o=i.trace_x,l=e.trace_x,d=a||0,c=s||l.length-1,u=0,h=1;h<o.length;h++){var _=e.trace_indexes[+o[h]];_!==void 0&&_<=c&&(r&&r.apply(this,[u,h,d,_]),d=_,u=h)}},alineScaleColumns:function(e,i,a,s){this.iterateScales(e,i,a,s,function(r,o,l,d){var c=this.getSum(e.width,l,d-1);this.getSum(i.width,r,o-1)!=c&&this.setSumWidth(c,i,r,o-1)})},eachColumn:function(e,i,a,s,r){var o=new Date(a),l=new Date(s);n[e+"_start"]&&(o=n[e+"_start"](o));var d=new Date(o);for(+d>=+l&&(l=n.add(d,i,e));+d<+l;){r.call(this,new Date(d));var c=d.getTimezoneOffset();d=n.add(d,i,e),d=t._correct_dst_change(d,c,i,e),n[e+"_start"]&&(d=n[e+"_start"](d))}},limitVisibleRange:function(e){var i=e.trace_x,a=e.width.length-1,s=0;if(+i[0]<+e.min_date&&a!=0){var r=Math.floor(e.width[0]*((i[1]-e.min_date)/(i[1]-i[0])));s+=e.width[0]-r,e.width[0]=r,i[0]=new Date(e.min_date)}var o=i.length-1,l=i[o],d=n.add(l,e.step,e.unit);if(+d>+e.max_date&&o>0&&(r=e.width[o]-Math.floor(e.width[o]*((d-e.max_date)/(d-l))),s+=e.width[o]-r,e.width[o]=r),s){for(var c=this.getSum(e.width),u=0,h=0;h<e.width.length;h++){var _=Math.floor(s*(e.width[h]/c));e.width[h]+=_,u+=_}this.adjustSize(s-u,e.width)}}}}function zn(t){(function(){var n=[];function e(){return!!n.length}function i(d){setTimeout(function(){e()||t.$destroyed||t.focus()},1)}function a(d){t.eventRemove(d,"keydown",r),t.event(d,"keydown",r),n.push(d)}function s(){var d=n.pop();d&&t.eventRemove(d,"keydown",r),i()}function r(d){var c=d.currentTarget;c==n[n.length-1]&&t.$keyboardNavigation.trapFocus(c,d)}function o(){a(t.getLightbox())}t.attachEvent("onLightbox",o),t.attachEvent("onAfterLightbox",s),t.attachEvent("onLightboxChange",function(){s(),o()}),t.attachEvent("onAfterQuickInfo",function(){i()}),t.attachEvent("onMessagePopup",function(d){l=t.utils.dom.getActiveElement(),a(d)}),t.attachEvent("onAfterMessagePopup",function(){s(),setTimeout(function(){l&&l.focus&&(l.focus(),l=null)},1)});var l=null;t.$keyboardNavigation.isModal=e})()}class jn{constructor(n){this.show=(e,i)=>{i===void 0?this._showForTask(e):this._showAtCoordinates(e,i)},this.hide=e=>{const i=this._gantt,a=this._quickInfoBox;this._quickInfoBoxId=0;const s=this._quickInfoTask;if(this._quickInfoTask=null,a&&a.parentNode){if(i.config.quick_info_detached)return i.callEvent("onAfterQuickInfo",[s]),a.parentNode.removeChild(a);a.className+=" gantt_qi_hidden",a.style.right==="auto"?a.style.left="-350px":a.style.right="-350px",e&&(a.style.left=a.style.right="",a.parentNode.removeChild(a)),i.callEvent("onAfterQuickInfo",[s])}},this.getNode=()=>this._quickInfoBox?this._quickInfoBox:null,this.setContainer=e=>{e&&(this._container=typeof e=="string"?document.getElementById(e):e)},this.setContent=e=>{const i=this._gantt,a={taskId:null,header:{title:"",date:""},content:"",buttons:i.config.quickinfo_buttons};e||(e=a),e.taskId||(e.taskId=a.taskId),e.header||(e.header=a.header),e.header.title||(e.header.title=a.header.title),e.header.date||(e.header.date=a.header.date),e.content||(e.content=a.content),e.buttons||(e.buttons=a.buttons);let s=this.getNode();s||(s=this._createQuickInfoElement()),e.taskId&&(this._quickInfoBoxId=e.taskId);const r=s.querySelector(".gantt_cal_qi_title"),o=r.querySelector(".gantt_cal_qi_tcontent"),l=r.querySelector(".gantt_cal_qi_tdate"),d=s.querySelector(".gantt_cal_qi_content"),c=s.querySelector(".gantt_cal_qi_controls");i._waiAria.quickInfoHeader(s,[e.header.title,e.header.date].join(" ")),o.innerHTML=e.header.title,l.innerHTML=e.header.date,e.header.title||e.header.date?r.style.display="":r.style.display="none",d.innerHTML=e.content;const u=e.buttons;u.length?c.style.display="":c.style.display="none";let h="";for(let _=0;_<u.length;_++){const f=i._waiAria.quickInfoButtonAttrString(i.locale.labels[u[_]]);h+=`<div class="gantt_qi_big_icon ${u[_]} dhx_gantt_${u[_]}" title="${i.locale.labels[u[_]]}" ${f}>
            <div class='dhx_menu_icon dhx_gantt_icon ${u[_]} gantt_menu_icon dhx_gantt_${u[_]}'></div>
            <div>${i.locale.labels[u[_]]}</div>
         </div>`}c.innerHTML=h,i.eventRemove(s,"click",this._qiButtonClickHandler),i.eventRemove(s,"keypress",this._qiKeyPressHandler),i.event(s,"click",this._qiButtonClickHandler),i.event(s,"keypress",this._qiKeyPressHandler)},this._qiButtonClickHandler=e=>{this._qi_button_click(e.target)},this._qiKeyPressHandler=e=>{const i=e.which;i!==13&&i!==32||setTimeout(()=>{this._qi_button_click(e.target)},1)},this._gantt=n}_showAtCoordinates(n,e){this.hide(!0),this._quickInfoBoxId=0,this._quickInfoTask=null,this._quickInfoBox||(this._createQuickInfoElement(),this.setContent()),this._appendAtCoordinates(n,e),this._gantt.callEvent("onQuickInfo",[null])}_showForTask(n){const e=this._gantt;if(n===this._quickInfoBoxId&&e.utils.dom.isChildOf(this._quickInfoBox,document.body)||!e.config.show_quick_info)return;this.hide(!0);const i=this._getContainer(),a=this._get_event_counter_part(n,6,i.xViewport,i.yViewport);a&&(this._quickInfoBox=this._init_quick_info(n),this._quickInfoTask=n,this._quickInfoBox.className=this._prepare_quick_info_classname(n),this._fill_quick_data(n),this._show_quick_info(a,6),e.callEvent("onQuickInfo",[n]))}_get_event_counter_part(n,e,i,a){const s=this._gantt;let r=s.getTaskNode(n);if(!r&&(r=s.getTaskRowNode(n),!r))return null;let o=0;const l=e+r.offsetTop+r.offsetHeight;let d=r;if(s.utils.dom.isChildOf(d,i))for(;d&&d!==i;)o+=d.offsetLeft,d=d.offsetParent;const c=s.getScrollState();return d?{left:o,top:l,dx:o+r.offsetWidth/2-c.x>i.offsetWidth/2?1:0,dy:l+r.offsetHeight/2-c.y>a.offsetHeight/2?1:0,width:r.offsetWidth,height:r.offsetHeight}:null}_createQuickInfoElement(){const n=this._gantt,e=document.createElement("div");e.className+="gantt_cal_quick_info",n._waiAria.quickInfoAttr(e);var i=`
		<div class="gantt_cal_qi_tcontrols">
			<a class="gantt_cal_qi_close_btn dhx_gantt_icon dhx_gantt_icon_close"></a>
		</div>
		<div class="gantt_cal_qi_title" ${n._waiAria.quickInfoHeaderAttrString()}>
				
				<div class="gantt_cal_qi_tcontent"></div>
				<div class="gantt_cal_qi_tdate"></div>
			</div>
			<div class="gantt_cal_qi_content"></div>`;if(i+='<div class="gantt_cal_qi_controls">',i+="</div>",e.innerHTML=i,n.config.quick_info_detached){const a=this._getContainer();n.event(a.parent,"scroll",()=>{this.hide()})}return this._quickInfoBox=e,e}_init_quick_info(n){const e=this._gantt,i=e.getTask(n);return typeof this._quickInfoReadonly=="boolean"&&e.isReadonly(i)!==this._quickInfoReadonly&&(this.hide(!0),this._quickInfoBox=null),this._quickInfoReadonly=e.isReadonly(i),this._quickInfoBox||(this._quickInfoBox=this._createQuickInfoElement()),this._quickInfoBox}_prepare_quick_info_classname(n){const e=this._gantt,i=e.getTask(n);let a=`gantt_cal_quick_info gantt_${e.getTaskType(i)}`;const s=e.templates.quick_info_class(i.start_date,i.end_date,i);return s&&(a+=" "+s),a}_fill_quick_data(n){const e=this._gantt,i=e.getTask(n);this._quickInfoBoxId=n;let a=[];if(this._quickInfoReadonly){const s=e.config.quickinfo_buttons,r={icon_delete:!0,icon_edit:!0};for(let o=0;o<s.length;o++)this._quickInfoReadonly&&r[s[o]]||a.push(s[o])}else a=e.config.quickinfo_buttons;this.setContent({header:{title:e.templates.quick_info_title(i.start_date,i.end_date,i),date:e.templates.quick_info_date(i.start_date,i.end_date,i)},content:e.templates.quick_info_content(i.start_date,i.end_date,i),buttons:a})}_appendAtCoordinates(n,e){const i=this._quickInfoBox,a=this._getContainer();i.parentNode&&i.parentNode.nodeName.toLowerCase()!=="#document-fragment"||a.parent.appendChild(i),i.style.left=n+"px",i.style.top=e+"px"}_show_quick_info(n,e){const i=this._gantt,a=this._quickInfoBox;if(i.config.quick_info_detached){const s=this._getContainer();a.parentNode&&a.parentNode.nodeName.toLowerCase()!=="#document-fragment"||s.parent.appendChild(a);const r=a.offsetWidth,o=a.offsetHeight,l=i.getScrollState(),d=s.xViewport,c=s.yViewport,u=d.offsetWidth+l.x-r,h=n.top-l.y+o;let _=n.top;h>c.offsetHeight/2&&(_=n.top-(o+n.height+2*e),_<l.y&&h<=c.offsetHeight&&(_=n.top)),_<l.y&&(_=l.y);const f=Math.min(Math.max(l.x,n.left-n.dx*(r-n.width)),u),y=_;this._appendAtCoordinates(f,y)}else a.style.top="20px",n.dx===1?(a.style.right="auto",a.style.left="-300px",setTimeout(()=>{a.style.left="10px"},1)):(a.style.left="auto",a.style.right="-300px",setTimeout(()=>{a.style.right="10px"},1)),a.className+=" gantt_qi_"+(n.dx===1?"left":"right"),i.$root.appendChild(a)}_qi_button_click(n){const e=this._gantt,i=this._quickInfoBox;if(!n||n===i)return;if(n.closest(".gantt_cal_qi_close_btn"))return void this.hide();const a=n.className;if(a.indexOf("_icon")!==-1){const s=this._quickInfoBoxId;e.$click.buttons[a.split(" ")[1].replace("icon_","")](s)}else this._qi_button_click(n.parentNode)}_getContainer(){const n=this._gantt;let e=this._container?this._container:n.$task_data;return e&&e.offsetHeight&&e.offsetWidth?{parent:e,xViewport:n.$task,yViewport:n.$task_data}:(e=this._container?this._container:n.$grid_data,e&&e.offsetHeight&&e.offsetWidth?{parent:e,xViewport:n.$grid,yViewport:n.$grid_data}:{parent:this._container?this._container:n.$layout,xViewport:n.$layout,yViewport:n.$layout})}}function Gt(t,n){t=t||Fe,n=n||Ve;var e=[],i={attach:function(a,s,r,o){e.push({element:a,event:s,callback:r,capture:o}),t(a,s,r,o)},detach:function(a,s,r,o){n(a,s,r,o);for(var l=0;l<e.length;l++){var d=e[l];d.element===a&&d.event===s&&d.callback===r&&d.capture===o&&(e.splice(l,1),l--)}},detachAll:function(){for(var a=e.slice(),s=0;s<a.length;s++){var r=a[s];i.detach(r.element,r.event,r.callback,r.capture),i.detach(r.element,r.event,r.callback,void 0),i.detach(r.element,r.event,r.callback,!1),i.detach(r.element,r.event,r.callback,!0)}e.splice(0,e.length)},extend:function(){return Gt(this.event,this.eventRemove)}};return i}class Wn{constructor(n){this._gantt=n}getNode(){const n=this._gantt;return this._tooltipNode||(this._tooltipNode=document.createElement("div"),this._tooltipNode.className="gantt_tooltip",n._waiAria.tooltipAttr(this._tooltipNode)),this._tooltipNode}setViewport(n){return this._root=n,this}show(n,e){const i=this._gantt,a=document.body,s=this.getNode();if(J(s,a)||(this.hide(),s.style.top=s.style.top||"0px",s.style.left=s.style.left||"0px",a.appendChild(s)),this._isLikeMouseEvent(n)){const r=this._calculateTooltipPosition(n);e=r.top,n=r.left}return s.style.top=e+"px",s.style.left=n+"px",i._waiAria.tooltipVisibleAttr(s),this}hide(){const n=this._gantt,e=this.getNode();return e&&e.parentNode&&e.parentNode.removeChild(e),n._waiAria.tooltipHiddenAttr(e),this}setContent(n){return this.getNode().innerHTML=n,this}_isLikeMouseEvent(n){return!(!n||typeof n!="object")&&"clientX"in n&&"clientY"in n}_getViewPort(){return this._root||document.body}_calculateTooltipPosition(n){const e=this._gantt,i=this._getViewPortSize(),a=this.getNode(),s={top:0,left:0,width:a.offsetWidth,height:a.offsetHeight,bottom:0,right:0},r=e.config.tooltip_offset_x,o=e.config.tooltip_offset_y,l=document.body,d=at(n,l),c=V(l);d.y+=c.y,s.top=d.y,s.left=d.x,s.top+=o,s.left+=r,s.bottom=s.top+s.height,s.right=s.left+s.width;const u=window.scrollY+l.scrollTop;return s.top<i.top-u?(s.top=i.top,s.bottom=s.top+s.height):s.bottom>i.bottom&&(s.bottom=i.bottom,s.top=s.bottom-s.height),s.left<i.left?(s.left=i.left,s.right=i.left+s.width):s.right>i.right&&(s.right=i.right,s.left=s.right-s.width),d.x>=s.left&&d.x<=s.right&&(s.left=d.x-s.width-r,s.right=s.left+s.width),d.y>=s.top&&d.y<=s.bottom&&(s.top=d.y-s.height-o,s.bottom=s.top+s.height),s.left<0&&(s.left=0),s.right<0&&(s.right=0),s}_getViewPortSize(){const n=this._gantt,e=this._getViewPort();let i,a=e,s=window.scrollY+document.body.scrollTop,r=window.scrollX+document.body.scrollLeft;return e===n.$task_data?(a=n.$task,s=0,r=0,i=V(n.$task)):i=V(a),{left:i.x+r,top:i.y+s,width:i.width,height:i.height,bottom:i.y+i.height+s,right:i.x+i.width+r}}}class Fn{constructor(n){this._listeners={},this.tooltip=new Wn(n),this._gantt=n,this._domEvents=Gt(),this._initDelayedFunctions()}destructor(){this.tooltip.hide(),this._domEvents.detachAll()}hideTooltip(){this.delayHide()}attach(n){let e=document.body;const i=this._gantt;n.global||(e=i.$root);let a=null;const s=r=>{const o=yt(r),l=dt(o,n.selector);if(J(o,this.tooltip.getNode()))return;const d=()=>{a=l,n.onmouseenter(r,l)};a?l&&l===a?n.onmousemove(r,l):(n.onmouseleave(r,a),a=null,l&&l!==a&&d()):l&&d()};this.detach(n.selector),this._domEvents.attach(e,"mousemove",s),this._listeners[n.selector]={node:e,handler:s}}detach(n){const e=this._listeners[n];e&&this._domEvents.detach(e.node,"mousemove",e.handler)}tooltipFor(n){const e=i=>{let a=i;return document.createEventObject&&!document.createEvent&&(a=document.createEventObject(i)),a};this._initDelayedFunctions(),this.attach({selector:n.selector,global:n.global,onmouseenter:(i,a)=>{const s=n.html(i,a);s&&this.delayShow(e(i),s)},onmousemove:(i,a)=>{const s=n.html(i,a);s?this.delayShow(e(i),s):(this.delayShow.$cancelTimeout(),this.delayHide())},onmouseleave:()=>{this.delayShow.$cancelTimeout(),this.delayHide()}})}_initDelayedFunctions(){const n=this._gantt;this.delayShow&&this.delayShow.$cancelTimeout(),this.delayHide&&this.delayHide.$cancelTimeout(),this.tooltip.hide(),this.delayShow=ce((e,i)=>{n.callEvent("onBeforeTooltip",[e])===!1?this.tooltip.hide():(this.tooltip.setContent(i),this.tooltip.show(e))},n.config.tooltip_timeout||1),this.delayHide=ce(()=>{this.delayShow.$cancelTimeout(),this.tooltip.hide()},n.config.tooltip_hide_timeout||1)}}const Ue={onBeforeUndo:"onAfterUndo",onBeforeRedo:"onAfterRedo"},qe=["onTaskDragStart","onAfterTaskUpdate","onAfterParentExpand","onAfterTaskDelete","onBeforeBatchUpdate"];class Vn{constructor(n,e){this._batchAction=null,this._batchMode=!1,this._ignore=!1,this._ignoreMoveEvents=!1,this._initialTasks={},this._initialLinks={},this._nestedTasks={},this._nestedLinks={},this._undo=n,this._gantt=e,this._attachEvents()}store(n,e,i=!1){return e===this._gantt.config.undo_types.task?this._storeTask(n,i):e===this._gantt.config.undo_types.link&&this._storeLink(n,i)}isMoveEventsIgnored(){return this._ignoreMoveEvents}toggleIgnoreMoveEvents(n){this._ignoreMoveEvents=n||!1}startIgnore(){this._ignore=!0}stopIgnore(){this._ignore=!1}startBatchAction(){this._timeout||(this._timeout=setTimeout(()=>{this.stopBatchAction(),this._timeout=null},10)),this._ignore||this._batchMode||(this._batchMode=!0,this._batchAction=this._undo.action.create())}stopBatchAction(){if(this._ignore)return;const n=this._undo;this._batchAction&&n.logAction(this._batchAction),this._batchMode=!1,this._batchAction=null}onTaskAdded(n){this._ignore||this._storeTaskCommand(n,this._undo.command.type.add)}onTaskUpdated(n){this._ignore||this._storeTaskCommand(n,this._undo.command.type.update)}onTaskMoved(n){this._ignore||(n.$local_index=this._gantt.getTaskIndex(n.id),this._storeEntityCommand(n,this.getInitialTask(n.id),this._undo.command.type.move,this._undo.command.entity.task))}onTaskDeleted(n){if(!this._ignore){if(this._storeTaskCommand(n,this._undo.command.type.remove),this._nestedTasks[n.id]){const e=this._nestedTasks[n.id];for(let i=0;i<e.length;i++)this._storeTaskCommand(e[i],this._undo.command.type.remove)}if(this._nestedLinks[n.id]){const e=this._nestedLinks[n.id];for(let i=0;i<e.length;i++)this._storeLinkCommand(e[i],this._undo.command.type.remove)}}}onLinkAdded(n){this._ignore||this._storeLinkCommand(n,this._undo.command.type.add)}onLinkUpdated(n){this._ignore||this._storeLinkCommand(n,this._undo.command.type.update)}onLinkDeleted(n){this._ignore||this._storeLinkCommand(n,this._undo.command.type.remove)}setNestedTasks(n,e){const i=this._gantt;let a=null;const s=[];let r=this._getLinks(i.getTask(n));for(let d=0;d<e.length;d++)a=this.setInitialTask(e[d]),r=r.concat(this._getLinks(a)),s.push(a);const o={};for(let d=0;d<r.length;d++)o[r[d]]=!0;const l=[];for(const d in o)l.push(this.setInitialLink(d));this._nestedTasks[n]=s,this._nestedLinks[n]=l}setInitialTask(n,e){const i=this._gantt;if(e||!this._initialTasks[n]||!this._batchMode){const a=i.copy(i.getTask(n));a.$index=i.getGlobalTaskIndex(n),a.$local_index=i.getTaskIndex(n),this.setInitialTaskObject(n,a)}return this._initialTasks[n]}getInitialTask(n){return this._initialTasks[n]}clearInitialTasks(){this._initialTasks={}}setInitialTaskObject(n,e){this._initialTasks[n]=e}setInitialLink(n,e){return this._initialLinks[n]&&this._batchMode||(this._initialLinks[n]=this._gantt.copy(this._gantt.getLink(n))),this._initialLinks[n]}getInitialLink(n){return this._initialLinks[n]}clearInitialLinks(){this._initialLinks={}}_attachEvents(){let n=null;const e=this._gantt,i=()=>{n||(n=setTimeout(()=>{n=null}),this.clearInitialTasks(),e.eachTask(l=>{this.setInitialTask(l.id)}),this.clearInitialLinks(),e.getLinks().forEach(l=>{this.setInitialLink(l.id)}))},a=l=>e.copy(e.getTask(l));for(const l in Ue)e.attachEvent(l,()=>(this.startIgnore(),!0)),e.attachEvent(Ue[l],()=>(this.stopIgnore(),!0));for(let l=0;l<qe.length;l++)e.attachEvent(qe[l],()=>(this.startBatchAction(),!0));e.attachEvent("onParse",()=>{this._undo.clearUndoStack(),this._undo.clearRedoStack(),i()}),e.attachEvent("onAfterTaskAdd",(l,d)=>{this.setInitialTask(l,!0),this.onTaskAdded(d)}),e.attachEvent("onAfterTaskUpdate",(l,d)=>{this.onTaskUpdated(d)}),e.attachEvent("onAfterParentExpand",(l,d)=>{this.onTaskUpdated(d)}),e.attachEvent("onAfterTaskDelete",(l,d)=>{this.onTaskDeleted(d)}),e.attachEvent("onAfterLinkAdd",(l,d)=>{this.setInitialLink(l,!0),this.onLinkAdded(d)}),e.attachEvent("onAfterLinkUpdate",(l,d)=>{this.onLinkUpdated(d)}),e.attachEvent("onAfterLinkDelete",(l,d)=>{this.onLinkDeleted(d)}),e.attachEvent("onRowDragEnd",(l,d)=>(this.onTaskMoved(a(l)),this.toggleIgnoreMoveEvents(),!0)),e.attachEvent("onBeforeTaskDelete",l=>{this.store(l,e.config.undo_types.task);const d=[];return i(),e.eachTask(c=>{d.push(c.id)},l),this.setNestedTasks(l,d),!0});const s=e.getDatastore("task");s.attachEvent("onBeforeItemMove",(l,d,c)=>(this.isMoveEventsIgnored()||i(),!0)),s.attachEvent("onAfterItemMove",(l,d,c)=>(this.isMoveEventsIgnored()||this.onTaskMoved(a(l)),!0)),e.attachEvent("onRowDragStart",(l,d,c)=>(this.toggleIgnoreMoveEvents(!0),i(),!0));let r=null,o=!1;if(e.attachEvent("onBeforeTaskDrag",l=>{if(r=e.getState().drag_id,r===l){const d=e.getTask(l);e.isSummaryTask(d)&&e.config.drag_project&&(o=!0)}if(e.plugins().multiselect){const d=e.getSelectedTasks();d.length>1&&d.forEach(c=>{this.store(c,e.config.undo_types.task,!0)})}return this.store(l,e.config.undo_types.task)}),e.attachEvent("onAfterTaskDrag",l=>{(o||e.plugins().multiselect&&e.getSelectedTasks().length>1)&&r===l&&(o=!1,r=null,this.stopBatchAction()),this.store(l,e.config.undo_types.task,!0)}),e.attachEvent("onLightbox",l=>this.store(l,e.config.undo_types.task)),e.attachEvent("onBeforeTaskAutoSchedule",l=>(this.store(l.id,e.config.undo_types.task,!0),!0)),e.ext.inlineEditors){let l=null,d=null;e.attachEvent("onGanttLayoutReady",()=>{l&&e.ext.inlineEditors.detachEvent(l),d&&e.ext.inlineEditors.detachEvent(d),d=e.ext.inlineEditors.attachEvent("onEditStart",c=>{e.$data.tempAssignmentsStore&&e._lightbox_id||this.store(c.id,e.config.undo_types.task)}),l=e.ext.inlineEditors.attachEvent("onBeforeEditStart",c=>(this.stopBatchAction(),!0))})}}_storeCommand(n){const e=this._undo;if(e.updateConfigs(),e.undoEnabled)if(this._batchMode)this._batchAction.commands.push(n);else{const i=e.action.create([n]);e.logAction(i)}}_storeEntityCommand(n,e,i,a){const s=this._undo.command.create(n,e,i,a);this._storeCommand(s)}_storeTaskCommand(n,e){this._gantt.isTaskExists(n.id)&&(n.$local_index=this._gantt.getTaskIndex(n.id)),this._storeEntityCommand(n,this.getInitialTask(n.id),e,this._undo.command.entity.task)}_storeLinkCommand(n,e){this._storeEntityCommand(n,this.getInitialLink(n.id),e,this._undo.command.entity.link)}_getLinks(n){return n.$source.concat(n.$target)}_storeTask(n,e=!1){const i=this._gantt;return this.setInitialTask(n,e),i.eachTask(a=>{this.setInitialTask(a.id)},n),!0}_storeLink(n,e=!1){return this.setInitialLink(n,e),!0}}class Un{constructor(n){this.maxSteps=100,this.undoEnabled=!0,this.redoEnabled=!0,this.action={create:e=>({commands:e?e.slice():[]}),invert:e=>{const i=this._gantt.copy(e),a=this.command;for(let s=0;s<e.commands.length;s++){const r=i.commands[s]=a.invert(i.commands[s]);r.type!==a.type.update&&r.type!==a.type.move||([r.value,r.oldValue]=[r.oldValue,r.value])}return i}},this.command={entity:null,type:null,create:(e,i,a,s)=>{const r=this._gantt;return{entity:s,type:a,value:r.copy(e),oldValue:r.copy(i||e)}},invert:e=>{const i=this._gantt.copy(e);return i.type=this.command.inverseCommands(e.type),i},inverseCommands:e=>{const i=this._gantt,a=this.command.type;switch(e){case a.update:return a.update;case a.remove:return a.add;case a.add:return a.remove;case a.move:return a.move;default:return i.assert(!1,"Invalid command "+e),null}}},this._undoStack=[],this._redoStack=[],this._gantt=n}getUndoStack(){return this._undoStack}setUndoStack(n){this._undoStack=n}getRedoStack(){return this._redoStack}setRedoStack(n){this._redoStack=n}clearUndoStack(){this._undoStack=[]}clearRedoStack(){this._redoStack=[]}updateConfigs(){const n=this._gantt;this.maxSteps=n.config.undo_steps||100,this.command.entity=n.config.undo_types,this.command.type=n.config.undo_actions,this.undoEnabled=!!n.config.undo,this.redoEnabled=!!n.config.redo}undo(){const n=this._gantt;if(this.updateConfigs(),!this.undoEnabled)return;const e=this._pop(this._undoStack);if(e&&this._reorderCommands(e),n.callEvent("onBeforeUndo",[e])!==!1&&e)return this._applyAction(this.action.invert(e)),this._push(this._redoStack,n.copy(e)),void n.callEvent("onAfterUndo",[e]);n.callEvent("onAfterUndo",[null])}redo(){const n=this._gantt;if(this.updateConfigs(),!this.redoEnabled)return;const e=this._pop(this._redoStack);if(e&&this._reorderCommands(e),n.callEvent("onBeforeRedo",[e])!==!1&&e)return this._applyAction(e),this._push(this._undoStack,n.copy(e)),void n.callEvent("onAfterRedo",[e]);n.callEvent("onAfterRedo",[null])}logAction(n){this._push(this._undoStack,n),this._redoStack=[]}_push(n,e){const i=this._gantt;if(!e.commands.length)return;const a=n===this._undoStack?"onBeforeUndoStack":"onBeforeRedoStack";if(i.callEvent(a,[e])!==!1&&e.commands.length){for(n.push(e);n.length>this.maxSteps;)n.shift();return e}}_pop(n){return n.pop()}_reorderCommands(n){const e={any:0,link:1,task:2},i={move:1,any:0};n.commands.sort(function(a,s){if(a.entity==="task"&&s.entity==="task")return a.type!==s.type?(i[s.type]||0)-(i[a.type]||0):a.type==="move"&&a.oldValue&&s.oldValue&&s.oldValue.parent===a.oldValue.parent?a.oldValue.$index-s.oldValue.$index:0;{const r=e[a.entity]||e.any;return(e[s.entity]||e.any)-r}})}_applyAction(n){let e=null;const i=this.command.entity,a=this.command.type,s=this._gantt,r={};r[i.task]={add:"addTask",get:"getTask",update:"updateTask",remove:"deleteTask",move:"moveTask",isExists:"isTaskExists"},r[i.link]={add:"addLink",get:"getLink",update:"updateLink",remove:"deleteLink",isExists:"isLinkExists"},s.batchUpdate(function(){for(let o=0;o<n.commands.length;o++){e=n.commands[o];const l=r[e.entity][e.type],d=r[e.entity].get,c=r[e.entity].isExists;if(e.type===a.add)s[l](e.oldValue,e.oldValue.parent,e.oldValue.$local_index);else if(e.type===a.remove)s[c](e.value.id)&&s[l](e.value.id);else if(e.type===a.update){const u=s[d](e.value.id);for(const h in e.value){let _=!(h.startsWith("$")||h.startsWith("_"));["$open"].indexOf(h)>-1&&(_=!0),_&&(u[h]=e.value[h])}s[l](e.value.id)}else e.type===a.move&&(s[l](e.value.id,e.value.$local_index,e.value.parent),s.callEvent("onRowDragEnd",[e.value.id]))}})}}const qn={click_drag:function(t){t.ext||(t.ext={});const n={className:"gantt_click_drag_rect",useRequestAnimationFrame:!0,callback:void 0,singleRow:!1};function e(){const i={viewPort:t.$task_data,...n};t.ext.clickDrag&&t.ext.clickDrag.destructor(),t.ext.clickDrag=new Rn(t);const a=t.config.click_drag;i.render=a.render||n.render,i.className=a.className||n.className,i.callback=a.callback||n.callback,i.viewPort=a.viewPort||t.$task_data,i.useRequestAnimationFrame=a.useRequestAnimationFrame===void 0?n.useRequestAnimationFrame:a.useRequestAnimationFrame,i.singleRow=a.singleRow===void 0?n.singleRow:a.singleRow;const s=t.$ui.getView("timeline"),r=new Hn(i,t,s);t.ext.clickDrag.attach(r,a.useKey,a.ignore)}t.attachEvent("onGanttReady",()=>{t.config.click_drag&&e()}),t.attachEvent("onGanttLayoutReady",function(){t.$container&&t.config.click_drag&&t.attachEvent("onGanttRender",function(){e()},{once:!0})}),t.attachEvent("onDestroy",()=>{t.ext.clickDrag&&t.ext.clickDrag.destructor()})},drag_timeline:function(t){t.ext||(t.ext={}),t.ext.dragTimeline={create:()=>Ut.create(t),_isDragInProgress:()=>Ut._isDragInProgress},t.config.drag_timeline={enabled:!0,render:!1}},fullscreen:function(t){function n(){const c=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;return!(!c||c!==document.body)}function e(){try{return document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled}catch(c){console.error("Fullscreen is not available:",c)}}t.$services.getService("state").registerProvider("fullscreen",()=>e()?{fullscreen:n()}:void 0);let i={overflow:null,padding:null,paddingTop:null,paddingRight:null,paddingBottom:null,paddingLeft:null};const a={width:null,height:null,top:null,left:null,position:null,zIndex:null,modified:!1};let s=null;function r(c,u){u.width=c.width,u.height=c.height,u.top=c.top,u.left=c.left,u.position=c.position,u.zIndex=c.zIndex}let o=!1;function l(){if(!t.$container)return;let c;n()?o&&(c="onExpand",function(){const u=t.ext.fullscreen.getFullscreenElement(),h=document.body;r(u.style,a),i={overflow:h.style.overflow,padding:h.style.padding?h.style.padding:null,paddingTop:h.style.paddingTop?h.style.paddingTop:null,paddingRight:h.style.paddingRight?h.style.paddingRight:null,paddingBottom:h.style.paddingBottom?h.style.paddingBottom:null,paddingLeft:h.style.paddingLeft?h.style.paddingLeft:null},h.style.padding&&(h.style.padding="0"),h.style.paddingTop&&(h.style.paddingTop="0"),h.style.paddingRight&&(h.style.paddingRight="0"),h.style.paddingBottom&&(h.style.paddingBottom="0"),h.style.paddingLeft&&(h.style.paddingLeft="0"),h.style.overflow="hidden",u.style.width="100vw",u.style.height="100vh",u.style.top="0px",u.style.left="0px",u.style.position="absolute",u.style.zIndex=1,a.modified=!0,s=function(_){let f=_.parentNode;const y=[];for(;f&&f.style;)y.push({element:f,originalPositioning:f.style.position}),f.style.position="static",f=f.parentNode;return y}(u)}()):o&&(o=!1,c="onCollapse",function(){const u=t.ext.fullscreen.getFullscreenElement(),h=document.body;a.modified&&(i.padding&&(h.style.padding=i.padding),i.paddingTop&&(h.style.paddingTop=i.paddingTop),i.paddingRight&&(h.style.paddingRight=i.paddingRight),i.paddingBottom&&(h.style.paddingBottom=i.paddingBottom),i.paddingLeft&&(h.style.paddingLeft=i.paddingLeft),h.style.overflow=i.overflow,i={overflow:null,padding:null,paddingTop:null,paddingRight:null,paddingBottom:null,paddingLeft:null},r(a,u.style),a.modified=!1),s.forEach(_=>{_.element.style.position=_.originalPositioning}),s=null}()),setTimeout(()=>{t.render()}),setTimeout(()=>{t.callEvent(c,[t.ext.fullscreen.getFullscreenElement()])})}function d(){return!t.$container||!t.ext.fullscreen.getFullscreenElement()?!0:e()?!1:((console.warning||console.log)("The `fullscreen` feature not being allowed, or full-screen mode not being supported"),!0)}t.ext.fullscreen={expand(){if(d()||n()||!t.callEvent("onBeforeExpand",[this.getFullscreenElement()]))return;o=!0;const c=document.body,u=c.webkitRequestFullscreen?[Element.ALLOW_KEYBOARD_INPUT]:[],h=c.msRequestFullscreen||c.mozRequestFullScreen||c.webkitRequestFullscreen||c.requestFullscreen;h&&h.apply(c,u)},collapse(){if(d()||!n()||!t.callEvent("onBeforeCollapse",[this.getFullscreenElement()]))return;const c=document.msExitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.exitFullscreen;c&&c.apply(document)},toggle(){d()||(n()?this.collapse():this.expand())},getFullscreenElement:()=>t.$root},t.expand=function(){t.ext.fullscreen.expand()},t.collapse=function(){t.ext.fullscreen.collapse()},t.attachEvent("onGanttReady",function(){t.event(document,"webkitfullscreenchange",l),t.event(document,"mozfullscreenchange",l),t.event(document,"MSFullscreenChange",l),t.event(document,"fullscreenChange",l),t.event(document,"fullscreenchange",l)})},keyboard_navigation:function(t){(function(n){n.config.keyboard_navigation=!0,n.config.keyboard_navigation_cells=!1,n.$keyboardNavigation={},n._compose=function(){for(var e=Array.prototype.slice.call(arguments,0),i={},a=0;a<e.length;a++){var s=e[a];for(var r in typeof s=="function"&&(s=new s),s)i[r]=s[r]}return i},function(e){e.$keyboardNavigation.shortcuts={createCommand:function(){return{modifiers:{shift:!1,alt:!1,ctrl:!1,meta:!1},keyCode:null}},parse:function(i){for(var a=[],s=this.getExpressions(this.trim(i)),r=0;r<s.length;r++){for(var o=this.getWords(s[r]),l=this.createCommand(),d=0;d<o.length;d++)this.commandKeys[o[d]]?l.modifiers[o[d]]=!0:this.specialKeys[o[d]]?l.keyCode=this.specialKeys[o[d]]:l.keyCode=o[d].charCodeAt(0);a.push(l)}return a},getCommandFromEvent:function(i){var a=this.createCommand();a.modifiers.shift=!!i.shiftKey,a.modifiers.alt=!!i.altKey,a.modifiers.ctrl=!!i.ctrlKey,a.modifiers.meta=!!i.metaKey,a.keyCode=i.which||i.keyCode,a.keyCode>=96&&a.keyCode<=105&&(a.keyCode-=48);var s=String.fromCharCode(a.keyCode);return s&&(a.keyCode=s.toLowerCase().charCodeAt(0)),a},getHashFromEvent:function(i){return this.getHash(this.getCommandFromEvent(i))},getHash:function(i){var a=[];for(var s in i.modifiers)i.modifiers[s]&&a.push(s);return a.push(i.keyCode),a.join(this.junctionChar)},getExpressions:function(i){return i.split(this.junctionChar)},getWords:function(i){return i.split(this.combinationChar)},trim:function(i){return i.replace(/\s/g,"")},junctionChar:",",combinationChar:"+",commandKeys:{shift:16,alt:18,ctrl:17,meta:!0},specialKeys:{backspace:8,tab:9,enter:13,esc:27,space:32,up:38,down:40,left:37,right:39,home:36,end:35,pageup:33,pagedown:34,delete:46,insert:45,plus:107,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123}}}(n),function(e){e.$keyboardNavigation.EventHandler={_handlers:null,findHandler:function(i){this._handlers||(this._handlers={});var a=e.$keyboardNavigation.shortcuts.getHash(i);return this._handlers[a]},doAction:function(i,a){var s=this.findHandler(i);if(s){if(e.$keyboardNavigation.facade.callEvent("onBeforeAction",[i,a])===!1)return;s.call(this,a),a.preventDefault?a.preventDefault():a.returnValue=!1}},bind:function(i,a){this._handlers||(this._handlers={});for(var s=e.$keyboardNavigation.shortcuts,r=s.parse(i),o=0;o<r.length;o++)this._handlers[s.getHash(r[o])]=a},unbind:function(i){for(var a=e.$keyboardNavigation.shortcuts,s=a.parse(i),r=0;r<s.length;r++)this._handlers[a.getHash(s[r])]&&delete this._handlers[a.getHash(s[r])]},bindAll:function(i){for(var a in i)this.bind(a,i[a])},initKeys:function(){this._handlers||(this._handlers={}),this.keys&&this.bindAll(this.keys)}}}(n),function(e){e.$keyboardNavigation.getFocusableNodes=At,e.$keyboardNavigation.trapFocus=function(i,a){if(a.keyCode!=9)return!1;for(var s=e.$keyboardNavigation.getFocusableNodes(i),r=le(),o=-1,l=0;l<s.length;l++)if(s[l]==r){o=l;break}if(a.shiftKey){if(o<=0){var d=s[s.length-1];if(d)return d.focus(),a.preventDefault(),!0}}else if(o>=s.length-1){var c=s[0];if(c)return c.focus(),a.preventDefault(),!0}return!1}}(n),function(e){e.$keyboardNavigation.GanttNode=function(){},e.$keyboardNavigation.GanttNode.prototype=e._compose(e.$keyboardNavigation.EventHandler,{focus:function(){e.focus()},blur:function(){},isEnabled:function(){return e.$container.hasAttribute("tabindex")},scrollHorizontal:function(i){var a=e.dateFromPos(e.getScrollState().x),s=e.getScale(),r=i<0?-s.step:s.step;a=e.date.add(a,r,s.unit),e.scrollTo(e.posFromDate(a))},scrollVertical:function(i){var a=e.getScrollState().y,s=e.config.row_height;e.scrollTo(null,a+(i<0?-1:1)*s)},keys:{"alt+left":function(i){this.scrollHorizontal(-1)},"alt+right":function(i){this.scrollHorizontal(1)},"alt+up":function(i){this.scrollVertical(-1)},"alt+down":function(i){this.scrollVertical(1)},"ctrl+z":function(){e.undo&&e.undo()},"ctrl+r":function(){e.redo&&e.redo()}}}),e.$keyboardNavigation.GanttNode.prototype.bindAll(e.$keyboardNavigation.GanttNode.prototype.keys)}(n),function(e){e.$keyboardNavigation.KeyNavNode=function(){},e.$keyboardNavigation.KeyNavNode.prototype=e._compose(e.$keyboardNavigation.EventHandler,{isValid:function(){return!0},fallback:function(){return null},moveTo:function(i){e.$keyboardNavigation.dispatcher.setActiveNode(i)},compareTo:function(i){if(!i)return!1;for(var a in this){if(!!this[a]!=!!i[a])return!1;var s=!(!this[a]||!this[a].toString),r=!(!i[a]||!i[a].toString);if(r!=s)return!1;if(r&&s){if(i[a].toString()!=this[a].toString())return!1}else if(i[a]!=this[a])return!1}return!0},getNode:function(){},focus:function(){var i=this.getNode();if(i){var a=e.$keyboardNavigation.facade;a.callEvent("onBeforeFocus",[i])!==!1&&i&&(i.setAttribute("tabindex","-1"),i.$eventAttached||(i.$eventAttached=!0,e.event(i,"focus",function(s){return s.preventDefault(),!1},!1)),e.utils.dom.isChildOf(document.activeElement,i)&&(i=document.activeElement),i.focus&&i.focus(),a.callEvent("onFocus",[this.getNode()]))}},blur:function(){var i=this.getNode();i&&(e.$keyboardNavigation.facade.callEvent("onBlur",[i]),i.setAttribute("tabindex","-1"))}})}(n),function(e){e.$keyboardNavigation.HeaderCell=function(i){this.index=i||0},e.$keyboardNavigation.HeaderCell.prototype=e._compose(e.$keyboardNavigation.KeyNavNode,{_handlers:null,isValid:function(){return!(!e.config.show_grid&&e.getVisibleTaskCount()||!e.getGridColumns()[this.index]&&e.getVisibleTaskCount())},fallback:function(){if(!e.config.show_grid)return e.getVisibleTaskCount()?new e.$keyboardNavigation.TaskRow:null;for(var i=e.getGridColumns(),a=this.index;a>=0&&!i[a];)a--;return i[a]?new e.$keyboardNavigation.HeaderCell(a):null},fromDomElement:function(i){var a=ft(i,"gantt_grid_head_cell");if(a){for(var s=0;a&&a.previousSibling;)a=a.previousSibling,s+=1;return new e.$keyboardNavigation.HeaderCell(s)}return null},getNode:function(){const i=e.$grid_scale;return i?i.childNodes[this.index]:null},keys:{left:function(){this.index>0&&this.moveTo(new e.$keyboardNavigation.HeaderCell(this.index-1))},right:function(){var i=e.getGridColumns();this.index<i.length-1&&this.moveTo(new e.$keyboardNavigation.HeaderCell(this.index+1))},down:function(){var i,a=e.getChildren(e.config.root_id);e.isTaskExists(a[0])&&(i=a[0]),i&&(e.config.keyboard_navigation_cells?this.moveTo(new e.$keyboardNavigation.TaskCell(i,this.index)):this.moveTo(new e.$keyboardNavigation.TaskRow(i)))},end:function(){var i=e.getGridColumns();this.moveTo(new e.$keyboardNavigation.HeaderCell(i.length-1))},home:function(){this.moveTo(new e.$keyboardNavigation.HeaderCell(0))},"enter, space":function(){le().click()},"ctrl+enter":function(){e.isReadonly(this)||e.createTask({},this.taskId)}}}),e.$keyboardNavigation.HeaderCell.prototype.bindAll(e.$keyboardNavigation.HeaderCell.prototype.keys)}(n),function(e){e.$keyboardNavigation.TaskRow=function(i){if(!i){var a=e.getChildren(e.config.root_id);a[0]&&(i=a[0])}this.taskId=i,e.isTaskExists(this.taskId)&&(this.index=e.getTaskIndex(this.taskId),this.globalIndex=e.getGlobalTaskIndex(this.taskId),this.splitItem=!!e.getTask(this.taskId).$split_subtask,this.parentId=e.getParent(this.taskId))},e.$keyboardNavigation.TaskRow.prototype=e._compose(e.$keyboardNavigation.KeyNavNode,{_handlers:null,isValid:function(){return e.isTaskExists(this.taskId)&&e.getTaskIndex(this.taskId)>-1},fallback:function(){if(!e.getVisibleTaskCount()){var i=new e.$keyboardNavigation.HeaderCell;return i.isValid()?i:null}if(this.splitItem)return new e.$keyboardNavigation.TaskRow(this.parentId);var a=-1;if(e.getTaskByIndex(this.globalIndex-1))a=this.globalIndex-1;else if(e.getTaskByIndex(this.globalIndex+1))a=this.globalIndex+1;else for(var s=this.globalIndex;s>=0;){if(e.getTaskByIndex(s)){a=s;break}s--}return a>-1?new e.$keyboardNavigation.TaskRow(e.getTaskByIndex(a).id):void 0},fromDomElement:function(i){if(e.config.keyboard_navigation_cells)return null;var a=e.locate(i);return e.isTaskExists(a)?new e.$keyboardNavigation.TaskRow(a):null},getNode:function(){if(e.isTaskExists(this.taskId)&&e.isTaskVisible(this.taskId))return e.config.show_grid?e.$grid.querySelector(`.gantt_row[${e.config.task_attribute}="${String(this.taskId).replaceAll('"','\\"')}"]`):e.getTaskNode(this.taskId)},focus:function(i){if(!i){const a=e.getTaskPosition(e.getTask(this.taskId)),s=e.getTaskHeight(this.taskId),r=e.getScrollState();let o,l;o=e.$task?e.$task.offsetWidth:r.inner_width,l=e.$grid_data||e.$task_data?(e.$grid_data||e.$task_data).offsetHeight:r.inner_height;const d=e.config.show_chart&&e.$ui.getView("timeline");a.top<r.y||a.top+s>r.y+l?e.scrollTo(null,a.top-20):e.config.scroll_on_click&&d&&(a.left>r.x+o?e.scrollTo(a.left-e.config.task_scroll_offset):a.left+a.width<r.x&&e.scrollTo(a.left+a.width-e.config.task_scroll_offset))}e.$keyboardNavigation.KeyNavNode.prototype.focus.apply(this,[i]),function(){var a=e.$ui.getView("grid");if(a&&a.$grid_data){var s=parseInt(a.$grid.scrollLeft),r=parseInt(a.$grid_data.scrollTop),o=a.$config.scrollX;if(o&&a.$config.scrollable){var l=e.$ui.getView(o);l&&l.scrollTo(s,r)}var d=a.$config.scrollY;if(d){var c=e.$ui.getView(d);c&&c.scrollTo(s,r)}}}()},keys:{pagedown:function(){e.getVisibleTaskCount()&&this.moveTo(new e.$keyboardNavigation.TaskRow(e.getTaskByIndex(e.getVisibleTaskCount()-1).id))},pageup:function(){e.getVisibleTaskCount()&&this.moveTo(new e.$keyboardNavigation.TaskRow(e.getTaskByIndex(0).id))},up:function(){var i=null,a=e.getPrev(this.taskId);i=e.isTaskExists(a)?new e.$keyboardNavigation.TaskRow(a):new e.$keyboardNavigation.HeaderCell,this.moveTo(i)},down:function(){var i=e.getNext(this.taskId);e.isTaskExists(i)&&this.moveTo(new e.$keyboardNavigation.TaskRow(i))},"shift+down":function(){e.hasChild(this.taskId)&&!e.getTask(this.taskId).$open&&e.open(this.taskId)},"shift+up":function(){e.hasChild(this.taskId)&&e.getTask(this.taskId).$open&&e.close(this.taskId)},"shift+right":function(){if(!e.isReadonly(this)){var i=e.getPrevSibling(this.taskId);e.isTaskExists(i)&&!e.isChildOf(this.taskId,i)&&(e.getTask(i).$open=!0,e.moveTask(this.taskId,-1,i)!==!1&&e.updateTask(this.taskId))}},"shift+left":function(){if(!e.isReadonly(this)){var i=e.getParent(this.taskId);e.isTaskExists(i)&&e.moveTask(this.taskId,e.getTaskIndex(i)+1,e.getParent(i))!==!1&&e.updateTask(this.taskId)}},space:function(i){e.isSelectedTask(this.taskId)?e.unselectTask(this.taskId):e.selectTask(this.taskId)},"ctrl+left":function(i){e.close(this.taskId)},"ctrl+right":function(i){e.open(this.taskId)},delete:function(i){e.isReadonly(this)||e.$click.buttons.delete(this.taskId)},enter:function(){e.isReadonly(this)||e.showLightbox(this.taskId)},"ctrl+enter":function(){e.isReadonly(this)||e.createTask({},this.taskId)}}}),e.$keyboardNavigation.TaskRow.prototype.bindAll(e.$keyboardNavigation.TaskRow.prototype.keys)}(n),function(e){e.$keyboardNavigation.TaskCell=function(i,a){if(!(i=rt(i,e.config.root_id))){var s=e.getChildren(e.config.root_id);s[0]&&(i=s[0])}this.taskId=i,this.columnIndex=a||0,e.isTaskExists(this.taskId)&&(this.index=e.getTaskIndex(this.taskId),this.globalIndex=e.getGlobalTaskIndex(this.taskId))},e.$keyboardNavigation.TaskCell.prototype=e._compose(e.$keyboardNavigation.TaskRow,{_handlers:null,isValid:function(){return e.$keyboardNavigation.TaskRow.prototype.isValid.call(this)&&!!e.getGridColumns()[this.columnIndex]},fallback:function(){var i=e.$keyboardNavigation.TaskRow.prototype.fallback.call(this),a=i;if(i instanceof e.$keyboardNavigation.TaskRow){for(var s=e.getGridColumns(),r=this.columnIndex;r>=0&&!s[r];)r--;s[r]&&(a=new e.$keyboardNavigation.TaskCell(i.taskId,r))}return a},fromDomElement:function(i){if(!e.config.keyboard_navigation_cells)return null;var a=e.locate(i);if(e.isTaskExists(a)){var s=0,r=nt(i,"data-column-index");return r&&(s=1*r.getAttribute("data-column-index")),new e.$keyboardNavigation.TaskCell(a,s)}return null},getNode:function(){if(e.isTaskExists(this.taskId)&&(e.isTaskVisible(this.taskId)||e.config.show_tasks_outside_timescale)){if(e.config.show_grid&&e.$grid){var i=e.$grid.querySelector(".gantt_row["+e.config.task_attribute+"='"+this.taskId+"']");return i?i.querySelector("[data-column-index='"+this.columnIndex+"']"):null}return e.getTaskNode(this.taskId)}},keys:{up:function(){var i=null,a=e.getPrev(this.taskId);i=e.isTaskExists(a)?new e.$keyboardNavigation.TaskCell(a,this.columnIndex):new e.$keyboardNavigation.HeaderCell(this.columnIndex),this.moveTo(i)},down:function(){var i=e.getNext(this.taskId);e.isTaskExists(i)&&this.moveTo(new e.$keyboardNavigation.TaskCell(i,this.columnIndex))},left:function(){this.columnIndex>0&&this.moveTo(new e.$keyboardNavigation.TaskCell(this.taskId,this.columnIndex-1))},right:function(){var i=e.getGridColumns();this.columnIndex<i.length-1&&this.moveTo(new e.$keyboardNavigation.TaskCell(this.taskId,this.columnIndex+1))},end:function(){var i=e.getGridColumns();this.moveTo(new e.$keyboardNavigation.TaskCell(this.taskId,i.length-1))},home:function(){this.moveTo(new e.$keyboardNavigation.TaskCell(this.taskId,0))},pagedown:function(){e.getVisibleTaskCount()&&this.moveTo(new e.$keyboardNavigation.TaskCell(e.getTaskByIndex(e.getVisibleTaskCount()-1).id,this.columnIndex))},pageup:function(){e.getVisibleTaskCount()&&this.moveTo(new e.$keyboardNavigation.TaskCell(e.getTaskByIndex(0).id,this.columnIndex))}}}),e.$keyboardNavigation.TaskCell.prototype.bindAll(e.$keyboardNavigation.TaskRow.prototype.keys),e.$keyboardNavigation.TaskCell.prototype.bindAll(e.$keyboardNavigation.TaskCell.prototype.keys)}(n),zn(n),function(e){e.$keyboardNavigation.dispatcher={isActive:!1,activeNode:null,globalNode:new e.$keyboardNavigation.GanttNode,enable:function(){this.isActive=!0,this.setActiveNode(this.getActiveNode())},disable:function(){this.isActive=!1},isEnabled:function(){return!!this.isActive},getDefaultNode:function(){var i;return(i=e.config.keyboard_navigation_cells?new e.$keyboardNavigation.TaskCell:new e.$keyboardNavigation.TaskRow).isValid()||(i=i.fallback()),i},setDefaultNode:function(){this.setActiveNode(this.getDefaultNode())},getActiveNode:function(){var i=this.activeNode;return i&&!i.isValid()&&(i=i.fallback()),i},fromDomElement:function(i){for(var a=[e.$keyboardNavigation.TaskRow,e.$keyboardNavigation.TaskCell,e.$keyboardNavigation.HeaderCell],s=0;s<a.length;s++)if(a[s].prototype.fromDomElement){var r=a[s].prototype.fromDomElement(i);if(r)return r}return null},focusGlobalNode:function(){this.blurNode(this.globalNode),this.focusNode(this.globalNode)},setActiveNode:function(i){var a=!0;this.activeNode&&this.activeNode.compareTo(i)&&(a=!1),this.isEnabled()&&(a&&this.blurNode(this.activeNode),this.activeNode=i,this.focusNode(this.activeNode,!a))},focusNode:function(i,a){i&&i.focus&&i.focus(a)},blurNode:function(i){i&&i.blur&&i.blur()},keyDownHandler:function(i){if(!e.$keyboardNavigation.isModal()&&this.isEnabled()&&!i.defaultPrevented){var a=this.globalNode,s=e.$keyboardNavigation.shortcuts.getCommandFromEvent(i),r=this.getActiveNode();e.$keyboardNavigation.facade.callEvent("onKeyDown",[s,i])!==!1&&(r?r.findHandler(s)?r.doAction(s,i):a.findHandler(s)&&a.doAction(s,i):this.setDefaultNode())}},_timeout:null,awaitsFocus:function(){return this._timeout!==null},delay:function(i,a){clearTimeout(this._timeout),this._timeout=setTimeout(e.bind(function(){this._timeout=null,i()},this),a||1)},clearDelay:function(){clearTimeout(this._timeout)}}}(n),function(){var e=n.$keyboardNavigation.dispatcher;e.isTaskFocused=function(v){var b=e.activeNode;return(b instanceof n.$keyboardNavigation.TaskRow||b instanceof n.$keyboardNavigation.TaskCell)&&b.taskId==v};var i=function(v){if(n.config.keyboard_navigation&&(n.config.keyboard_navigation_cells||!r(v))&&!o(v)&&!function(b){return!!dt(b.target,".gantt_cal_light")}(v))return e.keyDownHandler(v)},a=function(v){if(e.$preventDefault)return v.preventDefault(),n.$container.blur(),!1;e.awaitsFocus()||e.focusGlobalNode()},s=function(){if(!e.isEnabled())return;const v=!J(document.activeElement,n.$container)&&document.activeElement.localName!="body";var b=e.getActiveNode();if(b&&!v){var m,g,p=b.getNode();p&&p.parentNode&&(m=p.parentNode.scrollTop,g=p.parentNode.scrollLeft),b.focus(!0),p&&p.parentNode&&(p.parentNode.scrollTop=m,p.parentNode.scrollLeft=g)}};function r(v){return!!dt(v.target,".gantt_grid_editor_placeholder")}function o(v){return!!dt(v.target,".no_keyboard_navigation")}function l(v){if(!n.config.keyboard_navigation||!n.config.keyboard_navigation_cells&&r(v))return!0;if(!o(v)){var b,m=e.fromDomElement(v);if(m&&(e.activeNode instanceof n.$keyboardNavigation.TaskCell&&J(v.target,n.$task)&&(m=new n.$keyboardNavigation.TaskCell(m.taskId,e.activeNode.columnIndex)),b=m,n.config.show_grid&&n.$ui.getView("grid")&&n.config.keyboard_navigation_cells)){const g=v.target.classList.contains("gantt_row"),p=v.target.closest(".gantt_task_line"),k=n.utils.dom.getNodePosition(n.$grid).x,x=k+n.$grid.offsetWidth,w=n.utils.dom.getNodePosition(document.activeElement).x;if(g||p&&(w<k||x<w)){let $=n.$grid.scrollLeft;const T=$+n.$grid.offsetWidth;let S=0;g&&($=n.utils.dom.getRelativeEventPosition(v,n.$grid).x);for(let C=0;C<n.config.columns.length;C++){const E=n.config.columns[C];if(!E.hide&&(S+=E.width,$<S)){T<S&&(S-=E.width),b.columnIndex=C;break}}}}b?e.isEnabled()?e.delay(function(){e.setActiveNode(b)}):e.activeNode=b:(e.$preventDefault=!0,setTimeout(function(){e.$preventDefault=!1},300))}}n.attachEvent("onDataRender",function(){n.config.keyboard_navigation&&s()}),n.attachEvent("onGanttRender",function(){n.$root&&(n.eventRemove(n.$root,"keydown",i),n.eventRemove(n.$container,"focus",a),n.eventRemove(n.$container,"mousedown",l),n.config.keyboard_navigation?(n.event(n.$root,"keydown",i),n.event(n.$container,"focus",a),n.event(n.$container,"mousedown",l),n.$container.setAttribute("tabindex","0")):n.$container.removeAttribute("tabindex"))});var d=n.attachEvent("onGanttReady",function(){if(n.detachEvent(d),n.$data.tasksStore.attachEvent("onStoreUpdated",function(b){if(n.config.keyboard_navigation&&e.isEnabled()){const m=e.getActiveNode(),g=n.$ui.getView("grid");if(!g||!g.$grid_data)return;const p=g.getItemTop(b),k=g.$grid_data.scrollTop,x=k+g.$grid_data.getBoundingClientRect().height;m&&m.taskId==b&&k<=p&&x>=p&&s()}}),n._smart_render){var v=n._smart_render._redrawTasks;n._smart_render._redrawTasks=function(b,m){if(n.config.keyboard_navigation&&e.isEnabled()){var g=e.getActiveNode();if(g&&g.taskId!==void 0){for(var p=!1,k=0;k<m.length;k++)if(m[k].id==g.taskId&&m[k].start_date){p=!0;break}p||m.push(n.getTask(g.taskId))}}return v.apply(this,arguments)}}});let c=null,u=!1;n.attachEvent("onTaskCreated",function(v){return c=v.id,!0}),n.attachEvent("onAfterTaskAdd",function(v,b){if(!n.config.keyboard_navigation)return!0;if(e.isEnabled()){if(v==c&&(u=!0,setTimeout(()=>{u=!1,c=null})),u&&b.type==n.config.types.placeholder)return;var m=0,g=e.activeNode;g instanceof n.$keyboardNavigation.TaskCell&&(m=g.columnIndex);var p=n.config.keyboard_navigation_cells?n.$keyboardNavigation.TaskCell:n.$keyboardNavigation.TaskRow;b.type==n.config.types.placeholder&&n.config.placeholder_task.focusOnCreate===!1||e.setActiveNode(new p(v,m))}}),n.attachEvent("onTaskIdChange",function(v,b){if(!n.config.keyboard_navigation)return!0;var m=e.activeNode;return e.isTaskFocused(v)&&(m.taskId=b),!0});var h=setInterval(function(){n.config.keyboard_navigation&&(e.isEnabled()||e.enable())},500);function _(v){var b={gantt:n.$keyboardNavigation.GanttNode,headerCell:n.$keyboardNavigation.HeaderCell,taskRow:n.$keyboardNavigation.TaskRow,taskCell:n.$keyboardNavigation.TaskCell};return b[v]||b.gantt}function f(v){for(var b=n.getGridColumns(),m=0;m<b.length;m++)if(b[m].name==v)return m;return 0}n.attachEvent("onDestroy",function(){clearInterval(h)});var y={};st(y),n.mixin(y,{addShortcut:function(v,b,m){var g=_(m);g&&g.prototype.bind(v,b)},getShortcutHandler:function(v,b){var m=n.$keyboardNavigation.shortcuts.parse(v);if(m.length)return y.getCommandHandler(m[0],b)},getCommandHandler:function(v,b){var m=_(b);if(m&&v)return m.prototype.findHandler(v)},removeShortcut:function(v,b){var m=_(b);m&&m.prototype.unbind(v)},focus:function(v){var b,m=v?v.type:null,g=_(m);switch(m){case"taskCell":b=new g(v.id,f(v.column));break;case"taskRow":b=new g(v.id);break;case"headerCell":b=new g(f(v.column))}e.delay(function(){b?e.setActiveNode(b):(e.enable(),e.getActiveNode()?e.awaitsFocus()||e.enable():e.setDefaultNode())})},getActiveNode:function(){if(e.isEnabled()){var v=e.getActiveNode(),b=(g=v)instanceof n.$keyboardNavigation.GanttNode?"gantt":g instanceof n.$keyboardNavigation.HeaderCell?"headerCell":g instanceof n.$keyboardNavigation.TaskRow?"taskRow":g instanceof n.$keyboardNavigation.TaskCell?"taskCell":null,m=n.getGridColumns();switch(b){case"taskCell":return{type:"taskCell",id:v.taskId,column:m[v.columnIndex].name};case"taskRow":return{type:"taskRow",id:v.taskId};case"headerCell":return{type:"headerCell",column:m[v.index].name}}}var g;return null}}),n.$keyboardNavigation.facade=y,n.ext.keyboardNavigation=y,n.focus=function(){y.focus()},n.addShortcut=y.addShortcut,n.getShortcutHandler=y.getShortcutHandler,n.removeShortcut=y.removeShortcut}()})(t)},quick_info:function(t){t.ext||(t.ext={}),t.ext.quickInfo=new jn(t),t.config.quickinfo_buttons=["icon_edit","icon_delete"],t.config.quick_info_detached=!0,t.config.show_quick_info=!0,t.templates.quick_info_title=function(a,s,r){return r.text.substr(0,50)},t.templates.quick_info_content=function(a,s,r){return r.details||r.text},t.templates.quick_info_date=function(a,s,r){return t.templates.task_time(a,s,r)},t.templates.quick_info_class=function(a,s,r){return""},t.attachEvent("onTaskClick",function(a,s){const r=t.utils.dom.closest(s.target,".gantt_add"),o=t.utils.dom.closest(s.target,".gantt_close"),l=t.utils.dom.closest(s.target,".gantt_open");return!r&&!o&&!l&&setTimeout(function(){t.ext.quickInfo.show(a)},0),!0});const n=["onViewChange","onLightbox","onBeforeTaskDelete","onBeforeDrag"],e=function(){return t.ext.quickInfo.hide(),!0};for(let a=0;a<n.length;a++)t.attachEvent(n[a],e);function i(){return t.ext.quickInfo.hide(),t.ext.quickInfo._quickInfoBox=null,!0}t.attachEvent("onEmptyClick",function(a){let s=!0;const r=document.querySelector(".gantt_cal_quick_info");r&&t.utils.dom.isChildOf(a.target,r)&&(s=!1),s&&e()}),t.attachEvent("onGanttReady",i),t.attachEvent("onDestroy",i),t.event(window,"keydown",function(a){a.keyCode===27&&t.ext.quickInfo.hide()}),t.showQuickInfo=function(){t.ext.quickInfo.show.apply(t.ext.quickInfo,arguments)},t.hideQuickInfo=function(){t.ext.quickInfo.hide.apply(t.ext.quickInfo,arguments)}},tooltip:function(t){t.config.tooltip_timeout=30,t.config.tooltip_offset_y=20,t.config.tooltip_offset_x=10,t.config.tooltip_hide_timeout=30;const n=new Fn(t);t.ext.tooltips=n,t.attachEvent("onGanttReady",function(){t.$root&&n.tooltipFor({selector:"["+t.config.task_attribute+"]:not(.gantt_task_row)",html:e=>{if(t.config.touch&&!t.config.touch_tooltip)return;const i=t.locate(e);if(t.isTaskExists(i)){const a=t.getTask(i);return t.templates.tooltip_text(a.start_date,a.end_date,a)}return null},global:!1})}),t.attachEvent("onDestroy",function(){n.destructor()}),t.attachEvent("onLightbox",function(){n.hideTooltip()}),t.attachEvent("onBeforeTooltip",function(){if(t.getState().link_source_id)return!1}),t.attachEvent("onGanttScroll",function(){n.hideTooltip()})},undo:function(t){const n=new Un(t),e=new Vn(n,t);function i(c,u){return String(c)===String(u)}function a(c,u,h){c&&(i(c.id,u)&&(c.id=h),i(c.parent,u)&&(c.parent=h))}function s(c,u,h){a(c.value,u,h),a(c.oldValue,u,h)}function r(c,u,h){c&&(i(c.source,u)&&(c.source=h),i(c.target,u)&&(c.target=h))}function o(c,u,h){r(c.value,u,h),r(c.oldValue,u,h)}function l(c,u,h){const _=n;for(let f=0;f<c.length;f++){const y=c[f];for(let v=0;v<y.commands.length;v++)y.commands[v].entity===_.command.entity.task?s(y.commands[v],u,h):y.commands[v].entity===_.command.entity.link&&o(y.commands[v],u,h)}}function d(c,u,h){const _=n;for(let f=0;f<c.length;f++){const y=c[f];for(let v=0;v<y.commands.length;v++){const b=y.commands[v];b.entity===_.command.entity.link&&(b.value&&b.value.id===u&&(b.value.id=h),b.oldValue&&b.oldValue.id===u&&(b.oldValue.id=h))}}}t.config.undo=!0,t.config.redo=!0,t.config.undo_types={link:"link",task:"task"},t.config.undo_actions={update:"update",remove:"remove",add:"add",move:"move"},t.ext||(t.ext={}),t.ext.undo={undo:()=>n.undo(),redo:()=>n.redo(),getUndoStack:()=>n.getUndoStack(),setUndoStack:c=>n.setUndoStack(c),getRedoStack:()=>n.getRedoStack(),setRedoStack:c=>n.setRedoStack(c),clearUndoStack:()=>n.clearUndoStack(),clearRedoStack:()=>n.clearRedoStack(),saveState:(c,u)=>e.store(c,u,!0),getInitialState:(c,u)=>u===t.config.undo_types.link?e.getInitialLink(c):e.getInitialTask(c)},t.undo=t.ext.undo.undo,t.redo=t.ext.undo.redo,t.getUndoStack=t.ext.undo.getUndoStack,t.getRedoStack=t.ext.undo.getRedoStack,t.clearUndoStack=t.ext.undo.clearUndoStack,t.clearRedoStack=t.ext.undo.clearRedoStack,t.attachEvent("onTaskIdChange",(c,u)=>{const h=n;l(h.getUndoStack(),c,u),l(h.getRedoStack(),c,u)}),t.attachEvent("onLinkIdChange",(c,u)=>{const h=n;d(h.getUndoStack(),c,u),d(h.getRedoStack(),c,u)}),t.attachEvent("onGanttReady",()=>{n.updateConfigs()})},marker:function(t){function n(i){if(!t.config.show_markers||!i.start_date)return!1;var a=t.getState();if(+i.start_date>+a.max_date||(!i.end_date||+i.end_date<+a.min_date)&&+i.start_date<+a.min_date)return;var s=document.createElement("div");s.setAttribute("data-marker-id",i.id);var r="gantt_marker";t.templates.marker_class&&(r+=" "+t.templates.marker_class(i)),i.css&&(r+=" "+i.css),t.templates.marker_class&&(r+=" "+t.templates.marker_class(i)),i.title&&(s.title=i.title),s.className=r;var o=t.posFromDate(i.start_date);s.style.left=o+"px";let l=Math.max(t.getRowTop(t.getVisibleTaskCount()),0)+"px";if(t.config.timeline_placeholder&&t.$task_data&&(l=t.$task_data.scrollHeight+"px"),s.style.height=l,i.end_date){var d=t.posFromDate(i.end_date);s.style.width=Math.max(d-o,0)+"px"}if(i.text){let c=null;c=typeof i.text=="function"?i.text(i):i.text,c&&(t.config.external_render&&t.config.external_render.isElement(c)?(s.innerHTML="<div class='gantt_marker_content' ></div>",t.config.external_render.renderElement(c,s.querySelector(".gantt_marker_content"))):s.innerHTML="<div class='gantt_marker_content' >"+i.text+"</div>")}return s}function e(){if(t.$task_data&&t.$root.contains(t.$task_data)){if(!t.$marker_area||!t.$task_data.contains(t.$marker_area)){var i=document.createElement("div");i.className="gantt_marker_area",t.$task_data.appendChild(i),t.$marker_area=i}}else t.$marker_area=null}t._markers||(t._markers=t.createDatastore({name:"marker",initItem:function(i){return i.id=i.id||t.uid(),i}})),t.config.show_markers=!0,t.attachEvent("onBeforeGanttRender",function(){t.$marker_area||e()}),t.attachEvent("onDataRender",function(){t.$marker_area||(e(),t.renderMarkers())}),t.attachEvent("onGanttLayoutReady",function(){t.attachEvent("onBeforeGanttRender",function(){t.$marker_area&&(t.$marker_area.innerHTML=""),e(),t.$services.getService("layers").createDataRender({name:"marker",defaultContainer:function(){return t.$marker_area}}).addLayer(n)},{once:!0})}),t.getMarker=function(i){return this._markers?this._markers.getItem(i):null},t.addMarker=function(i){return this._markers.addItem(i)},t.deleteMarker=function(i){return!!this._markers.exists(i)&&(this._markers.removeItem(i),!0)},t.updateMarker=function(i){this._markers.refresh(i)},t._getMarkers=function(){return this._markers.getItems()},t.renderMarkers=function(){this._markers.refresh()}},multiselect:function(t){t.config.multiselect=!0,t.config.multiselect_one_level=!1,t._multiselect={_selected:{},_one_level:!1,_active:!0,_first_selected_when_shift:null,getDefaultSelected:function(){var n=this.getSelected();return n.length?n[n.length-1]:null},setFirstSelected:function(n){this._first_selected_when_shift=n},getFirstSelected:function(){return this._first_selected_when_shift},isActive:function(){return this.updateState(),this._active},updateState:function(){this._one_level=t.config.multiselect_one_level;var n=this._active;this._active=t.config.select_task,this._active!=n&&this.reset()},reset:function(){this._selected={}},setLastSelected:function(n){t.$data.tasksStore.silent(function(){var e=t.$data.tasksStore;n?e.select(n+""):e.unselect(null)})},getLastSelected:function(){var n=t.$data.tasksStore.getSelectedId();return n&&t.isTaskExists(n)?n:null},select:function(n,e){return!!(n&&t.callEvent("onBeforeTaskMultiSelect",[n,!0,e])&&t.callEvent("onBeforeTaskSelected",[n]))&&(this._selected[n]=!0,this.setLastSelected(n),this.afterSelect(n),t.callEvent("onTaskMultiSelect",[n,!0,e]),t.callEvent("onTaskSelected",[n]),!0)},toggle:function(n,e){this._selected[n]?this.unselect(n,e):this.select(n,e)},unselect:function(n,e){n&&t.callEvent("onBeforeTaskMultiSelect",[n,!1,e])&&(this._selected[n]=!1,this.getLastSelected()==n&&this.setLastSelected(this.getDefaultSelected()),this.afterSelect(n),t.callEvent("onTaskMultiSelect",[n,!1,e]),t.callEvent("onTaskUnselected",[n]))},isSelected:function(n){return!(!t.isTaskExists(n)||!this._selected[n])},getSelected:function(){var n=[];for(var e in this._selected)this._selected[e]&&t.isTaskExists(e)?n.push(e):this._selected[e]=!1;return n.sort(function(i,a){return t.getGlobalTaskIndex(i)>t.getGlobalTaskIndex(a)?1:-1}),n},forSelected:function(n){for(var e=this.getSelected(),i=0;i<e.length;i++)n(e[i])},isSameLevel:function(n){if(!this._one_level)return!0;var e=this.getLastSelected();return!e||!t.isTaskExists(e)||!t.isTaskExists(n)||t.calculateTaskLevel(t.getTask(e))==t.calculateTaskLevel(t.getTask(n))},afterSelect:function(n){t.isTaskExists(n)&&t._quickRefresh(function(){t.refreshTask(n)})},doSelection:function(n){if(!this.isActive()||t._is_icon_open_click(n))return!1;var e=t.locate(n);if(!e||!t.callEvent("onBeforeMultiSelect",[n]))return!1;var i=this.getSelected(),a=this.getFirstSelected(),s=!1,r=this.getLastSelected(),o=t.config.multiselect,l=(function(){const c=t.ext.inlineEditors;if(c&&c.getState){const h=c.getState(),_=c.locateCell(n.target);t.config.inline_editors_multiselect_open&&_&&c.getEditorConfig(_.columnName)&&(c.isVisible()&&h.id==_.id&&h.columnName==_.columnName||c.startEdit(_.id,_.columnName))}this.setFirstSelected(e),this.isSelected(e)||this.select(e,n),i=this.getSelected();for(var u=0;u<i.length;u++)i[u]!==e&&this.unselect(i[u],n)}).bind(this),d=(function(){if(r){if(e){var c=t.getGlobalTaskIndex(this.getFirstSelected()),u=t.getGlobalTaskIndex(e),h=t.getGlobalTaskIndex(r);c!=-1&&h!=-1||(c=u,this.reset());for(var _=r;t.getGlobalTaskIndex(_)!==c;)this.unselect(_,n),_=c>h?t.getNext(_):t.getPrev(_);for(_=e;t.getGlobalTaskIndex(_)!==c;)this.select(_,n)&&!s&&(s=!0,a=_),_=c>u?t.getNext(_):t.getPrev(_)}}else r=e}).bind(this);return o&&(n.ctrlKey||n.metaKey)?(this.isSelected(e)||this.setFirstSelected(e),e&&this.toggle(e,n)):o&&n.shiftKey?(t.isTaskExists(this.getFirstSelected())&&this.getFirstSelected()!==null||this.setFirstSelected(e),i.length?d():l()):l(),this.isSelected(e)?this.setLastSelected(e):a?e==r&&this.setLastSelected(n.shiftKey?a:this.getDefaultSelected()):this.setLastSelected(null),this.getSelected().length||this.setLastSelected(null),this.getLastSelected()&&this.isSelected(this.getFirstSelected())||this.setFirstSelected(this.getLastSelected()),!0}},function(){var n=t.selectTask;t.selectTask=function(i){if(!(i=rt(i,this.config.root_id)))return!1;var a=t._multiselect,s=i;return a.isActive()?(a.select(i,null)&&a.setLastSelected(i),a.setFirstSelected(a.getLastSelected())):s=n.call(this,i),s};var e=t.unselectTask;t.unselectTask=function(i){var a=t._multiselect,s=a.isActive();(i=i||a.getLastSelected())&&s&&(a.unselect(i,null),i==a.getLastSelected()&&a.setLastSelected(null),t.refreshTask(i),a.setFirstSelected(a.getLastSelected()));var r=i;return s||(r=e.call(this,i)),r},t.toggleTaskSelection=function(i){var a=t._multiselect;i&&a.isActive()&&(a.toggle(i),a.setFirstSelected(a.getLastSelected()))},t.getSelectedTasks=function(){var i=t._multiselect;return i.isActive(),i.getSelected()},t.eachSelectedTask=function(i){return this._multiselect.forSelected(i)},t.isSelectedTask=function(i){return this._multiselect.isSelected(i)},t.getLastSelectedTask=function(){return this._multiselect.getLastSelected()},t.attachEvent("onGanttReady",function(){var i=t.$data.tasksStore.isSelected;t.$data.tasksStore.isSelected=function(a){return t._multiselect.isActive()?t._multiselect.isSelected(a):i.call(this,a)}})}(),t.attachEvent("onTaskIdChange",function(n,e){var i=t._multiselect;if(!i.isActive())return!0;t.isSelectedTask(n)&&(i.unselect(n,null),i.select(e,null))}),t.attachEvent("onAfterTaskDelete",function(n,e){var i=t._multiselect;if(!i.isActive())return!0;i._selected[n]&&(i._selected[n]=!1,i.setLastSelected(i.getDefaultSelected())),i.forSelected(function(a){t.isTaskExists(a)||i.unselect(a,null)})}),t.attachEvent("onBeforeTaskMultiSelect",function(n,e,i){const a=t._multiselect;if(e&&a.isActive()){let s=t.getSelectedId(),r=null;s&&(r=t.getTask(s));let o=t.getTask(n),l=!1;if(r&&r.$level!=o.$level&&(l=!0),t.config.multiselect_one_level&&l&&!i.ctrlKey&&!i.shiftKey)return!0;if(a._one_level)return a.isSameLevel(n)}return!0}),t.attachEvent("onTaskClick",function(n,e){return t._multiselect.doSelection(e)&&t.callEvent("onMultiSelect",[e]),!0})},export_api:function(t){return t.ext=t.ext||{},t.ext.export_api=t.ext.export_api||{_apiUrl:"https://export.dhtmlx.com/gantt",_preparePDFConfigRaw(n,e){let i=null;n.start&&n.end&&(i={start_date:t.config.start_date,end_date:t.config.end_date},t.config.start_date=t.date.str_to_date(t.config.date_format)(n.start),t.config.end_date=t.date.str_to_date(t.config.date_format)(n.end)),n=t.mixin(n,{name:"gantt."+e,data:t.ext.export_api._serializeHtml()}),i&&(t.config.start_date=i.start_date,t.config.end_date=i.end_date)},_prepareConfigPDF:(n,e)=>(n=t.mixin(n||{},{name:"gantt."+e,data:t.ext.export_api._serializeAll(),config:t.config}),t.ext.export_api._fixColumns(n.config.columns),n),_pdfExportRouter(n,e){n&&n.raw?t.ext.export_api._preparePDFConfigRaw(n,e):n=t.ext.export_api._prepareConfigPDF(n,e),n.version=t.version,t.ext.export_api._sendToExport(n,e)},exportToPDF(n){t.ext.export_api._pdfExportRouter(n,"pdf")},exportToPNG(n){t.ext.export_api._pdfExportRouter(n,"png")},exportToICal(n){n=t.mixin(n||{},{name:"gantt.ical",data:t.ext.export_api._serializePlain().data,version:t.version}),t.ext.export_api._sendToExport(n,"ical")},exportToExcel(n){let e;n=n||{};let i,a,s=[];const r=t.config.smart_rendering;if(n.visual==="base-colors"&&(t.config.smart_rendering=!1),n.start||n.end){i=t.getState(),s=[t.config.start_date,t.config.end_date],a=t.getScrollState();const o=t.date.str_to_date(t.config.date_format);e=t.eachTask,n.start&&(t.config.start_date=o(n.start)),n.end&&(t.config.end_date=o(n.end)),t.render(),t.config.smart_rendering=r,t.eachTask=t.ext.export_api._eachTaskTimed(t.config.start_date,t.config.end_date)}else n.visual==="base-colors"&&(t.render(),t.config.smart_rendering=r);(n=t.mixin(n,{name:"gantt.xlsx",title:"Tasks",data:t.ext.export_api._serializeTimeline(n),columns:t.ext.export_api._serializeGrid({raw:n.raw,rawDates:!0}),version:t.version})).visual&&(n.scales=t.ext.export_api._serializeScales(n)),t.ext.export_api._sendToExport(n,"excel"),(n.start||n.end)&&(t.config.start_date=i.min_date,t.config.end_date=i.max_date,t.eachTask=e,t.render(),t.scrollTo(a.x,a.y),t.config.start_date=s[0],t.config.end_date=s[1])},exportToJSON(n){n=t.mixin(n||{},{name:"gantt.json",data:t.ext.export_api._serializeAll(),config:t.config,columns:t.ext.export_api._serializeGrid(),worktime:t.ext.export_api._getWorktimeSettings(),version:t.version}),t.ext.export_api._sendToExport(n,"json")},importFromExcel(n){try{const e=n.data;if(e instanceof File){const i=new FormData;i.append("file",e),n.data=i}}catch{}t.ext.export_api._sendImportAjaxExcel(n)},importFromMSProject(n){const e=n.data;try{if(e instanceof File){const i=new FormData;i.append("file",e),n.data=i}}catch{}t.ext.export_api._sendImportAjaxMSP(n)},importFromPrimaveraP6:n=>(n.type="primaveraP6-parse",t.importFromMSProject(n)),exportToMSProject(n){(n=n||{}).skip_circular_links=n.skip_circular_links===void 0||!!n.skip_circular_links;const e=t.templates.xml_format,i=t.templates.format_date,a=t.config.xml_date,s=t.config.date_format,r="%d-%m-%Y %H:%i:%s";t.config.xml_date=r,t.config.date_format=r,t.templates.xml_format=t.date.date_to_str(r),t.templates.format_date=t.date.date_to_str(r);const o=t.ext.export_api._serializeAll();t.ext.export_api._customProjectProperties(o,n),t.ext.export_api._customTaskProperties(o,n),n.skip_circular_links&&t.ext.export_api._clearRecLinks(o),n=t.ext.export_api._exportConfig(o,n),t.ext.export_api._sendToExport(n,n.type||"msproject"),t.config.xml_date=a,t.config.date_format=s,t.templates.xml_format=e,t.templates.format_date=i,t.config.$custom_data=null,t.config.custom=null},exportToPrimaveraP6:n=>((n=n||{}).type="primaveraP6",t.exportToMSProject(n)),_fixColumns(n){for(let e=0;e<n.length;e++)n[e].label=n[e].label||t.locale.labels["column_"+n[e].name],typeof n[e].width=="string"&&(n[e].width=1*n[e].width)},_xdr(n,e,i){t.ajax.post(n,e,i)},_markColumns(n){const e=n.config.columns;if(e)for(let i=0;i<e.length;i++)e[i].template&&(e[i].$template=!0)},_sendImportAjaxExcel(n){const e=n.server||t.ext.export_api._apiUrl,i=n.store||0,a=n.data,s=n.callback;a.append("type","excel-parse"),a.append("data",JSON.stringify({sheet:n.sheet||0})),i&&a.append("store",i);const r=new XMLHttpRequest;r.onreadystatechange=function(o){r.readyState===4&&r.status===0&&s&&s(null)},r.onload=function(){let o=null;if(!(r.status>400))try{o=JSON.parse(r.responseText)}catch{}s&&s(o)},r.open("POST",e,!0),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.send(a)},_ajaxToExport(n,e,i){delete n.callback;const a=n.server||t.ext.export_api._apiUrl,s="type="+e+"&store=1&data="+encodeURIComponent(JSON.stringify(n));t.ext.export_api._xdr(a,s,function(r){const o=r.xmlDoc||r;let l=null;if(!(o.status>400))try{l=JSON.parse(o.responseText)}catch{}i(l)})},_serializableGanttConfig(n){const e=t.mixin({},n);return e.columns&&(e.columns=e.columns.map(function(i){const a=t.mixin({},i);return delete a.editor,a})),delete e.editor_types,e},_sendToExport(n,e){const i=t.date.date_to_str(t.config.date_format||t.config.xml_date);if(n.skin||(n.skin=t.skin),n.config&&(n.config=t.copy(t.ext.export_api._serializableGanttConfig(n.config)),t.ext.export_api._markColumns(n,e),n.config.start_date&&n.config.end_date&&(n.config.start_date instanceof Date&&(n.config.start_date=i(n.config.start_date)),n.config.end_date instanceof Date&&(n.config.end_date=i(n.config.end_date)))),n.callback)return t.ext.export_api._ajaxToExport(n,e,n.callback);const a=t.ext.export_api._createHiddenForm();a.firstChild.action=n.server||t.ext.export_api._apiUrl,a.firstChild.childNodes[0].value=JSON.stringify(n),a.firstChild.childNodes[1].value=e,a.firstChild.submit()},_createHiddenForm(){if(!t.ext.export_api._hidden_export_form){const n=t.ext.export_api._hidden_export_form=document.createElement("div");n.style.display="none",n.innerHTML="<form method='POST' target='_blank'><textarea name='data' style='width:0px; height:0px;' readonly='true'></textarea><input type='hidden' name='type' value=''></form>",document.body.appendChild(n)}return t.ext.export_api._hidden_export_form},_copyObjectBase(n){const e={start_date:void 0,end_date:void 0,constraint_date:void 0,deadline:void 0};for(const a in n)a.charAt(0)!=="$"&&a!=="baselines"&&(e[a]=n[a]);const i=t.templates.xml_format||t.templates.format_date;return e.start_date=i(e.start_date),e.end_date&&(e.end_date=i(e.end_date)),e.constraint_date&&(e.constraint_date=i(e.constraint_date)),e.deadline&&(e.deadline=i(e.deadline)),e},_color_box:null,_color_hash:{},_getStyles(n){if(t.ext.export_api._color_box||(t.ext.export_api._color_box=document.createElement("DIV"),t.ext.export_api._color_box.style.cssText="position:absolute; display:none;",document.body.appendChild(t.ext.export_api._color_box)),t.ext.export_api._color_hash[n])return t.ext.export_api._color_hash[n];t.ext.export_api._color_box.className=n;const e=t.ext.export_api._getColor(t.ext.export_api._color_box,"color"),i=t.ext.export_api._getColor(t.ext.export_api._color_box,"backgroundColor");return t.ext.export_api._color_hash[n]=e+";"+i},_getMinutesWorktimeSettings(n){const e=[];return n.forEach(function(i){e.push(i.startMinute),e.push(i.endMinute)}),e},_getWorktimeSettings(){const n={hours:[0,24],minutes:null,dates:{0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0}};let e;if(t.config.work_time){const i=t._working_time_helper;if(i&&i.get_calendar)e=i.get_calendar();else if(i)e={hours:i.hours,minutes:null,dates:i.dates};else if(t.config.worktimes&&t.config.worktimes.global){const a=t.config.worktimes.global;if(a.parsed){e={hours:null,minutes:t.ext.export_api._getMinutesWorktimeSettings(a.parsed.hours),dates:{}};for(const s in a.parsed.dates)Array.isArray(a.parsed.dates[s])?e.dates[s]=t.ext.export_api._getMinutesWorktimeSettings(a.parsed.dates[s]):e.dates[s]=a.parsed.dates[s]}else e={hours:a.hours,minutes:null,dates:a.dates}}else e=n}else e=n;return e},_eachTaskTimed:(n,e)=>function(i,a,s){a=a||t.config.root_id,s=s||t;const r=t.getChildren(a);if(r)for(let o=0;o<r.length;o++){const l=t._pull[r[o]];(!n||l.end_date>n)&&(!e||l.start_date<e)&&i.call(s,l),t.hasChild(l.id)&&t.eachTask(i,l.id,s)}},_originalCopyObject:t.json._copyObject,_copyObjectPlainICal(n){const e=t.templates.task_text(n.start_date,n.end_date,n),i=t.ext.export_api._copyObjectBase(n);return i.text=e||i.text,i},_copyObjectPlainExcel(n){const e=t.templates.task_text(n.start_date,n.end_date,n),i=t.json.serializeTask(n);return i.text=e||i.text,i},_getColor(n,e){let i=n.currentStyle?n.currentStyle[e]:getComputedStyle(n,null)[e];n.closest(".gantt_task_progress")&&i==="rgba(0, 0, 0, 0.15)"&&(i=(n=n.parentNode.parentNode).currentStyle?n.currentStyle[e]:getComputedStyle(n,null)[e]);const a=i.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+)/i);return(a&&a.length===4?("0"+parseInt(a[1],10).toString(16)).slice(-2)+("0"+parseInt(a[2],10).toString(16)).slice(-2)+("0"+parseInt(a[3],10).toString(16)).slice(-2):i).replace("#","")},_copyObjectTable(n){const e=t.date.date_to_str("%Y-%m-%dT%H:%i:%s.000Z"),i=t.ext.export_api._copyObjectColumns(n,t.ext.export_api._copyObjectPlainExcel(n));return i.start_date&&(typeof i.start_date=="string"?i.original_start_date=t.date.str_to_date(t.config.date_format)(i.start_date):(i.original_start_date=i.start_date,i.start_date=e(n.start_date))),i.end_date?typeof i.end_date=="string"?i.original_end_date=t.date.str_to_date(t.config.date_format)(i.end_date):(i.original_end_date=i.end_date,i.end_date=e(n.end_date)):i.original_start_date&&(i.original_end_date=t.calculateEndDate({start_date:i.original_start_date,duration:i.duration,task:i}),i.end_date=e(i.original_end_date)),i},_generatedScales:null,_generateScales(){const n=t.getState(),e=function(s){var r=new qt(s);return r.processIgnores=function(o){var l=o.count;if(o.ignore_x={},s.ignore_time||s.config.skip_off_time){var d=s.ignore_time||function(){return!1};l=0;for(var c=0;c<o.trace_x.length;c++)d.call(s,o.trace_x[c])||this._ignore_time_config.call(s,o.trace_x[c],o)?(o.ignore_x[o.trace_x[c].valueOf()]=!0,o.ignored_colls=!0):l++}o.display_count=l},r}(t),i=[e.primaryScale(t.config)].concat(e.getSubScales(t.config)),a=e.prepareConfigs(i,t.config.min_column_width,1e3,t.config.scale_height-1,n.min_date,n.max_date,t.config.rtl);return t.ext.export_api._generatedScales=a,a},_getDayIndex(n,e){let i=n.trace_indexes;if(i[+e])return i[+e];{i=n.trace_x;const a=t.getState();return+e<=a.min_date?t.config.rtl?i.length:0:+e>=a.max_date?t.config.rtl?0:i.length:Tt(i,+e)}},_copyObjectColors(n,e){const i=t.ext.export_api._copyObjectTable(n);let a,s=i.original_start_date,r=i.original_end_date,o=t.columnIndexByDate;if(t.ext.export_api._generatedScales){const h=t.ext.export_api._generatedScales;a=h[h.length-1],i.$start=t.ext.export_api._getDayIndex(a,s),i.$end=t.ext.export_api._getDayIndex(a,r)}else a=t.getScale(),i.$start=o.call(t,s),i.$end=o.call(t,r);let l=0;const d=a.width;if(d.indexOf(0)>-1){let h=0;for(;h<i.$start;h++)d[h]||l++;for(i.$start-=l;h<i.$end;h++)d[h]||l++;i.$end-=l}i.$level=n.$level,i.$type=n.$rendered_type;const c=t.templates;i.$text=c.task_text(n.start,n.end_date,n),i.$left=c.leftside_text?c.leftside_text(n.start,n.end_date,n):"",i.$right=c.rightside_text?c.rightside_text(n.start,n.end_date,n):"";const u=t.getTaskNode&&t.getTaskNode(n.id);if(u&&u.firstChild){let h=u;e.visual!=="base-colors"&&(h=u.querySelector(".gantt_task_progress"));let _=t.ext.export_api._getColor(h,"backgroundColor");_==="363636"&&(_=t.ext.export_api._getColor(u,"backgroundColor")),i.$color=_}else if(n.color)i.$color=n.color;else{const h=t.templates.task_class(n.start,n.end,n);if(h){const _=t.ext.export_api._getStyles(h);i.$color=_.split(";")[1]}}return i},_copyObjectColumns(n,e){for(let i=0;i<t.config.columns.length;i++){const a=t.config.columns[i].template;if(a){let s=a(n);s instanceof Date&&(s=t.templates.date_grid(s,n)),e["_"+i]=s}}return e},_copyObjectAll(n){const e=t.ext.export_api._copyObjectBase(n),i=["leftside_text","rightside_text","task_text","progress_text","task_class"];for(let a=0;a<i.length;a++){const s=t.templates[i[a]];s&&(e["$"+a]=s(n.start_date,n.end_date,n))}return t.ext.export_api._copyObjectColumns(n,e),e.open=n.$open,e},_serializeHtml(){const n=t.config.smart_scales,e=t.config.smart_rendering;(n||e)&&(t.config.smart_rendering=!1,t.config.smart_scales=!1,t.render());const i=t.$container.parentNode.innerHTML;return(n||e)&&(t.config.smart_scales=n,t.config.smart_rendering=e,t.render()),i},_serializeAll(){t.json._copyObject=t.ext.export_api._copyObjectAll;const n=t.ext.export_api._exportSerialize();return t.json._copyObject=t.ext.export_api._originalCopyObject,n},_serializePlain(){const n=t.templates.xml_format,e=t.templates.format_date;t.templates.xml_format=t.date.date_to_str("%Y%m%dT%H%i%s",!0),t.templates.format_date=t.date.date_to_str("%Y%m%dT%H%i%s",!0),t.json._copyObject=t.ext.export_api._copyObjectPlainICal;const i=t.ext.export_api._exportSerialize();return t.templates.xml_format=n,t.templates.format_date=e,t.json._copyObject=t.ext.export_api._originalCopyObject,delete i.links,i},_getRaw(){const n=t.$ui.getView("timeline");if(n&&t.config.show_chart){let e=n.$config.width;t.config.autosize!=="x"&&t.config.autosize!=="xy"||(e=Math.max(t.config.autosize_min_width,0));const i=t.getState(),a=n._getScales(),s=t.config.min_column_width,r=t.config.scale_height-1,o=t.config.rtl;return n.$scaleHelper.prepareConfigs(a,s,e,r,i.min_date,i.max_date,o)}return t.ext.export_api._generateScales()},_serializeTimeline(n){let e;t.ext.export_api._generatedScales=null,n.visual&&(e=t.ext.export_api._getRaw(n.start,n.end)),n.data&&(n.custom_dataset=!0);let i=n.data||t.serialize().data;if(i.forEach(function(a,s){if(n.visual)if(a.render=="split"){const r=[];n.custom_dataset?i.forEach(function(l){if(l.parent==a.id){const d=t.ext.export_api._copyObjectColors(l,n);d.$split_subtask=!0,r.push(d)}}):t.eachTask(function(l){const d=t.ext.export_api._copyObjectColors(l,n);r.push(d)},a.id),a.split_bars=[];const o={};for(let l=0;l<r.length;l++){const d=r[l];for(let c=0;c<r.length;c++){const u=r[c];if(d.id==u.id||o[u.id])continue;const h=+d.original_start_date<+u.original_start_date&&+u.original_start_date<=+d.original_end_date,_=+u.original_start_date<=+d.original_start_date&&+d.original_end_date<=+u.original_end_date;if(h&&(d.original_end_date=u.original_start_date,d.end_date=u.start_date,d.$end=u.$start),_){o[d.id]=!0;break}}o[d.id]||a.split_bars.push(d)}i[s]=a}else a.$split_subtask||(i[s]=t.ext.export_api._copyObjectColors(a,n));else i[s]=t.ext.export_api._copyObjectTable(a)}),n.raw&&!n.data){const a=t.getDatastore("task").visibleOrder;if(i.length!==a.length){const s=[];i.forEach(function(r){a.indexOf(r.id)>-1&&s.push(r)}),i=s}}if(n.cellColors){const a=t.templates.timeline_cell_class||t.templates.task_cell_class;if(a){let s=e[0].trace_x;for(let r=1;r<e.length;r++)e[r].trace_x.length>s.length&&(s=e[r].trace_x);for(let r=0;r<i.length;r++){i[r].styles=[];const o=t.getTask(i[r].id);for(let l=0;l<s.length;l++){const d=a(o,s[l]);d&&i[r].styles.push({index:l,styles:t.ext.export_api._getStyles(d)})}}}}return i},_serializeScales(n){const e=[],i=t.ext.export_api._getRaw();let a=1/0,s=0;for(let r=0;r<i.length;r++)a=Math.min(a,i[r].col_width);for(let r=0;r<i.length;r++){let o=0,l=0;const d=[];e.push(d);const c=i[r];s=Math.max(s,c.trace_x.length);const u=c.format||c.template||t.date.date_to_str(c.date);for(let h=0;h<c.trace_x.length;h++){const _=c.trace_x[h];l=o+Math.round(c.width[h]/a);const f={text:u(_),start:o,end:l,styles:""};if(n.cellColors){const y=c.css||t.templates.scaleCell_class;if(y){const v=y(_);v&&(f.styles=t.ext.export_api._getStyles(v))}}d.push(f),o=l}}return{width:s,height:e.length,data:e}},_serializeGrid(n){t.exportMode=!0;const e=[],i=t.config.columns;let a=0;for(let s=0;s<i.length;s++)i[s].name!=="add"&&i[s].name!=="buttons"&&(n&&n.raw&&i[s].hide||(e[a]={id:i[s].template?"_"+s:i[s].name,header:i[s].label||t.locale.labels["column_"+i[s].name],width:i[s].width?Math.floor(i[s].width/4):"",tree:i[s].tree||!1},i[s].name==="duration"&&(e[a].type="number"),i[s].name!=="start_date"&&i[s].name!=="end_date"||(e[a].type="date",n&&n.rawDates&&(e[a].id=i[s].name)),a++));return t.exportMode=!1,e},_exportSerialize(){t.exportMode=!0;const n=t.templates.xml_format,e=t.templates.format_date;t.templates.xml_format=t.templates.format_date=t.date.date_to_str(t.config.date_format||t.config.xml_date);const i=t.serialize();return t.templates.xml_format=n,t.templates.format_date=e,t.exportMode=!1,i},_setLevel(n){for(let e=0;e<n.length;e++){n[e].parent==0&&(n[e]._lvl=1);for(let i=e+1;i<n.length;i++)n[e].id==n[i].parent&&(n[i]._lvl=n[e]._lvl+1)}},_clearLevel(n){for(let e=0;e<n.length;e++)delete n[e]._lvl},_clearRecLinks(n){t.ext.export_api._setLevel(n.data);const e={};for(let s=0;s<n.data.length;s++)e[n.data[s].id]=n.data[s];const i={};for(let s=0;s<n.links.length;s++){const r=n.links[s];t.isTaskExists(r.source)&&t.isTaskExists(r.target)&&e[r.source]&&e[r.target]&&(i[r.id]=r)}for(const s in i)t.ext.export_api._makeLinksSameLevel(i[s],e);const a={};for(const s in e)t.ext.export_api._clearCircDependencies(e[s],i,e,{},a,null);Object.keys(i)&&t.ext.export_api._clearLinksSameLevel(i,e);for(let s=0;s<n.links.length;s++)i[n.links[s].id]||(n.links.splice(s,1),s--);t.ext.export_api._clearLevel(n.data)},_clearCircDependencies(n,e,i,a,s,r){const o=n.$_source;if(!o)return;a[n.id]&&t.ext.export_api._onCircDependencyFind(r,e,a,s),a[n.id]=!0;const l={};for(let d=0;d<o.length;d++){if(s[o[d]])continue;const c=e[o[d]],u=i[c._target];l[u.id]&&t.ext.export_api._onCircDependencyFind(c,e,a,s),l[u.id]=!0,t.ext.export_api._clearCircDependencies(u,e,i,a,s,c)}a[n.id]=!1},_onCircDependencyFind(n,e,i,a){n&&(t.callEvent("onExportCircularDependency",[n.id,n])&&delete e[n.id],delete i[n._source],delete i[n._target],a[n.id]=!0)},_makeLinksSameLevel(n,e){let i,a;const s={target:e[n.target],source:e[n.source]};if(s.target._lvl!=s.source._lvl){s.target._lvl<s.source._lvl?(i="source",a=s.target._lvl):(i="target",a=s.source._lvl);do{const l=e[s[i].parent];if(!l)break;s[i]=l}while(s[i]._lvl<a);let r=e[s.source.parent],o=e[s.target.parent];for(;r&&o&&r.id!=o.id;)s.source=r,s.target=o,r=e[s.source.parent],o=e[s.target.parent]}n._target=s.target.id,n._source=s.source.id,s.target.$_target||(s.target.$_target=[]),s.target.$_target.push(n.id),s.source.$_source||(s.source.$_source=[]),s.source.$_source.push(n.id)},_clearLinksSameLevel(n,e){for(const i in n)delete n[i]._target,delete n[i]._source;for(const i in e)delete e[i].$_source,delete e[i].$_target},_customProjectProperties(n,e){if(e&&e.project){for(const i in e.project)t.config.$custom_data||(t.config.$custom_data={}),t.config.$custom_data[i]=typeof e.project[i]=="function"?e.project[i](t.config):e.project[i];delete e.project}},_customTaskProperties(n,e){e&&e.tasks&&(n.data.forEach(function(i){for(const a in e.tasks)i.$custom_data||(i.$custom_data={}),i.$custom_data[a]=typeof e.tasks[a]=="function"?e.tasks[a](i,t.config):e.tasks[a]}),delete e.tasks)},_exportConfig(n,e){const i=e.name||"gantt.xml";delete e.name,t.config.custom=e;const a=t.ext.export_api._getWorktimeSettings(),s=t.getSubtaskDates();if(s.start_date&&s.end_date){const l=t.templates.format_date||t.templates.xml_format;t.config.start_end={start_date:l(s.start_date),end_date:l(s.end_date)}}const r=!!t._getAutoSchedulingConfig().enabled,o={callback:e.callback||null,config:t.config,data:n,manual:r,name:i,worktime:a};for(const l in e)o[l]=e[l];return o},_sendImportAjaxMSP(n){const e=n.server||t.ext.export_api._apiUrl,i=n.store||0,a=n.data,s=n.callback,r={durationUnit:n.durationUnit||void 0,projectProperties:n.projectProperties||void 0,taskProperties:n.taskProperties||void 0};a.append("type",n.type||"msproject-parse"),a.append("data",JSON.stringify(r)),i&&a.append("store",i);const o=new XMLHttpRequest;o.onreadystatechange=function(l){o.readyState===4&&o.status===0&&s&&s(null)},o.onload=function(){let l=null;if(!(o.status>400))try{l=JSON.parse(o.responseText)}catch{}s&&s(l)},o.open("POST",e,!0),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.send(a)}},t.exportToPDF=t.ext.export_api.exportToPDF,t.exportToPNG=t.ext.export_api.exportToPNG,t.exportToICal=t.ext.export_api.exportToICal,t.exportToExcel=t.ext.export_api.exportToExcel,t.exportToJSON=t.ext.export_api.exportToJSON,t.importFromExcel=t.ext.export_api.importFromExcel,t.importFromMSProject=t.ext.export_api.importFromMSProject,t.exportToMSProject=t.ext.export_api.exportToMSProject,t.importFromPrimaveraP6=t.ext.export_api.importFromPrimaveraP6,t.exportToPrimaveraP6=t.ext.export_api.exportToPrimaveraP6,t.ext.export_api}},Gn={KEY_CODES:{UP:38,DOWN:40,LEFT:37,RIGHT:39,SPACE:32,ENTER:13,DELETE:46,ESC:27,TAB:9}};class Yn{constructor(n){this.addExtension=(e,i)=>{this._extensions[e]=i},this.getExtension=e=>this._extensions[e],this._extensions={};for(const e in n)this._extensions[e]=n[e]}}var _t=typeof window<"u";const ct=typeof navigator<"u"?navigator:{userAgent:""},pt={isIE:_t&&(ct.userAgent.indexOf("MSIE")>=0||ct.userAgent.indexOf("Trident")>=0),isOpera:_t&&(ct.userAgent.indexOf("Opera")>=0||ct.userAgent.indexOf("OPR")>=0),isChrome:_t&&ct.userAgent.indexOf("Chrome")>=0,isSafari:_t&&(ct.userAgent.indexOf("Safari")>=0||ct.userAgent.indexOf("Konqueror")>=0),isFF:_t&&ct.userAgent.indexOf("Firefox")>=0,isIPad:_t&&ct.userAgent.search(/iPad/gi)>=0,isEdge:_t&&ct.userAgent.indexOf("Edge")!=-1,isNode:!_t||typeof navigator>"u"||!1,isSalesforce:_t&&(!!Q.Sfdc||!!Q.$A||Q.Aura)};function Ge(t){if(typeof t=="string"||typeof t=="number")return t;let n="";for(const e in t){let i="";t.hasOwnProperty(e)&&(i=typeof t[e]=="string"?encodeURIComponent(t[e]):typeof t[e]=="number"?String(t[e]):encodeURIComponent(JSON.stringify(t[e])),i=e+"="+i,n.length&&(i="&"+i),n+=i)}return n}function Ct(t,n){var e={method:t};if(n.length===0)throw new Error("Arguments list of query is wrong.");if(n.length===1)return typeof n[0]=="string"?(e.url=n[0],e.async=!0):(e.url=n[0].url,e.async=n[0].async||!0,e.callback=n[0].callback,e.headers=n[0].headers),n[0].data?typeof n[0].data!="string"?e.data=Ge(n[0].data):e.data=n[0].data:e.data="",e;switch(e.url=n[0],t){case"GET":case"DELETE":e.callback=n[1],e.headers=n[2];break;case"POST":case"PUT":n[1]?typeof n[1]!="string"?e.data=Ge(n[1]):e.data=n[1]:e.data="",e.callback=n[2],e.headers=n[3]}return e}const Ye={date_to_str:(t,n,e)=>{t=t.replace(/%[a-zA-Z]/g,a=>{switch(a){case"%d":return`"+to_fixed(date.get${n?"UTC":""}Date())+"`;case"%m":return`"+to_fixed((date.get${n?"UTC":""}Month()+1))+"`;case"%j":return`"+date.get${n?"UTC":""}Date()+"`;case"%n":return`"+(date.get${n?"UTC":""}Month()+1)+"`;case"%y":return`"+to_fixed(date.get${n?"UTC":""}FullYear()%100)+"`;case"%Y":return`"+date.get${n?"UTC":""}FullYear()+"`;case"%D":return`"+locale.date.day_short[date.get${n?"UTC":""}Day()]+"`;case"%l":return`"+locale.date.day_full[date.get${n?"UTC":""}Day()]+"`;case"%M":return`"+locale.date.month_short[date.get${n?"UTC":""}Month()]+"`;case"%F":return`"+locale.date.month_full[date.get${n?"UTC":""}Month()]+"`;case"%h":return`"+to_fixed((date.get${n?"UTC":""}Hours()+11)%12+1)+"`;case"%g":return`"+((date.get${n?"UTC":""}Hours()+11)%12+1)+"`;case"%G":return`"+date.get${n?"UTC":""}Hours()+"`;case"%H":return`"+to_fixed(date.get${n?"UTC":""}Hours())+"`;case"%i":return`"+to_fixed(date.get${n?"UTC":""}Minutes())+"`;case"%a":return`"+(date.get${n?"UTC":""}Hours()>11?"pm":"am")+"`;case"%A":return`"+(date.get${n?"UTC":""}Hours()>11?"PM":"AM")+"`;case"%s":return`"+to_fixed(date.get${n?"UTC":""}Seconds())+"`;case"%W":return'"+to_fixed(getISOWeek(date))+"';case"%w":return'"+to_fixed(getWeek(date))+"';default:return a}});const i=new Function("date","to_fixed","locale","getISOWeek","getWeek",`return "${t}";`);return a=>i(a,e.date.to_fixed,e.locale,e.date.getISOWeek,e.date.getWeek)},str_to_date:(t,n,e)=>{let i="var temp=date.match(/[a-zA-Z]+|[0-9]+/g);";const a=t.match(/%[a-zA-Z]/g);for(let o=0;o<a.length;o++)switch(a[o]){case"%j":case"%d":i+=`set[2]=temp[${o}]||1;`;break;case"%n":case"%m":i+=`set[1]=(temp[${o}]||1)-1;`;break;case"%y":i+=`set[0]=temp[${o}]*1+(temp[${o}]>50?1900:2000);`;break;case"%g":case"%G":case"%h":case"%H":i+=`set[3]=temp[${o}]||0;`;break;case"%i":i+=`set[4]=temp[${o}]||0;`;break;case"%Y":i+=`set[0]=temp[${o}]||0;`;break;case"%a":case"%A":i+=`set[3]=set[3]%12+((temp[${o}]||'').toLowerCase()=='am'?0:12);`;break;case"%s":i+=`set[5]=temp[${o}]||0;`;break;case"%M":i+=`set[1]=locale.date.month_short_hash[temp[${o}]]||0;`;break;case"%F":i+=`set[1]=locale.date.month_full_hash[temp[${o}]]||0;`}let s="set[0],set[1],set[2],set[3],set[4],set[5]";n&&(s=` Date.UTC(${s})`);const r=new Function("date","locale",`var set=[0,0,1,0,0,0]; ${i} return new Date(${s});`);return o=>r(o,e.locale)}},Je={date_to_str:(t,n,e)=>i=>t.replace(/%[a-zA-Z]/g,a=>{switch(a){case"%d":return n?e.date.to_fixed(i.getUTCDate()):e.date.to_fixed(i.getDate());case"%m":return n?e.date.to_fixed(i.getUTCMonth()+1):e.date.to_fixed(i.getMonth()+1);case"%j":return n?i.getUTCDate():i.getDate();case"%n":return n?i.getUTCMonth()+1:i.getMonth()+1;case"%y":return n?e.date.to_fixed(i.getUTCFullYear()%100):e.date.to_fixed(i.getFullYear()%100);case"%Y":return n?i.getUTCFullYear():i.getFullYear();case"%D":return n?e.locale.date.day_short[i.getUTCDay()]:e.locale.date.day_short[i.getDay()];case"%l":return n?e.locale.date.day_full[i.getUTCDay()]:e.locale.date.day_full[i.getDay()];case"%M":return n?e.locale.date.month_short[i.getUTCMonth()]:e.locale.date.month_short[i.getMonth()];case"%F":return n?e.locale.date.month_full[i.getUTCMonth()]:e.locale.date.month_full[i.getMonth()];case"%h":return n?e.date.to_fixed((i.getUTCHours()+11)%12+1):e.date.to_fixed((i.getHours()+11)%12+1);case"%g":return n?(i.getUTCHours()+11)%12+1:(i.getHours()+11)%12+1;case"%G":return n?i.getUTCHours():i.getHours();case"%H":return n?e.date.to_fixed(i.getUTCHours()):e.date.to_fixed(i.getHours());case"%i":return n?e.date.to_fixed(i.getUTCMinutes()):e.date.to_fixed(i.getMinutes());case"%a":return n?i.getUTCHours()>11?"pm":"am":i.getHours()>11?"pm":"am";case"%A":return n?i.getUTCHours()>11?"PM":"AM":i.getHours()>11?"PM":"AM";case"%s":return n?e.date.to_fixed(i.getUTCSeconds()):e.date.to_fixed(i.getSeconds());case"%W":return n?e.date.to_fixed(e.date.getUTCISOWeek(i)):e.date.to_fixed(e.date.getISOWeek(i));case"%w":return e.date.to_fixed(e.date.getWeek(i));default:return a}}),str_to_date:(t,n,e)=>i=>{const a=[0,0,1,0,0,0],s=i.match(/[a-zA-Z]+|[0-9]+/g),r=t.match(/%[a-zA-Z]/g);for(let o=0;o<r.length;o++)switch(r[o]){case"%j":case"%d":a[2]=s[o]||1;break;case"%n":case"%m":a[1]=(s[o]||1)-1;break;case"%y":a[0]=1*s[o]+(s[o]>50?1900:2e3);break;case"%g":case"%G":case"%h":case"%H":a[3]=s[o]||0;break;case"%i":a[4]=s[o]||0;break;case"%Y":a[0]=s[o]||0;break;case"%a":case"%A":a[3]=a[3]%12+((s[o]||"").toLowerCase()==="am"?0:12);break;case"%s":a[5]=s[o]||0;break;case"%M":a[1]=e.locale.date.month_short_hash[s[o]]||0;break;case"%F":a[1]=e.locale.date.month_full_hash[s[o]]||0}return n?new Date(Date.UTC(a[0],a[1],a[2],a[3],a[4],a[5])):new Date(a[0],a[1],a[2],a[3],a[4],a[5])}};function Jn(t){var n=null;function e(){var a=!1;return t.config.csp==="auto"?(n===null&&function(){try{new Function("canUseCsp = false;")}catch{n=!0}}(),a=n):a=t.config.csp,a}var i={init:function(){for(var a=t.locale,s=a.date.month_short,r=a.date.month_short_hash={},o=0;o<s.length;o++)r[s[o]]=o;for(s=a.date.month_full,r=a.date.month_full_hash={},o=0;o<s.length;o++)r[s[o]]=o},date_part:function(a){var s=new Date(a);return a.setHours(0),this.hour_start(a),a.getHours()&&(a.getDate()<s.getDate()||a.getMonth()<s.getMonth()||a.getFullYear()<s.getFullYear())&&a.setTime(a.getTime()+36e5*(24-a.getHours())),a},time_part:function(a){return(a.valueOf()/1e3-60*a.getTimezoneOffset())%86400},week_start:function(a){var s=a.getDay();return t.config.start_on_monday&&(s===0?s=6:s--),this.date_part(this.add(a,-1*s,"day"))},month_start:function(a){return a.setDate(1),this.date_part(a)},quarter_start:function(a){this.month_start(a);var s,r=a.getMonth();return s=r>=9?9:r>=6?6:r>=3?3:0,a.setMonth(s),a},year_start:function(a){return a.setMonth(0),this.month_start(a)},day_start:function(a){return this.date_part(a)},hour_start:function(a){return a.getMinutes()&&a.setMinutes(0),this.minute_start(a),a},minute_start:function(a){return a.getSeconds()&&a.setSeconds(0),a.getMilliseconds()&&a.setMilliseconds(0),a},_add_days:function(a,s,r){a.setDate(a.getDate()+s);var o=s>=0,l=!r.getHours()&&a.getHours(),d=a.getDate()<=r.getDate()||a.getMonth()<r.getMonth()||a.getFullYear()<r.getFullYear();return o&&l&&d&&a.setTime(a.getTime()+36e5*(24-a.getHours())),s>1&&l&&a.setHours(0),a},add:function(a,s,r){var o=new Date(a.valueOf());switch(r){case"day":o=this._add_days(o,s,a);break;case"week":o=this._add_days(o,7*s,a);break;case"month":o.setMonth(o.getMonth()+s);break;case"year":o.setYear(o.getFullYear()+s);break;case"hour":o.setTime(o.getTime()+60*s*60*1e3);break;case"minute":o.setTime(o.getTime()+60*s*1e3);break;default:return this["add_"+r](a,s,r)}return o},add_quarter:function(a,s){return this.add(a,3*s,"month")},to_fixed:function(a){return a<10?"0"+a:a},copy:function(a){return new Date(a.valueOf())},date_to_str:function(a,s){var r=Ye;return e()&&(r=Je),r.date_to_str(a,s,t)},str_to_date:function(a,s){var r=Ye;return e()&&(r=Je),r.str_to_date(a,s,t)},getISOWeek:function(a){return t.date._getWeekNumber(a,!0)},_getWeekNumber:function(a,s){if(!a)return!1;var r=a.getDay();s&&r===0&&(r=7);var o=new Date(a.valueOf());o.setDate(a.getDate()+(4-r));var l=o.getFullYear(),d=Math.round((o.getTime()-new Date(l,0,1).getTime())/864e5);return 1+Math.floor(d/7)},getWeek:function(a){return t.date._getWeekNumber(a,t.config.start_on_monday)},getUTCISOWeek:function(a){return t.date.getISOWeek(a)},convert_to_utc:function(a){return new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds())},parseDate:function(a,s){return a&&!a.getFullYear&&(typeof s!="function"&&(s=typeof s=="string"?s==="parse_date"||s==="xml_date"?t.defined(t.templates.xml_date)?t.templates.xml_date:t.templates.parse_date:t.defined(t.templates[s])?t.templates[s]:t.date.str_to_date(s):t.defined(t.templates.xml_date)?t.templates.xml_date:t.templates.parse_date),a=a?s(a):null),a}};return i}class Ke{constructor(n){const{url:e,token:i}=n;this._url=e,this._token=i,this._mode=1,this._seed=1,this._queue=[],this.data={},this.api={},this._events={}}headers(){return{Accept:"application/json","Content-Type":"application/json","Remote-Token":this._token}}fetch(n,e){const i={credentials:"include",headers:this.headers()};return e&&(i.method="POST",i.body=e),fetch(n,i).then(a=>a.json())}load(n){return n&&(this._url=n),this.fetch(this._url).then(e=>this.parse(e))}parse(n){const{key:e,websocket:i}=n;e&&(this._token=n.key);for(const a in n.data)this.data[a]=n.data[a];for(const a in n.api){const s=this.api[a]={},r=n.api[a];for(const o in r)s[o]=this._wrapper(a+"."+o)}return i&&this.connect(),this}connect(){const n=this._socket;n&&(this._socket=null,n.onclose=function(){},n.close()),this._mode=2,this._socket=function(e,i,a,s){let r=i;r[0]==="/"&&(r=document.location.protocol+"//"+document.location.host+i),r=r.replace(/^http(s|):/,"ws$1:");const o=r.indexOf("?")!=-1?"&":"?";r=`${r}${o}token=${a}&ws=1`;const l=new WebSocket(r);return l.onclose=()=>setTimeout(()=>e.connect(),2e3),l.onmessage=d=>{const c=JSON.parse(d.data);switch(c.action){case"result":e.result(c.body,[]);break;case"event":e.fire(c.body.name,c.body.value);break;case"start":s();break;default:e.onError(c.data)}},l}(this,this._url,this._token,()=>(this._mode=3,this._send(),this._resubscribe(),this))}_wrapper(n){return(function(){const e=[].slice.call(arguments);let i=null;const a=new Promise((s,r)=>{i={data:{id:this._uid(),name:n,args:e},status:1,resolve:s,reject:r},this._queue.push(i)});return this.onCall(i,a),this._mode===3?this._send(i):setTimeout(()=>this._send(),1),a}).bind(this)}_uid(){return(this._seed++).toString()}_send(n){if(this._mode==2)return void setTimeout(()=>this._send(),100);const e=n?[n]:this._queue.filter(a=>a.status===1);if(!e.length)return;const i=e.map(a=>(a.status=2,a.data));this._mode!==3?this.fetch(this._url,JSON.stringify(i)).catch(a=>this.onError(a)).then(a=>this.result(a,i)):this._socket.send(JSON.stringify({action:"call",body:i}))}result(n,e){const i={};if(n)for(let a=0;a<n.length;a++)i[n[a].id]=n[a];else for(let a=0;a<e.length;a++)i[e[a].id]={id:e[a].id,error:"Network Error",data:null};for(let a=this._queue.length-1;a>=0;a--){const s=this._queue[a],r=i[s.data.id];r&&(this.onResponse(s,r),r.error?s.reject(r.error):s.resolve(r.data),this._queue.splice(a,1))}}on(n,e){const i=this._uid();let a=this._events[n];const s=!!a;return s||(a=this._events[n]=[]),a.push({id:i,handler:e}),s||this._mode!=3||this._socket.send(JSON.stringify({action:"subscribe",name:n})),{name:n,id:i}}_resubscribe(){if(this._mode==3)for(const n in this._events)this._socket.send(JSON.stringify({action:"subscribe",name:n}))}detach(n){if(!n){if(this._mode==3)for(const s in this._events)this._socket.send(JSON.stringify({action:"unsubscribe",key:s}));return void(this._events={})}const{id:e,name:i}=n,a=this._events[i];if(a){const s=a.filter(r=>r.id!=e);s.length?this._events[i]=s:(delete this._events[i],this._mode==3&&this._socket.send(JSON.stringify({action:"unsubscribe",name:i})))}}fire(n,e){const i=this._events[n];if(i)for(let a=0;a<i.length;a++)i[a].handler(e)}onError(n){return null}onCall(n,e){}onResponse(n,e){}}const Kn=function(t,n){const e=new Ke({url:t,token:n});e.fetch=function(i,a){const s={headers:this.headers()};return a&&(s.method="POST",s.body=a),fetch(i,s).then(r=>r.json())},this._ready=e.load().then(i=>this._remote=i),this.ready=function(){return this._ready},this.on=function(i,a){this.ready().then(s=>{if(typeof i=="string")s.on(i,a);else for(const r in i)s.on(r,i[r])})}};function Xe(t,n){if(!n)return!0;if(t._on_timeout)return!1;var e=Math.ceil(1e3/n);return e<2||(setTimeout(function(){delete t._on_timeout},e),t._on_timeout=!0),!0}var Xn=function(){var t={};return{getState:function(n){if(t[n])return t[n].method();var e={};for(var i in t)t[i].internal||R(e,t[i].method(),!0);return e},registerProvider:function(n,e,i){t[n]={method:e,internal:i}},unregisterProvider:function(n){delete t[n]}}};const Zn=Promise;var it={$create:function(t){return R(t||[],this)},$removeAt:function(t,n){t>=0&&this.splice(t,n||1)},$remove:function(t){this.$removeAt(this.$find(t))},$insertAt:function(t,n){if(n||n===0){var e=this.splice(n,this.length-n);this[n]=t,this.push.apply(this,e)}else this.push(t)},$find:function(t){for(var n=0;n<this.length;n++)if(t==this[n])return n;return-1},$each:function(t,n){for(var e=0;e<this.length;e++)t.call(n||this,this[e])},$map:function(t,n){for(var e=0;e<this.length;e++)this[e]=t.call(n||this,this[e]);return this},$filter:function(t,n){for(var e=0;e<this.length;e++)t.call(n||this,this[e])||(this.splice(e,1),e--);return this}};function It(t,n,e,i){return(i=n?n.config:i)&&i.placeholder_task&&e.exists(t)?e.getItem(t).type===i.types.placeholder:!1}var lt=function(t){return this.pull={},this.$initItem=t.initItem,this.visibleOrder=it.$create(),this.fullOrder=it.$create(),this._skip_refresh=!1,this._filterRule=null,this._searchVisibleOrder={},this._indexRangeCache={},this._getItemsCache=null,this.$config=t,st(this),this._attachDataChange(function(){return this._indexRangeCache={},this._getItemsCache=null,!0}),this};lt.prototype={_attachDataChange:function(t){this.attachEvent("onClearAll",t),this.attachEvent("onBeforeParse",t),this.attachEvent("onBeforeUpdate",t),this.attachEvent("onBeforeDelete",t),this.attachEvent("onBeforeAdd",t),this.attachEvent("onParse",t),this.attachEvent("onBeforeFilter",t)},_parseInner:function(t){for(var n=null,e=[],i=0,a=t.length;i<a;i++)n=t[i],this.$initItem&&(this.$config.copyOnParse()&&(n=K(n)),n=this.$initItem(n)),this.callEvent("onItemLoading",[n])&&(this.pull.hasOwnProperty(n.id)||this.fullOrder.push(n.id),e.push(n),this.pull[n.id]=n);return e},parse:function(t){this.isSilent()||this.callEvent("onBeforeParse",[t]);var n=this._parseInner(t);this.isSilent()||(this.refresh(),this.callEvent("onParse",[n]))},getItem:function(t){return this.pull[t]},_updateOrder:function(t){t.call(this.visibleOrder),t.call(this.fullOrder)},updateItem:function(t,n){if(U(n)||(n=this.getItem(t)),!this.isSilent()&&this.callEvent("onBeforeUpdate",[n.id,n])===!1)return!1;R(this.pull[t],n,!0),this.isSilent()||(this.callEvent("onAfterUpdate",[n.id,n]),this.callEvent("onStoreUpdated",[n.id,n,"update"]))},_removeItemInner:function(t){this._updateOrder(function(){this.$remove(t)}),delete this.pull[t]},removeItem:function(t){var n=this.getItem(t);if(!this.isSilent()&&this.callEvent("onBeforeDelete",[n.id,n])===!1)return!1;this.callEvent("onAfterDeleteConfirmed",[n.id,n]),this._removeItemInner(t),this.isSilent()&&this.callEvent("onAfterSilentDelete",[n.id,n]),this.isSilent()||(this.filter(),this.callEvent("onAfterDelete",[n.id,n]),this.callEvent("onStoreUpdated",[n.id,n,"delete"]))},_addItemInner:function(t,n){if(this.exists(t.id))this.silent(function(){this.updateItem(t.id,t)});else{var e=this.visibleOrder,i=e.length;(!U(n)||n<0)&&(n=i),n>i&&(n=Math.min(e.length,n))}this.pull[t.id]=t,this._updateOrder(function(){this.$find(t.id)===-1&&this.$insertAt(t.id,n)}),this.filter()},isVisible:function(t){return this.visibleOrder.$find(t)>-1},getVisibleItems:function(){return this.getIndexRange()},addItem:function(t,n){return U(t.id)||(t.id=ot()),this.$initItem&&(t=this.$initItem(t)),!(!this.isSilent()&&this.callEvent("onBeforeAdd",[t.id,t])===!1)&&(this._addItemInner(t,n),this.isSilent()?this.sync_link&&this.sync_link(t):(this.callEvent("onAfterAdd",[t.id,t]),this.callEvent("onStoreUpdated",[t.id,t,"add"])),t.id)},_changeIdInner:function(t,n){this.pull[t]&&(this.pull[n]=this.pull[t]);var e=this._searchVisibleOrder[t];this.pull[n].id=n,this._updateOrder(function(){this[this.$find(t)]=n}),this._searchVisibleOrder[n]=e,delete this._searchVisibleOrder[t],delete this.pull[t]},changeId:function(t,n){this._changeIdInner(t,n),this.callEvent("onIdChange",[t,n])},exists:function(t){return!!this.pull[t]},_moveInner:function(t,n){var e=this.getIdByIndex(t);this._updateOrder(function(){this.$removeAt(t),this.$insertAt(e,Math.min(this.length,n))})},move:function(t,n){var e=this.getIdByIndex(t),i=this.getItem(e);this._moveInner(t,n),this.isSilent()||this.callEvent("onStoreUpdated",[i.id,i,"move"])},clearAll:function(){this.$destroyed||(this.silent(function(){this.unselect()}),this.pull={},this.visibleOrder=it.$create(),this.fullOrder=it.$create(),this.isSilent()||(this.callEvent("onClearAll",[]),this.refresh()))},silent:function(t,n){var e=!1;this.isSilent()&&(e=!0),this._skip_refresh=!0,t.call(n||this),e||(this._skip_refresh=!1)},isSilent:function(){return!!this._skip_refresh},arraysEqual:function(t,n){if(t.length!==n.length)return!1;for(var e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0},refresh:function(t,n){var e,i;if(!this.$destroyed&&!this.isSilent()&&(t&&(e=this.getItem(t)),i=t?[t,e,"paint"]:[null,null,null],this.callEvent("onBeforeStoreUpdate",i)!==!1)){var a=this._quick_refresh&&!this._mark_recompute;if(this._mark_recompute=!1,t){if(!n&&!a){var s=this.visibleOrder;this.filter(),this.arraysEqual(s,this.visibleOrder)||(t=void 0)}}else a||this.filter();i=t?[t,e,"paint"]:[null,null,null],this.callEvent("onStoreUpdated",i)}},count:function(){return this.fullOrder.length},countVisible:function(){return this.visibleOrder.length},sort:function(t){},serialize:function(){},eachItem:function(t){for(var n=0;n<this.fullOrder.length;n++){var e=this.getItem(this.fullOrder[n]);t.call(this,e)}},find:function(t){var n=[];return this.eachItem(function(e){t(e)&&n.push(e)}),n},filter:function(t){this.isSilent()||this.callEvent("onBeforeFilter",[]),this.callEvent("onPreFilter",[]);var n=it.$create(),e=[];this.eachItem(function(a){this.callEvent("onFilterItem",[a.id,a])&&(It(a.id,null,this,this._ganttConfig)?e.push(a.id):n.push(a.id))});for(var i=0;i<e.length;i++)n.push(e[i]);for(this.visibleOrder=n,this._searchVisibleOrder={},i=0;i<this.visibleOrder.length;i++)this._searchVisibleOrder[this.visibleOrder[i]]=i;this.isSilent()||this.callEvent("onFilter",[])},getIndexRange:function(t,n){var e=Math.min(n||1/0,this.countVisible()-1),i=t||0,a=i+"-"+e;if(this._indexRangeCache[a])return this._indexRangeCache[a].slice();for(var s=[],r=i;r<=e;r++)s.push(this.getItem(this.visibleOrder[r]));return this._indexRangeCache[a]=s.slice(),s},getItems:function(){if(this._getItemsCache)return this._getItemsCache.slice();var t=[];for(var n in this.pull)t.push(this.pull[n]);return this._getItemsCache=t.slice(),t},getIdByIndex:function(t){return this.visibleOrder[t]},getIndexById:function(t){var n=this._searchVisibleOrder[t];return n===void 0&&(n=-1),n},_getNullIfUndefined:function(t){return t===void 0?null:t},getFirst:function(){return this._getNullIfUndefined(this.visibleOrder[0])},getLast:function(){return this._getNullIfUndefined(this.visibleOrder[this.visibleOrder.length-1])},getNext:function(t){return this._getNullIfUndefined(this.visibleOrder[this.getIndexById(t)+1])},getPrev:function(t){return this._getNullIfUndefined(this.visibleOrder[this.getIndexById(t)-1])},destructor:function(){this.callEvent("onDestroy",[]),this.detachAllEvents(),this.$destroyed=!0,this.pull=null,this.$initItem=null,this.visibleOrder=null,this.fullOrder=null,this._skip_refresh=null,this._filterRule=null,this._searchVisibleOrder=null,this._indexRangeCache={}}};class Qn{constructor(n){this._datastore=null,this.isSplitItem=e=>e.render=="split"&&this._datastore.hasChild(e.id),this.isSubrowSplitItem=e=>e.split_placement=="subrow",this.isDefaultSplitItem=e=>e.split_placement=="auto"||e.split_placement===void 0,this.isInlineSplitItem=e=>e.split_placement=="inline",this._datastore=n}}var Ze=function(t){var n;lt.apply(this,[t]),this._branches={},this._splitTaskHelper=new Qn(this),this.pull={},this.$initItem=function(o){var l=o;t.initItem&&(l=t.initItem(l));var d=this.getItem(o.id);return d&&!ut(d.parent,l.parent)&&this.move(l.id,l.$index||-1,l.parent||this._ganttConfig.root_id),l},this.$parentProperty=t.parentProperty||"parent",typeof t.rootId!="function"?this.$getRootId=(n=t.rootId||0,function(){return n}):this.$getRootId=t.rootId,this.$openInitially=t.openInitially,this.visibleOrder=it.$create(),this.fullOrder=it.$create(),this._searchVisibleOrder={},this._indexRangeCache={},this._eachItemMainRangeCache=null,this._getItemsCache=null,this._skip_refresh=!1,this._ganttConfig=null,t.getConfig&&(this._ganttConfig=t.getConfig());var e={},i={},a={},s={},r=!1;return this._attachDataChange(function(){return this._indexRangeCache={},this._eachItemMainRangeCache=null,this._getItemsCache=null,!0}),this.attachEvent("onPreFilter",function(){this._indexRangeCache={},this._eachItemMainRangeCache=null,e={},i={},a={},s={},r=!1,this.eachItem(function(o){var l=this.getParent(o.id);o.$open&&a[l]!==!1?a[o.id]=!0:a[o.id]=!1,this._isSplitItem(o)&&(r=!0,e[o.id]=!0,i[o.id]=!0),r&&i[l]&&(this._isDefaultItem(o)||this._isInlineChildItem(o))&&(i[o.id]=!0),a[l]||a[l]===void 0||this._isInlineChildItem(o)?s[o.id]=!0:s[o.id]=!1})}),this.attachEvent("onFilterItem",function(o,l){var d=!1;this._ganttConfig&&(d=this._ganttConfig.open_split_tasks);var c=s[l.id];return r&&(c&&i[l.id]&&!e[l.id]&&(c=!!d),i[l.id]&&!e[l.id]&&(this._isSplitChildItem(l)||(l.$split_subtask=!0))),l.$expanded_branch=!!s[l.id],this._isInlineChildItem(l)&&(c=!1),!!c}),this.attachEvent("onFilter",function(){e={},i={},a={},s={}}),this};function ut(t,n){return String(t)===String(n)}function Y(t){return pt.isNode||!t.$root}Ze.prototype=R({_buildTree:function(t){for(var n=null,e=this.$getRootId(),i=0,a=t.length;i<a;i++)n=t[i],this.setParent(n,rt(this.getParent(n),e)||e);for(i=0,a=t.length;i<a;i++)n=t[i],this._add_branch(n),n.$level=this.calculateItemLevel(n),n.$local_index=this.getBranchIndex(n.id),U(n.$open)||(n.$open=U(n.open)?n.open:this.$openInitially());this._updateOrder()},_isSplitItem:function(t){return this._splitTaskHelper.isSplitItem(t)},_isSplitChildItem:function(t){return this._splitTaskHelper.isSubrowSplitItem(t)},_isDefaultItem:function(t){return this._splitTaskHelper.isDefaultSplitItem(t)},_isInlineChildItem:function(t){return this._splitTaskHelper.isInlineSplitItem(t)},parse:function(t){this._skip_refresh||this.callEvent("onBeforeParse",[t]);var n=this._parseInner(t);this._buildTree(n),this.filter(),this._skip_refresh||this.callEvent("onParse",[n])},_addItemInner:function(t,n){var e=this.getParent(t);U(e)||(e=this.$getRootId(),this.setParent(t,e));var i=this.getIndexById(e)+Math.min(Math.max(n,0),this.visibleOrder.length);1*i!==i&&(i=void 0),lt.prototype._addItemInner.call(this,t,i),this.setParent(t,e),t.hasOwnProperty("$rendered_parent")&&this._move_branch(t,t.$rendered_parent),this._add_branch(t,n)},_changeIdInner:function(t,n){var e=this.getChildren(t),i=this._searchVisibleOrder[t];lt.prototype._changeIdInner.call(this,t,n);var a=this.getParent(n);this._replace_branch_child(a,t,n),this._branches[t]&&(this._branches[n]=this._branches[t]);for(var s=0;s<e.length;s++){var r=this.getItem(e[s]);r[this.$parentProperty]=n,r.$rendered_parent=n}this._searchVisibleOrder[n]=i,delete this._branches[t]},_traverseBranches:function(t,n){U(n)||(n=this.$getRootId());var e=this._branches[n];if(e)for(var i=0;i<e.length;i++){var a=e[i];t.call(this,a),this._branches[a]&&this._traverseBranches(t,a)}},_updateOrder:function(t){this.fullOrder=it.$create(),this._traverseBranches(function(n){this.fullOrder.push(n)}),t&&lt.prototype._updateOrder.call(this,t)},_removeItemInner:function(t){var n=[];this.eachItem(function(i){n.push(i)},t),n.push(this.getItem(t));for(var e=0;e<n.length;e++)this._move_branch(n[e],this.getParent(n[e]),null),lt.prototype._removeItemInner.call(this,n[e].id),this._move_branch(n[e],this.getParent(n[e]),null)},move:function(t,n,e){var i=arguments[3],a=(this._ganttConfig||{}).root_id||0;if(i=rt(i,a)){if(i===t)return;e=this.getParent(i),n=this.getBranchIndex(i)}if(!ut(t,e)){U(e)||(e=this.$getRootId());var s=this.getItem(t),r=this.getParent(s.id),o=this.getChildren(e);if(n==-1&&(n=o.length+1),ut(r,e)&&this.getBranchIndex(t)==n)return;if(this.callEvent("onBeforeItemMove",[t,e,n])===!1)return!1;for(var l=[],d=0;d<o.length;d++)It(o[d],null,this,this._ganttConfig)&&(l.push(o[d]),o.splice(d,1),d--);this._replace_branch_child(r,t);var c=(o=this.getChildren(e))[n];(c=rt(c,a))?o=o.slice(0,n).concat([t]).concat(o.slice(n)):o.push(t),l.length&&(o=o.concat(l)),ut(s.$rendered_parent,r)||ut(r,e)||(s.$rendered_parent=r),this.setParent(s,e),this._branches[e]=o;var u=this.calculateItemLevel(s)-s.$level;s.$level+=u,this.eachItem(function(h){h.$level+=u},s.id,this),this._moveInner(this.getIndexById(t),this.getIndexById(e)+n),this.callEvent("onAfterItemMove",[t,e,n]),this.refresh()}},getBranchIndex:function(t){var n=this.getChildren(this.getParent(t));let e=n.indexOf(t+"");return e==-1&&(e=n.indexOf(+t)),e},hasChild:function(t){var n=this._branches[t];return n&&n.length},getChildren:function(t){var n=this._branches[t];return n||it.$create()},isChildOf:function(t,n){if(!this.exists(t))return!1;if(n===this.$getRootId())return!0;if(!this.hasChild(n))return!1;var e=this.getItem(t),i=this.getParent(t);if(this.getItem(n).$level>=e.$level)return!1;for(;e&&this.exists(i);){if((e=this.getItem(i))&&ut(e.id,n))return!0;i=this.getParent(e)}return!1},getSiblings:function(t){if(!this.exists(t))return it.$create();var n=this.getParent(t);return this.getChildren(n)},getNextSibling:function(t){for(var n=this.getSiblings(t),e=0,i=n.length;e<i;e++)if(ut(n[e],t)){var a=n[e+1];return a===0&&e>0&&(a="0"),a||null}return null},getPrevSibling:function(t){for(var n=this.getSiblings(t),e=0,i=n.length;e<i;e++)if(ut(n[e],t)){var a=n[e-1];return a===0&&e>0&&(a="0"),a||null}return null},getParent:function(t){var n=null;return(n=t.id!==void 0?t:this.getItem(t))?n[this.$parentProperty]:this.$getRootId()},clearAll:function(){this._branches={},lt.prototype.clearAll.call(this)},calculateItemLevel:function(t){var n=0;return this.eachParent(function(){n++},t),n},_setParentInner:function(t,n,e){e||(t.hasOwnProperty("$rendered_parent")?this._move_branch(t,t.$rendered_parent,n):this._move_branch(t,t[this.$parentProperty],n))},setParent:function(t,n,e){this._setParentInner(t,n,e),t[this.$parentProperty]=n},_eachItemCached:function(t,n){for(var e=0,i=n.length;e<i;e++)t.call(this,n[e])},_eachItemIterate:function(t,n,e){var i=this.getChildren(n);for(i.length&&(i=i.slice().reverse());i.length;){var a=i.pop(),s=this.getItem(a);if(t.call(this,s),e&&e.push(s),this.hasChild(s.id))for(var r=this.getChildren(s.id),o=r.length-1;o>=0;o--)i.push(r[o])}},eachItem:function(t,n){var e=this.$getRootId();U(n)||(n=e);var i=rt(n,e)||e,a=!1,s=!1,r=null;i===e&&(this._eachItemMainRangeCache?(a=!0,r=this._eachItemMainRangeCache):(s=!0,r=this._eachItemMainRangeCache=[])),a?this._eachItemCached(t,r):this._eachItemIterate(t,i,s?r:null)},eachParent:function(t,n){for(var e={},i=n,a=this.getParent(i);this.exists(a);){if(e[a])throw new Error("Invalid tasks tree. Cyclic reference has been detected on task "+a);e[a]=!0,i=this.getItem(a),t.call(this,i),a=this.getParent(i)}},_add_branch:function(t,n,e){var i=e===void 0?this.getParent(t):e;this.hasChild(i)||(this._branches[i]=it.$create());var a=this.getChildren(i);a.indexOf(t.id+"")>-1||a.indexOf(+t.id)>-1||(1*n==n?a.splice(n,0,t.id):a.push(t.id),t.$rendered_parent=i)},_move_branch:function(t,n,e){this._eachItemMainRangeCache=null,this._replace_branch_child(n,t.id),this.exists(e)||ut(e,this.$getRootId())?this._add_branch(t,void 0,e):delete this._branches[t.id],t.$level=this.calculateItemLevel(t),this.eachItem(function(i){i.$level=this.calculateItemLevel(i)},t.id)},_replace_branch_child:function(t,n,e){var i=this.getChildren(t);if(i&&t!==void 0){var a=it.$create();let s=i.indexOf(n+"");s!=-1||isNaN(+n)||(s=i.indexOf(+n)),s>-1&&(e?i.splice(s,1,e):i.splice(s,1)),a=i,this._branches[t]=a}},sort:function(t,n,e){this.exists(e)||(e=this.$getRootId()),t||(t="order");var i=typeof t=="string"?function(l,d){return l[t]==d[t]||tt(l[t])&&tt(d[t])&&l[t].valueOf()==d[t].valueOf()?0:l[t]>d[t]?1:-1}:t;if(n){var a=i;i=function(l,d){return a(d,l)}}var s=this.getChildren(e);if(s){for(var r=[],o=s.length-1;o>=0;o--)r[o]=this.getItem(s[o]);for(r.sort(i),o=0;o<r.length;o++)s[o]=r[o].id,this.sort(t,n,s[o])}},filter:function(t){for(let n in this.pull){const e=this.pull[n].$rendered_parent,i=this.getParent(this.pull[n]);ut(e,i)||this._move_branch(this.pull[n],e,i)}return lt.prototype.filter.apply(this,arguments)},open:function(t){this.exists(t)&&(this.getItem(t).$open=!0,this._skipTaskRecalculation=!0,this.callEvent("onItemOpen",[t]))},close:function(t){this.exists(t)&&(this.getItem(t).$open=!1,this._skipTaskRecalculation=!0,this.callEvent("onItemClose",[t]))},destructor:function(){lt.prototype.destructor.call(this),this._branches=null,this._indexRangeCache={},this._eachItemMainRangeCache=null}},lt.prototype);const ti=function(t,n){const e=n.getDatastore(t),i=function(o,l){const d=l.getLayers(),c=e.getItem(o);if(c&&e.isVisible(o))for(let u=0;u<d.length;u++)d[u].render_item(c)},a=function(o){const l=o.getLayers();for(let _=0;_<l.length;_++)l[_].clear();let d=null;const c={};for(let _=0;_<l.length;_++){const f=l[_];let y;if(f.get_visible_range){var u=f.get_visible_range(e);if(u.start!==void 0&&u.end!==void 0){var h=u.start+" - "+u.end;c[h]?y=c[h]:(y=e.getIndexRange(u.start,u.end),c[h]=y)}else{if(u.ids===void 0)throw new Error("Invalid range returned from 'getVisibleRange' of the layer");y=u.ids.map(function(v){return e.getItem(v)})}}else d||(d=e.getVisibleItems()),y=d;f.prepare_data&&f.prepare_data(y),l[_].render_items(y)}},s=function(o){if(o.update_items){let d=[];if(o.get_visible_range){var l=o.get_visible_range(e);if(l.start!==void 0&&l.end!==void 0&&(d=e.getIndexRange(l.start,l.end)),l.ids!==void 0){let c=l.ids.map(function(u){return e.getItem(u)});c.length>0&&(c=c.filter(u=>u!==void 0),d=d.concat(c))}if((l.start==null||l.end==null)&&l.ids==null)throw new Error("Invalid range returned from 'getVisibleRange' of the layer")}else d=e.getVisibleItems();o.prepare_data&&o.prepare_data(d,o),o.update_items(d)}};function r(o){return!!o.$services.getService("state").getState("batchUpdate").batch_update}e.attachEvent("onStoreUpdated",function(o,l,d){if(Y(n))return!0;const c=n.$services.getService("layers").getDataRender(t);c&&(c.onUpdateRequest=function(u){s(u)})}),e.attachEvent("onStoreUpdated",function(o,l,d){r(n)||(o&&d!="move"&&d!="delete"?(e.callEvent("onBeforeRefreshItem",[l.id]),e.callEvent("onAfterRefreshItem",[l.id])):(e.callEvent("onBeforeRefreshAll",[]),e.callEvent("onAfterRefreshAll",[])))}),e.attachEvent("onAfterRefreshAll",function(){if(Y(n))return!0;const o=n.$services.getService("layers").getDataRender(t);o&&!r(n)&&a(o)}),e.attachEvent("onAfterRefreshItem",function(o){if(Y(n))return!0;const l=n.$services.getService("layers").getDataRender(t);l&&i(o,l)}),e.attachEvent("onItemOpen",function(){if(Y(n)||e.isSilent())return!0;n.render()}),e.attachEvent("onItemClose",function(){if(Y(n)||e.isSilent())return!0;n.render()}),e.attachEvent("onIdChange",function(o,l){if(Y(n))return!0;if(e.callEvent("onBeforeIdChange",[o,l]),!r(n)&&!e.isSilent()){const d=n.$services.getService("layers").getDataRender(t);d?(function(c,u,h){for(let _=0;_<c.length;_++)c[_].change_id(u,h)}(d.getLayers(),o,l,e.getItem(l)),i(l,d)):n.render()}})};function _e(){for(var t=this.$services.getService("datastores"),n=[],e=0;e<t.length;e++){var i=this.getDatastore(t[e]);i.$destroyed||n.push(i)}return n}const ei={create:function(){var t=R({},{createDatastore:function(n){var e=(n.type||"").toLowerCase()=="treedatastore"?Ze:lt;if(n){var i=this;n.openInitially=function(){return i.config.open_tree_initially},n.copyOnParse=function(){return i.config.deepcopy_on_parse}}var a=new e(n);if(this.mixin(a,function(o){var l=null,d=o._removeItemInner;function c(u){l=null,this.callEvent("onAfterUnselect",[u])}return o._removeItemInner=function(u){return l==u&&c.call(this,u),l&&this.eachItem&&this.eachItem(function(h){h.id==l&&c.call(this,h.id)},u),d.apply(this,arguments)},o.attachEvent("onIdChange",function(u,h){o.getSelectedId()==u&&o.silent(function(){o.unselect(u),o.select(h)})}),{select:function(u){if(u){if(l==u)return l;if(!this._skip_refresh&&!this.callEvent("onBeforeSelect",[u]))return!1;this.unselect(),l=u,this._skip_refresh||(this.refresh(u),this.callEvent("onAfterSelect",[u]))}return l},getSelectedId:function(){return l},isSelected:function(u){return u==l},unselect:function(u){(u=u||l)&&(l=null,this._skip_refresh||(this.refresh(u),c.call(this,u)))}}}(a)),n.name){var s="datastore:"+n.name;a.attachEvent("onDestroy",(function(){this.$services.dropService(s);for(var o=this.$services.getService("datastores"),l=0;l<o.length;l++)if(o[l]===n.name){o.splice(l,1);break}}).bind(this)),this.$services.dropService(s),this.$services.setService(s,function(){return a});var r=this.$services.getService("datastores");r?r.indexOf(n.name)<0&&r.push(n.name):(r=[],this.$services.setService("datastores",function(){return r}),r.push(n.name)),ti(n.name,this)}return a},getDatastore:function(n){return this.$services.getService("datastore:"+n)},_getDatastores:_e,refreshData:function(){var n;Y(this)||(n=this.getScrollState()),this.callEvent("onBeforeDataRender",[]);for(var e=_e.call(this),i=0;i<e.length;i++)e[i].refresh();this.config.preserve_scroll&&!Y(this)&&((n.x||n.y)&&this.scrollTo(n.x,n.y),this.$layout.getScrollbarsInfo().forEach(a=>{const s=this.$ui.getView(a.id);if(!s)return;const r=this.utils.dom.isChildOf(s.$view,this.$container);a.boundViews.forEach(o=>{const l=this.$ui.getView(o);a.y&&l&&!r&&l.scrollTo(void 0,0)})})),this.callEvent("onDataRender",[])},isChildOf:function(n,e){return this.$data.tasksStore.isChildOf(n,e)},refreshTask:function(n,e){var i=this.getTask(n),a=this;function s(){if(e===void 0||e){for(var o=0;o<i.$source.length;o++)a.refreshLink(i.$source[o]);for(o=0;o<i.$target.length;o++)a.refreshLink(i.$target[o])}}if(i&&this.isTaskVisible(n))this.$data.tasksStore.refresh(n,!!this.getState("tasksDnd").drag_id||e===!1),s();else if(this.isTaskExists(n)&&this.isTaskExists(this.getParent(n))&&!this._bulk_dnd){this.refreshTask(this.getParent(n));var r=!1;this.eachParent(function(o){(r||this.isSplitTask(o))&&(r=!0)},n),r&&s()}},refreshLink:function(n){this.$data.linksStore.refresh(n,!!this.getState("tasksDnd").drag_id)},silent:function(n){var e=this;e.$data.tasksStore.silent(function(){e.$data.linksStore.silent(function(){n()})})},clearAll:function(){for(var n=_e.call(this),e=0;e<n.length;e++)n[e].silent(function(){n[e].clearAll()});for(e=0;e<n.length;e++)n[e].clearAll();this._update_flags(),this.userdata={},this.callEvent("onClear",[]),this.render()},_clear_data:function(){this.$data.tasksStore.clearAll(),this.$data.linksStore.clearAll(),this._update_flags(),this.userdata={}},selectTask:function(n){var e=this.$data.tasksStore;if(!this.config.select_task)return!1;if(n=rt(n,this.config.root_id)){let i=this.getSelectedId();e._skipResourceRepaint=!0,e.select(n),e._skipResourceRepaint=!1,i&&e.pull[i].$split_subtask&&i!=n&&this.refreshTask(i),e.pull[n].$split_subtask&&i!=n&&this.refreshTask(n)}return e.getSelectedId()},unselectTask:function(n){var e=this.$data.tasksStore;e.unselect(n),n&&e.pull[n].$split_subtask&&this.refreshTask(n)},isSelectedTask:function(n){return this.$data.tasksStore.isSelected(n)},getSelectedId:function(){return this.$data.tasksStore.getSelectedId()}});return R(t,{getTask:function(n){n=rt(n,this.config.root_id),this.assert(n,"Invalid argument for gantt.getTask");var e=this.$data.tasksStore.getItem(n);return this.assert(e,"Task not found id="+n),e},getTaskByTime:function(n,e){var i=this.$data.tasksStore.getItems(),a=[];if(n||e){n=+n||-1/0,e=+e||1/0;for(var s=0;s<i.length;s++){var r=i[s];+r.start_date<e&&+r.end_date>n&&a.push(r)}}else a=i;return a},isTaskExists:function(n){return!(!this.$data||!this.$data.tasksStore)&&this.$data.tasksStore.exists(n)},updateTask:function(n,e){U(e)||(e=this.getTask(n)),this.$data.tasksStore.updateItem(n,e),this.isTaskExists(n)&&this.refreshTask(n)},addTask:function(n,e,i){if(U(n.id)||(n.id=ot()),this.isTaskExists(n.id)&&this.getTask(n.id).$index!=n.$index)return n.start_date&&typeof n.start_date=="string"&&(n.start_date=this.date.parseDate(n.start_date,"parse_date")),n.end_date&&typeof n.end_date=="string"&&(n.end_date=this.date.parseDate(n.end_date,"parse_date")),this.$data.tasksStore.updateItem(n.id,n);if(U(e)||(e=this.getParent(n)||0),this.isTaskExists(e)||(e=this.config.root_id),this.setParent(n,e),this.getState().lightbox&&this.isTaskExists(e)){var a=this.getTask(e);this.callEvent("onAfterParentExpand",[e,a])}return this.$data.tasksStore.addItem(n,i,e)},deleteTask:function(n){return n=rt(n,this.config.root_id),this.$data.tasksStore.removeItem(n)},getTaskCount:function(){return this.$data.tasksStore.count()},getVisibleTaskCount:function(){return this.$data.tasksStore.countVisible()},getTaskIndex:function(n){return this.$data.tasksStore.getBranchIndex(n)},getGlobalTaskIndex:function(n){return n=rt(n,this.config.root_id),this.assert(n,"Invalid argument"),this.$data.tasksStore.getIndexById(n)},eachTask:function(n,e,i){return this.$data.tasksStore.eachItem(O(n,i||this),e)},eachParent:function(n,e,i){return this.$data.tasksStore.eachParent(O(n,i||this),e)},changeTaskId:function(n,e){this.$data.tasksStore.changeId(n,e);var i=this.$data.tasksStore.getItem(e),a=[];i.$source&&(a=a.concat(i.$source)),i.$target&&(a=a.concat(i.$target));for(var s=0;s<a.length;s++){var r=this.getLink(a[s]);r.source==n&&(r.source=e),r.target==n&&(r.target=e)}},calculateTaskLevel:function(n){return this.$data.tasksStore.calculateItemLevel(n)},getNext:function(n){return this.$data.tasksStore.getNext(n)},getPrev:function(n){return this.$data.tasksStore.getPrev(n)},getParent:function(n){return this.$data.tasksStore.getParent(n)},setParent:function(n,e,i){return this.$data.tasksStore.setParent(n,e,i)},getSiblings:function(n){return this.$data.tasksStore.getSiblings(n).slice()},getNextSibling:function(n){return this.$data.tasksStore.getNextSibling(n)},getPrevSibling:function(n){return this.$data.tasksStore.getPrevSibling(n)},getTaskByIndex:function(n){var e=this.$data.tasksStore.getIdByIndex(n);return this.isTaskExists(e)?this.getTask(e):null},getChildren:function(n){return this.hasChild(n)?this.$data.tasksStore.getChildren(n).slice():[]},hasChild:function(n){return this.$data.tasksStore.hasChild(n)},open:function(n){this.$data.tasksStore.open(n)},close:function(n){this.$data.tasksStore.close(n)},moveTask:function(n,e,i){return i=rt(i,this.config.root_id),this.$data.tasksStore.move.apply(this.$data.tasksStore,arguments)},sort:function(n,e,i,a){var s=!a;this.$data.tasksStore.sort(n,e,i),this.callEvent("onAfterSort",[n,e,i]),s&&this.render()}}),R(t,{getLinkCount:function(){return this.$data.linksStore.count()},getLink:function(n){return this.$data.linksStore.getItem(n)},getLinks:function(){return this.$data.linksStore.getItems()},isLinkExists:function(n){return this.$data.linksStore.exists(n)},addLink:function(n){return this.$data.linksStore.addItem(n)},updateLink:function(n,e){U(e)||(e=this.getLink(n)),this.$data.linksStore.updateItem(n,e)},deleteLink:function(n){return this.$data.linksStore.removeItem(n)},changeLinkId:function(n,e){return this.$data.linksStore.changeId(n,e)}}),t}};function ni(t){var n=function(c){const u=new qt(c).primaryScale();let h=u.unit,_=u.step;if(c.config.scale_offset_minimal){const f=new qt(c),y=[f.primaryScale()].concat(f.getAdditionalScales());f.sortScales(y),h=y[y.length-1].unit,_=y[y.length-1].step||1}return{unit:h,step:_}}(t),e=n.unit,i=n.step,a=function(c,u){var h={start_date:null,end_date:null};if(u.config.start_date&&u.config.end_date){h.start_date=u.date[c+"_start"](new Date(u.config.start_date));var _=new Date(u.config.end_date),f=u.date[c+"_start"](new Date(_));_=+_!=+f?u.date.add(f,1,c):f,h.end_date=_}return h}(e,t);if(!a.start_date||!a.end_date){for(var s=!0,r=t.getTaskByTime(),o=0;o<r.length;o++)if(r[o].type!==t.config.types.project){s=!1;break}if(r.length&&s){var l=r[0].start_date,d=t.date.add(l,1,t.config.duration_unit);a={start_date:new Date(l),end_date:new Date(d)}}else a=t.getSubtaskDates();a.start_date&&a.end_date||(a={start_date:new Date,end_date:new Date}),t.eachTask(function(c){t.config.deadlines&&c.deadline&&ge(a,c.deadline,c.deadline),c.constraint_date&&c.constraint_type&&t._getAutoSchedulingConfig().apply_constraints&&t.config.constraint_types&&c.constraint_type!==t.config.constraint_types.ASAP&&c.constraint_type!==t.config.constraint_types.ALAP&&ge(a,c.constraint_date,c.constraint_date),t.config.baselines&&c.baselines&&c.baselines.forEach(function(u){ge(a,u.start_date,u.end_date)})}),a.start_date=t.date[e+"_start"](a.start_date),a.start_date=t.calculateEndDate({start_date:t.date[e+"_start"](a.start_date),duration:-1,unit:e,step:i}),a.end_date=t.date[e+"_start"](a.end_date),a.end_date=t.calculateEndDate({start_date:a.end_date,duration:2,unit:e,step:i})}t._min_date=a.start_date,t._max_date=a.end_date}function ge(t,n,e){n<t.start_date&&(t.start_date=new Date(n)),e>t.end_date&&(t.end_date=new Date(e))}function fe(t){ni(t),function(n){if(n.config.fit_tasks){var e=+n._min_date,i=+n._max_date;if(+n._min_date!=e||+n._max_date!=i)return n.render(),n.callEvent("onScaleAdjusted",[]),!0}}(t)}function Qe(t,n,e){for(var i=0;i<n.length;i++)t.isLinkExists(n[i])&&(e[n[i]]=t.getLink(n[i]))}function tn(t,n,e){Qe(t,n.$source,e),Qe(t,n.$target,e)}const pe={getSubtreeLinks:function(t,n){var e={};return t.isTaskExists(n)&&tn(t,t.getTask(n),e),t.eachTask(function(i){tn(t,i,e)},n),e},getSubtreeTasks:function(t,n){var e={};return t.eachTask(function(i){e[i.id]=i},n),e}};class ii{constructor(n,e){this.$gantt=n,this.$dp=e,this._dataProcessorHandlers=[]}attach(){const n=this.$dp,e=this.$gantt,i={},a=o=>this.clientSideDelete(o,n,e);this._dataProcessorHandlers.push(e.attachEvent("onAfterTaskAdd",function(o,l){e.isTaskExists(o)&&(n.setGanttMode("tasks"),n.setUpdated(o,!0,"inserted"))})),this._dataProcessorHandlers.push(e.attachEvent("onAfterTaskUpdate",function(o,l){e.isTaskExists(o)&&(n.setGanttMode("tasks"),n.setUpdated(o,!0),e._sendTaskOrder&&e._sendTaskOrder(o,l))})),this._dataProcessorHandlers.push(e.attachEvent("onBeforeTaskDelete",function(o,l){return e.config.cascade_delete&&(i[o]={tasks:pe.getSubtreeTasks(e,o),links:pe.getSubtreeLinks(e,o)}),!n.deleteAfterConfirmation||(n.setGanttMode("tasks"),n.setUpdated(o,!0,"deleted"),!1)})),this._dataProcessorHandlers.push(e.attachEvent("onAfterTaskDelete",function(o,l){n.setGanttMode("tasks");const d=!a(o),c=e.config.cascade_delete&&i[o];if(d||c){if(c){const u=n.updateMode;n.setUpdateMode("off");const h=i[o];for(const _ in h.tasks)a(_)||(n.storeItem(h.tasks[_]),n.setUpdated(_,!0,"deleted"));n.setGanttMode("links");for(const _ in h.links)a(_)||(n.storeItem(h.links[_]),n.setUpdated(_,!0,"deleted"));i[o]=null,u!=="off"&&n.sendAllData(),n.setGanttMode("tasks"),n.setUpdateMode(u)}d&&(n.storeItem(l),n.deleteAfterConfirmation||n.setUpdated(o,!0,"deleted")),n.updateMode==="off"||n._tSend||n.sendAllData()}})),this._dataProcessorHandlers.push(e.attachEvent("onAfterLinkUpdate",function(o,l){e.isLinkExists(o)&&(n.setGanttMode("links"),n.setUpdated(o,!0))})),this._dataProcessorHandlers.push(e.attachEvent("onAfterLinkAdd",function(o,l){e.isLinkExists(o)&&(n.setGanttMode("links"),n.setUpdated(o,!0,"inserted"))})),this._dataProcessorHandlers.push(e.attachEvent("onAfterLinkDelete",function(o,l){n.setGanttMode("links"),!a(o)&&(n.storeItem(l),n.setUpdated(o,!0,"deleted"))})),this._dataProcessorHandlers.push(e.attachEvent("onRowDragEnd",function(o,l){e._sendTaskOrder(o,e.getTask(o))}));let s=null,r=null;this._dataProcessorHandlers.push(e.attachEvent("onTaskIdChange",function(o,l){if(!n._waitMode)return;const d=e.getChildren(l);if(d.length){s=s||{};for(let u=0;u<d.length;u++){const h=this.getTask(d[u]);s[h.id]=h}}const c=function(u){let h=[];return u.$source&&(h=h.concat(u.$source)),u.$target&&(h=h.concat(u.$target)),h}(this.getTask(l));if(c.length){r=r||{};for(let u=0;u<c.length;u++){const h=this.getLink(c[u]);r[h.id]=h}}})),n.attachEvent("onAfterUpdateFinish",function(){(s||r)&&(e.batchUpdate(function(){for(const o in s)e.updateTask(s[o].id);for(const o in r)e.updateLink(r[o].id);s=null,r=null}),s?e._dp.setGanttMode("tasks"):e._dp.setGanttMode("links"))}),n.attachEvent("onBeforeDataSending",function(){if(this._tMode==="CUSTOM")return!0;let o=this._serverProcessor;if(this._tMode==="REST-JSON"||this._tMode==="REST"){const l=this._ganttMode;o=o.substring(0,o.indexOf("?")>-1?o.indexOf("?"):o.length),this.serverProcessor=o+(o.slice(-1)==="/"?"":"/")+l}else{const l=this._ganttMode+"s";this.serverProcessor=o+e.ajax.urlSeparator(o)+"gantt_mode="+l}return!0}),n.attachEvent("insertCallback",function(o,l,d,c){const u=o.data||e.xml._xmlNodeToJSON(o.firstChild),h={add:e.addTask,isExist:e.isTaskExists};c==="links"&&(h.add=e.addLink,h.isExist=e.isLinkExists),h.isExist.call(e,l)||(u.id=l,h.add.call(e,u))}),n.attachEvent("updateCallback",function(o,l){const d=o.data||e.xml._xmlNodeToJSON(o.firstChild);if(!e.isTaskExists(l))return;const c=e.getTask(l);for(const u in d){let h=d[u];switch(u){case"id":continue;case"start_date":case"end_date":h=e.defined(e.templates.xml_date)?e.templates.xml_date(h):e.templates.parse_date(h);break;case"duration":c.end_date=e.calculateEndDate({start_date:c.start_date,duration:h,task:c})}c[u]=h}e.updateTask(l),e.refreshData()}),n.attachEvent("deleteCallback",function(o,l,d,c){const u={delete:e.deleteTask,isExist:e.isTaskExists};c==="links"?(u.delete=e.deleteLink,u.isExist=e.isLinkExists):c==="assignment"&&(u.delete=function(h){e.$data.assignmentsStore.remove(h)},u.isExist=function(h){return e.$data.assignmentsStore.exists(h)}),u.isExist.call(e,l)&&u.delete.call(e,l)}),this.handleResourceCRUD(n,e),this.handleResourceAssignmentCRUD(n,e),this.handleBaselineCRUD(n,e)}clientSideDelete(n,e,i){const a=e.updatedRows.slice();let s=!1;i.getUserData(n,"!nativeeditor_status",e._ganttMode)==="true_deleted"&&(s=!0,e.setUpdated(n,!1));for(let r=0;r<a.length&&!e._in_progress[n];r++)a[r]===n&&(i.getUserData(n,"!nativeeditor_status",e._ganttMode)==="inserted"&&(s=!0),e.setUpdated(n,!1));return s}handleResourceAssignmentCRUD(n,e){if(!e.config.resources||e.config.resources.dataprocessor_assignments!==!0)return;const i=e.getDatastore(e.config.resource_assignment_store),a={},s={};function r(o){const l=o.id;i.exists(l)&&(n.setGanttMode("assignment"),n.setUpdated(l,!0,"inserted")),delete s[l]}e.attachEvent("onBeforeTaskAdd",function(o,l){return a[o]=!0,!0}),e.attachEvent("onTaskIdChange",function(o,l){delete a[o]}),i.attachEvent("onAfterAdd",(o,l)=>{a[l.task_id]?function(d){s[d.id]=d,a[d.task_id]=!0}(l):r(l)}),i.attachEvent("onAfterUpdate",(o,l)=>{i.exists(o)&&(s[o]?r(l):(n.setGanttMode("assignment"),n.setUpdated(o,!0)))}),i.attachEvent("onAfterDelete",(o,l)=>{n.setGanttMode("assignment"),!this.clientSideDelete(o,n,e)&&(n.storeItem(l),n.setUpdated(o,!0,"deleted"))})}handleResourceCRUD(n,e){if(!e.config.resources||e.config.resources.dataprocessor_resources!==!0)return;const i=e.getDatastore(e.config.resource_store);i.attachEvent("onAfterAdd",(a,s)=>{(function(r){const o=r.id;i.exists(o)&&(n.setGanttMode("resource"),n.setUpdated(o,!0,"inserted"))})(s)}),i.attachEvent("onAfterUpdate",(a,s)=>{i.exists(a)&&(n.setGanttMode("resource"),n.setUpdated(a,!0))}),i.attachEvent("onAfterDelete",(a,s)=>{n.setGanttMode("resource"),!this.clientSideDelete(a,n,e)&&(n.storeItem(s),n.setUpdated(a,!0,"deleted"))})}handleBaselineCRUD(n,e){if(!e.config.baselines||e.config.baselines.dataprocessor_baselines!==!0)return;const i=e.getDatastore(e.config.baselines.datastore);i.attachEvent("onAfterAdd",(a,s)=>{(function(r){const o=r.id;i.exists(o)&&(n.setGanttMode("baseline"),n.setUpdated(o,!0,"inserted"))})(s)}),i.attachEvent("onAfterUpdate",(a,s)=>{i.exists(a)&&(n.setGanttMode("baseline"),n.setUpdated(a,!0))}),i.attachEvent("onAfterDelete",(a,s)=>{n.setGanttMode("baseline"),!this.clientSideDelete(a,n,e)&&(n.storeItem(s),n.setUpdated(a,!0,"deleted"))})}detach(){xt(this._dataProcessorHandlers,n=>{this.$gantt.detachEvent(n)}),this._dataProcessorHandlers=[]}}const ne=class ne{constructor(){this.clear=()=>{this._storage={}},this.storeItem=n=>{this._storage[n.id]=K(n)},this.getStoredItem=n=>this._storage[n]||null,this._storage={}}};ne.create=()=>new ne;let Yt=ne,en=class{constructor(t){this.serverProcessor=t,this.action_param="!nativeeditor_status",this.updatedRows=[],this.autoUpdate=!0,this.updateMode="cell",this._headers=null,this._payload=null,this._postDelim="_",this._routerParametersFormat="parameters",this._waitMode=0,this._in_progress={},this._storage=Yt.create(),this._invalid={},this.messages=[],this.styles={updated:"font-weight:bold;",inserted:"font-weight:bold;",deleted:"text-decoration : line-through;",invalid:"background-color:FFE0E0;",invalid_cell:"border-bottom:2px solid red;",error:"color:red;",clear:"font-weight:normal;text-decoration:none;"},this.enableUTFencoding(!0),st(this)}setTransactionMode(t,n){typeof t=="object"?(this._tMode=t.mode||this._tMode,U(t.headers)&&(this._headers=t.headers),U(t.payload)&&(this._payload=t.payload),this._tSend=!!n):(this._tMode=t,this._tSend=n),this._tMode==="REST"&&(this._tSend=!1),this._tMode==="JSON"||this._tMode==="REST-JSON"?(this._tSend=!1,this._serializeAsJson=!0,this._headers=this._headers||{},this._headers["Content-Type"]="application/json"):this._headers&&!this._headers["Content-Type"]&&(this._headers["Content-Type"]="application/x-www-form-urlencoded"),this._tMode==="CUSTOM"&&(this._tSend=!1,this._router=t.router)}escape(t){return this._utf?encodeURIComponent(t):escape(t)}enableUTFencoding(t){this._utf=!!t}getSyncState(){return!this.updatedRows.length}setUpdateMode(t,n){this.autoUpdate=t==="cell",this.updateMode=t,this.dnd=n}ignore(t,n){this._silent_mode=!0,t.call(n||Q),this._silent_mode=!1}setUpdated(t,n,e){if(this._silent_mode)return;const i=this.findRow(t);e=e||"updated";const a=this.$gantt.getUserData(t,this.action_param,this._ganttMode);a&&e==="updated"&&(e=a),n?(this.set_invalid(t,!1),this.updatedRows[i]=t,this.$gantt.setUserData(t,this.action_param,e,this._ganttMode),this._in_progress[t]&&(this._in_progress[t]="wait")):this.is_invalid(t)||(this.updatedRows.splice(i,1),this.$gantt.setUserData(t,this.action_param,"",this._ganttMode)),this.markRow(t,n,e),n&&this.autoUpdate&&this.sendData(t)}markRow(t,n,e){let i="";const a=this.is_invalid(t);if(a&&(i=this.styles[a],n=!0),this.callEvent("onRowMark",[t,n,e,a])&&(i=this.styles[n?e:"clear"]+" "+i,this.$gantt[this._methods[0]](t,i),a&&a.details)){i+=this.styles[a+"_cell"];for(let s=0;s<a.details.length;s++)a.details[s]&&this.$gantt[this._methods[1]](t,s,i)}}getActionByState(t){return t==="inserted"?"create":t==="updated"?"update":t==="deleted"?"delete":"update"}getState(t){return this.$gantt.getUserData(t,this.action_param,this._ganttMode)}is_invalid(t){return this._invalid[t]}set_invalid(t,n,e){e&&(n={value:n,details:e,toString:function(){return this.value.toString()}}),this._invalid[t]=n}checkBeforeUpdate(t){return!0}sendData(t){if(this.$gantt.editStop&&this.$gantt.editStop(),t===void 0||this._tSend){const n=[];if(this.modes&&["task","link","assignment","baseline"].forEach(e=>{this.modes[e]&&this.modes[e].updatedRows.length&&n.push(e)}),n.length){for(let e=0;e<n.length;e++)this.setGanttMode(n[e]),this.sendAllData();return}return this.sendAllData()}return!this._in_progress[t]&&(this.messages=[],!(!this.checkBeforeUpdate(t)&&this.callEvent("onValidationError",[t,this.messages]))&&void this._beforeSendData(this._getRowData(t),t))}serialize(t,n){if(this._serializeAsJson)return this._serializeAsJSON(t);if(typeof t=="string")return t;if(n!==void 0)return this.serialize_one(t,"");{const e=[],i=[];for(const a in t)t.hasOwnProperty(a)&&(e.push(this.serialize_one(t[a],a+this._postDelim)),i.push(a));return e.push("ids="+this.escape(i.join(","))),this.$gantt.security_key&&e.push("dhx_security="+this.$gantt.security_key),e.join("&")}}serialize_one(t,n){if(typeof t=="string")return t;const e=[];let i="";for(const a in t)if(t.hasOwnProperty(a)){if((a==="id"||a==this.action_param)&&this._tMode==="REST")continue;i=typeof t[a]=="string"||typeof t[a]=="number"?String(t[a]):JSON.stringify(t[a]),e.push(this.escape((n||"")+a)+"="+this.escape(i))}return e.join("&")}sendAllData(){if(!this.updatedRows.length)return;this.messages=[];let t=!0;if(this._forEachUpdatedRow(function(n){t=t&&this.checkBeforeUpdate(n)}),!t&&!this.callEvent("onValidationError",["",this.messages]))return!1;this._tSend?this._sendData(this._getAllData()):this._forEachUpdatedRow(function(n){if(!this._in_progress[n]){if(this.is_invalid(n))return;this._beforeSendData(this._getRowData(n),n)}})}findRow(t){let n=0;for(n=0;n<this.updatedRows.length&&t!=this.updatedRows[n];n++);return n}defineAction(t,n){this._uActions||(this._uActions={}),this._uActions[t]=n}afterUpdateCallback(t,n,e,i,a){if(!this.$gantt)return;this.setGanttMode(a);const s=t,r=e!=="error"&&e!=="invalid";if(r||this.set_invalid(t,e),this._uActions&&this._uActions[e]&&!this._uActions[e](i))return delete this._in_progress[s];this._in_progress[s]!=="wait"&&this.setUpdated(t,!1);const o=t;switch(e){case"inserted":case"insert":n!=t&&(this.setUpdated(t,!1),this.$gantt[this._methods[2]](t,n),t=n);break;case"delete":case"deleted":if(this.deleteAfterConfirmation&&this._ganttMode==="task"){if(this._ganttMode==="task"&&this.$gantt.isTaskExists(t)){this.$gantt.setUserData(t,this.action_param,"true_deleted",this._ganttMode);const l=this.$gantt.getTask(t);this.$gantt.silent(()=>{this.$gantt.deleteTask(t)}),this.$gantt.callEvent("onAfterTaskDelete",[t,l]),this.$gantt.render(),delete this._in_progress[s]}return this.callEvent("onAfterUpdate",[t,e,n,i])}return this.$gantt.setUserData(t,this.action_param,"true_deleted",this._ganttMode),this.$gantt[this._methods[3]](t),delete this._in_progress[s],this.callEvent("onAfterUpdate",[t,e,n,i])}this._in_progress[s]!=="wait"?(r&&this.$gantt.setUserData(t,this.action_param,"",this._ganttMode),delete this._in_progress[s]):(delete this._in_progress[s],this.setUpdated(n,!0,this.$gantt.getUserData(t,this.action_param,this._ganttMode))),this.callEvent("onAfterUpdate",[o,e,n,i])}afterUpdate(t,n,e){let i;i=arguments.length===3?arguments[1]:arguments[4];let a=this.getGanttMode();const s=i.filePath||i.url;a=this._tMode!=="REST"&&this._tMode!=="REST-JSON"?s.indexOf("gantt_mode=links")!==-1?"link":s.indexOf("gantt_mode=assignments")!==-1?"assignment":s.indexOf("gantt_mode=baselines")!==-1?"baseline":"task":s.indexOf("/link")>=0?"link":s.indexOf("/assignment")>=0?"assignment":s.indexOf("/baseline")>=0?"baseline":"task",this.setGanttMode(a);const r=this.$gantt.ajax;let o;try{o=JSON.parse(n.xmlDoc.responseText)}catch{n.xmlDoc.responseText.length||(o={})}const l=u=>{const h=o.action||this.getState(u)||"updated",_=o.sid||u[0],f=o.tid||u[0];t.afterUpdateCallback(_,f,h,o,a)};if(o)return Array.isArray(e)&&e.length>1?e.forEach(u=>l(u)):l(e),t.finalizeUpdate(),void this.setGanttMode(a);const d=r.xmltop("data",n.xmlDoc);if(!d)return this.cleanUpdate(e);const c=r.xpath("//data/action",d);if(!c.length)return this.cleanUpdate(e);for(let u=0;u<c.length;u++){const h=c[u],_=h.getAttribute("type"),f=h.getAttribute("sid"),y=h.getAttribute("tid");t.afterUpdateCallback(f,y,_,h,a)}t.finalizeUpdate()}cleanUpdate(t){if(t)for(let n=0;n<t.length;n++)delete this._in_progress[t[n]]}finalizeUpdate(){this._waitMode&&this._waitMode--,this.callEvent("onAfterUpdateFinish",[]),this.updatedRows.length||this.callEvent("onFullSync",[])}init(t){if(this._initialized)return;this.$gantt=t,this.$gantt._dp_init&&this.$gantt._dp_init(this),this._setDefaultTransactionMode(),this.styles={updated:"gantt_updated",order:"gantt_updated",inserted:"gantt_inserted",deleted:"gantt_deleted",delete_confirmation:"gantt_deleted",invalid:"gantt_invalid",error:"gantt_error",clear:""},this._methods=["_row_style","setCellTextStyle","_change_id","_delete_task"],function(e,i){e.getUserData=function(a,s,r){return this.userdata||(this.userdata={}),this.userdata[r]=this.userdata[r]||{},this.userdata[r][a]&&this.userdata[r][a][s]?this.userdata[r][a][s]:""},e.setUserData=function(a,s,r,o){this.userdata||(this.userdata={}),this.userdata[o]=this.userdata[o]||{},this.userdata[o][a]=this.userdata[o][a]||{},this.userdata[o][a][s]=r},e._change_id=function(a,s){switch(this._dp._ganttMode){case"task":this.changeTaskId(a,s);break;case"link":this.changeLinkId(a,s);break;case"assignment":this.$data.assignmentsStore.changeId(a,s);break;case"resource":this.$data.resourcesStore.changeId(a,s);break;case"baseline":this.$data.baselineStore.changeId(a,s);break;default:throw new Error(`Invalid mode of the dataProcessor after database id is received: ${this._dp._ganttMode}, new id: ${s}`)}},e._row_style=function(a,s){this._dp._ganttMode==="task"&&e.isTaskExists(a)&&(e.getTask(a).$dataprocessor_class=s,e.refreshTask(a))},e._delete_task=function(a,s){},e._sendTaskOrder=function(a,s){s.$drop_target&&(this._dp.setGanttMode("task"),this.getTask(a).target=s.$drop_target,this._dp.setUpdated(a,!0,"order"),delete this.getTask(a).$drop_target)},e.setDp=function(){this._dp=i},e.setDp()}(this.$gantt,this);const n=new ii(this.$gantt,this);n.attach(),this.attachEvent("onDestroy",function(){delete this.setGanttMode,delete this._getRowData,delete this.$gantt._dp,delete this.$gantt._change_id,delete this.$gantt._row_style,delete this.$gantt._delete_task,delete this.$gantt._sendTaskOrder,delete this.$gantt,n.detach()}),this.$gantt.callEvent("onDataProcessorReady",[this]),this._initialized=!0}setOnAfterUpdate(t){this.attachEvent("onAfterUpdate",t)}setOnBeforeUpdateHandler(t){this.attachEvent("onBeforeDataSending",t)}setAutoUpdate(t,n){t=t||2e3,this._user=n||new Date().valueOf(),this._needUpdate=!1,this._updateBusy=!1,this.attachEvent("onAfterUpdate",this.afterAutoUpdate),this.attachEvent("onFullSync",this.fullSync),setInterval(()=>{this.loadUpdate()},t)}afterAutoUpdate(t,n,e,i){return n!=="collision"||(this._needUpdate=!0,!1)}fullSync(){return this._needUpdate&&(this._needUpdate=!1,this.loadUpdate()),!0}getUpdates(t,n){const e=this.$gantt.ajax;if(this._updateBusy)return!1;this._updateBusy=!0,e.get(t,n)}loadUpdate(){const t=this.$gantt.ajax,n=this.$gantt.getUserData(0,"version",this._ganttMode);let e=this.serverProcessor+t.urlSeparator(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+n].join("&");e=e.replace("editing=true&",""),this.getUpdates(e,i=>{const a=t.xpath("//userdata",i);this.$gantt.setUserData(0,"version",this._getXmlNodeValue(a[0]),this._ganttMode);const s=t.xpath("//update",i);if(s.length){this._silent_mode=!0;for(let r=0;r<s.length;r++){const o=s[r].getAttribute("status"),l=s[r].getAttribute("id"),d=s[r].getAttribute("parent");switch(o){case"inserted":this.callEvent("insertCallback",[s[r],l,d]);break;case"updated":this.callEvent("updateCallback",[s[r],l,d]);break;case"deleted":this.callEvent("deleteCallback",[s[r],l,d])}}this._silent_mode=!1}this._updateBusy=!1})}destructor(){this.callEvent("onDestroy",[]),this.detachAllEvents(),this.updatedRows=[],this._in_progress={},this._invalid={},this._storage.clear(),this._storage=null,this._headers=null,this._payload=null,delete this._initialized}setGanttMode(t){t==="tasks"?t="task":t==="links"&&(t="link");const n=this.modes||{},e=this.getGanttMode();e&&(n[e]={_in_progress:this._in_progress,_invalid:this._invalid,_storage:this._storage,updatedRows:this.updatedRows});let i=n[t];i||(i=n[t]={_in_progress:{},_invalid:{},_storage:Yt.create(),updatedRows:[]}),this._in_progress=i._in_progress,this._invalid=i._invalid,this._storage=i._storage,this.updatedRows=i.updatedRows,this.modes=n,this._ganttMode=t}getGanttMode(){return this._ganttMode}storeItem(t){this._storage.storeItem(t)}url(t){this.serverProcessor=this._serverProcessor=t}_beforeSendData(t,n){if(!this.callEvent("onBeforeUpdate",[n,this.getState(n),t]))return!1;this._sendData(t,n)}_serializeAsJSON(t){if(typeof t=="string")return t;const n=K(t);return this._tMode==="REST-JSON"&&(delete n.id,delete n[this.action_param]),JSON.stringify(n)}_applyPayload(t){const n=this.$gantt.ajax;if(this._payload)for(const e in this._payload)t=t+n.urlSeparator(t)+this.escape(e)+"="+this.escape(this._payload[e]);return t}_cleanupArgumentsBeforeSend(t){let n;if(t[this.action_param]===void 0){n={};for(const e in t)n[e]=this._cleanupArgumentsBeforeSend(t[e])}else n=this._cleanupItemBeforeSend(t);return n}_cleanupItemBeforeSend(t){let n=null;return t&&(t[this.action_param]==="deleted"?(n={},n.id=t.id,n[this.action_param]=t[this.action_param]):n=t),n}_sendData(t,n){if(!t)return;if(!this.callEvent("onBeforeDataSending",n?[n,this.getState(n),t]:[null,null,t]))return!1;n&&(this._in_progress[n]=new Date().valueOf());const e=this.$gantt.ajax;if(this._tMode==="CUSTOM"){const l=this.getState(n),d=this.getActionByState(l);delete t[this.action_param];const c=this.getGanttMode(),u=_=>{let f=l||"updated",y=n,v=n;_&&(f=_.action||l,y=_.sid||y,v=_.id||_.tid||v),this.afterUpdateCallback(y,v,f,_,c)};let h;if(this._router instanceof Function)if(this._routerParametersFormat==="object"){const _={entity:c,action:d,data:t,id:n};h=this._router(_)}else h=this._router(c,d,t,n);else if(this._router[c]instanceof Function)h=this._router[c](d,t,n);else{const _="Incorrect configuration of gantt.createDataProcessor",f=`
You need to either add missing properties to the dataProcessor router object or to use a router function.
See https://docs.dhtmlx.com/gantt/desktop__server_side.html#customrouting and https://docs.dhtmlx.com/gantt/api__gantt_createdataprocessor.html for details.`;if(!this._router[c])throw new Error(`${_}: router for the **${c}** entity is not defined. ${f}`);switch(l){case"inserted":if(!this._router[c].create)throw new Error(`${_}: **create** action for the **${c}** entity is not defined. ${f}`);h=this._router[c].create(t);break;case"deleted":if(!this._router[c].delete)throw new Error(`${_}: **delete** action for the **${c}** entity is not defined. ${f}`);h=this._router[c].delete(n);break;default:if(!this._router[c].update)throw new Error(`${_}: **update**" action for the **${c}** entity is not defined. ${f}`);h=this._router[c].update(t,n)}}if(h){if(!h.then&&h.id===void 0&&h.tid===void 0&&h.action===void 0)throw new Error("Incorrect router return value. A Promise or a response object is expected");h.then?h.then(u).catch(_=>{_&&_.action?u(_):u({action:"error",value:_})}):u(h)}else u(null);return}let i;i={callback:l=>{const d=[];if(n)d.push(n);else if(t)for(const c in t)d.push(c);return this.afterUpdate(this,l,d)},headers:this._headers};const a="dhx_version="+this.$gantt.getUserData(0,"version",this._ganttMode),s=this.serverProcessor+(this._user?e.urlSeparator(this.serverProcessor)+["dhx_user="+this._user,a].join("&"):"");let r,o=this._applyPayload(s);switch(this._tMode){case"GET":r=this._cleanupArgumentsBeforeSend(t),i.url=o+e.urlSeparator(o)+this.serialize(r,n),i.method="GET";break;case"POST":r=this._cleanupArgumentsBeforeSend(t),i.url=o,i.method="POST",i.data=this.serialize(r,n);break;case"JSON":r={};const l=this._cleanupItemBeforeSend(t);for(const d in l)d!==this.action_param&&d!=="id"&&d!=="gr_id"&&(r[d]=l[d]);i.url=o,i.method="POST",i.data=JSON.stringify({id:n,action:t[this.action_param],data:r});break;case"REST":case"REST-JSON":switch(o=s.replace(/(&|\?)editing=true/,""),r="",this.getState(n)){case"inserted":i.method="POST",i.data=this.serialize(t,n);break;case"deleted":i.method="DELETE",o=o+(o.slice(-1)==="/"?"":"/")+n;break;default:i.method="PUT",i.data=this.serialize(t,n),o=o+(o.slice(-1)==="/"?"":"/")+n}i.url=this._applyPayload(o)}return this._waitMode++,e.query(i)}_forEachUpdatedRow(t){const n=this.updatedRows.slice();for(let e=0;e<n.length;e++){const i=n[e];this.$gantt.getUserData(i,this.action_param,this._ganttMode)&&t.call(this,i)}}_setDefaultTransactionMode(){this.serverProcessor&&(this.setTransactionMode("POST",!0),this.serverProcessor+=(this.serverProcessor.indexOf("?")!==-1?"&":"?")+"editing=true",this._serverProcessor=this.serverProcessor)}_getXmlNodeValue(t){return t.firstChild?t.firstChild.nodeValue:""}_getAllData(){const t={};let n=!1;return this._forEachUpdatedRow(function(e){if(this._in_progress[e]||this.is_invalid(e))return;const i=this._getRowData(e);this.callEvent("onBeforeUpdate",[e,this.getState(e),i])&&(t[e]=i,n=!0,this._in_progress[e]=new Date().valueOf())}),n?t:null}_prepareDate(t){return this.$gantt.defined(this.$gantt.templates.xml_format)?this.$gantt.templates.xml_format(t):this.$gantt.templates.format_date(t)}_prepareArray(t,n){return n.push(t),t.map(e=>tt(e)?this._prepareDate(e):Array.isArray(e)&&!Vt(n,e)?this._prepareArray(e,n):e&&typeof e=="object"&&!Vt(n,e)?this._prepareObject(e,n):e)}_prepareObject(t,n){const e={};n.push(t);for(const i in t){if(i.substr(0,1)==="$")continue;const a=t[i];tt(a)?e[i]=this._prepareDate(a):a===null?e[i]="":Array.isArray(a)&&!Vt(n,a)?e[i]=this._prepareArray(a,n):a&&typeof a=="object"&&!Vt(n,a)?e[i]=this._prepareObject(a,n):e[i]=a}return e}_prepareDataItem(t){const n=this._prepareObject(t,[]);return n[this.action_param]=this.$gantt.getUserData(t.id,this.action_param,this._ganttMode),n}getStoredItem(t){return this._storage.getStoredItem(t)}_getRowData(t){let n;const e=this.$gantt;return this.getGanttMode()==="task"?e.isTaskExists(t)&&(n=this.$gantt.getTask(t)):this.getGanttMode()==="assignment"?this.$gantt.$data.assignmentsStore.exists(t)&&(n=this.$gantt.$data.assignmentsStore.getItem(t)):this.getGanttMode()==="baseline"?this.$gantt.$data.baselineStore.exists(t)&&(n=this.$gantt.$data.baselineStore.getItem(t)):e.isLinkExists(t)&&(n=this.$gantt.getLink(t)),n||(n=this.getStoredItem(t)),n||(n={id:t}),this._prepareDataItem(n)}};const ai=function(t){return new en(t)},si=function(t){let n,e,i;t instanceof Function?n=t:t.hasOwnProperty("router")?n=t.router:t.hasOwnProperty("assignment")||t.hasOwnProperty("baseline")||t.hasOwnProperty("link")||t.hasOwnProperty("task")?n=t:t.hasOwnProperty("headers")&&(i=t.headers),e=n?"CUSTOM":t.mode||"REST-JSON";const a=new en(t.url);return a.init(this),a.setTransactionMode({mode:e,router:n,headers:i},t.batchUpdate),t.deleteAfterConfirmation&&(a.deleteAfterConfirmation=t.deleteAfterConfirmation),a};function ri(t){var n={},e=!1;function i(l,d){d=typeof d=="function"?d:function(){},n[l]||(n[l]=this[l],this[l]=d)}function a(l){n[l]&&(this[l]=n[l],n[l]=null)}function s(l){for(var d in l)i.call(this,d,l[d])}function r(){for(var l in n)a.call(this,l)}function o(l){try{l()}catch(d){Q.console.error(d)}}return t.$services.getService("state").registerProvider("batchUpdate",function(){return{batch_update:e}},!1),function(l,d){if(e)o(l);else{var c,u=this._dp&&this._dp.updateMode!="off";u&&(c=this._dp.updateMode,this._dp.setUpdateMode("off"));var h={},_={render:!0,refreshData:!0,refreshTask:!0,refreshLink:!0,resetProjectDates:function(y){h[y.id]=y}};for(var f in s.call(this,_),e=!0,this.callEvent("onBeforeBatchUpdate",[]),o(l),this.callEvent("onAfterBatchUpdate",[]),r.call(this),h)this.resetProjectDates(h[f]);e=!1,d||this.render(),u&&(this._dp.setUpdateMode(c),this._dp.setGanttMode("task"),this._dp.sendData(),this._dp.setGanttMode("link"),this._dp.sendData())}}}function oi(t){t.batchUpdate=ri(t)}function li(t){const n=function(i){return{_needRecalc:!0,reset:function(){this._needRecalc=!0},_isRecalcNeeded:function(){return!this._isGroupSort()&&this._needRecalc},_isGroupSort:function(){return!!i.getState().group_mode},_getWBSCode:function(a){return a?(this._isRecalcNeeded()&&this._calcWBS(),a.$virtual?"":this._isGroupSort()?a.$wbs||"":(a.$wbs||(this.reset(),this._calcWBS()),a.$wbs)):""},_setWBSCode:function(a,s){a.$wbs=s},getWBSCode:function(a){return this._getWBSCode(a)},getByWBSCode:function(a){let s=a.split("."),r=i.config.root_id;for(let o=0;o<s.length;o++){const l=i.getChildren(r);let d=1*s[o]-1;if(!i.isTaskExists(l[d]))return null;r=l[d]}return i.isTaskExists(r)?i.getTask(r):null},_calcWBS:function(){if(!this._isRecalcNeeded())return;let a=!0;i.eachTask(function(s){if(s.type==i.config.types.placeholder)return;if(a)return a=!1,void this._setWBSCode(s,"1");const r=this._getPrevNonPlaceholderSibling(s.id);if(r!==null)this._increaseWBS(s,r);else{let o=i.getParent(s.id);this._setWBSCode(s,i.getTask(o).$wbs+".1")}},i.config.root_id,this),this._needRecalc=!1},_increaseWBS:function(a,s){let r=i.getTask(s).$wbs;r&&(r=r.split("."),r[r.length-1]++,this._setWBSCode(a,r.join(".")))},_getPrevNonPlaceholderSibling:function(a){let s,r=a;do s=i.getPrevSibling(r),r=s;while(s!==null&&i.getTask(s).type==i.config.types.placeholder);return s}}}(t);function e(){return n.reset(),!0}t.getWBSCode=function(i){return n.getWBSCode(i)},t.getTaskByWBSCode=function(i){return n.getByWBSCode(i)},t.attachEvent("onAfterTaskMove",e),t.attachEvent("onBeforeParse",e),t.attachEvent("onAfterTaskDelete",e),t.attachEvent("onAfterTaskAdd",e),t.attachEvent("onAfterSort",e)}function di(t){var n={},e=!1;t.$data.tasksStore.attachEvent("onStoreUpdated",function(){n={},e=!1}),t.attachEvent("onBeforeGanttRender",function(){n={}});var i=String(Math.random());function a(l){return l===null?i+String(l):String(l)}function s(l,d,c){return Array.isArray(l)?l.map(function(u){return a(u)}).join("_")+`_${d}_${c}`:a(l)+`_${d}_${c}`}function r(l,d,c){var u,h=s(d,l,JSON.stringify(c)),_={};return xt(d,function(f){_[a(f)]=!0}),n[h]?u=n[h]:(u=n[h]=[],t.eachTask(function(f){if(c){if(!c[t.getTaskType(f)])return}else if(f.type==t.config.types.project)return;l in f&&xt(de(f[l])?f[l]:[f[l]],function(y){var v=y&&y.resource_id?y.resource_id:y;if(_[a(v)])u.push(f);else if(!e){var b=s(y,l);n[b]||(n[b]=[]),n[b].push(f)}})}),e=!0),u}function o(l,d,c){var u=t.config.resource_property,h=[];if(t.getDatastore("task").exists(d)){var _=t.getTask(d);h=_[u]||[]}Array.isArray(h)||(h=[h]);for(var f=0;f<h.length;f++)h[f].resource_id==l&&c.push({task_id:_.id,resource_id:h[f].resource_id,value:h[f].value})}return{getTaskBy:function(l,d,c){return typeof l=="function"?(u=l,h=[],t.eachTask(function(_){u(_)&&h.push(_)}),h):de(d)?r(l,d,c):r(l,[d],c);var u,h},getResourceAssignments:function(l,d){var c=[],u=t.config.resource_property;return d!==void 0?o(l,d,c):t.getTaskBy(u,l).forEach(function(h){o(l,h.id,c)}),c}}}function ci(t){const n={renderEditableLabel:function(e,i,a,s,r){const o=t.config.readonly?"":"contenteditable";if(e<a.end_date&&i>a.start_date){for(let l=0;l<r.length;l++){const d=r[l];return"<div "+o+" data-assignment-cell data-assignment-id='"+d.id+"' data-row-id='"+a.id+"' data-task='"+a.$task_id+"' data-start-date='"+t.templates.format_date(e)+"' data-end-date='"+t.templates.format_date(i)+"'>"+d.value+"</div>"}return"<div "+o+" data-assignment-cell data-empty  data-row-id='"+a.id+"' data-resource-id='"+a.$resource_id+"' data-task='"+a.$task_id+"' data-start-date='"+t.templates.format_date(e)+"''  data-end-date='"+t.templates.format_date(i)+"'>-</div>"}return""},renderSummaryLabel:function(e,i,a,s,r){let o=r.reduce(function(l,d){return l+Number(d.value)},0);return o%1&&(o=Math.round(10*o)/10),o?"<div>"+o+"</div>":""},editableResourceCellTemplate:function(e,i,a,s,r){return a.$role==="task"?n.renderEditableLabel(e,i,a,s,r):n.renderSummaryLabel(e,i,a,s,r)},editableResourceCellClass:function(e,i,a,s,r){const o=[];o.push("resource_marker"),a.$role==="task"?o.push("task_cell"):o.push("resource_cell");const l=r.reduce(function(c,u){return c+Number(u.value)},0);let d=Number(a.capacity);return isNaN(d)&&(d=8),l<=d?o.push("workday_ok"):o.push("workday_over"),o.join(" ")},getSummaryResourceAssignments:function(e){let i;const a=t.getDatastore(t.config.resource_store),s=a.getItem(e);return s.$role==="task"?i=t.getResourceAssignments(s.$resource_id,s.$task_id):(i=t.getResourceAssignments(e),a.eachItem&&a.eachItem(function(r){r.$role!=="task"&&(i=i.concat(t.getResourceAssignments(r.id)))},e)),i},initEditableDiagram:function(){t.config.resource_render_empty_cells=!0,function(){let a=null;function s(){return a&&cancelAnimationFrame(a),a=requestAnimationFrame(function(){t.$container&&Array.prototype.slice.call(t.$container.querySelectorAll(".resourceTimeline_cell [data-assignment-cell]")).forEach(function(r){r.contentEditable=!0})}),!0}t.attachEvent("onGanttReady",function(){t.getDatastore(t.config.resource_assignment_store).attachEvent("onStoreUpdated",s),t.getDatastore(t.config.resource_store).attachEvent("onStoreUpdated",s)},{once:!0}),t.attachEvent("onGanttLayoutReady",function(){t.$layout.getCellsByType("viewCell").forEach(function(r){r.$config&&r.$config.view==="resourceTimeline"&&r.$content&&r.$content.attachEvent("onScroll",s)})})}();let e=null;function i(a,s){let r=s||a.target.closest(".resourceTimeline_cell [data-assignment-cell]");if(r){let o=(r.innerText||"").trim();o=="-"&&(o="0");let l=Number(o),d=r.getAttribute("data-row-id"),c=r.getAttribute("data-assignment-id"),u=r.getAttribute("data-task"),h=r.getAttribute("data-resource-id"),_=t.templates.parse_date(r.getAttribute("data-start-date")),f=t.templates.parse_date(r.getAttribute("data-end-date"));const y=t.getDatastore(t.config.resource_assignment_store);if(isNaN(l))t.getDatastore(t.config.resource_store).refresh(d);else{const v=t.getTask(u);if(c){t.plugins().undo&&t.ext.undo.saveState(u,"task");const b=y.getItem(c);if(!b||l===b.value)return;if(b.start_date.valueOf()===_.valueOf()&&b.end_date.valueOf()===f.valueOf())b.value=l,l?y.updateItem(b.id):y.removeItem(b.id);else{if(b.end_date.valueOf()>f.valueOf()){const m=t.copy(b);m.id=t.uid(),m.start_date=f,m.duration=t.calculateDuration({start_date:m.start_date,end_date:m.end_date,task:v}),m.delay=t.calculateDuration({start_date:v.start_date,end_date:m.start_date,task:v}),m.mode=b.mode||"default",m.duration!==0&&y.addItem(m)}b.start_date.valueOf()<_.valueOf()?(b.end_date=_,b.duration=t.calculateDuration({start_date:b.start_date,end_date:b.end_date,task:v}),b.mode="fixedDuration",b.duration===0?y.removeItem(b.id):y.updateItem(b.id)):y.removeItem(b.id),l&&y.addItem({task_id:b.task_id,resource_id:b.resource_id,value:l,start_date:_,end_date:f,duration:t.calculateDuration({start_date:_,end_date:f,task:v}),delay:t.calculateDuration({start_date:v.start_date,end_date:_,task:v}),mode:"fixedDuration"})}t.updateTaskAssignments(v.id),t.updateTask(v.id)}else if(l){let b={task_id:u,resource_id:h,value:l,start_date:_,end_date:f,duration:t.calculateDuration({start_date:_,end_date:f,task:v}),delay:t.calculateDuration({start_date:v.start_date,end_date:_,task:v}),mode:"fixedDuration"};y.addItem(b),t.updateTaskAssignments(v.id),t.updateTask(v.id)}}}}t.attachEvent("onGanttReady",function(){let a=null;t.event(t.$container,"keypress",function(s){let r=s.target.closest(".resourceTimeline_cell [data-assignment-cell]");r&&(s.keyCode!==13&&s.keyCode!==27||(r.blur(),i(s)),a=s.target)}),t.event(t.$container,"keydown",function(s){s.key==="Tab"&&(e=At(t.$container).indexOf(document.activeElement),i(s),setTimeout(function(){var l;const o=At(t.$container);e>-1&&((l=o[e+1])==null||l.focus())},300))}),t.event(t.$container,"click",function(s){if(a&&(i(s,a),a=null,s.target.hasAttribute("data-assignment-id"))){const r=t.$container.querySelectorAll("[contenteditable='true']"),o=Array.from(r).find(l=>l.getAttribute("data-start-date")==s.target.getAttribute("data-start-date")&&l.getAttribute("data-assignment-id")==s.target.getAttribute("data-assignment-id"));setTimeout(()=>{const l=t.$container.querySelectorAll("[contenteditable='true']"),d=Array.from(l).find(c=>c.getAttribute("data-start-date")==o.getAttribute("data-start-date")&&c.getAttribute("data-row-id")==o.getAttribute("data-row-id"));d&&d.focus()},400)}})},{once:!0})}};return n}function ui(t){var n=di(t);t.ext.resources=ci(t),t.config.resources={dataprocessor_assignments:!1,dataprocessor_resources:!1,editable_resource_diagram:!1,resource_store:{type:"treeDataStore",fetchTasks:!1,initItem:function(a){return a.parent=a.parent||t.config.root_id,a[t.config.resource_property]=a.parent,a.open=!0,a}},lightbox_resources:function(a){const s=[],r=t.getDatastore(t.config.resource_store);return a.forEach(function(o){if(!r.hasChild(o.id)){const l=t.copy(o);l.key=o.id,l.label=o.text,s.push(l)}}),s}},t.attachEvent("onBeforeGanttReady",function(){if(t.getDatastore(t.config.resource_store))return;const a=t.config.resources?t.config.resources.resource_store:void 0;let s=a?a.fetchTasks:void 0;t.config.resources&&t.config.resources.editable_resource_diagram&&(s=!0);let r=function(l){return l.parent=l.parent||t.config.root_id,l[t.config.resource_property]=l.parent,l.open=!0,l};a&&a.initItem&&(r=a.initItem);const o=a&&a.type?a.type:"treeDatastore";t.$resourcesStore=t.createDatastore({name:t.config.resource_store,type:o,fetchTasks:s!==void 0&&s,initItem:r}),t.$data.resourcesStore=t.$resourcesStore,t.$resourcesStore.attachEvent("onParse",function(){let l,d=function(c){const u=[];return c.forEach(function(h){const _=t.copy(h);_.key=h.id,_.label=h.text,u.push(_)}),u};t.config.resources&&t.config.resources.lightbox_resources&&(d=t.config.resources.lightbox_resources),t.config.resources&&t.config.resources.editable_resource_diagram?l=d(t.$resourcesStore.getItems().filter(c=>{let u=t.getResourceAssignments(c.id);if(!t.$resourcesStore.hasChild(c.id)||u&&u.length)return!c.$resource_id||!c.$task_id})):l=d(t.$resourcesStore.getItems()),t.updateCollection("resourceOptions",l)})}),t.getTaskBy=n.getTaskBy,t.getResourceAssignments=n.getResourceAssignments,t.config.resource_property="owner_id",t.config.resource_store="resource",t.config.resource_render_empty_cells=!1,t.templates.histogram_cell_class=function(a,s,r,o,l){},t.templates.histogram_cell_label=function(a,s,r,o,l){return o.length+"/3"},t.templates.histogram_cell_allocated=function(a,s,r,o,l){return o.length/3},t.templates.histogram_cell_capacity=function(a,s,r,o,l){return 0};const e=function(a,s,r,o,l){return o.length<=1?"gantt_resource_marker_ok":"gantt_resource_marker_overtime"},i=function(a,s,r,o,l){return 8*o.length};t.templates.resource_cell_value=i,t.templates.resource_cell_class=e,t.attachEvent("onBeforeGanttReady",function(){t.config.resources&&t.config.resources.editable_resource_diagram&&(t.config.resource_render_empty_cells=!0,t.templates.resource_cell_value===i&&(t.templates.resource_cell_value=t.ext.resources.editableResourceCellTemplate),t.templates.resource_cell_class===e&&(t.templates.resource_cell_class=t.ext.resources.editableResourceCellClass),t.ext.resources.initEditableDiagram(t))})}function hi(t){var n="$resourceAssignments";t.config.resource_assignment_store="resourceAssignments",t.config.process_resource_assignments=!0;var e="auto",i="singleValue",a="valueArray",s="resourceValueArray",r="assignmentsArray",o=e,l="fixedDates",d="fixedDuration",c="default";function u(p,k){p.start_date?p.start_date=t.date.parseDate(p.start_date,"parse_date"):p.start_date=null,p.end_date?p.end_date=t.date.parseDate(p.end_date,"parse_date"):p.end_date=null;var x=Number(p.delay),w=!1;if(isNaN(x)?(p.delay=0,w=!0):p.delay=x,t.defined(p.value)||(p.value=null),!p.task_id||!p.resource_id)return!1;if(p.mode=p.mode||c,p.mode===d&&(isNaN(Number(p.duration))&&(k=k||t.getTask(p.task_id),p.duration=t.calculateDuration({start_date:p.start_date,end_date:p.end_date,id:k})),w&&(k=k||t.getTask(p.task_id),p.delay=t.calculateDuration({start_date:k.start_date,end_date:p.start_date,id:k}))),p.mode!==l&&(k||t.isTaskExists(p.task_id))){var $=_(p,k=k||t.getTask(p.task_id));p.start_date=$.start_date,p.end_date=$.end_date,p.duration=$.duration}}var h=t.createDatastore({name:t.config.resource_assignment_store,initItem:function(p){return p.id||(p.id=t.uid()),u(p),p}});function _(p,k){if(p.mode===l)return{start_date:p.start_date,end_date:p.end_date,duration:p.duration};var x,w,$=p.delay?t.calculateEndDate({start_date:k.start_date,duration:p.delay,task:k}):new Date(k.start_date);return p.mode===d?(x=t.calculateEndDate({start_date:$,duration:p.duration,task:k}),w=p.duration):(x=new Date(k.end_date),w=k.duration-p.delay),{start_date:$,end_date:x,duration:w}}function f(p){const k=t.config.resource_property;let x=p[k];const w=[];let $=o===e;if(t.defined(x)&&x){Array.isArray(x)||(x=[x],$&&(o=i,$=!1));const T={};x.forEach(function(S){S.resource_id||(S={resource_id:S},$&&(o=a,$=!1)),$&&(S.id&&S.resource_id?(o=r,$=!1):(o=s,$=!1));let C,E=c;S.mode||(S.start_date&&S.end_date||S.start_date&&S.duration)&&(E=d),C=S.id||!S.$id||T[S.$id]?S.id&&!T[S.id]?S.id:t.uid():S.$id,T[C]=!0;const D={id:C,start_date:S.start_date,duration:S.duration,end_date:S.end_date,delay:S.delay,task_id:p.id,resource_id:S.resource_id,value:S.value,mode:S.mode||E};Object.keys(S).forEach(A=>{A!="$id"&&(D[A]=S[A])}),D.start_date&&D.start_date.getMonth&&D.end_date&&D.end_date.getMonth&&typeof D.duration=="number"||u(D,p),w.push(D)})}return w}function y(p){if(t.isTaskExists(p)){var k=t.getTask(p);v(k,t.getTaskAssignments(k.id))}}function v(p,k){k.sort(function(x,w){return x.start_date&&w.start_date&&x.start_date.valueOf()!=w.start_date.valueOf()?x.start_date-w.start_date:0}),o==r?p[t.config.resource_property]=k:o==s&&(p[t.config.resource_property]=k.map(function(x){return{$id:x.id,start_date:x.start_date,duration:x.duration,end_date:x.end_date,delay:x.delay,resource_id:x.resource_id,value:x.value,mode:x.mode}})),p[n]=k}function b(p){var k=f(p);return k.forEach(function(x){x.id=x.id||t.uid()}),k}function m(p,k){var x=function(w,$){var T={inBoth:[],inTaskNotInStore:[],inStoreNotInTask:[]};if(o==i){var S=w[0],C=S?S.resource_id:null,E=!1;$.forEach(function(I){I.resource_id!=C?T.inStoreNotInTask.push(I):I.resource_id==C&&(T.inBoth.push({store:I,task:S}),E=!0)}),!E&&S&&T.inTaskNotInStore.push(S)}else if(o==a){var D={},A={},M={};w.forEach(function(I){D[I.resource_id]=I}),$.forEach(function(I){A[I.resource_id]=I}),w.concat($).forEach(function(I){if(!M[I.resource_id]){M[I.resource_id]=!0;var N=D[I.resource_id],L=A[I.resource_id];N&&L?T.inBoth.push({store:L,task:N}):N&&!L?T.inTaskNotInStore.push(N):!N&&L&&T.inStoreNotInTask.push(L)}})}else o!=r&&o!=s||(D={},A={},M={},w.forEach(function(I){D[I.id||I.$id]=I}),$.forEach(function(I){A[I.id]=I}),w.concat($).forEach(function(I){var N=I.id||I.$id;if(!M[N]){M[N]=!0;var L=D[N],B=A[N];L&&B?T.inBoth.push({store:B,task:L}):L&&!B?T.inTaskNotInStore.push(L):!L&&B&&T.inStoreNotInTask.push(B)}}));return T}(f(p),k);x.inStoreNotInTask.forEach(function(w){h.removeItem(w.id)}),x.inTaskNotInStore.forEach(function(w){h.addItem(w)}),x.inBoth.forEach(function(w){if(function(T,S){var C={id:!0};for(var E in T)if(!C[E]&&String(T[E])!==String(S[E]))return!0;return!1}(w.task,w.store))(function(T,S){var C={id:!0};for(var E in T)C[E]||(S[E]=T[E])})(w.task,w.store),h.updateItem(w.store.id);else if(w.task.start_date&&w.task.end_date&&w.task.mode!==l){var $=_(w.store,p);w.store.start_date.valueOf()==$.start_date.valueOf()&&w.store.end_date.valueOf()==$.end_date.valueOf()||(w.store.start_date=$.start_date,w.store.end_date=$.end_date,w.store.duration=$.duration,h.updateItem(w.store.id))}}),y(p.id)}function g(p){var k=p[n]||h.find(function(x){return x.task_id==p.id});m(p,k)}t.$data.assignmentsStore=h,t.attachEvent("onGanttReady",function(){if(t.config.process_resource_assignments){t.attachEvent("onParse",function(){t.silent(function(){h.clearAll();var C=[];t.eachTask(function(E){if(E.type!==t.config.types.project){var D=b(E);v(E,D),D.forEach(function(A){C.push(A)})}}),h.parse(C)})});var p=!1,k=!1,x={},w=!1;t.attachEvent("onBeforeBatchUpdate",function(){p=!0}),t.attachEvent("onAfterBatchUpdate",function(){if(k){var C={};for(var E in x)C[E]=t.getTaskAssignments(x[E].id);for(var E in t.config.process_resource_assignments&&o==="resourceValueArray"&&(S=null),x)m(x[E],C[E])}k=!1,p=!1,x={}}),t.attachEvent("onTaskCreated",function(C){var E=b(C);return h.parse(E),v(C,E),!0}),t.attachEvent("onAfterTaskUpdate",function(C,E){p?(k=!0,x[C]=E):E.unscheduled||g(E)}),t.attachEvent("onAfterTaskAdd",function(C,E){p?(k=!0,x[C]=E):g(E)}),t.attachEvent("onRowDragEnd",function(C){g(t.getTask(C))}),t.$data.tasksStore.attachEvent("onAfterDeleteConfirmed",function(C,E){var D,A=[C];t.eachTask(function(M){A.push(M.id)},C),D={},A.forEach(function(M){D[M]=!0}),h.find(function(M){return D[M.task_id]}).forEach(function(M){h.removeItem(M.id)})}),t.$data.tasksStore.attachEvent("onClearAll",function(){return $=null,T=null,S=null,h.clearAll(),!0}),t.attachEvent("onTaskIdChange",function(C,E){h.find(function(D){return D.task_id==C}).forEach(function(D){D.task_id=E,h.updateItem(D.id)}),y(E)}),t.attachEvent("onBeforeUndo",function(C){return w=!0,!0}),t.attachEvent("onAfterUndo",function(C){w=!0});var $=null,T=null,S=null;h.attachEvent("onStoreUpdated",function(){return p&&!w||($=null,T=null,S=null),!0}),t.getResourceAssignments=function(C,E){var D=t.defined(E)&&E!==null;return $===null&&($={},T={},h.eachItem(function(A){$[A.resource_id]||($[A.resource_id]=[]),$[A.resource_id].push(A);var M=A.resource_id+"-"+A.task_id;T[M]||(T[M]=[]),T[M].push(A)})),D?(T[C+"-"+E]||[]).slice():($[C]||[]).slice()},t.getTaskAssignments=function(C){if(S===null){var E=[];S={},h.eachItem(function(D){S[D.task_id]||(S[D.task_id]=[]),S[D.task_id].push(D),D.task_id==C&&E.push(D)})}return(S[C]||[]).slice()},t.getTaskResources=function(C){const E=t.getDatastore("resource"),D=t.getTaskAssignments(C),A={};D.forEach(function(I){A[I.resource_id]||(A[I.resource_id]=I.resource_id)});const M=[];for(const I in A){const N=E.getItem(A[I]);N&&M.push(N)}return M},t.updateTaskAssignments=y}},{once:!0})}function _i(t){function n(o){return function(){return!t.config.placeholder_task||o.apply(this,arguments)}}function e(){var o=t.getTaskBy("type",t.config.types.placeholder);if(!o.length||!t.isTaskExists(o[0].id)){var l={unscheduled:!0,type:t.config.types.placeholder,duration:0,text:t.locale.labels.new_task};if(t.callEvent("onTaskCreated",[l])===!1)return;t.addTask(l)}}function i(o){var l=t.getTask(o);l.type==t.config.types.placeholder&&(l.start_date&&l.end_date&&l.unscheduled&&(l.unscheduled=!1),t.batchUpdate(function(){var d=t.copy(l);t.silent(function(){t.deleteTask(l.id)}),delete d["!nativeeditor_status"],d.type=t.config.types.task,d.id=t.uid(),t.addTask(d)}))}t.config.types.placeholder="placeholder",t.attachEvent("onDataProcessorReady",n(function(o){o&&!o._silencedPlaceholder&&(o._silencedPlaceholder=!0,o.attachEvent("onBeforeUpdate",n(function(l,d,c){return c.type!=t.config.types.placeholder||(o.setUpdated(l,!1),!1)})))}));var a=!1;function s(o){return!!(t.config.types.placeholder&&t.isTaskExists(o)&&t.getTask(o).type==t.config.types.placeholder)}function r(o){return!(!s(o.source)&&!s(o.target))}t.attachEvent("onGanttReady",function(){a||(a=!0,t.attachEvent("onAfterTaskUpdate",n(i)),t.attachEvent("onAfterTaskAdd",n(function(o,l){l.type!=t.config.types.placeholder&&(t.getTaskBy("type",t.config.types.placeholder).forEach(function(d){t.silent(function(){t.isTaskExists(d.id)&&t.deleteTask(d.id)})}),e())})),t.attachEvent("onParse",n(e)))}),t.attachEvent("onLinkValidation",function(o){return!r(o)}),t.attachEvent("onBeforeLinkAdd",function(o,l){return!r(l)}),t.attachEvent("onBeforeUndoStack",function(o){for(var l=0;l<o.commands.length;l++){var d=o.commands[l];d.entity==="task"&&d.value.type===t.config.types.placeholder&&(o.commands.splice(l,1),l--)}return!0})}function gi(t){function n(c){return function(){return!t.config.auto_types||t.getTaskType(t.config.types.project)!=t.config.types.project||c.apply(this,arguments)}}function e(c,u){var h=t.getTask(c),_=s(h);_!==!1&&t.getTaskType(h)!==_&&(u.$needsUpdate=!0,u[h.id]={task:h,type:_})}function i(c){if(!t.getState().group_mode){var u=function(h,_){return e(h,_=_||{}),t.eachParent(function(f){e(f.id,_)},h),_}(c);u.$needsUpdate&&t.batchUpdate(function(){(function(h){for(var _ in h)if(h[_]&&h[_].task){var f=h[_].task;f.type=h[_].type,t.updateTask(f.id)}})(u)})}}var a;function s(c){var u=t.config.types,h=t.hasChild(c.id),_=t.getTaskType(c.type);return h&&_===u.task?u.project:!h&&_===u.project&&u.task}var r,o,l=!0;function d(c){c!=t.config.root_id&&t.isTaskExists(c)&&i(c)}t.attachEvent("onParse",n(function(){l=!1,t.getState().group_mode||(t.batchUpdate(function(){t.eachTask(function(c){var u=s(c);u!==!1&&function(h,_){t.getState().group_mode||(h.type=_,t.updateTask(h.id))}(c,u)})}),l=!0)})),t.attachEvent("onAfterTaskAdd",n(function(c){l&&i(c)})),t.attachEvent("onAfterTaskUpdate",n(function(c){l&&i(c)})),t.attachEvent("onBeforeTaskDelete",n(function(c,u){return a=t.getParent(c),!0})),t.attachEvent("onAfterTaskDelete",n(function(c,u){d(a)})),t.attachEvent("onRowDragStart",n(function(c,u,h){return r=t.getParent(c),!0})),t.attachEvent("onRowDragEnd",n(function(c,u){d(r),i(c)})),t.attachEvent("onBeforeTaskMove",n(function(c,u,h){return o=t.getParent(c),!0})),t.attachEvent("onAfterTaskMove",n(function(c,u,h){document.querySelector(".gantt_drag_marker")||(d(o),i(c))}))}const ie=class ie{constructor(){this.canParse=n=>!isNaN(this.parse(n)),this.format=n=>String(n),this.parse=n=>parseInt(n,10)}};ie.create=(n=null)=>new ie;let Mt=ie;const ae=class ae{constructor(n){this.format=e=>this._getWBSCode(e.source),this.canParse=e=>this._linkReg.test(e),this.parse=e=>{if(!this.canParse(e))return null;const i=this._linkReg.exec(e)[0].trim();return{id:void 0,source:this._findSource(i)||null,target:null,type:this._gantt.config.links.finish_to_start,lag:0}},this._getWBSCode=e=>{const i=this._gantt.getTask(e);return this._gantt.getWBSCode(i)},this._findSource=e=>{const i=new RegExp("^[0-9.]+","i");if(i.exec(e)){const a=i.exec(e)[0],s=this._gantt.getTaskByWBSCode(a);if(s)return s.id}return null},this._linkReg=/^[0-9\.]+/,this._gantt=n}};ae.create=(n=null,e)=>new ae(e);let me=ae;function fi(t){t.ext.formatters={durationFormatter:function(n){return n||(n={}),n.store||(n.store=t.config.duration_unit),n.enter||(n.enter=t.config.duration_unit),Mt.create(n,t)},linkFormatter:function(n){return me.create(n,t)}}}function pi(t){t.ext=t.ext||{},t.config.show_empty_state=!1,t.ext.emptyStateElement=t.ext.emptyStateElement||{isEnabled:()=>t.config.show_empty_state===!0,isGanttEmpty:()=>!t.getTaskByTime().length,renderContent(n){const e=`<div class='gantt_empty_state'><div class='gantt_empty_state_image'></div>${`<div class='gantt_empty_state_text'>
    <div class='gantt_empty_state_text_link' data-empty-state-create-task>${t.locale.labels.empty_state_text_link}</div>
    <div class='gantt_empty_state_text_description'>${t.locale.labels.empty_state_text_description}</div>
    </div>`}</div>`;n.innerHTML=e},clickEvents:[],attachAddTaskEvent(){const n=t.attachEvent("onEmptyClick",function(e){t.utils.dom.closest(e.target,"[data-empty-state-create-task]")&&t.createTask({id:t.uid(),text:"New Task"})});this.clickEvents.push(n)},detachAddTaskEvents(){this.clickEvents.forEach(function(n){t.detachEvent(n)}),this.clickEvents=[]},getContainer(){if(t.$container){const n=t.utils.dom;if(t.$container.contains(t.$grid_data))return n.closest(t.$grid_data,".gantt_layout_content");if(t.$container.contains(t.$task_data))return n.closest(t.$task_data,".gantt_layout_content")}return null},getNode(){const n=this.getContainer();return n?n.querySelector(".gantt_empty_state_wrapper"):null},show(){const n=this.getContainer();if(!n&&this.isGanttEmpty())return null;const e=document.createElement("div");e.className="gantt_empty_state_wrapper",e.style.marginTop=t.config.scale_height-n.offsetHeight+"px";const i=t.$container.querySelectorAll(".gantt_empty_state_wrapper");Array.prototype.forEach.call(i,function(a){a.parentNode.removeChild(a)}),this.detachAddTaskEvents(),this.attachAddTaskEvent(),n.appendChild(e),this.renderContent(e)},hide(){const n=this.getNode();if(!n)return!1;n.parentNode.removeChild(n)},init(){}},t.attachEvent("onDataRender",function(){const n=t.ext.emptyStateElement;n.isEnabled()&&n.isGanttEmpty()?n.show():n.hide()})}const nn=function(t,n){const e=n.baselines&&n.baselines.length,i=t.config.baselines.render_mode=="separateRow"||t.config.baselines.render_mode=="individualRow";if(e&&i)return!0},Et=function(t){return t.render&&t.render=="split"&&!t.$open};function mi(t){t.config.baselines={datastore:"baselines",render_mode:!1,dataprocessor_baselines:!1,row_height:16,bar_height:8};const n=t.createDatastore({name:t.config.baselines.datastore,initItem:function(a){return a.id||(a.id=t.uid()),function(s){if(!s.task_id||!s.start_date&&!s.end_date)return!1;s.start_date?s.start_date=t.date.parseDate(s.start_date,"parse_date"):s.start_date=null,s.end_date?s.end_date=t.date.parseDate(s.end_date,"parse_date"):s.end_date=null,s.duration=s.duration||1,s.start_date&&!s.end_date?s.end_date=t.calculateEndDate(s.start_date,s.duration):s.end_date&&!s.start_date&&(s.start_date=t.calculateEndDate(s.end_date,-s.duration))}(a),a}});function e(a){let s=0;t.adjustTaskHeightForBaselines(a),t.eachTask(function(r){let o=r.row_height||t.config.row_height;s=s||o,o>s&&(s=o)},a.id),a.row_height<s&&(a.row_height=s)}function i(a){t.eachParent(function(s){if(Et(s)){const r=s.row_height||t.getLayoutView("timeline").getBarHeight(s.id);let o=a.row_height;t.getChildren(s.id).forEach(function(l){const d=t.getTask(l);if(d.id==a.id)return;const c=d.row_height||t.getLayoutView("timeline").getBarHeight(d.id);o=o||c,c>o&&(o=c)}),s.row_height=o,s.bar_height=s.bar_height||r}},a.id)}t.$data.baselineStore=n,t.adjustTaskHeightForBaselines=function(a){let s,r,o=a.baselines&&a.baselines.length||0;const l=t.config.baselines.row_height,d=t.getLayoutView("timeline");if(d&&t.config.show_chart)switch(t.config.baselines.render_mode){case"taskRow":default:a.row_height=a.bar_height+8;break;case"separateRow":s=d.getBarHeight(a.id),o?(a.bar_height=a.bar_height||s,a.bar_height>s&&(s=a.bar_height),a.row_height=s+l):a.bar_height&&(a.row_height=a.bar_height+4),i(a);break;case"individualRow":s=d.getBarHeight(a.id),o?(a.bar_height=a.bar_height||s,a.bar_height>s&&(s=a.bar_height),r=l*o,a.row_height=s+r+2):a.bar_height&&(a.row_height=a.bar_height+4),i(a)}},t.attachEvent("onGanttReady",function(){t.config.baselines&&(t.attachEvent("onParse",function(){n.eachItem(function(a){const s=a.task_id;if(t.isTaskExists(s)){const r=t.getTask(s);r.baselines=r.baselines||[];let o=!0;for(let l=0;l<r.baselines.length;l++){let d=r.baselines[l];if(d.id==a.id){o=!1,t.mixin(d,a,!0);break}}o&&r.baselines.push(a),Y(t)||(Et(r)?e(r):t.adjustTaskHeightForBaselines(r))}})}),t.attachEvent("onBeforeTaskUpdate",function(a,s){return function(r){let o=!1;const l={},d=r.baselines||[],c=t.getTaskBaselines(r.id);d.length!=c.length&&(o=!0),d.forEach(function(u){l[u.id]=!0;const h=n.getItem(u.id);if(h){const _=+h.start_date!=+u.start_date,f=+h.end_date!=+u.end_date;(_||f)&&n.updateItem(u.id,u)}else n.addItem(u)}),c.forEach(function(u){l[u.id]||n.removeItem(u.id)}),o&&(Et(r)?e(r):t.adjustTaskHeightForBaselines(r),t.render())}(s),!0}),t.attachEvent("onAfterUndo",function(a){if((t.config.baselines.render_mode=="separateRow"||t.config.baselines.render_mode=="individualRow")&&a){let s=!1;a.commands.forEach(function(r){if(r.entity=="task"){const o=r.value.id;if(t.isTaskExists(o)){const l=t.getTask(o);if(l.parent&&t.isTaskExists(l.parent)){const d=t.getTask(l.parent);Et(d)&&(e(d),s=!0)}}}}),s&&t.render()}}),t.attachEvent("onAfterTaskDelete",function(a,s){if(nn&&s.parent&&t.isTaskExists(s.parent)){const r=t.getTask(s.parent);Et(r)&&e(r)}n.eachItem(function(r){t.isTaskExists(r.task_id)||n.removeItem(r.id)})}),t.getTaskBaselines=function(a){const s=[];return n.eachItem(function(r){r.task_id==a&&s.push(r)}),s},t.$data.baselineStore.attachEvent("onClearAll",function(){return t.eachTask(function(a){a.baselines&&delete a.baselines}),!0}),t.$data.tasksStore.attachEvent("onClearAll",function(){return n.clearAll(),!0}),t.attachEvent("onTaskIdChange",function(a,s){n.find(function(r){return r.task_id==a}).forEach(function(r){r.task_id=s,n.updateItem(r.id)})}))},{once:!0})}class vi{constructor(n,e){const i=new Ke({url:n,token:e});i.fetch=function(a,s){const r={headers:this.headers()};return s&&(r.method="POST",r.body=s),fetch(a,r).then(o=>o.json())},this._ready=i.load().then(a=>this._remote=a)}ready(){return this._ready}on(n,e){this.ready().then(i=>{if(typeof n=="string")i.on(n,e);else for(const a in n)i.on(a,n[a])})}}function ki(t){let n=[],e=null;function i(o){var u,h;if(!o||!o.type||!((u=o.task)!=null&&u.id)&&!((h=o.link)!=null&&h.id))return void console.error("Invalid message format:",o);const{type:l,task:d,link:c}=o;if(!(d&&t._dp._in_progress[d.id]||c&&t._dp._in_progress[c.id])){if(l==="add-task"){for(const _ in t._dp._in_progress)if(t._dp.getState(_)==="inserted")return void t._dp.attachEvent("onFullSync",function(){t.isTaskExists(d.id)||s(o)},{once:!0})}n.push(o),e&&clearTimeout(e),e=setTimeout(a,50)}}function a(){n.length!==0&&(n.length===1?s(n[0]):t.batchUpdate(function(){n.forEach(o=>{s(o)})}),n=[])}function s(o){const{type:l,task:d,link:c}=o;switch(l){case"add-task":(function(u){if(t.isTaskExists(u.id))return void console.warn(`Task with ID ${u.id} already exists. Skipping add.`);u.start_date=t.templates.parse_date(u.start_date),u.end_date&&(u.end_date=t.templates.parse_date(u.end_date)),r(()=>{t.addTask(u)})})(d);break;case"update-task":(function(u){const h=u.id;if(!t.getTask(h))return void console.warn(`Task with ID ${h} does not exist. Skipping update.`);const _=t.getDatastore("task").$initItem.bind(t.getDatastore("task")),f=t.getTask(h);r(()=>{const y=_(u);for(let v in y)f[v]=y[v];y.end_date||(f.end_date=t.calculateEndDate(f)),t.updateTask(h),h!==u.id&&t.changeTaskId(h,u.id)})})(d);break;case"delete-task":(function(u){const h=u.id;t.isTaskExists(h)&&r(()=>{t.getTask(h)&&(t.getState().lightbox_id==h&&(u.id=this._lightbox_id,t.getTask(this._lightbox_id)),t.deleteTask(h,!0))})})(d);break;case"add-link":(function(u){if(t.isLinkExists(u.id))return void console.warn(`Link with ID ${u.id} already exists. Skipping add.`);r(()=>{t.addLink(u)})})(c);break;case"update-link":(function(u){const h=u.id;if(!t.isLinkExists(h))return void console.warn(`Link with ID ${h} does not exist. Skipping update.`);const _=t.getLink(h);r(()=>{Object.assign(_,u),t.updateLink(h),h!==u.id&&t.changeLinkId(h,u.id)})})(c);break;case"delete-link":(function(u){const h=u.id;t.getLink(h)&&r(()=>{t.getLink(h)&&(t.getState().lightbox_id==h&&(u.id=this._lightbox_id,t.getLink(this._lightbox_id)),t.deleteLink(h,!0))})})(c)}}function r(o){t._dp?t._dp.ignore(o):o()}return{tasks:i,links:i}}function yi(t){t.ext||(t.ext={}),t.ext.liveUpdates={RemoteEvents:vi,remoteUpdates:ki(t)}}function bi(t){function n(e){throw t.assert(!1,"Can't parse data: incorrect value of gantt.parse or gantt.load method. Actual argument value: "+JSON.stringify(e)),new Error("Invalid argument for gantt.parse or gantt.load. An object or a JSON string of format https://docs.dhtmlx.com/gantt/desktop__supported_data_formats.html#json is expected. Actual argument value: "+JSON.stringify(e))}t.load=function(){throw new Error("gantt.load() method is not available in the node.js, use gantt.parse() instead")},t.parse=function(e,i){this.on_load({xmlDoc:{responseText:e}},i)},t.serialize=function(e){return this[e=e||"json"].serialize()},t.on_load=function(e,i){if(e.xmlDoc&&e.xmlDoc.status===404)this.assert(!1,"Failed to load the data from <a href='"+e.xmlDoc.responseURL+"' target='_blank'>"+e.xmlDoc.responseURL+"</a>, server returns 404");else if(!t.$destroyed){this.callEvent("onBeforeParse",[]),i||(i="json"),this.assert(this[i],"Invalid data type:'"+i+"'");var a=e.xmlDoc.responseText,s=this[i].parse(a,e);this._process_loading(s)}},t._process_loading=function(e){e.collections&&this._load_collections(e.collections),e.resources&&this.$data.resourcesStore&&this.$data.resourcesStore.parse(e.resources),t.config.baselines&&e.baselines&&this.$data.baselineStore&&this.$data.baselineStore.parse(e.baselines);const i=e.data||e.tasks;e.assignments&&function(s,r){const o={};r.forEach(l=>{o[l.task_id]||(o[l.task_id]=[]),o[l.task_id].push(l)}),s.forEach(l=>{l[t.config.resource_property]=o[l.id]||[]})}(i,e.assignments),this.$data.tasksStore.parse(i);var a=e.links||(e.collections&&e.collections.links?e.collections.links:[]);this.$data.linksStore.parse(a),this.callEvent("onParse",[]),this.render()},t._load_collections=function(e){var i=!1;for(var a in e)if(e.hasOwnProperty(a)){i=!0;var s=e[a];this.serverList[a]=this.serverList[a]||[];var r=this.serverList[a];if(!r)continue;r.splice(0,r.length);for(var o=0;o<s.length;o++){var l=s[o],d=this.copy(l);for(var c in d.key=d.value,l)if(l.hasOwnProperty(c)){if(c=="value"||c=="label")continue;d[c]=l[c]}r.push(d)}}i&&this.callEvent("onOptionsLoad",[])},t.attachEvent("onBeforeTaskDisplay",function(e,i){return!i.$ignore}),t.json={parse:function(e){if(e||n(e),typeof e=="string")if(typeof JSON!=null)try{e=JSON.parse(e)}catch{n(e)}else t.assert(!1,"JSON is not supported");return e.data||e.tasks||n(e),e.dhx_security&&(t.security_key=e.dhx_security),e},serializeTask:function(e){return this._copyObject(e)},serializeLink:function(e){return this._copyLink(e)},_copyLink:function(e){var i={};for(var a in e)i[a]=e[a];return i},_copyObject:function(e){var i={};for(var a in e)a.charAt(0)!="$"&&(i[a]=e[a],tt(i[a])&&(i[a]=t.defined(t.templates.xml_format)?t.templates.xml_format(i[a]):t.templates.format_date(i[a])));return i},serialize:function(){var e=[],i=[];let a=[];t.eachTask(function(o){t.resetProjectDates(o),e.push(this.serializeTask(o))},t.config.root_id,this);for(var s=t.getLinks(),r=0;r<s.length;r++)i.push(this.serializeLink(s[r]));return t.getDatastore("baselines").eachItem(function(o){const l=t.json.serializeTask(o);a.push(l)}),{data:e,links:i,baselines:a}}},t.xml={_xmlNodeToJSON:function(e,i){for(var a={},s=0;s<e.attributes.length;s++)a[e.attributes[s].name]=e.attributes[s].value;if(!i){for(s=0;s<e.childNodes.length;s++){var r=e.childNodes[s];r.nodeType==1&&(a[r.tagName]=r.firstChild?r.firstChild.nodeValue:"")}a.text||(a.text=e.firstChild?e.firstChild.nodeValue:"")}return a},_getCollections:function(e){for(var i={},a=t.ajax.xpath("//coll_options",e),s=0;s<a.length;s++)for(var r=i[a[s].getAttribute("for")]=[],o=t.ajax.xpath(".//item",a[s]),l=0;l<o.length;l++){for(var d=o[l].attributes,c={key:o[l].getAttribute("value"),label:o[l].getAttribute("label")},u=0;u<d.length;u++){var h=d[u];h.nodeName!="value"&&h.nodeName!="label"&&(c[h.nodeName]=h.nodeValue)}r.push(c)}return i},_getXML:function(e,i,a){a=a||"data",i.getXMLTopNode||(i=t.ajax.parse(i));var s=t.ajax.xmltop(a,i.xmlDoc);s&&s.tagName==a||function(o){throw t.assert(!1,"Can't parse data: incorrect value of gantt.parse or gantt.load method. Actual argument value: "+JSON.stringify(o)),new Error("Invalid argument for gantt.parse or gantt.load. An XML of format https://docs.dhtmlx.com/gantt/desktop__supported_data_formats.html#xmldhtmlxgantt20 is expected. Actual argument value: "+JSON.stringify(o))}(e);var r=s.getAttribute("dhx_security");return r&&(t.security_key=r),s},parse:function(e,i){i=this._getXML(e,i);for(var a={},s=a.data=[],r=t.ajax.xpath("//task",i),o=0;o<r.length;o++)s[o]=this._xmlNodeToJSON(r[o]);return a.collections=this._getCollections(i),a},_copyLink:function(e){return"<item id='"+e.id+"' source='"+e.source+"' target='"+e.target+"' type='"+e.type+"' />"},_copyObject:function(e){return"<task id='"+e.id+"' parent='"+(e.parent||"")+"' start_date='"+e.start_date+"' duration='"+e.duration+"' open='"+!!e.open+"' progress='"+e.progress+"' end_date='"+e.end_date+"'><![CDATA["+e.text+"]]></task>"},serialize:function(){for(var e=[],i=[],a=t.json.serialize(),s=0,r=a.data.length;s<r;s++)e.push(this._copyObject(a.data[s]));for(s=0,r=a.links.length;s<r;s++)i.push(this._copyLink(a.links[s]));return"<data>"+e.join("")+"<coll_options for='links'>"+i.join("")+"</coll_options></data>"}},t.oldxml={parse:function(e,i){i=t.xml._getXML(e,i,"projects");for(var a={collections:{links:[]}},s=a.data=[],r=t.ajax.xpath("//task",i),o=0;o<r.length;o++){s[o]=t.xml._xmlNodeToJSON(r[o]);var l=r[o].parentNode;l.tagName=="project"?s[o].parent="project-"+l.getAttribute("id"):s[o].parent=l.parentNode.getAttribute("id")}for(r=t.ajax.xpath("//project",i),o=0;o<r.length;o++)(d=t.xml._xmlNodeToJSON(r[o],!0)).id="project-"+d.id,s.push(d);for(o=0;o<s.length;o++){var d;(d=s[o]).start_date=d.startdate||d.est,d.end_date=d.enddate,d.text=d.name,d.duration=d.duration/8,d.open=1,d.duration||d.end_date||(d.duration=1),d.predecessortasks&&a.collections.links.push({target:d.id,source:d.predecessortasks,type:t.config.links.finish_to_start})}return a},serialize:function(){t.message("Serialization to 'old XML' is not implemented")}},t.serverList=function(e,i){return i?this.serverList[e]=i.slice(0):this.serverList[e]||(this.serverList[e]=[]),this.serverList[e]}}function ve(t,n,e,i,a){return this.date=t,this.unit=n,this.task=e,this.id=i,this.calendar=a,this}function ke(t,n,e,i,a,s){return this.date=t,this.dir=n,this.unit=e,this.task=i,this.id=a,this.calendar=s,this}function ye(t,n,e,i,a,s,r){return this.start_date=t,this.duration=n,this.unit=e,this.step=i,this.task=a,this.id=s,this.calendar=r,this}function xi(t,n,e,i){return this.start_date=t,this.end_date=n,this.task=e,this.calendar=i,this.unit=null,this.step=null,this}var an=function(t){return{getWorkHoursArguments:function(){var n=arguments[0];if(!St((n=tt(n)?{date:n}:R({},n)).date))throw t.assert(!1,"Invalid date argument for getWorkHours method"),new Error("Invalid date argument for getWorkHours method");return n},setWorkTimeArguments:function(){return arguments[0]},unsetWorkTimeArguments:function(){return arguments[0]},isWorkTimeArguments:function(){var n,e=arguments[0];if(e instanceof ve)return e;if((n=e.date?new ve(e.date,e.unit,e.task,null,e.calendar):new ve(arguments[0],arguments[1],arguments[2],null,arguments[3])).unit=n.unit||t.config.duration_unit,!St(n.date))throw t.assert(!1,"Invalid date argument for isWorkTime method"),new Error("Invalid date argument for isWorkTime method");return n},getClosestWorkTimeArguments:function(n){var e,i=arguments[0];if(i instanceof ke)return i;if(e=tt(i)?new ke(i):new ke(i.date,i.dir,i.unit,i.task,null,i.calendar),i.id&&(e.task=i),e.dir=i.dir||"any",e.unit=i.unit||t.config.duration_unit,!St(e.date))throw t.assert(!1,"Invalid date argument for getClosestWorkTime method"),new Error("Invalid date argument for getClosestWorkTime method");return e},_getStartEndConfig:function(n){var e,i=xi;if(n instanceof i)return n;if(tt(n)?e=new i(arguments[0],arguments[1],arguments[2],arguments[3]):(e=new i(n.start_date,n.end_date,n.task),n.id!==null&&n.id!==void 0&&(e.task=n)),e.unit=e.unit||t.config.duration_unit,e.step=e.step||t.config.duration_step,e.start_date=e.start_date||e.start||e.date,!St(e.start_date))throw t.assert(!1,"Invalid start_date argument for getDuration method"),new Error("Invalid start_date argument for getDuration method");if(!St(e.end_date))throw t.assert(!1,"Invalid end_date argument for getDuration method"),new Error("Invalid end_date argument for getDuration method");return e},getDurationArguments:function(n,e,i,a){return this._getStartEndConfig.apply(this,arguments)},hasDurationArguments:function(n,e,i,a){return this._getStartEndConfig.apply(this,arguments)},calculateEndDateArguments:function(n,e,i,a){var s,r=arguments[0];if(r instanceof ye)return r;if(s=tt(r)?new ye(arguments[0],arguments[1],arguments[2],void 0,arguments[3],void 0,arguments[4]):new ye(r.start_date,r.duration,r.unit,r.step,r.task,null,r.calendar),r.id!==null&&r.id!==void 0&&(s.task=r,s.unit=null,s.step=null),s.unit=s.unit||t.config.duration_unit,s.step=s.step||t.config.duration_step,!St(s.start_date))throw t.assert(!1,"Invalid start_date argument for calculateEndDate method"),new Error("Invalid start_date argument for calculateEndDate method");return s}}};function sn(){}sn.prototype={_getIntervals:function(t){for(var n=[],e=0;e<t.length;e+=2)n.push({start:t[e],end:t[e+1]});return n},_toHoursArray:function(t){var n=[];function e(a){var s,r=Math.floor(a/3600),o=a-60*r*60,l=Math.floor(o/60);return r+":"+((s=String(l)).length<2&&(s="0"+s),s)}for(var i=0;i<t.length;i++)n.push(e(t[i].start)+"-"+e(t[i].end));return n},_intersectHourRanges:function(t,n){var e=[],i=t.length>n.length?t:n,a=t===i?n:t;i=i.slice(),a=a.slice(),e=[];for(var s=0;s<i.length;s++)for(var r=i[s],o=0;o<a.length;o++){var l=a[o];l.start<r.end&&l.end>r.start&&(e.push({start:Math.max(r.start,l.start),end:Math.min(r.end,l.end)}),r.end>l.end&&(a.splice(o,1),o--,s--))}return e},_mergeAdjacentIntervals:function(t){var n=t.slice();n.sort(function(s,r){return s.start-r.start});for(var e=n[0],i=1;i<n.length;i++){var a=n[i];a.start<=e.end?(a.end>e.end&&(e.end=a.end),n.splice(i,1),i--):e=a}return n},_mergeHoursConfig:function(t,n){return this._mergeAdjacentIntervals(this._intersectHourRanges(t,n))},merge:function(t,n){const e=K(t.getConfig()),i=K(n.getConfig()),a=e.parsed,s=i.parsed;a.customWeeks=e.customWeeks,s.customWeeks=i.customWeeks;var r={hours:this._toHoursArray(this._mergeHoursConfig(a.hours,s.hours)),dates:{},customWeeks:{}};const o=(d,c)=>{for(let u in d.dates){const h=d.dates[u];+u>1e3&&(r.dates[u]=!1);for(const _ in c.dates){const f=c.dates[_];if(_==u&&(r.dates[u]=!(!h||!f)),Array.isArray(h)){const y=Array.isArray(f)?f:c.hours;r.dates[u]=this._toHoursArray(this._mergeHoursConfig(h,y))}}}};if(o(a,s),o(s,a),a.customWeeks)for(var l in a.customWeeks)r.customWeeks[l]=a.customWeeks[l];if(s.customWeeks)for(var l in s.customWeeks)r.customWeeks[l]?r.customWeeks[l+"_second"]=s.customWeeks[l]:r.customWeeks[l]=s.customWeeks[l];return r}};class $i{constructor(){this.clear()}getItem(n,e,i){if(this._cache.has(n)){const a=this._cache.get(n)[i.getFullYear()];if(a&&a.has(e))return a.get(e)}return-1}setItem(n,e,i,a){if(!n||!e)return;const s=this._cache,r=a.getFullYear();let o;s.has(n)?o=s.get(n):(o=[],s.set(n,o));let l=o[r];l||(l=o[r]=new Map),l.set(e,i)}clear(){this._cache=new Map}}class wi{constructor(){this.clear()}getItem(n,e,i){const a=this._cache;if(a&&a[n]){const s=a[n];if(s===void 0)return-1;const r=s[i.getFullYear()];if(r&&r[e]!==void 0)return r[e]}return-1}setItem(n,e,i,a){if(!n||!e)return;const s=this._cache;if(!s)return;s[n]||(s[n]=[]);const r=s[n],o=a.getFullYear();let l=r[o];l||(l=r[o]={}),l[e]=i}clear(){this._cache={}}}class Si{constructor(n){this.getMinutesPerWeek=e=>{const i=e.valueOf();if(this._weekCache.has(i))return this._weekCache.get(i);const a=this._calendar,s=this._calendar.$gantt;let r=0,o=s.date.week_start(new Date(e));for(let l=0;l<7;l++)r+=60*a.getHoursPerDay(o),o=s.date.add(o,1,"day");return this._weekCache.set(i,r),r},this.getMinutesPerMonth=e=>{const i=e.valueOf();if(this._monthCache.has(i))return this._monthCache.get(i);const a=this._calendar,s=this._calendar.$gantt;let r=0,o=s.date.week_start(new Date(e));const l=s.date.add(o,1,"month").valueOf();for(;o.valueOf()<l;)r+=60*a.getHoursPerDay(o),o=s.date.add(o,1,"day");return this._monthCache.set(i,r),r},this.clear=()=>{this._weekCache=new Map,this._monthCache=new Map},this.clear(),this._calendar=n}}class Ti{constructor(){this.clear()}_getCacheObject(n,e,i){const a=this._cache;a[e]||(a[e]=[]);let s=a[e];s||(s=a[e]={});let r=s[i];r||(r=s[i]={});const o=n.getFullYear();let l=r[o];return l||(l=r[o]={durations:{},endDates:{}}),l}_endDateCacheKey(n,e){return String(n)+"-"+String(e)}_durationCacheKey(n,e){return String(n)+"-"+String(e)}getEndDate(n,e,i,a,s){const r=this._getCacheObject(n,i,a),o=n.valueOf(),l=this._endDateCacheKey(o,e);let d;if(r.endDates[l]===void 0){const c=s(),u=c.valueOf();r.endDates[l]=u,r.durations[this._durationCacheKey(o,u)]=e,d=c}else d=new Date(r.endDates[l]);return d}getDuration(n,e,i,a,s){const r=this._getCacheObject(n,i,a),o=n.valueOf(),l=e.valueOf(),d=this._durationCacheKey(o,l);let c;if(r.durations[d]===void 0){const u=s();r.durations[d]=u.valueOf(),c=u}else c=r.durations[d];return c}clear(){this._cache={}}}function be(t,n){this.argumentsHelper=n,this.$gantt=t,this._workingUnitsCache=typeof Map<"u"?new $i:new wi,this._largeUnitsCache=new Si(this),this._dateDurationCache=new Ti,this._worktime=null,this._cached_timestamps={},this._cached_timestamps_count=0}be.prototype={units:["year","month","week","day","hour","minute"],_clearCaches:function(){this._workingUnitsCache.clear(),this._largeUnitsCache.clear(),this._dateDurationCache.clear()},_getUnitOrder:function(t){for(var n=0,e=this.units.length;n<e;n++)if(this.units[n]==t)return n},_resetTimestampCache:function(){this._cached_timestamps={},this._cached_timestamps_count=0},_timestamp:function(t){this._cached_timestamps_count>1e6&&this._resetTimestampCache();var n=null;if(t.day||t.day===0)n=t.day;else if(t.date){var e=String(t.date.valueOf());this._cached_timestamps[e]?n=this._cached_timestamps[e]:(n=Date.UTC(t.date.getFullYear(),t.date.getMonth(),t.date.getDate()),this._cached_timestamps[e]=n,this._cached_timestamps_count++)}return n},_checkIfWorkingUnit:function(t,n){if(!this["_is_work_"+n]){const e=this.$gantt.date[`${n}_start`](new Date(t)),i=this.$gantt.date.add(e,1,n);return this.hasDuration(e,i)}return this["_is_work_"+n](t)},_is_work_day:function(t){var n=this._getWorkHours(t);return!!Array.isArray(n)&&n.length>0},_is_work_hour:function(t){for(var n=this._getWorkHours(t),e=t.getHours(),i=0;i<n.length;i++)if(e>=n[i].startHour&&e<n[i].endHour)return!0;return!1},_getTimeOfDayStamp:function(t,n){var e=t.getHours();return t.getHours()||t.getMinutes()||!n||(e=24),60*e*60+60*t.getMinutes()},_is_work_minute:function(t){for(var n=this._getWorkHours(t),e=this._getTimeOfDayStamp(t),i=0;i<n.length;i++)if(e>=n[i].start&&e<n[i].end)return!0;return!1},_nextDate:function(t,n,e){return this.$gantt.date.add(t,e,n)},_getWorkUnitsBetweenGeneric:function(t,n,e,i){var a=this.$gantt.date,s=new Date(t),r=new Date(n);i=i||1;var o,l,d=0,c=null,u=!1;(o=a[e+"_start"](new Date(s))).valueOf()!=s.valueOf()&&(u=!0);var h=!1;(l=a[e+"_start"](new Date(n))).valueOf()!=n.valueOf()&&(h=!0);for(var _=!1;s.valueOf()<r.valueOf();){if(_=(c=this._nextDate(s,e,i)).valueOf()>r.valueOf(),this._isWorkTime(s,e))(u||h&&_)&&(o=a[e+"_start"](new Date(s)),l=a.add(o,i,e)),u?(u=!1,c=this._nextDate(o,e,i),d+=(l.valueOf()-s.valueOf())/(l.valueOf()-o.valueOf())):h&&_?(h=!1,d+=(r.valueOf()-s.valueOf())/(l.valueOf()-o.valueOf())):d++;else{var f=this._getUnitOrder(e),y=this.units[f-1];y&&!this._isWorkTime(s,y)&&(c=this._getClosestWorkTimeFuture(s,y))}s=c}return d},_getMinutesPerHour:function(t){var n=this._getTimeOfDayStamp(t),e=this._getTimeOfDayStamp(this._nextDate(t,"hour",1));e===0&&(e=86400);for(var i=this._getWorkHours(t),a=0;a<i.length;a++){var s=i[a];if(n>=s.start&&e<=s.end)return 60;if(n<s.end&&e>s.start)return(Math.min(e,s.end)-Math.max(n,s.start))/60}return 0},_getMinutesPerDay:function(t){var n=this._getWorkHours(t),e=0;return n.forEach(function(i){e+=i.durationMinutes}),e},getHoursPerDay:function(t){var n=this._getWorkHours(t),e=0;return n.forEach(function(i){e+=i.durationHours}),e},_getWorkUnitsForRange:function(t,n,e,i){var a,s=0,r=new Date(t),o=new Date(n);for(a=O(e=="minute"?this._getMinutesPerDay:this.getHoursPerDay,this);r.valueOf()<o.valueOf();)if(o-r>27648e5&&r.getDate()===0){var l=this._largeUnitsCache.getMinutesPerMonth(r);e=="hour"&&(l/=60),s+=l,r=this.$gantt.date.add(r,1,"month")}else{if(o-r>13824e5){var d=this.$gantt.date.week_start(new Date(r));if(r.valueOf()===d.valueOf()){l=this._largeUnitsCache.getMinutesPerWeek(r),e=="hour"&&(l/=60),s+=l,r=this.$gantt.date.add(r,7,"day");continue}}s+=a(r),r=this._nextDate(r,"day",1)}return s/i},_getMinutesBetweenSingleDay:function(t,n){for(var e=this._getIntervalTimestamp(t,n),i=this._getWorkHours(t),a=0,s=0;s<i.length;s++){var r=i[s];if(e.end>=r.start&&e.start<=r.end){var o=Math.max(r.start,e.start),l=Math.min(r.end,e.end);a+=(l-o)/60,e.start=l}}return Math.floor(a)},_getMinutesBetween:function(t,n,e,i){var a=new Date(t),s=new Date(n);i=i||1;var r=new Date(a),o=this.$gantt.date.add(this.$gantt.date.day_start(new Date(a)),1,"day");if(s.valueOf()<=o.valueOf())return this._getMinutesBetweenSingleDay(t,n);var l=this.$gantt.date.day_start(new Date(s)),d=s,c=this._getMinutesBetweenSingleDay(r,o),u=this._getMinutesBetweenSingleDay(l,d);return c+this._getWorkUnitsForRange(o,l,e,i)+u},_getHoursBetween:function(t,n,e,i){var a=new Date(t),s=new Date(n);i=i||1;var r=new Date(a),o=this.$gantt.date.add(this.$gantt.date.day_start(new Date(a)),1,"day");if(s.valueOf()<=o.valueOf())return Math.round(this._getMinutesBetweenSingleDay(t,n)/60);var l=this.$gantt.date.day_start(new Date(s)),d=s,c=this._getMinutesBetweenSingleDay(r,o,e,i)/60,u=this._getMinutesBetweenSingleDay(l,d,e,i)/60,h=c+this._getWorkUnitsForRange(o,l,e,i)+u;return Math.round(h)},getConfig:function(){return this._worktime},_setConfig:function(t){this._worktime=t,this._parseSettings(),this._clearCaches()},_parseSettings:function(){var t=this.getConfig();for(var n in t.parsed={dates:{},hours:null,haveCustomWeeks:!1,customWeeks:{},customWeeksRangeStart:null,customWeeksRangeEnd:null,customWeeksBoundaries:[]},t.parsed.hours=this._parseHours(t.hours),t.dates)t.parsed.dates[n]=this._parseHours(t.dates[n]);if(t.customWeeks){var e=null,i=null;for(var n in t.customWeeks){var a=t.customWeeks[n];if(a.from&&a.to){var s=a.from,r=a.to;(!e||e>s.valueOf())&&(e=s.valueOf()),(!i||i<r.valueOf())&&(i=r.valueOf()),t.parsed.customWeeksBoundaries.push({from:s.valueOf(),fromReadable:new Date(s),to:r.valueOf(),toReadable:new Date(r),name:n}),t.parsed.haveCustomWeeks=!0;var o=t.parsed.customWeeks[n]={from:a.from,to:a.to,hours:this._parseHours(a.hours),dates:{}};if(a.days&&!a.dates){for(a.dates=a.dates||{},n=0;n<a.days.length;n++)a.dates[n]=a.days[n],a.days[n]instanceof Array||(a.dates[n]=!!a.days[n]);delete a.days}for(var l in a.dates)o.dates[l]=this._parseHours(a.dates[l])}}t.parsed.customWeeksRangeStart=e,t.parsed.customWeeksRangeEnd=i}},_tryChangeCalendarSettings:function(t){var n=JSON.stringify(this.getConfig());return t(),!!this.hasWorkTime()||(this._setConfig(JSON.parse(n)),this._clearCaches(),!1)},_arraysEqual:function(t,n){if(t===n)return!0;if(!t||!n||t.length!=n.length)return!1;for(var e=0;e<t.length;++e)if(t[e]!==n[e])return!1;return!0},_compareSettings:function(t,n){if(!this._arraysEqual(t.hours,n.hours))return!1;var e=Object.keys(t.dates),i=Object.keys(n.dates);if(e.sort(),i.sort(),!this._arraysEqual(e,i))return!1;for(var a=0;a<e.length;a++){var s=e[a],r=t.dates[s],o=t.dates[s];if(r!==o&&!(Array.isArray(r)&&Array.isArray(o)&&this._arraysEqual(r,o)))return!1}return!0},equals:function(t){if(!(t instanceof be))return!1;var n=this.getConfig(),e=t.getConfig();if(!this._compareSettings(n,e))return!1;if(n.parsed.haveCustomWeeks&&e.parsed.haveCustomWeeks){if(n.parsed.customWeeksBoundaries.length!=e.parsed.customWeeksBoundaries.length)return!1;for(var i in n.parsed.customWeeks){var a=n.parsed.customWeeks[i],s=e.parsed.customWeeks[i];if(!s||!this._compareSettings(a,s))return!1}}else if(n.parse.haveCustomWeeks!==e.parsed.haveCustomWeeks)return!1;return!0},getWorkHours:function(){var t=this.argumentsHelper.getWorkHoursArguments.apply(this.argumentsHelper,arguments);return this._getWorkHours(t.date,!1)},_getWorkHours:function(t,n){var e=this.getConfig();if(n!==!1&&(e=e.parsed),!t)return e.hours;const i=new Date(t.getFullYear(),t.getMonth(),t.getDate());var a=this._timestamp({date:i});if(e.haveCustomWeeks&&e.customWeeksRangeStart<=a&&e.customWeeksRangeEnd>a){for(var s=0;s<e.customWeeksBoundaries.length;s++)if(e.customWeeksBoundaries[s].from<=a&&e.customWeeksBoundaries[s].to>a){e=e.customWeeks[e.customWeeksBoundaries[s].name];break}}var r=!0;return e.dates[a]!==void 0?r=e.dates[a]:e.dates[t.getDay()]!==void 0&&(r=e.dates[t.getDay()]),r===!0?e.hours:r||[]},_getIntervalTimestamp:function(t,n){var e={start:0,end:0};e.start=60*t.getHours()*60+60*t.getMinutes()+t.getSeconds();var i=n.getHours();return!i&&!n.getMinutes()&&!n.getSeconds()&&t.valueOf()<n.valueOf()&&(i=24),e.end=60*i*60+60*n.getMinutes()+n.getSeconds(),e},_parseHours:function(t){if(Array.isArray(t)){var n=[];t.forEach(function(o){typeof o=="number"?n.push(60*o*60):typeof o=="string"&&o.split("-").map(function(l){return l.trim()}).forEach(function(l){var d=l.split(":").map(function(u){return u.trim()}),c=parseInt(60*d[0]*60);d[1]&&(c+=parseInt(60*d[1])),d[2]&&(c+=parseInt(d[2])),n.push(c)})});for(var e=[],i=0;i<n.length;i+=2){var a=n[i],s=n[i+1],r=s-a;e.push({start:a,end:s,startHour:Math.floor(a/3600),startMinute:Math.floor(a/60),endHour:Math.ceil(s/3600),endMinute:Math.ceil(s/60),durationSeconds:r,durationMinutes:r/60,durationHours:r/3600})}return e}return t},setWorkTime:function(t){return this._tryChangeCalendarSettings(O(function(){var n=t.hours===void 0||t.hours,e=this._timestamp(t),i=this.getConfig();if(e!==null?i.dates[e]=n:t.customWeeks||(i.hours=n),t.customWeeks){if(i.customWeeks||(i.customWeeks={}),typeof t.customWeeks=="string")e!==null?i.customWeeks[t.customWeeks].dates[e]=n:t.customWeeks||(i.customWeeks[t.customWeeks].hours=n);else if(typeof t.customWeeks=="object"&&t.customWeeks.constructor===Object)for(var a in t.customWeeks)i.customWeeks[a]=t.customWeeks[a]}this._parseSettings(),this._clearCaches()},this))},unsetWorkTime:function(t){return this._tryChangeCalendarSettings(O(function(){if(t){var n=this._timestamp(t);n!==null&&delete this.getConfig().dates[n]}else this.reset_calendar();this._parseSettings(),this._clearCaches()},this))},_isWorkTime:function(t,n){var e,i=-1;return e=String(t.valueOf()),(i=this._workingUnitsCache.getItem(n,e,t))==-1&&(i=this._checkIfWorkingUnit(t,n),this._workingUnitsCache.setItem(n,e,i,t)),i},isWorkTime:function(){var t=this.argumentsHelper.isWorkTimeArguments.apply(this.argumentsHelper,arguments);return this._isWorkTime(t.date,t.unit)},calculateDuration:function(){var t=this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper,arguments);if(!t.unit)return!1;var n=this;return this._dateDurationCache.getDuration(t.start_date,t.end_date,t.unit,t.step,function(){return n._calculateDuration(t.start_date,t.end_date,t.unit,t.step)})},_calculateDuration:function(t,n,e,i){var a=0,s=1;if(t.valueOf()>n.valueOf()){var r=n;n=t,t=r,s=-1}return a=e=="hour"&&i==1?this._getHoursBetween(t,n,e,i):e=="minute"&&i==1?this._getMinutesBetween(t,n,e,i):this._getWorkUnitsBetweenGeneric(t,n,e,i),s*Math.round(a)},hasDuration:function(){var t=this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper,arguments),n=t.start_date,e=t.end_date,i=t.unit,a=t.step;if(!i)return!1;var s=new Date(n),r=new Date(e);for(a=a||1;s.valueOf()<r.valueOf();){if(this._isWorkTime(s,i))return!0;s=this._nextDate(s,i,a)}return!1},calculateEndDate:function(){var t=this.argumentsHelper.calculateEndDateArguments.apply(this.argumentsHelper,arguments),n=t.start_date,e=t.duration,i=t.unit,a=t.step;if(!i)return!1;var s=t.duration>=0?1:-1;e=Math.abs(1*e);var r=this;return this._dateDurationCache.getEndDate(n,e,i,a*s,function(){return r._calculateEndDate(n,e,i,a*s)})},_calculateEndDate:function(t,n,e,i){return!!e&&(i==1&&e=="minute"?this._calculateMinuteEndDate(t,n,i):i==-1&&e=="minute"?this._subtractMinuteDate(t,n,i):i==1&&e=="hour"?this._calculateHourEndDate(t,n,i):this._addInterval(t,n,e,i,null).end)},_addInterval:function(t,n,e,i,a){for(var s=0,r=t,o=!1;s<n&&(!a||!a(r));){var l=this._nextDate(r,e,i);e=="day"&&(o=o||!r.getHours()&&l.getHours())&&(l.setHours(0),l.getHours()||(o=!1));var d=new Date(l.valueOf()+1);i>0&&(d=new Date(l.valueOf()-1)),this._isWorkTime(d,e)&&!o&&s++,r=l}return{end:r,start:t,added:s}},_addHoursUntilDayEnd:function(t,n){for(var e=this.$gantt.date.add(this.$gantt.date.day_start(new Date(t)),1,"day"),i=0,a=n,s=this._getIntervalTimestamp(t,e),r=this._getWorkHours(t),o=0;o<r.length&&i<n;o++){var l=r[o];if(s.end>=l.start&&s.start<=l.end){var d=Math.max(l.start,s.start),c=Math.min(l.end,s.end),u=(c-d)/3600;u>a&&(u=a,c=d+60*a*60);var h=Math.round((c-d)/3600);i+=h,a-=h,s.start=c}}var _=e;return i===n&&(_=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,s.start)),{added:i,end:_}},_calculateHourEndDate:function(t,n,e){var i=new Date(t),a=0;e=e||1,n=Math.abs(1*n);var s=this._addHoursUntilDayEnd(i,n);if(a=s.added,i=s.end,d=n-a){for(var r=i;a<n;){var o=this._nextDate(r,"day",e);o.setHours(0),o.setMinutes(0),o.setSeconds(0);var l=0;if(a+(l=e>0?this.getHoursPerDay(new Date(o.valueOf()-1)):this.getHoursPerDay(new Date(o.valueOf()+1)))>=n)break;a+=l,r=o}i=r}if(a<n){var d=n-a;i=(s=this._addHoursUntilDayEnd(i,d)).end}return i},_addMinutesUntilHourEnd:function(t,n){if(t.getMinutes()===0)return{added:0,end:new Date(t)};for(var e=this.$gantt.date.add(this.$gantt.date.hour_start(new Date(t)),1,"hour"),i=0,a=n,s=this._getIntervalTimestamp(t,e),r=this._getWorkHours(t),o=0;o<r.length&&i<n;o++){var l=r[o];if(s.end>=l.start&&s.start<=l.end){var d=Math.max(l.start,s.start),c=Math.min(l.end,s.end),u=(c-d)/60;u>a&&(u=a,c=d+60*a);var h=Math.round((c-d)/60);a-=h,i+=h,s.start=c}}var _=e;return i===n&&(_=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,s.start)),{added:i,end:_}},_subtractMinutesUntilHourStart:function(t,n){for(var e=this.$gantt.date.hour_start(new Date(t)),i=0,a=n,s=60*e.getHours()*60+60*e.getMinutes()+e.getSeconds(),r=60*t.getHours()*60+60*t.getMinutes()+t.getSeconds(),o=this._getWorkHours(t),l=o.length-1;l>=0&&i<n;l--){var d=o[l];if(r>d.start&&s<=d.end){var c=Math.min(r,d.end),u=Math.max(s,d.start),h=(c-u)/60;h>a&&(h=a,u=c-60*a);var _=Math.abs(Math.round((c-u)/60));a-=_,i+=_,r=u}}var f=e;return i===n&&(f=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,r)),{added:i,end:f}},_subtractMinuteDate:function(t,n,e){var i=this.getClosestWorkTime({date:t,dir:"past",unit:"minute"}),a=0;e=e||-1,n=Math.abs(1*n),n=Math.round(n);const s=this._isMinutePrecision(i);let r=this._subtractMinutesUntilHourStart(i,n);a+=r.added,i=r.end;for(var o=0,l=[],d=0;a<n;){var c=this.$gantt.date.day_start(new Date(i)),u=!1;i.valueOf()===c.valueOf()&&(c=this.$gantt.date.add(c,-1,"day"),u=!0);var h=new Date(c.getFullYear(),c.getMonth(),c.getDate(),23,59,59,999).valueOf();h!==o&&(l=this._getWorkHours(c),d=this._getMinutesPerDay(c),o=h);var _=n-a,f=this._getTimeOfDayStamp(i,u);if(l.length&&d)if(l[l.length-1].end<=f&&_>d)a+=d,i=this.$gantt.date.add(i,-1,"day");else{for(var y=!1,v=null,b=null,m=l.length-1;m>=0;m--)if(l[m].start<f-1&&l[m].end>=f-1){y=!0,v=l[m],b=l[m-1];break}if(y)if(f===v.end&&_>=v.durationMinutes)a+=v.durationMinutes,i=this.$gantt.date.add(i,-v.durationMinutes,"minute");else if(!s&&_<=f/60-v.startMinute)a+=_,i=this.$gantt.date.add(i,-_,"minute");else if(s)_<=f/60-v.startMinute?(a+=_,i=this.$gantt.date.add(i,-_,"minute")):(a+=f/60-v.startMinute,i=b?new Date(i.getFullYear(),i.getMonth(),i.getDate(),0,0,b.end):this.$gantt.date.day_start(i));else{var g=this._getMinutesPerHour(i);g<=_?(a+=g,i=this._nextDate(i,"hour",e)):(r=this._subtractMinutesUntilHourStart(i,_),a+=r.added,i=r.end)}else if(i.getHours()===0&&i.getMinutes()===0&&i.getSeconds()===0){if((p=this._getClosestWorkTimePast(i,"hour")).valueOf()===i.valueOf()){var p=this.$gantt.date.add(i,-1,"day"),k=this._getWorkHours(p);if(k.length){var x=k[k.length-1];p.setSeconds(x.durationSeconds)}}i=p}else i=this._getClosestWorkTimePast(new Date(i-1),"hour")}else i=this.$gantt.date.add(i,-1,"day")}if(a<n){var w=n-a;r=this._subtractMinutesUntilHourStart(i,w),a+=r.added,i=r.end}return i},_calculateMinuteEndDate:function(t,n,e){var i=new Date(t),a=0;e=e||1,n=Math.abs(1*n),n=Math.round(n);var s=this._addMinutesUntilHourEnd(i,n);a+=s.added,i=s.end;for(var r=0,o=[],l=0,d=this._isMinutePrecision(i);a<n;){var c=this.$gantt.date.day_start(new Date(i)).valueOf();c!==r&&(o=this._getWorkHours(i),l=this._getMinutesPerDay(i),r=c);var u=n-a,h=this._getTimeOfDayStamp(i);if(o.length&&l)if(o[0].start>=h&&u>=l){if(a+=l,u==l){i=new Date(i.getFullYear(),i.getMonth(),i.getDate(),0,0,o[o.length-1].end);break}i=this.$gantt.date.add(i,1,"day"),i=this.$gantt.date.day_start(i)}else{for(var _=!1,f=null,y=0;y<o.length;y++)if(o[y].start<=h&&o[y].end>h){_=!0,f=o[y];break}if(_)if(h===f.start&&u>=f.durationMinutes)a+=f.durationMinutes,i=this.$gantt.date.add(i,f.durationMinutes,"minute");else if(u<=f.endMinute-h/60)a+=u,i=this.$gantt.date.add(i,u,"minute");else{var v=this._getMinutesPerHour(i);v<=u?(a+=v,i=d?this.$gantt.date.add(i,v,"minute"):this._nextDate(i,"hour",e)):(a+=(s=this._addMinutesUntilHourEnd(i,u)).added,i=s.end)}else i=this._getClosestWorkTimeFuture(i,"hour")}else i=this.$gantt.date.add(this.$gantt.date.day_start(i),1,"day")}if(a<n){var b=n-a;a+=(s=this._addMinutesUntilHourEnd(i,b)).added,i=s.end}return i},getClosestWorkTime:function(){var t=this.argumentsHelper.getClosestWorkTimeArguments.apply(this.argumentsHelper,arguments);return this._getClosestWorkTime(t.date,t.unit,t.dir)},_getClosestWorkTime:function(t,n,e){var i=new Date(t);if(this._isWorkTime(i,n))return i;if(i=this.$gantt.date[n+"_start"](i),e!="any"&&e)i=e=="past"?this._getClosestWorkTimePast(i,n):this._getClosestWorkTimeFuture(i,n);else{var a=this._getClosestWorkTimeFuture(i,n),s=this._getClosestWorkTimePast(i,n);i=Math.abs(a-t)<=Math.abs(t-s)?a:s}return i},_getClosestWorkTimeFuture:function(t,n){return this._getClosestWorkTimeGeneric(t,n,1)},_getClosestWorkTimePast:function(t,n){var e=this._getClosestWorkTimeGeneric(t,n,-1);return this.$gantt.date.add(e,1,n)},_findClosestTimeInDay:function(t,n,e){var i=new Date(t),a=null,s=!1;this._getWorkHours(i).length||(i=this._getClosestWorkTime(i,"day",n<0?"past":"future"),n<0&&(i=new Date(i.valueOf()-1),s=!0),e=this._getWorkHours(i));var r=this._getTimeOfDayStamp(i);if(s&&(r=this._getTimeOfDayStamp(new Date(i.valueOf()+1),s)),n>0){for(var o=0;o<e.length;o++)if(e[o].start>=r){a=new Date(i.getFullYear(),i.getMonth(),i.getDate(),0,0,e[o].start);break}}else for(o=e.length-1;o>=0;o--){if(e[o].end<=r){a=new Date(i.getFullYear(),i.getMonth(),i.getDate(),0,0,e[o].end);break}if(e[o].end>r&&e[o].start<=r){a=new Date(i.getFullYear(),i.getMonth(),i.getDate(),0,0,r);break}}return a},_getClosestWorkMinute:function(t,n,e){var i=new Date(t),a=this._getWorkHours(i),s=this._findClosestTimeInDay(i,e,a);return s||(e>0?(i=this.calculateEndDate(i,e,n),i=this.$gantt.date.day_start(i)):(i=this.calculateEndDate(i,e,"day"),i=this.$gantt.date.day_start(i),i=this.$gantt.date.add(i,1,"day"),i=new Date(i.valueOf()-1)),a=this._getWorkHours(i),s=this._findClosestTimeInDay(i,e,a)),e<0&&(s=this.$gantt.date.add(s,-1,n)),s},_getClosestWorkTimeGeneric:function(t,n,e){if(n==="hour"||n==="minute")return this._getClosestWorkMinute(t,n,e);for(var i=this._getUnitOrder(n),a=this.units[i-1],s=t,r=0;!this._isWorkTime(s,n)&&(!a||this._isWorkTime(s,a)||(s=e>0?this._getClosestWorkTimeFuture(s,a):this._getClosestWorkTimePast(s,a),!this._isWorkTime(s,n)));){if(++r>3e3)return this.$gantt.assert(!1,"Invalid working time check"),!1;var o=s.getTimezoneOffset();s=this.$gantt.date.add(s,e,n),s=this.$gantt._correct_dst_change(s,o,e,n),this.$gantt.date[n+"_start"]&&(s=this.$gantt.date[n+"_start"](s))}return s},hasWorkTime:function(){var t=this.getConfig(),n=t.dates;for(var e in t.dates);var i=this._checkWorkHours(t.hours),a=!1;return[0,1,2,3,4,5,6].forEach((function(s){if(!a){var r=n[s];r===!0?a=i:Array.isArray(r)&&(a=this._checkWorkHours(r))}}).bind(this)),a},_checkWorkHours:function(t){if(t.length===0)return!1;for(var n=!1,e=0;e<t.length;e+=2)t[e]!==t[e+1]&&(n=!0);return n},_isMinutePrecision:function(t){let n=!1;return this._getWorkHours(t).forEach(function(e){(e.startMinute%60||e.endMinute%60)&&(n=!0)}),n}};const Nt={isLegacyResourceCalendarFormat:function(t){if(!t)return!1;for(var n in t)if(t[n]&&typeof t[n]=="object")return!0;return!1},getResourceProperty:function(t){var n=t.resource_calendars,e=t.resource_property;if(this.isLegacyResourceCalendarFormat(n))for(var i in t){e=i;break}return e},getCalendarIdFromLegacyConfig:function(t,n){if(n)for(var e in n){var i=n[e];if(t[e]){var a=i[t[e]];if(a)return a}}return null}},Ci=(Jt={},{getCalendarIdFromMultipleResources:function(t,n){var e=function(a){return a.map(function(s){return s&&s.resource_id?s.resource_id:s}).sort().join("-")}(t);if(t.length){if(t.length===1)return n.getResourceCalendar(e).id;if(Jt[e])return Jt[e].id;var i=function(a,s){return s.mergeCalendars(a.map(function(r){var o=r&&r.resource_id?r.resource_id:r;return s.getResourceCalendar(o)}))}(t,n);return Jt[e]=i,n.addCalendar(i)}return null}});var Jt;function rn(t){this.$gantt=t,this._calendars={},this._legacyConfig=void 0,this.$gantt.attachEvent("onGanttReady",(function(){this.$gantt.config.resource_calendars&&(this._isLegacyConfig=Nt.isLegacyResourceCalendarFormat(this.$gantt.config.resource_calendars))}).bind(this)),this.$gantt.attachEvent("onBeforeGanttReady",(function(){this.createDefaultCalendars()}).bind(this)),this.$gantt.attachEvent("onBeforeGanttRender",(function(){this.createDefaultCalendars()}).bind(this))}function xe(t,n){this.argumentsHelper=n,this.$gantt=t}function on(t){this.$gantt=t.$gantt,this.argumentsHelper=an(this.$gantt),this.calendarManager=t,this.$disabledCalendar=new xe(this.$gantt,this.argumentsHelper)}rn.prototype={_calendars:{},_convertWorkTimeSettings:function(t){const n=t.days;if(typeof n!="object"||Array.isArray(n)||n===null){if(n&&!t.dates){t.dates=t.dates||{};for(let e=0;e<n.length;e++)t.dates[e]=n[e],n[e]instanceof Array||(t.dates[e]=!!n[e])}}else{const e={};if(n!=null&&n.weekdays)for(let i=0;i<7;i++)e[i]=n.weekdays[i];n!=null&&n.dates&&Object.entries(n.dates).forEach(([i,a])=>{e[new Date(i).valueOf()]=a}),Object.entries(e).forEach(([i,a])=>{a instanceof Array||(e[i]=!!a)}),t={...t,dates:e}}return delete t.days,t},mergeCalendars:function(){var t=[],n=arguments;if(Array.isArray(n[0]))t=n[0].slice();else for(var e=0;e<arguments.length;e++)t.push(arguments[e]);var i,a=new sn;return t.forEach((function(s){i=i?this._createCalendarFromConfig(a.merge(i,s)):s}).bind(this)),this.createCalendar(i)},_createCalendarFromConfig:function(t){var n=new be(this.$gantt,an(this.$gantt));n.id=String(ot());var e=this._convertWorkTimeSettings(t);if(e.customWeeks)for(var i in e.customWeeks)e.customWeeks[i]=this._convertWorkTimeSettings(e.customWeeks[i]);return n._setConfig(e),n},createCalendar:function(t){var n;return t||(t={}),R(n=t.getConfig?K(t.getConfig()):t.worktime?K(t.worktime):K(t),K(this.defaults.fulltime.worktime)),this._createCalendarFromConfig(n)},getCalendar:function(t){t=t||"global";var n=this._calendars[t];return n||(this.createDefaultCalendars(),n=this._calendars[t]),n},getCalendars:function(){var t=[];for(var n in this._calendars)t.push(this.getCalendar(n));return t},_getOwnCalendar:function(t){var n=this.$gantt.config;if(t[n.calendar_property])return this.getCalendar(t[n.calendar_property]);if(n.resource_calendars){var e;if(e=this._legacyConfig===!1?n.resource_property:Nt.getResourceProperty(n),Array.isArray(t[e])&&t[e].length)n.dynamic_resource_calendars?i=Ci.getCalendarIdFromMultipleResources(t[e],this):a=this.getResourceCalendar(t[e]);else if(this._legacyConfig===void 0&&(this._legacyConfig=Nt.isLegacyResourceCalendarFormat(n.resource_calendars)),this._legacyConfig)var i=Nt.getCalendarIdFromLegacyConfig(t,n.resource_calendars);else if(e&&t[e]&&n.resource_calendars[t[e]])var a=this.getResourceCalendar(t[e]);if(i&&(a=this.getCalendar(i)),a)return a}return null},getResourceCalendar:function(t){if(t==null)return this.getCalendar();var n=null;n=typeof t=="number"||typeof t=="string"?t:t.id||t.key;var e=this.$gantt.config,i=e.resource_calendars,a=null;if(Array.isArray(t)&&t.length===1&&(n=typeof t[0]=="object"?t[0].resource_id:t[0]),i){if(this._legacyConfig===void 0&&(this._legacyConfig=Nt.isLegacyResourceCalendarFormat(e.resource_calendars)),this._legacyConfig){for(var s in i)if(i[s][n]){a=i[s][n];break}}else a=i[n];if(a)return this.getCalendar(a)}return this.getCalendar()},getTaskCalendar:function(t){var n,e=this.$gantt;if(t==null)return this.getCalendar();if(!(n=typeof t!="number"&&typeof t!="string"||!e.isTaskExists(t)?t:e.getTask(t)))return this.getCalendar();var i=this._getOwnCalendar(n),a=!!e.getState().group_mode;if(!i&&e.config.inherit_calendar&&e.isTaskExists(n.parent)){for(var s=n;e.isTaskExists(s.parent)&&(s=e.getTask(s.parent),!e.isSummaryTask(s)||!(i=this._getOwnCalendar(s))););a&&!i&&t.$effective_calendar&&(i=this.getCalendar(t.$effective_calendar))}return i||this.getCalendar()},addCalendar:function(t){if(!this.isCalendar(t)){var n=t.id;(t=this.createCalendar(t)).id=n}if(t._tryChangeCalendarSettings(function(){})){var e=this.$gantt.config;return t.id=t.id||ot(),this._calendars[t.id]=t,e.worktimes||(e.worktimes={}),e.worktimes[t.id]=t.getConfig(),t.id}return this.$gantt.callEvent("onCalendarError",[{message:"Invalid calendar settings, no worktime available"},t]),null},deleteCalendar:function(t){var n=this.$gantt.config;return!!t&&!!this._calendars[t]&&(delete this._calendars[t],n.worktimes&&n.worktimes[t]&&delete n.worktimes[t],!0)},restoreConfigCalendars:function(t){for(var n in t)if(!this._calendars[n]){var e=t[n],i=this.createCalendar(e);i.id=n,this.addCalendar(i)}},defaults:{global:{id:"global",worktime:{hours:[8,12,13,17],days:[0,1,1,1,1,1,0]}},fulltime:{id:"fulltime",worktime:{hours:[0,24],days:[1,1,1,1,1,1,1]}}},createDefaultCalendars:function(){var t=this.$gantt.config;this.restoreConfigCalendars(this.defaults),this.restoreConfigCalendars(t.worktimes)},isCalendar:function(t){return[t.isWorkTime,t.setWorkTime,t.getWorkHours,t.unsetWorkTime,t.getClosestWorkTime,t.calculateDuration,t.hasDuration,t.calculateEndDate].every(function(n){return n instanceof Function})}},xe.prototype={getWorkHours:function(){return[0,24]},setWorkTime:function(){return!0},unsetWorkTime:function(){return!0},isWorkTime:function(){return!0},getClosestWorkTime:function(t){return this.argumentsHelper.getClosestWorkTimeArguments.apply(this.argumentsHelper,arguments).date},calculateDuration:function(){var t=this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper,arguments),n=t.start_date,e=t.end_date,i=t.unit,a=t.step;return this._calculateDuration(n,e,i,a)},_calculateDuration:function(t,n,e,i){var a=this.$gantt.date,s={week:6048e5,day:864e5,hour:36e5,minute:6e4},r=0;if(s[e])r=Math.round((n-t)/(i*s[e]));else{for(var o=new Date(t),l=new Date(n);o.valueOf()<l.valueOf();)r+=1,o=a.add(o,i,e);o.valueOf()!=n.valueOf()&&(r+=(l-o)/(a.add(o,i,e)-o))}return Math.round(r)},hasDuration:function(){var t=this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper,arguments),n=t.start_date,e=t.end_date;return!!t.unit&&(n=new Date(n),e=new Date(e),n.valueOf()<e.valueOf())},hasWorkTime:function(){return!0},equals:function(t){return t instanceof xe},calculateEndDate:function(){var t=this.argumentsHelper.calculateEndDateArguments.apply(this.argumentsHelper,arguments),n=t.start_date,e=t.duration,i=t.unit,a=t.step;return this.$gantt.date.add(n,a*e,i)}},on.prototype={_getCalendar:function(t){var n;if(this.$gantt.config.work_time){var e=this.calendarManager;t.task?n=e.getTaskCalendar(t.task):t.id?n=e.getTaskCalendar(t):t.calendar&&(n=t.calendar),n||(n=e.getTaskCalendar())}else n=this.$disabledCalendar;return n},getWorkHours:function(t){return t=this.argumentsHelper.getWorkHoursArguments.apply(this.argumentsHelper,arguments),this._getCalendar(t).getWorkHours(t.date)},setWorkTime:function(t,n){return t=this.argumentsHelper.setWorkTimeArguments.apply(this.argumentsHelper,arguments),n||(n=this.calendarManager.getCalendar()),n.setWorkTime(t)},unsetWorkTime:function(t,n){return t=this.argumentsHelper.unsetWorkTimeArguments.apply(this.argumentsHelper,arguments),n||(n=this.calendarManager.getCalendar()),n.unsetWorkTime(t)},isWorkTime:function(t,n,e,i){var a=this.argumentsHelper.isWorkTimeArguments.apply(this.argumentsHelper,arguments);return(i=this._getCalendar(a)).isWorkTime(a)},getClosestWorkTime:function(t){return t=this.argumentsHelper.getClosestWorkTimeArguments.apply(this.argumentsHelper,arguments),this._getCalendar(t).getClosestWorkTime(t)},calculateDuration:function(){var t=this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper,arguments);return this._getCalendar(t).calculateDuration(t)},hasDuration:function(){var t=this.argumentsHelper.hasDurationArguments.apply(this.argumentsHelper,arguments);return this._getCalendar(t).hasDuration(t)},calculateEndDate:function(t){return t=this.argumentsHelper.calculateEndDateArguments.apply(this.argumentsHelper,arguments),this._getCalendar(t).calculateEndDate(t)}};const Ei=function(t,n){return{getWorkHours:function(e){return n.getWorkHours(e)},setWorkTime:function(e){return n.setWorkTime(e)},unsetWorkTime:function(e){n.unsetWorkTime(e)},isWorkTime:function(e,i,a){return n.isWorkTime(e,i,a)},getClosestWorkTime:function(e){return n.getClosestWorkTime(e)},calculateDuration:function(e,i,a){return n.calculateDuration(e,i,a)},_hasDuration:function(e,i,a){return n.hasDuration(e,i,a)},calculateEndDate:function(e,i,a,s){return n.calculateEndDate(e,i,a,s)},mergeCalendars:O(t.mergeCalendars,t),createCalendar:O(t.createCalendar,t),addCalendar:O(t.addCalendar,t),getCalendar:O(t.getCalendar,t),getCalendars:O(t.getCalendars,t),getResourceCalendar:O(t.getResourceCalendar,t),getTaskCalendar:O(t.getTaskCalendar,t),deleteCalendar:O(t.deleteCalendar,t)}};function Di(t){t.isUnscheduledTask=function(r){return t.assert(r&&r instanceof Object,"Invalid argument <b>task</b>="+r+" of gantt.isUnscheduledTask. Task object was expected"),!!r.unscheduled||!r.start_date},t._isAllowedUnscheduledTask=function(r){return!(!r.unscheduled||!t.config.show_unscheduled)},t._isTaskInTimelineLimits=function(r){var o=r.start_date?r.start_date.valueOf():null,l=r.end_date?r.end_date.valueOf():null;return!!(o&&l&&o<=this._max_date.valueOf()&&l>=this._min_date.valueOf())},t.isTaskVisible=function(r){if(!this.isTaskExists(r))return!1;var o=this.getTask(r);return!(!this._isAllowedUnscheduledTask(o)&&!this._isTaskInTimelineLimits(o))&&this.getGlobalTaskIndex(r)>=0},t._getProjectEnd=function(){if(t.config.project_end)return t.config.project_end;var r=t.getTaskByTime();return(r=r.sort(function(o,l){return+o.end_date>+l.end_date?1:-1})).length?r[r.length-1].end_date:null},t._getProjectStart=function(){if(t.config.project_start)return t.config.project_start;if(t.config.start_date)return t.config.start_date;if(t.getState().min_date)return t.getState().min_date;var r=t.getTaskByTime();return(r=r.sort(function(o,l){return+o.start_date>+l.start_date?1:-1})).length?r[0].start_date:null};var n=function(r,o){var l=!!(o&&o!=t.config.root_id&&t.isTaskExists(o))&&t.getTask(o),d=null;if(l)if(t._getAutoSchedulingConfig().schedule_from_end)d=t.calculateEndDate({start_date:l.end_date,duration:-t.config.duration_step,task:r});else{if(!l.start_date)return n(l,t.getParent(l));d=l.start_date}else if(t._getAutoSchedulingConfig().schedule_from_end)d=t.calculateEndDate({start_date:t._getProjectEnd(),duration:-t.config.duration_step,task:r});else{const c=t.getTaskByIndex(0),u=t.config.start_date||t.getState().min_date;d=c?c.start_date?c.start_date:c.end_date?t.calculateEndDate({start_date:c.end_date,duration:-t.config.duration_step,task:r}):u:u}return t.assert(d,"Invalid dates"),new Date(d)};t._set_default_task_timing=function(r){r.start_date=r.start_date||n(r,t.getParent(r)),r.duration=r.duration||t.config.duration_step,r.end_date=r.end_date||t.calculateEndDate(r)},t.createTask=function(r,o,l){if(r=r||{},t.defined(r.id)||(r.id=t.uid()),r.start_date||(r.start_date=n(r,o)),r.text===void 0&&(r.text=t.locale.labels.new_task),r.duration===void 0&&(r.duration=1),this.isTaskExists(o)){this.setParent(r,o,!0);var d=this.getTask(o);d.$open=!0,this.config.details_on_create||this.callEvent("onAfterParentExpand",[o,d])}return this.callEvent("onTaskCreated",[r])?(this.config.details_on_create?(t.isTaskExists(r.id)?t.getTask(r.id).$index!=r.$index&&(r.start_date&&typeof r.start_date=="string"&&(r.start_date=this.date.parseDate(r.start_date,"parse_date")),r.end_date&&typeof r.end_date=="string"&&(r.end_date=this.date.parseDate(r.end_date,"parse_date")),this.$data.tasksStore.updateItem(r.id,r)):(r.$new=!0,this.silent(function(){t.$data.tasksStore.addItem(r,l)})),this.selectTask(r.id),this.refreshData(),this.showLightbox(r.id)):this.addTask(r,o,l)&&(this.showTask(r.id),this.selectTask(r.id)),r.id):null},t._update_flags=function(r,o){var l=t.$data.tasksStore;r===void 0?(this._lightbox_id=null,l.silent(function(){l.unselect()}),this.getSelectedTasks&&this._multiselect.reset(),this._tasks_dnd&&this._tasks_dnd.drag&&(this._tasks_dnd.drag.id=null)):(this._lightbox_id==r&&(this._lightbox_id=o),l.getSelectedId()==r&&l.silent(function(){l.unselect(r),l.select(o)}),this._tasks_dnd&&this._tasks_dnd.drag&&this._tasks_dnd.drag.id==r&&(this._tasks_dnd.drag.id=o))};var e=function(r,o){var l=t.getTaskType(r.type),d={type:l,$no_start:!1,$no_end:!1,scheduled_summary:!1};return l===t.config.types.project&&r.auto_scheduling===!1&&(d.scheduled_summary=!0),o||l!=r.$rendered_type?(l==t.config.types.project?d.$no_end=d.$no_start=!0:l!=t.config.types.milestone&&(d.$no_end=!(r.end_date||r.duration),d.$no_start=!r.start_date,t._isAllowedUnscheduledTask(r)&&(d.$no_end=d.$no_start=!1)),d):(d.$no_start=r.$no_start,d.$no_end=r.$no_end,d)};function i(r){r.$effective_calendar=t.getTaskCalendar(r).id,r.start_date=t.getClosestWorkTime({dir:"future",date:r.start_date,unit:t.config.duration_unit,task:r}),r.end_date=t.calculateEndDate(r)}function a(r,o,l,d){const c={start:"start_date",end:"end_date"},u={start:"$auto_start_date",end:"$auto_end_date"};let h;h=r.type===t.config.types.project&&r.auto_scheduling===!1?u:c,o.$no_start&&(r[h.start]=l?new Date(l):n(r,this.getParent(r))),o.$no_end&&(r[h.end]=d?new Date(d):this.calculateEndDate({start_date:r[h.start],duration:this.config.duration_step,task:r})),(o.$no_start||o.$no_end)&&this._init_task_timing(r)}function s(r){let o=null,l=null,d=r!==void 0?r:t.config.root_id;const c=[],u=[];let h=null;return t.isTaskExists(d)&&(h=t.getTask(d)),t.eachTask(function(_){const f=t.getTaskType(_.type)==t.config.types.project&&_.auto_scheduling===!1;t.getTaskType(_.type)==t.config.types.project&&!f||t.isUnscheduledTask(_)||(_.rollup&&c.push(_.id),!_.start_date||_.$no_start&&!f||o&&!(o>_.start_date.valueOf())||(o=_.start_date.valueOf()),!_.end_date||_.$no_end&&!f||l&&!(l<_.end_date.valueOf())||(l=_.end_date.valueOf()),h&&h.render=="split"&&(_.split_placement==="inline"?u.push(_):_.split_placement==="subrow"||h.$open&&t.config.open_split_tasks||u.push(_)))},d),{start_date:o?new Date(o):null,end_date:l?new Date(l):null,rollup:c,splitItems:u}}t._init_task_timing=function(r){var o=e(r,!0),l=r.$rendered_type!=o.type,d=o.type;l&&(r.$no_start=o.$no_start,r.$no_end=o.$no_end,r.$rendered_type=o.type),l&&d!=this.config.types.milestone&&d==this.config.types.project&&(this._set_default_task_timing(r),r.$calculate_duration=!1),d==this.config.types.milestone&&(r.end_date=r.start_date),r.start_date&&r.end_date&&r.$calculate_duration!==!1&&(r.duration=this.calculateDuration(r)),r.$calculate_duration||(r.$calculate_duration=!0),r.end_date||(r.end_date=r.start_date),r.duration=r.duration||0,this.config.min_duration===0&&r.duration===0&&(r.$no_end=!1,r.type===t.config.types.project&&t.hasChild(r.id)&&(r.$no_end=!0));var c=this.getTaskCalendar(r);r.$effective_calendar&&r.$effective_calendar!==c.id&&(i(r),this.config.inherit_calendar&&this.isSummaryTask(r)&&this.eachTask(function(u){i(u)},r.id)),r.$effective_calendar=c.id},t.isSummaryTask=function(r){t.assert(r&&r instanceof Object,"Invalid argument <b>task</b>="+r+" of gantt.isSummaryTask. Task object was expected");var o=e(r);return!(!o.$no_end&&!o.$no_start)},t.resetProjectDates=function(r){var o=e(r);if(o.$no_end||o.$no_start){var l=s(r.id);a.call(this,r,o,l.start_date,l.end_date),r.$rollup=l.rollup,r.$inlineSplit=l.splitItems}},t.getSubtaskDuration=function(r){var o=0,l=r!==void 0?r:t.config.root_id;return this.eachTask(function(d){this.getTaskType(d.type)==t.config.types.project||this.isUnscheduledTask(d)||(o+=d.duration)},l),o},t.getSubtaskDates=function(r){var o=s(r);return{start_date:o.start_date,end_date:o.end_date}},t._update_parents=function(r,o,l){if(r){var d=this.getTask(r);d.rollup&&(l=!0);var c=this.getParent(d),u=e(d),h=!0;if(l||d.start_date&&d.end_date&&(u.$no_start||u.$no_end)){const y=d.$auto_start_date?"$auto_start_date":"start_date",v=d.$auto_end_date?"$auto_end_date":"end_date";var _=d[y].valueOf(),f=d[v].valueOf();t.resetProjectDates(d),l||_!=d[y].valueOf()||f!=d[v].valueOf()||(h=!1),h&&!o&&this.refreshTask(d.id,!0),u.scheduled_summary&&(h=!0)}h&&c&&this.isTaskExists(c)&&this._update_parents(c,o,l)}},t.roundDate=function(r){var o=t.getScale();tt(r)&&(r={date:r,unit:o?o.unit:t.config.duration_unit,step:o?o.step:t.config.duration_step});var l,d,c,u=r.date,h=r.step,_=r.unit;if(!o)return u;if(_==o.unit&&h==o.step&&+u>=+o.min_date&&+u<=+o.max_date)c=Math.floor(t.columnIndexByDate(u)),o.trace_x[c]||(c-=1,o.rtl&&(c=0)),d=new Date(o.trace_x[c]),l=t.date.add(d,h,_);else{for(c=Math.floor(t.columnIndexByDate(u)),l=t.date[_+"_start"](new Date(o.min_date)),o.trace_x[c]&&(l=t.date[_+"_start"](o.trace_x[c]));+l<+u;){var f=(l=t.date[_+"_start"](t.date.add(l,h,_))).getTimezoneOffset();l=t._correct_dst_change(l,f,l,_),t.date[_+"_start"]&&(l=t.date[_+"_start"](l))}d=t.date.add(l,-1*h,_)}return r.dir&&r.dir=="future"?l:r.dir&&r.dir=="past"||Math.abs(u-d)<Math.abs(l-u)?d:l},t.correctTaskWorkTime=function(r){t.config.work_time&&t.config.correct_work_time&&(this.isWorkTime(r.start_date,void 0,r)?this.isWorkTime(new Date(+r.end_date-1),void 0,r)||(r.end_date=this.calculateEndDate(r)):(r.start_date=this.getClosestWorkTime({date:r.start_date,dir:"future",task:r}),r.end_date=this.calculateEndDate(r)))},t.attachEvent("onBeforeTaskUpdate",function(r,o){return t._init_task_timing(o),!0}),t.attachEvent("onBeforeTaskAdd",function(r,o){return t._init_task_timing(o),!0}),t.attachEvent("onAfterTaskMove",function(r,o,l){return t._init_task_timing(t.getTask(r)),!0})}function ln(t,n){var e,i=t.config.container_resize_timeout||20;let a=dn(t);if(t.config.container_resize_method=="timeout")l();else try{t.event(n,"resize",function(){if(t.$scrollbarRepaint)t.$scrollbarRepaint=null;else{let d=dn(t);if(a.x==d.x&&a.y==d.y)return;a=d,s()}})}catch{l()}function s(){clearTimeout(e),e=setTimeout(function(){t.$destroyed||t.render()},i)}var r=t.$root.offsetHeight,o=t.$root.offsetWidth;function l(){t.$root.offsetHeight==r&&t.$root.offsetWidth==o||s(),r=t.$root.offsetHeight,o=t.$root.offsetWidth,setTimeout(l,i)}}function dn(t){return{x:t.$root.offsetWidth,y:t.$root.offsetHeight}}function Ai(t){t.assert=function(s){return function(r,o){r||s.config.show_errors&&s.callEvent("onError",[o])!==!1&&(s.message?s.message({type:"error",text:o,expire:-1}):console.log(o))}}(t);var n="Invalid value of the first argument of `gantt.init`. Supported values: HTMLElement, String (element id).This error means that either invalid object is passed into `gantt.init` or that the element with the specified ID doesn't exist on the page when `gantt.init` is called.";function e(s){if(!s||typeof s=="string"&&document.getElementById(s)||function(r){try{r.cloneNode(!1)}catch{return!1}return!0}(s))return!0;throw t.assert(!1,n),new Error(n)}t.init=function(s,r,o){t.env.isNode?s=null:e(s),r&&o&&(this.config.start_date=this._min_date=new Date(r),this.config.end_date=this._max_date=new Date(o)),this.date.init(),this.init=function(l){t.env.isNode?l=null:e(l),this.$container&&this.$container.parentNode&&(this.$container.parentNode.removeChild(this.$container),this.$container=null),this.$layout&&this.$layout.clear(),this._reinit(l)},this._reinit(s)},t._quickRefresh=function(s){for(var r=this._getDatastores.call(this),o=0;o<r.length;o++)r[o]._quick_refresh=!0;for(s(),o=0;o<r.length;o++)r[o]._quick_refresh=!1};var i=(function(){this._clearTaskLayers&&this._clearTaskLayers(),this._clearLinkLayers&&this._clearLinkLayers(),this.$layout&&(this.$layout.destructor(),this.$layout=null,this.$ui.reset())}).bind(t),a=(function(){Y(t)||(this.$root.innerHTML="",this.$root.gantt=this,fe(this),this.config.layout.id="main",this.$layout=this.$ui.createView("layout",this.$root,this.config.layout),this.$layout.attachEvent("onBeforeResize",function(){for(var s=t.$services.getService("datastores"),r=0;r<s.length;r++)t.getDatastore(s[r]).filter(),t.$data.tasksStore._skipTaskRecalculation?t.$data.tasksStore._skipTaskRecalculation!="lightbox"&&(t.$data.tasksStore._skipTaskRecalculation=!1):t.getDatastore(s[r]).callEvent("onBeforeRefreshAll",[])}),this.$layout.attachEvent("onResize",function(){t._quickRefresh(function(){t.refreshData()})}),this.callEvent("onGanttLayoutReady",[]),this.$layout.render(),this.$container=this.$layout.$container.firstChild,function(s){window.getComputedStyle(s.$root).getPropertyValue("position")=="static"&&(s.$root.style.position="relative");var r=document.createElement("iframe");r.className="gantt_container_resize_watcher",r.tabIndex=-1,s.config.wai_aria_attributes&&(r.setAttribute("role","none"),r.setAttribute("aria-hidden",!0)),s.env.isSalesforce&&(s.config.container_resize_method="timeout"),s.$root.appendChild(r),r.contentWindow?ln(s,r.contentWindow):(s.$root.removeChild(r),ln(s,window))}(this))}).bind(t);t.resetLayout=function(){i(),a(),this.render()},t._reinit=function(s){this.callEvent("onBeforeGanttReady",[]),this._update_flags(),this.$services.getService("templateLoader").initTemplates(this),i(),this.$root=null,s&&(this.$root=re(s),a(),this.$mouseEvents.reset(this.$root),function(r){r.$container&&!r.config.autosize&&r.$root.offsetHeight<50&&console.warn(`The Gantt container has a small height, so you cannot see its content. If it is not intended, you need to set the 'height' style rule to the container:
https://docs.dhtmlx.com/gantt/faq.html#theganttchartisntrenderedcorrectly`)}(t)),this.callEvent("onTemplatesReady",[]),this.callEvent("onGanttReady",[]),this.render()},t.$click={buttons:{edit:function(s){t.isReadonly(t.getTask(s))||t.showLightbox(s)},delete:function(s){var r=t.getTask(s);if(!t.isReadonly(r)){var o=t.locale.labels.confirm_deleting,l=t.locale.labels.confirm_deleting_title;t._delete_task_confirm({task:r,message:o,title:l,callback:function(){t.isTaskExists(s)&&(r.$new?(t.$data.tasksStore._skipTaskRecalculation="lightbox",t.silent(function(){t.deleteTask(s,!0)}),t.$data.tasksStore._skipTaskRecalculation=!1,t.refreshData()):(t.$data.tasksStore._skipTaskRecalculation=!0,t.deleteTask(s))),t.hideLightbox()}})}}}},t.render=function(){var s;if(this.callEvent("onBeforeGanttRender",[]),!Y(t)){!this.config.sort&&this._sort&&(this._sort=void 0),this.$root&&(this.config.rtl?(this.$root.classList.add("gantt_rtl"),this.$root.firstChild.classList.add("gantt_rtl")):(this.$root.classList.remove("gantt_rtl"),this.$root.firstChild.classList.remove("gantt_rtl")));var r=this.getScrollState(),o=r?r.x:0;this._getHorizontalScrollbar()&&(o=this._getHorizontalScrollbar().$config.codeScrollLeft||o||0),s=null,o&&(s=t.dateFromPos(o+this.config.task_scroll_offset))}if(fe(this),Y(t))t.refreshData();else{this.$layout.$config.autosize=this.config.autosize;var l=this.config.preserve_scroll;if(this.config.preserve_scroll=!1,this.$layout.resize(),this.config.preserve_scroll=l,this.config.preserve_scroll&&r){const u=t.ext.zoom._initialized;if((o||r.y)&&!u){var d=t.getScrollState();if(+s!=+t.dateFromPos(d.x)||d.y!=r.y){o=null;var c=null;s&&(o=Math.max(t.posFromDate(s)-t.config.task_scroll_offset,0)),r.y&&(c=r.y),t.scrollTo(o,c)}}this.$layout.getScrollbarsInfo().forEach(h=>{const _=t.$ui.getView(h.id),f=t.utils.dom.isChildOf(_.$view,t.$container);h.boundViews.forEach(y=>{const v=t.$ui.getView(y);h.y&&h.y!=r.y&&v&&!f&&v.scrollTo(void 0,0),h.x_pos&&h.x_pos!=r.x&&v&&f&&v.scrollTo(h.x_pos,void 0)})})}}this.callEvent("onGanttRender",[])},t.setSizes=t.render,t.getTaskRowNode=function(s){for(var r=this.$grid_data.childNodes,o=this.config.task_attribute,l=0;l<r.length;l++)if(r[l].getAttribute&&r[l].getAttribute(o)==s)return r[l];return null},t.changeLightboxType=function(s){if(this.getLightboxType()==s)return!0;t._silent_redraw_lightbox(s)},t._get_link_type=function(s,r){var o=null;return s&&r?o=t.config.links.start_to_start:!s&&r?o=t.config.links.finish_to_start:s||r?s&&!r&&(o=t.config.links.start_to_finish):o=t.config.links.finish_to_finish,o},t.isLinkAllowed=function(s,r,o,l){var d=null;if(!(d=typeof s=="object"?s:{source:s,target:r,type:this._get_link_type(o,l)})||!(d.source&&d.target&&d.type)||d.source==d.target)return!1;var c=!0;return this.checkEvent("onLinkValidation")&&(c=this.callEvent("onLinkValidation",[d])),c},t._correct_dst_change=function(s,r,o,l){var d=Ft(l)*o;if(d>3600&&d<86400){var c=s.getTimezoneOffset()-r;c&&(s=t.date.add(s,c,"minute"))}return s},t.isSplitTask=function(s){return t.assert(s&&s instanceof Object,"Invalid argument <b>task</b>="+s+" of gantt.isSplitTask. Task object was expected"),this.$data.tasksStore._isSplitItem(s)},t._is_icon_open_click=function(s){if(!s)return!1;var r=s.target||s.srcElement;if(!r||!r.className)return!1;var o=Z(r);return o.indexOf("gantt_tree_icon")!==-1&&(o.indexOf("gantt_close")!==-1||o.indexOf("gantt_open")!==-1)}}const Ii={date:{month_full:[" ","","","","","","","",""," "," "," "],month_short:["","","","","","","","","","","",""],day_full:["","","","","","",""],day_short:["","","","","","",""]},labels:{new_task:" ",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"  ,   ",confirm_deleting:"       ",section_description:"",section_time:" ",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Mi={date:{month_full:["","","","","Ma","","","","","","",""],month_short:["","","","","Ma","","","","","","",""],day_full:["","","","","","",""],day_short:["","","","","","",""]},labels:{new_task:" ",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"",confirm_deleting:"   , ?",section_description:"",section_time:" ",section_type:"",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"",column_text:"",column_start_date:"",column_duration:"",column_add:"",link:"",confirm_link_deleting:" ",link_start:"()",link_end:"()",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"ii",hours:"i",days:"",weeks:"",months:"",years:"",message_ok:"OK",message_cancel:"",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Ni={date:{month_full:["Gener","Febrer","Mar","Abril","Maig","Juny","Juliol","Agost","Setembre","Octubre","Novembre","Desembre"],month_short:["Gen","Feb","Mar","Abr","Mai","Jun","Jul","Ago","Set","Oct","Nov","Des"],day_full:["Diumenge","Dilluns","Dimarts","Dimecres","Dijous","Divendres","Dissabte"],day_short:["Dg","Dl","Dm","Dc","Dj","Dv","Ds"]},labels:{new_task:"Nova tasca",icon_save:"Guardar",icon_cancel:"Cancellar",icon_details:"Detalls",icon_edit:"Editar",icon_delete:"Esborrar",confirm_closing:"",confirm_deleting:"L'esdeveniment s'esborrar definitivament, continuar ?",section_description:"Descripci",section_time:"Periode de temps",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Cancellar",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Li={date:{month_full:["","","","","","","","","","","",""],month_short:["1","2","3","4","5","6","7","8","9","10","11","12"],day_full:["","","","","","",""],day_short:["","","","","","",""]},labels:{new_task:"",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"!",confirm_deleting:"?",section_description:"",section_time:"",section_type:"",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"",column_text:"",column_start_date:"",column_duration:"",column_add:"",link:"",confirm_link_deleting:"",link_start:" ()",link_end:" ()",type_task:"",type_project:"",type_milestone:"",minutes:"",hours:"",days:"",weeks:"",months:"",years:"",message_ok:"OK",message_cancel:"",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Ri={date:{month_full:["Leden","nor","Bezen","Duben","Kvten","erven","ervenec","Srpen","Z","jen","Listopad","Prosinec"],month_short:["Led","n","Be","Dub","Kv","er","ec","Srp","Z","j","List","Pro"],day_full:["Nedle","Pondl","ter","Steda","tvrtek","Ptek","Sobota"],day_short:["Ne","Po","t","St","t","P","So"]},labels:{new_task:"Nov prce",icon_save:"Uloit",icon_cancel:"Zpt",icon_details:"Detail",icon_edit:"Edituj",icon_delete:"Smazat",confirm_closing:"",confirm_deleting:"Udlost bude trvale smazna, opravdu?",section_description:"Poznmky",section_time:"Doba platnosti",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Zpt",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Pi={date:{month_full:["Januar","Februar","Marts","April","Maj","Juni","Juli","August","September","Oktober","November","December"],month_short:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],day_full:["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag"],day_short:["Sn","Man","Tir","Ons","Tor","Fre","Lr"]},labels:{new_task:"Ny opgave",icon_save:"Gem",icon_cancel:"Fortryd",icon_details:"Detaljer",icon_edit:"Tilret",icon_delete:"Slet",confirm_closing:"Dine rettelser vil g tabt.. Er dy sikker?",confirm_deleting:"Bigivenheden vil blive slettet permanent. Er du sikker?",section_description:"Beskrivelse",section_time:"Tidsperiode",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Fortryd",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Hi={date:{month_full:[" Januar"," Februar"," Mrz "," April"," Mai"," Juni"," Juli"," August"," September "," Oktober"," November "," Dezember"],month_short:["Jan","Feb","Mr","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],day_full:["Sonntag","Montag","Dienstag"," Mittwoch"," Donnerstag","Freitag","Samstag"],day_short:["So","Mo","Di","Mi","Do","Fr","Sa"]},labels:{new_task:"Neue Aufgabe",icon_save:"Speichern",icon_cancel:"Abbrechen",icon_details:"Details",icon_edit:"ndern",icon_delete:"Lschen",confirm_closing:"",confirm_deleting:"Der Eintrag wird gelscht",section_description:"Beschreibung",section_time:"Zeitspanne",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"PSP",column_text:"Task-Namen",column_start_date:"Startzeit",column_duration:"Dauer",column_add:"",link:"Link",confirm_link_deleting:"werden gelscht",link_start:"(starten)",link_end:"(ende)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minuten",hours:"Stunden",days:"Tage",weeks:"Wochen",months:"Monate",years:"Jahre",message_ok:"OK",message_cancel:"Abbrechen",section_constraint:"Regel",constraint_type:"Regel",constraint_date:"Regel - Datum",asap:"So bald wie mglich",alap:"So spt wie mglich",snet:"Beginn nicht vor",snlt:"Beginn nicht spter als",fnet:"Fertigstellung nicht vor",fnlt:"Fertigstellung nicht spter als",mso:"Muss beginnen am",mfo:"Muss fertig sein am",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Oi={date:{month_full:["","","","","","","","","","","",""],month_short:["","","","","","","","","","","",""],day_full:["","","","","","",""],day_short:["","","","","","",""]},labels:{new_task:" ",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"",confirm_deleting:"    .   ;",section_description:"",section_time:" ",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Bi={date:{month_full:["January","February","March","April","May","June","July","August","September","October","November","December"],month_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],day_full:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],day_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},labels:{new_task:"New task",icon_save:"Save",icon_cancel:"Cancel",icon_details:"Details",icon_edit:"Edit",icon_delete:"Delete",confirm_closing:"",confirm_deleting:"Task will be deleted permanently, are you sure?",section_description:"Description",section_time:"Time period",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Cancel",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},zi={date:{month_full:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],month_short:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],day_full:["Domingo","Lunes","Martes","Mircoles","Jueves","Viernes","Sbado"],day_short:["Dom","Lun","Mar","Mi","Jue","Vie","Sb"]},labels:{new_task:"Nueva tarea",icon_save:"Guardar",icon_cancel:"Cancelar",icon_details:"Detalles",icon_edit:"Editar",icon_delete:"Eliminar",confirm_closing:"",confirm_deleting:"El evento se borrar definitivamente, continuar?",section_description:"Descripcin",section_time:"Perodo",section_type:"Tipo",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"EDT",column_text:"Tarea",column_start_date:"Inicio",column_duration:"Duracin",column_add:"",link:"Enlace",confirm_link_deleting:"ser borrada",link_start:" (inicio)",link_end:" (fin)",type_task:"Tarea",type_project:"Proyecto",type_milestone:"Hito",minutes:"Minutos",hours:"Horas",days:"Das",weeks:"Semanas",months:"Meses",years:"Aos",message_ok:"OK",message_cancel:"Cancelar",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},ji={date:{month_full:["","","","","","","","","","","",""],month_short:["1","2","3","4","5","6","7","8","9","10","11","12"],day_full:["","","","","","",""],day_short:["","","","","","",""]},labels:{new_task:" ",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"       ",confirm_deleting:"         ",section_description:"",section_time:" ",section_type:"",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"",column_start_date:" ",column_duration:"",column_add:"",link:"",confirm_link_deleting:"  ",link_start:" ()",link_end:" ()",type_task:"",type_project:"",type_milestone:"",minutes:"",hours:"",days:"",weeks:"",months:"",years:"",message_ok:"",message_cancel:"",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Wi={date:{month_full:["Tammikuu","Helmikuu","Maaliskuu","Huhtikuu","Toukokuu","Kes&auml;kuu","Hein&auml;kuu","Elokuu","Syyskuu","Lokakuu","Marraskuu","Joulukuu"],month_short:["Tam","Hel","Maa","Huh","Tou","Kes","Hei","Elo","Syy","Lok","Mar","Jou"],day_full:["Sunnuntai","Maanantai","Tiistai","Keskiviikko","Torstai","Perjantai","Lauantai"],day_short:["Su","Ma","Ti","Ke","To","Pe","La"]},labels:{new_task:"Uusi tehtv",icon_save:"Tallenna",icon_cancel:"Peru",icon_details:"Tiedot",icon_edit:"Muokkaa",icon_delete:"Poista",confirm_closing:"",confirm_deleting:"Haluatko varmasti poistaa tapahtuman?",section_description:"Kuvaus",section_time:"Aikajakso",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Peru",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Fi={date:{month_full:["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"],month_short:["Jan","Fv","Mar","Avr","Mai","Juin","Juil","Ao","Sep","Oct","Nov","Dc"],day_full:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],day_short:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"]},labels:{new_task:"Nouvelle tche",icon_save:"Enregistrer",icon_cancel:"Annuler",icon_details:"Dtails",icon_edit:"Modifier",icon_delete:"Effacer",confirm_closing:"",confirm_deleting:"L'vnement sera effac sans appel, tes-vous sr ?",section_description:"Description",section_time:"Priode",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"OTP",column_text:"Nom de la tche",column_start_date:"Date initiale",column_duration:"Dure",column_add:"",link:"Le lien",confirm_link_deleting:"sera supprim",link_start:"(dbut)",link_end:"(fin)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Heures",days:"Jours",weeks:"Semaines",months:"Mois",years:"Annes",message_ok:"OK",message_cancel:"Annuler",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Vi={date:{month_full:["","","","","","","","","","","",""],month_short:["","","","","","","","","","","",""],day_full:["","","","","","",""],day_short:["","","","","","",""]},labels:{new_task:" ",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"",confirm_deleting:"  .?",section_description:"",section_time:"",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Ui={date:{month_full:["Sijeanj","Veljaa","Oujak","Travanj","Svibanj","Lipanj","Srpanj","Kolovoz","Rujan","Listopad","Studeni","Prosinac"],month_short:["Sij","Velj","Ou","Tra","Svi","Lip","Srp","Kol","Ruj","Lis","Stu","Pro"],day_full:["Nedjelja","Ponedjeljak","Utorak","Srijeda","etvrtak","Petak","Subota"],day_short:["Ned","Pon","Uto","Sri","et","Pet","Sub"]},labels:{new_task:"Novi Zadatak",icon_save:"Spremi",icon_cancel:"Odustani",icon_details:"Detalji",icon_edit:"Izmjeni",icon_delete:"Obrii",confirm_closing:"",confirm_deleting:"Zadatak e biti trajno izbrisan, jeste li sigurni?",section_description:"Opis",section_time:"Vremenski Period",section_type:"Tip",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"Naziv Zadatka",column_start_date:"Poetno Vrijeme",column_duration:"Trajanje",column_add:"",link:"Poveznica",confirm_link_deleting:"e biti izbrisan",link_start:" (poetak)",link_end:" (kraj)",type_task:"Zadatak",type_project:"Projekt",type_milestone:"Milestone",minutes:"Minute",hours:"Sati",days:"Dani",weeks:"Tjedni",months:"Mjeseci",years:"Godine",message_ok:"OK",message_cancel:"Odustani",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},qi={date:{month_full:["Janur","Februr","Mrcius","prilis","Mjus","Jnius","Jlius","Augusztus","Szeptember","Oktber","November","December"],month_short:["Jan","Feb","Mr","pr","Mj","Jn","Jl","Aug","Sep","Okt","Nov","Dec"],day_full:["Vasrnap","Htf","Kedd","Szerda","Cstrtk","Pntek","szombat"],day_short:["Va","H","Ke","Sze","Cs","P","Szo"]},labels:{new_task:"j feladat",icon_save:"Ments",icon_cancel:"Mgse",icon_details:"Rszletek",icon_edit:"Szerkeszts",icon_delete:"Trls",confirm_closing:"",confirm_deleting:"Az esemny trlve lesz, biztosan folytatja?",section_description:"Lers",section_time:"Idszak",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Mgse",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Gi={date:{month_full:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],month_short:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Ags","Sep","Okt","Nov","Des"],day_full:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],day_short:["Ming","Sen","Sel","Rab","Kam","Jum","Sab"]},labels:{new_task:"Tugas baru",icon_save:"Simpan",icon_cancel:"Batal",icon_details:"Detail",icon_edit:"Edit",icon_delete:"Hapus",confirm_closing:"",confirm_deleting:"Acara akan dihapus",section_description:"Keterangan",section_time:"Periode",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Batal",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Yi={date:{month_full:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],month_short:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],day_full:["Domenica","Luned","Marted","Mercoled","Gioved","Venerd","Sabato"],day_short:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"]},labels:{new_task:"Nuovo compito",icon_save:"Salva",icon_cancel:"Chiudi",icon_details:"Dettagli",icon_edit:"Modifica",icon_delete:"Elimina",confirm_closing:"",confirm_deleting:"Sei sicuro di confermare l'eliminazione?",section_description:"Descrizione",section_time:"Periodo di tempo",section_type:"Tipo",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"Nome Attivit",column_start_date:"Inizio",column_duration:"Durata",column_add:"",link:"Link",confirm_link_deleting:"sar eliminato",link_start:" (inizio)",link_end:" (fine)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minuti",hours:"Ore",days:"Giorni",weeks:"Settimane",months:"Mesi",years:"Anni",message_ok:"OK",message_cancel:"Chiudi",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Ji={date:{month_full:["1","2","3","4","5","6","7","8","9","10","11","12"],month_short:["1","2","3","4","5","6","7","8","9","10","11","12"],day_full:["","","","","","",""],day_short:["","","","","","",""]},labels:{new_task:"",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"",confirm_deleting:"",section_description:"",section_time:"",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Ki={date:{month_full:["1","2","3","4","5","6","7","8","9","10","11","12"],month_short:["1","2","3","4","5","6","7","8","9","10","11","12"],day_full:["","","","","","",""],day_short:["","","","","","",""]},labels:{new_task:" ",icon_save:"",icon_cancel:"",icon_details:" ",icon_edit:"",icon_delete:"",confirm_closing:"",confirm_deleting:" ?",section_description:"",section_time:"",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"",column_start_date:"",column_duration:"",column_add:"",link:"",confirm_link_deleting:" ?",link_start:" (start)",link_end:" (end)",type_task:"",type_project:"",type_milestone:"",minutes:"",hours:"",days:"",weeks:"",months:"",years:"",message_ok:"OK",message_cancel:"",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}};class Xi{constructor(n){this.addLocale=(e,i)=>{this._locales[e]=i},this.getLocale=e=>this._locales[e],this._locales={};for(const e in n)this._locales[e]=n[e]}}const Zi={date:{month_full:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],month_short:["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Des"],day_full:["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag"],day_short:["Sn","Mon","Tir","Ons","Tor","Fre","Lr"]},labels:{new_task:"Ny oppgave",icon_save:"Lagre",icon_cancel:"Avbryt",icon_details:"Detaljer",icon_edit:"Rediger",icon_delete:"Slett",confirm_closing:"",confirm_deleting:"Hendelsen vil bli slettet permanent. Er du sikker?",section_description:"Beskrivelse",section_time:"Tidsperiode",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Avbryt",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Qi={date:{month_full:["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"],month_short:["Jan","Feb","mrt","Apr","Mei","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],day_full:["Zondag","Maandag","Dinsdag","Woensdag","Donderdag","Vrijdag","Zaterdag"],day_short:["Zo","Ma","Di","Wo","Do","Vr","Za"]},labels:{new_task:"Nieuwe taak",icon_save:"Opslaan",icon_cancel:"Annuleren",icon_details:"Details",icon_edit:"Bewerken",icon_delete:"Verwijderen",confirm_closing:"",confirm_deleting:"Item zal permanent worden verwijderd, doorgaan?",section_description:"Beschrijving",section_time:"Tijd periode",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"Taak omschrijving",column_start_date:"Startdatum",column_duration:"Duur",column_add:"",link:"Koppeling",confirm_link_deleting:"zal worden verwijderd",link_start:" (start)",link_end:" (eind)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"minuten",hours:"uren",days:"dagen",weeks:"weken",months:"maanden",years:"jaren",message_ok:"OK",message_cancel:"Annuleren",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},ta={date:{month_full:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],month_short:["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Des"],day_full:["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag"],day_short:["Sn","Man","Tir","Ons","Tor","Fre","Lr"]},labels:{new_task:"Ny oppgave",icon_save:"Lagre",icon_cancel:"Avbryt",icon_details:"Detaljer",icon_edit:"Endre",icon_delete:"Slett",confirm_closing:"Endringer blir ikke lagret, er du sikker?",confirm_deleting:"Oppfringen vil bli slettet, er du sikker?",section_description:"Beskrivelse",section_time:"Tidsperiode",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Avbryt",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},ea={date:{month_full:["Stycze","Luty","Marzec","Kwiecie","Maj","Czerwiec","Lipiec","Sierpie","Wrzesie","Padziernik","Listopad","Grudzie"],month_short:["Sty","Lut","Mar","Kwi","Maj","Cze","Lip","Sie","Wrz","Pa","Lis","Gru"],day_full:["Niedziela","Poniedziaek","Wtorek","roda","Czwartek","Pitek","Sobota"],day_short:["Nie","Pon","Wto","ro","Czw","Pi","Sob"]},labels:{new_task:"Nowe zadanie",icon_save:"Zapisz",icon_cancel:"Anuluj",icon_details:"Szczegy",icon_edit:"Edytuj",icon_delete:"Usu",confirm_closing:"",confirm_deleting:"Zdarzenie zostanie usunite na zawsze, kontynuowa?",section_description:"Opis",section_time:"Okres czasu",section_type:"Typ",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"Nazwa zadania",column_start_date:"Pocztek",column_duration:"Czas trwania",column_add:"",link:"Link",confirm_link_deleting:"zostanie usunity",link_start:" (pocztek)",link_end:" (koniec)",type_task:"Zadanie",type_project:"Projekt",type_milestone:"Milestone",minutes:"Minuty",hours:"Godziny",days:"Dni",weeks:"Tydzie",months:"Miesice",years:"Lata",message_ok:"OK",message_cancel:"Anuluj",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},na={date:{month_full:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],month_short:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],day_full:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado"],day_short:["Dom","Seg","Ter","Qua","Qui","Sex","Sab"]},labels:{new_task:"Nova tarefa",icon_save:"Salvar",icon_cancel:"Cancelar",icon_details:"Detalhes",icon_edit:"Editar",icon_delete:"Excluir",confirm_closing:"",confirm_deleting:"As tarefas sero excluidas permanentemente, confirme?",section_description:"Descrio",section_time:"Perodo",section_type:"Tipo",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"EAP",column_text:"Nome tarefa",column_start_date:"Data incio",column_duration:"Durao",column_add:"",link:"Link",confirm_link_deleting:"Ser excludo!",link_start:" (incio)",link_end:" (fim)",type_task:"Task",type_project:"Projeto",type_milestone:"Marco",minutes:"Minutos",hours:"Horas",days:"Dias",weeks:"Semanas",months:"Meses",years:"Anos",message_ok:"OK",message_cancel:"Cancelar",section_constraint:"Restrio",constraint_type:"Tipo Restrio",constraint_date:"Data restrio",asap:"Mais breve possvel",alap:"Mais tarde possvel",snet:"No comear antes de",snlt:"No comear depois de",fnet:"No terminar antes de",fnlt:"No terminar depois de",mso:"Precisa comear em",mfo:"Precisa terminar em",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},ia={date:{month_full:["Ianuarie","Februarie","Martie","Aprilie","Mai","Iunie","Iulie","August","Septembrie","Octombrie","November","December"],month_short:["Ian","Feb","Mar","Apr","Mai","Iun","Iul","Aug","Sep","Oct","Nov","Dec"],day_full:["Duminica","Luni","Marti","Miercuri","Joi","Vineri","Sambata"],day_short:["Du","Lu","Ma","Mi","Jo","Vi","Sa"]},labels:{new_task:"Sarcina noua",icon_save:"Salveaza",icon_cancel:"Anuleaza",icon_details:"Detalii",icon_edit:"Editeaza",icon_delete:"Sterge",confirm_closing:"Schimbarile nu vor fi salvate, esti sigur?",confirm_deleting:"Evenimentul va fi sters permanent, esti sigur?",section_description:"Descriere",section_time:"Interval",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Anuleaza",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},aa={date:{month_full:["","","","","Ma","","","","","O","",""],month_short:["","","Ma","A","Ma","","","A","","","",""],day_full:["","","","","","",""],day_short:["","","","","","",""]},labels:{new_task:" ",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"",confirm_deleting:"   , ?",section_description:"",section_time:" ",section_type:"",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"",column_text:"",column_start_date:"",column_duration:"",column_add:"",link:"",confirm_link_deleting:" ",link_start:" ()",link_end:" ()",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"",hours:"",days:"",weeks:"",months:"",years:"",message_ok:"OK",message_cancel:"",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},sa={date:{month_full:["Januar","Februar","Marec","April","Maj","Junij","Julij","Avgust","September","Oktober","November","December"],month_short:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],day_full:["Nedelja","Ponedeljek","Torek","Sreda","etrtek","Petek","Sobota"],day_short:["Ned","Pon","Tor","Sre","et","Pet","Sob"]},labels:{new_task:"Nova naloga",icon_save:"Shrani",icon_cancel:"Preklii",icon_details:"Podrobnosti",icon_edit:"Uredi",icon_delete:"Izbrii",confirm_closing:"",confirm_deleting:"Dogodek bo izbrisan. elite nadaljevati?",section_description:"Opis",section_time:"asovni okvir",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Preklii",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},ra={date:{month_full:["Janur","Februr","Marec","Aprl","Mj","Jn","Jl","August","September","Oktber","November","December"],month_short:["Jan","Feb","Mar","Apr","Mj","Jn","Jl","Aug","Sept","Okt","Nov","Dec"],day_full:["Nedea","Pondelok","Utorok","Streda","tvrtok","Piatok","Sobota"],day_short:["Ne","Po","Ut","St","t","Pi","So"]},labels:{new_task:"Nov loha",icon_save:"Uloi",icon_cancel:"Sp",icon_details:"Detail",icon_edit:"Edituj",icon_delete:"Zmaza",confirm_closing:"Vae zmeny nebud uloen. Skutone?",confirm_deleting:"Udalos bude natrvalo vymazan. Skutone?",section_description:"Poznmky",section_time:"Doba platnosti",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Sp",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},oa={date:{month_full:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],month_short:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],day_full:["Sndag","Mndag","Tisdag","Onsdag","Torsdag","Fredag","Lrdag"],day_short:["Sn","Mn","Tis","Ons","Tor","Fre","Lr"]},labels:{new_task:"Ny uppgift",icon_save:"Spara",icon_cancel:"Avbryt",icon_details:"Detajer",icon_edit:"ndra",icon_delete:"Ta bort",confirm_closing:"",confirm_deleting:"r du sker p att du vill ta bort hndelsen permanent?",section_description:"Beskrivning",section_time:"Tid",section_type:"Typ",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"Uppgiftsnamn",column_start_date:"Starttid",column_duration:"Varaktighet",column_add:"",link:"Lnk",confirm_link_deleting:"kommer tas bort",link_start:" (start)",link_end:" (slut)",type_task:"Uppgift",type_project:"Projekt",type_milestone:"Milstolpe",minutes:"Minuter",hours:"Timmar",days:"Dagar",weeks:"Veckor",months:"Mnader",years:"r",message_ok:"OK",message_cancel:"Avbryt",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},la={date:{month_full:["Ocak","ubat","Mart","Nisan","Mays","Haziran","Temmuz","Austos","Eyll","Ekim","Kasm","Aralk"],month_short:["Oca","ub","Mar","Nis","May","Haz","Tem","Au","Eyl","Eki","Kas","Ara"],day_full:["Pazar","Pazartesi","Sal","aramba","Perembe","Cuma","Cumartesi"],day_short:["Paz","Pzt","Sal","ar","Per","Cum","Cmt"]},labels:{new_task:"Yeni grev",icon_save:"Kaydet",icon_cancel:"ptal",icon_details:"Detaylar",icon_edit:"Dzenle",icon_delete:"Sil",confirm_closing:"",confirm_deleting:"Grev silinecek, emin misiniz?",section_description:"Aklama",section_time:"Zaman Aral",section_type:"Tip",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"Grev Ad",column_start_date:"Balang",column_duration:"Sre",column_add:"",link:"Balant",confirm_link_deleting:"silinecek",link_start:" (balang)",link_end:" (biti)",type_task:"Grev",type_project:"Proje",type_milestone:"Kilometreta",minutes:"Dakika",hours:"Saat",days:"Gn",weeks:"Hafta",months:"Ay",years:"Yl",message_ok:"OK",message_cancel:"ptal",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},da={date:{month_full:["","","","","","","","","","","",""],month_short:["","","","","","","","","","","",""],day_full:["","","","","","'",""],day_short:["","","","","","",""]},labels:{new_task:" ",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"",confirm_deleting:"  .  ?",section_description:"",section_time:" ",section_type:"",section_deadline:"Deadline",section_baselines:"Baselines",section_new_resources:"Resources",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_add_button:"Add Assignment",resources_filter_placeholder:"Search...",resources_filter_label:"hide empty",resources_section_placeholder:"Nothing assigned yet. Click 'Add Assignment' to assign resources.",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}};function ca(){this.constants=Gn,this.version="9.1.0",this.license="gpl",this.templates={},this.ext={},this.keys={edit_save:this.constants.KEY_CODES.ENTER,edit_cancel:this.constants.KEY_CODES.ESC}}function ua(t){var n=new ca,e=new Yn(t),i={};n.plugins=function(l){for(var d in l)if(l[d]&&!i[d]){var c=e.getExtension(d);c&&(c(n),i[d]=!0)}return i},n.$services=function(){var l={};return{services:{},setService:function(d,c){l[d]=c},getService:function(d){return l[d]?l[d]():null},dropService:function(d){l[d]&&delete l[d]},destructor:function(){for(var d in l)if(l[d]){var c=l[d];c&&c.destructor&&c.destructor()}l=null}}}(),n.config={layout:{css:"gantt_container",rows:[{cols:[{view:"grid",scrollX:"scrollHor",scrollY:"scrollVer"},{resizer:!0,width:1},{view:"timeline",scrollX:"scrollHor",scrollY:"scrollVer"},{view:"scrollbar",id:"scrollVer"}]},{view:"scrollbar",id:"scrollHor",height:20}]},links:{finish_to_start:"0",start_to_start:"1",finish_to_finish:"2",start_to_finish:"3"},types:{task:"task",project:"project",milestone:"milestone"},auto_types:!1,duration_unit:"day",work_time:!1,correct_work_time:!1,skip_off_time:!1,cascade_delete:!0,autosize:!1,autosize_min_width:0,autoscroll:!0,autoscroll_speed:30,deepcopy_on_parse:!1,show_links:!0,show_task_cells:!0,static_background:!1,static_background_cells:!0,branch_loading:!1,branch_loading_property:"$has_child",show_loading:!1,show_chart:!0,show_grid:!0,min_duration:36e5,date_format:"%d-%m-%Y %H:%i",xml_date:void 0,start_on_monday:!0,server_utc:!1,show_progress:!0,fit_tasks:!1,select_task:!0,scroll_on_click:!0,smart_rendering:!0,preserve_scroll:!0,readonly:!1,container_resize_timeout:20,deadlines:!0,date_grid:"%Y-%m-%d",drag_links:!0,drag_progress:!0,drag_resize:!0,drag_project:!1,drag_move:!0,drag_mode:{resize:"resize",progress:"progress",move:"move",ignore:"ignore"},round_dnd_dates:!0,link_wrapper_width:20,link_arrow_size:12,root_id:0,autofit:!1,columns:[{name:"text",tree:!0,width:"*",resize:!0},{name:"start_date",align:"center",resize:!0},{name:"duration",align:"center"},{name:"add",width:44}],scale_offset_minimal:!0,inherit_scale_class:!1,scales:[{unit:"day",step:1,date:"%d %M"}],time_step:60,duration_step:1,task_date:"%d %F %Y",time_picker:"%H:%i",task_attribute:"data-task-id",link_attribute:"data-link-id",layer_attribute:"data-layer",buttons_left:["gantt_save_btn","gantt_cancel_btn"],_migrate_buttons:{dhx_save_btn:"gantt_save_btn",dhx_cancel_btn:"gantt_cancel_btn",dhx_delete_btn:"gantt_delete_btn"},buttons_right:["gantt_delete_btn"],lightbox:{sections:[{name:"description",height:70,map_to:"text",type:"textarea",focus:!0},{name:"time",type:"duration",map_to:"auto"}],project_sections:[{name:"description",height:70,map_to:"text",type:"textarea",focus:!0},{name:"type",type:"typeselect",map_to:"type"},{name:"time",type:"duration",readonly:!0,map_to:"auto"}],milestone_sections:[{name:"description",height:70,map_to:"text",type:"textarea",focus:!0},{name:"type",type:"typeselect",map_to:"type"},{name:"time",type:"duration",single_date:!0,map_to:"auto"}]},drag_lightbox:!0,sort:!1,details_on_create:!0,details_on_dblclick:!0,initial_scroll:!0,task_scroll_offset:100,order_branch:!1,order_branch_free:!1,task_height:void 0,bar_height:"full",bar_height_padding:9,min_column_width:70,min_grid_column_width:70,grid_resizer_column_attribute:"data-column-index",keep_grid_width:!1,grid_resize:!1,grid_elastic_columns:!1,show_tasks_outside_timescale:!1,show_unscheduled:!0,resize_rows:!1,task_grid_row_resizer_attribute:"data-row-index",min_task_grid_row_height:30,row_height:36,readonly_property:"readonly",editable_property:"editable",calendar_property:"calendar_id",resource_calendars:{},dynamic_resource_calendars:!1,inherit_calendar:!1,type_renderers:{},open_tree_initially:!1,optimize_render:!0,prevent_default_scroll:!1,show_errors:!0,wai_aria_attributes:!0,smart_scales:!0,rtl:!1,placeholder_task:!1,horizontal_scroll_key:"shiftKey",drag_timeline:{useKey:void 0,ignore:".gantt_task_line, .gantt_task_link",render:!1},drag_multiple:!0,csp:"auto",auto_scheduling:{}},n.ajax=function(l){return{cache:!0,method:"get",parse:function(d){return typeof d!="string"?d:(d=d.replace(/^[\s]+/,""),typeof DOMParser>"u"||pt.isIE?Q.ActiveXObject!==void 0&&((c=new Q.ActiveXObject("Microsoft.XMLDOM")).async="false",c.loadXML(d)):c=new DOMParser().parseFromString(d,"text/xml"),c);var c},xmltop:function(d,c,u){if(c.status===void 0||c.status<400){var h=c.responseXML?c.responseXML||c:this.parse(c.responseText||c);if(h&&h.documentElement!==null&&!h.getElementsByTagName("parsererror").length)return h.getElementsByTagName(d)[0]}return u!==-1&&l.callEvent("onLoadXMLError",["Incorrect XML",arguments[1],u]),document.createElement("DIV")},xpath:function(d,c){if(c.nodeName||(c=c.responseXML||c),pt.isIE)return c.selectNodes(d)||[];for(var u,h=[],_=(c.ownerDocument||c).evaluate(d,c,null,XPathResult.ANY_TYPE,null);u=_.iterateNext();)h.push(u);return h},query:function(d){return this._call(d.method||"GET",d.url,d.data||"",d.async||!0,d.callback,d.headers)},get:function(d,c,u){var h=Ct("GET",arguments);return this.query(h)},getSync:function(d,c){var u=Ct("GET",arguments);return u.async=!1,this.query(u)},put:function(d,c,u,h){var _=Ct("PUT",arguments);return this.query(_)},del:function(d,c,u){var h=Ct("DELETE",arguments);return this.query(h)},post:function(d,c,u,h){arguments.length==1?c="":arguments.length==2&&typeof c=="function"&&(u=c,c="");var _=Ct("POST",arguments);return this.query(_)},postSync:function(d,c,u){c=c===null?"":String(c);var h=Ct("POST",arguments);return h.async=!1,this.query(h)},_call:function(d,c,u,h,_,f){return new l.Promise(function(y,v){var b=typeof XMLHttpRequest!==void 0?new XMLHttpRequest:new Q.ActiveXObject("Microsoft.XMLHTTP"),m=navigator.userAgent.match(/AppleWebKit/)!==null&&navigator.userAgent.match(/Qt/)!==null&&navigator.userAgent.match(/Safari/)!==null;h&&(b.onreadystatechange=function(){if(b.readyState==4||m&&b.readyState==3){if((b.status<200||b.status>299||b.responseText==="")&&!l.callEvent("onAjaxError",[b]))return;setTimeout(function(){typeof _=="function"&&_.apply(Q,[{xmlDoc:b,filePath:c}]),y(b),typeof _=="function"&&(_=null,b=null)},0)}});var g=!this||!this.cache;if(d=="GET"&&g&&(c+=(c.indexOf("?")>=0?"&":"?")+"dhxr"+new Date().getTime()+"=1"),b.open(d,c,h),f)for(var p in f)b.setRequestHeader(p,f[p]);else d.toUpperCase()=="POST"||d=="PUT"||d=="DELETE"?b.setRequestHeader("Content-Type","application/x-www-form-urlencoded"):d=="GET"&&(u=null);if(b.setRequestHeader("X-Requested-With","XMLHttpRequest"),b.send(u),!h)return{xmlDoc:b,filePath:c}})},urlSeparator:function(d){return d.indexOf("?")!=-1?"&":"?"}}}(n),n.date=Jn(n),n.RemoteEvents=Kn;var a=function(l){function d(u){return{target:u.target||u.srcElement,pageX:u.pageX,pageY:u.pageY,clientX:u.clientX,clientY:u.clientY,metaKey:u.metaKey,shiftKey:u.shiftKey,ctrlKey:u.ctrlKey,altKey:u.altKey}}function c(u,h){this._obj=u,this._settings=h||{},st(this);var _=this.getInputMethods();this._drag_start_timer=null,l.attachEvent("onGanttScroll",O(function(v,b){this.clearDragTimer()},this));for(var f={passive:!1},y=0;y<_.length;y++)O(function(v){l.event(u,v.down,O(function(m){v.accessor(m)&&(m.button!==void 0&&m.button!==0||(h.preventDefault&&h.selector&&dt(m.target,h.selector)&&m.preventDefault(),l.config.touch&&m.timeStamp&&m.timeStamp-0<300||(this._settings.original_target=d(m),this._settings.original_element_sizes={...at(m,He(u)),width:m.target.offsetWidth,height:m.target.offsetHeight},l.config.touch?(this.clearDragTimer(),this._drag_start_timer=setTimeout(O(function(){l.getState().lightbox||this.dragStart(u,m,v)},this),l.config.touch_drag)):this.dragStart(u,m,v))))},this),f);var b=document.body;l.event(b,v.up,O(function(m){v.accessor(m)&&this.clearDragTimer()},this),f)},this)(_[y])}return c.prototype={traceDragEvents:function(u,h){var _=O(function(g){return this.dragMove(u,g,h.accessor)},this);O(function(g){return this.dragScroll(u,g)},this);var f=O(function(g){if(!this.config.started||!U(this.config.updates_per_second)||Xe(this,this.config.updates_per_second)){var p=_(g);if(p)try{g&&g.preventDefault&&g.cancelable&&g.preventDefault()}catch{}return p}},this),y=bt(l.$root),v=this.config.mousemoveContainer||bt(l.$root),b={passive:!1},m=O(function(g){return l.eventRemove(v,h.move,f),l.eventRemove(y,h.up,m,b),this.dragEnd(u)},this);l.event(v,h.move,f,b),l.event(y,h.up,m,b)},checkPositionChange:function(u){var h=u.x-this.config.pos.x,_=u.y-this.config.pos.y;return Math.sqrt(Math.pow(Math.abs(h),2)+Math.pow(Math.abs(_),2))>this.config.sensitivity},initDnDMarker:function(){var u=this.config.marker=document.createElement("div");u.className="gantt_drag_marker",u.innerHTML="",document.body.appendChild(u)},backupEventTarget:function(u,h){if(l.config.touch){var _=h(u),f=_.target||_.srcElement,y=f.cloneNode(!0);this.config.original_target=d(_),this.config.original_target.target=y,this.config.backup_element=f,f.parentNode.appendChild(y),f.style.display="none",(this.config.mousemoveContainer||document.body).appendChild(f)}},getInputMethods:function(){var u=[];return u.push({move:"mousemove",down:"mousedown",up:"mouseup",accessor:function(h){return h}}),l.config.touch&&(!l.env.isIE||Q.maxTouchPoints?u.push({move:"touchmove",down:"touchstart",up:"touchend",accessor:function(h){return h.touches&&h.touches.length>1?null:h.touches[0]?{target:document.elementFromPoint(h.touches[0].clientX,h.touches[0].clientY),pageX:h.touches[0].pageX,pageY:h.touches[0].pageY,clientX:h.touches[0].clientX,clientY:h.touches[0].clientY}:h}}):Q.PointerEvent&&u.push({move:"pointermove",down:"pointerdown",up:"pointerup",accessor:function(h){return h.pointerType=="mouse"?null:h}})),u},clearDragTimer:function(){this._drag_start_timer&&(clearTimeout(this._drag_start_timer),this._drag_start_timer=null)},dragStart:function(u,h,_){this.config&&this.config.started||(this.config={obj:u,marker:null,started:!1,pos:this.getPosition(h),sensitivity:4},this._settings&&R(this.config,this._settings,!0),this.traceDragEvents(u,_),l._prevent_touch_scroll=!0,h.target.closest(".gantt_row")&&!l.config.order_branch&&(l._prevent_touch_scroll=!1),document.body.classList.add("gantt_noselect"),l.config.touch&&this.dragMove(u,h,_.accessor))},dragMove:function(u,h,_){var f=_(h);if(!f)return!1;if(!this.config.marker&&!this.config.started){var y=this.getPosition(f);if(l.config.touch||this.checkPositionChange(y)){if(this.config.started=!0,this.config.ignore=!1,l._touch_drag=!0,this.callEvent("onBeforeDragStart",[u,this.config.original_target])===!1)return this.config.ignore=!0,!1;this.backupEventTarget(h,_),this.initDnDMarker(),l._touch_feedback(),this.callEvent("onAfterDragStart",[u,this.config.original_target])}else this.config.ignore=!0}return this.config.ignore?!1:h.targetTouches&&!f.target?void 0:(f.pos=this.getPosition(f),this.config.marker.style.left=f.pos.x+"px",this.config.marker.style.top=f.pos.y+"px",this.callEvent("onDragMove",[u,f]),!0)},dragEnd:function(u){var h=this.config.backup_element;h&&h.parentNode&&h.parentNode.removeChild(h),l._prevent_touch_scroll=!1,this.config.marker&&(this.config.marker.parentNode.removeChild(this.config.marker),this.config.marker=null,this.callEvent("onDragEnd",[])),this.config.started=!1,l._touch_drag=!1,document.body.classList.remove("gantt_noselect")},getPosition:function(u){var h=0,_=0;return u.pageX||u.pageY?(h=u.pageX,_=u.pageY):(u.clientX||u.clientY)&&(h=u.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,_=u.clientY+document.body.scrollTop+document.documentElement.scrollTop),{x:h,y:_}}},c}(n);n.$services.setService("dnd",function(){return a});var s=function(l){var d={};function c(u,h,_){_=_||u;var f=l.config,y=l.templates;l.config[u]&&d[_]!=f[u]&&(h&&y[_]||(y[_]=l.date.date_to_str(f[u]),d[_]=f[u]))}return{initTemplates:function(){var u=l.date,h=u.date_to_str,_=l.config,f=h(_.xml_date||_.date_format,_.server_utc),y=u.str_to_date(_.xml_date||_.date_format,_.server_utc);c("date_scale",!0,void 0,l.config,l.templates),c("date_grid",!0,"grid_date_format",l.config,l.templates),c("task_date",!0,void 0,l.config,l.templates),l.mixin(l.templates,{xml_format:void 0,format_date:f,xml_date:void 0,parse_date:y,progress_text:function(v,b,m){return""},grid_header_class:function(v,b){return""},task_text:function(v,b,m){return m.text},task_class:function(v,b,m){return""},task_end_date:function(v){return l.templates.task_date(v)},grid_row_class:function(v,b,m){return""},task_row_class:function(v,b,m){return""},timeline_cell_class:function(v,b){return""},timeline_cell_content:function(v,b){return""},scale_cell_class:function(v){return""},scale_row_class:function(v){return""},grid_indent:function(v){return"<div class='gantt_tree_indent'></div>"},grid_folder:function(v){return"<div class='gantt_tree_icon gantt_folder_"+(v.$open?"open":"closed")+"'></div>"},grid_file:function(v){return"<div class='gantt_tree_icon gantt_file'></div>"},grid_open:function(v){return"<div class='gantt_tree_icon gantt_"+(v.$open?"close":"open")+"'></div>"},grid_blank:function(v){return"<div class='gantt_tree_icon gantt_blank'></div>"},date_grid:function(v,b,m){return b&&l.isUnscheduledTask(b)&&l.config.show_unscheduled?l.templates.task_unscheduled_time(b):l.templates.grid_date_format(v,m)},task_time:function(v,b,m){return l.isUnscheduledTask(m)&&l.config.show_unscheduled?l.templates.task_unscheduled_time(m):l.templates.task_date(v)+" - "+l.templates.task_end_date(b)},task_unscheduled_time:function(v){return""},time_picker:h(_.time_picker),link_class:function(v){return""},link_description:function(v){var b=l.getTask(v.source),m=l.getTask(v.target);return"<b>"+b.text+"</b> &ndash;  <b>"+m.text+"</b>"},drag_link:function(v,b,m,g){v=l.getTask(v);var p=l.locale.labels,k="<b>"+v.text+"</b> "+(b?p.link_start:p.link_end)+"<br/>";return m&&(k+="<b> "+(m=l.getTask(m)).text+"</b> "+(g?p.link_start:p.link_end)+"<br/>"),k},drag_link_class:function(v,b,m,g){var p="";return v&&m&&(p=" "+(l.isLinkAllowed(v,m,b,g)?"gantt_link_allow":"gantt_link_deny")),"gantt_link_tooltip"+p},tooltip_date_format:u.date_to_str("%Y-%m-%d"),tooltip_text:function(v,b,m){return`<div>Task: ${m.text}</div>
				<div>Start date: ${l.templates.tooltip_date_format(v)}</div>
				<div>End date: ${l.templates.tooltip_date_format(b)}</div>`},baseline_text:function(v,b,m){return""}})},initTemplate:c}}(n);n.$services.setService("templateLoader",function(){return s}),st(n);var r=new Xn;r.registerProvider("global",function(){var l={min_date:n._min_date,max_date:n._max_date,selected_task:null};return n.$data&&n.$data.tasksStore&&(l.selected_task=n.$data.tasksStore.getSelectedId()),l}),n.getState=r.getState,n.$services.setService("state",function(){return r}),R(n,Bn),n.Promise=Zn,n.env=pt,function(l){var d=ei.create();R(l,d);var c,u=l.createDatastore({name:"task",type:"treeDatastore",rootId:function(){return l.config.root_id},initItem:O(function(m){this.defined(m.id)||(m.id=this.uid()),m.start_date&&(m.start_date=l.date.parseDate(m.start_date,"parse_date")),m.end_date&&(m.end_date=l.date.parseDate(m.end_date,"parse_date"));var g=null;(m.duration||m.duration===0)&&(m.duration=g=1*m.duration),g&&(m.start_date&&!m.end_date?m.end_date=this.calculateEndDate(m):!m.start_date&&m.end_date&&(m.start_date=this.calculateEndDate({start_date:m.end_date,duration:-m.duration,task:m}))),l.config.deadlines!==!1&&m.deadline&&(m.deadline=l.date.parseDate(m.deadline,"parse_date")),m.progress=Number(m.progress)||0,this._isAllowedUnscheduledTask(m)&&this._set_default_task_timing(m),this._init_task_timing(m),m.start_date&&m.end_date&&this.correctTaskWorkTime(m),m.$source=[],m.$target=[];var p=this.$data.tasksStore.getItem(m.id);return p&&!U(m.open)&&(m.$open=p.$open),m.parent===void 0&&(m.parent=this.config.root_id),m.open&&(m.$open=!0),m},l),getConfig:function(){return l.config}}),h=l.createDatastore({name:"link",initItem:O(function(m){return this.defined(m.id)||(m.id=this.uid()),m},l)});function _(m){var g=l.isTaskVisible(m);if(!g&&l.isTaskExists(m)){var p=l.getParent(m);l.isTaskExists(p)&&l.isTaskVisible(p)&&(p=l.getTask(p),l.isSplitTask(p)&&(g=!0))}return g}function f(m,g){return g.indexOf(String(m))===-1&&g.indexOf(Number(m))===-1}function y(m){if(l.isTaskExists(m.source)){for(var g=l.getTask(m.source),p=0;p<g.$source.length;p++)if(g.$source[p]==m.id){g.$source.splice(p,1);break}}if(l.isTaskExists(m.target)){var k=l.getTask(m.target);for(p=0;p<k.$target.length;p++)if(k.$target[p]==m.id){k.$target.splice(p,1);break}}}function v(){for(var m=null,g=l.$data.tasksStore.getItems(),p=0,k=g.length;p<k;p++)(m=g[p]).$source=[],m.$target=[];var x=l.$data.linksStore.getItems();for(p=0,k=x.length;p<k;p++){var w=x[p];h.sync_link(w)}}function b(m){var g=m.source,p=m.target;for(var k in m.events)(function(x,w){g.attachEvent(x,function(){return p.callEvent(w,Array.prototype.slice.call(arguments))},w)})(k,m.events[k])}l.attachEvent("onDestroy",function(){u.destructor(),h.destructor()}),l.attachEvent("onLinkValidation",function(m){if(l.isLinkExists(m.id)||m.id==="predecessor_generated")return!0;for(var g=l.getTask(m.source).$source,p=0;p<g.length;p++){var k=l.getLink(g[p]),x=m.source==k.source,w=m.target==k.target,$=m.type==k.type;if(x&&w&&$)return!1}return!0}),u.attachEvent("onBeforeRefreshAll",function(){if(!u._skipTaskRecalculation)for(var m=u.getVisibleItems(),g=0;g<m.length;g++){var p=m[g];p.$index=g,p.$local_index=l.getTaskIndex(p.id),l.resetProjectDates(p)}}),u.attachEvent("onFilterItem",function(m,g){if(l.config.show_tasks_outside_timescale)return!0;var p=null,k=null;if(l.config.start_date&&l.config.end_date){if(l._isAllowedUnscheduledTask(g))return!0;if(p=l.config.start_date.valueOf(),k=l.config.end_date.valueOf(),+g.start_date>k||+g.end_date<+p)return!1}return!0}),u.attachEvent("onIdChange",function(m,g){l._update_flags(m,g);var p=l.getTask(g);u.isSilent()||(p.$split_subtask||p.rollup)&&l.eachParent(function(k){l.refreshTask(k.id)},g)}),u.attachEvent("onAfterUpdate",function(m){if(l._update_parents(m),l.getState("batchUpdate").batch_update)return!0;var g=u.getItem(m);g.$source||(g.$source=[]);for(var p=0;p<g.$source.length;p++)h.refresh(g.$source[p]);for(g.$target||(g.$target=[]),p=0;p<g.$target.length;p++)h.refresh(g.$target[p])}),u.attachEvent("onBeforeItemMove",function(m,g,p){return!It(m,l,u)||(console.log("The placeholder task cannot be moved to another position."),!1)}),u.attachEvent("onAfterItemMove",function(m,g,p){var k=l.getTask(m);this.getNextSibling(m)!==null?k.$drop_target=this.getNextSibling(m):this.getPrevSibling(m)!==null?k.$drop_target="next:"+this.getPrevSibling(m):k.$drop_target="next:null"}),u.attachEvent("onStoreUpdated",function(m,g,p){if(p=="delete"&&l._update_flags(m,null),!l.$services.getService("state").getState("batchUpdate").batch_update){if(l.config.fit_tasks&&p!=="paint"){var k=l.getState();fe(l);var x=l.getState();if(+k.min_date!=+x.min_date||+k.max_date!=+x.max_date)return l.render(),l.callEvent("onScaleAdjusted",[]),!0}p=="add"||p=="move"||p=="delete"?l.$layout&&(this.$config.name!="task"||p!="add"&&p!="delete"||this._skipTaskRecalculation!="lightbox"&&(this._skipTaskRecalculation=!0),l.$layout.resize()):m||h.refresh()}}),h.attachEvent("onAfterAdd",function(m,g){h.sync_link(g)}),h.attachEvent("onAfterUpdate",function(m,g){v()}),h.attachEvent("onAfterDelete",function(m,g){y(g)}),h.attachEvent("onAfterSilentDelete",function(m,g){y(g)}),h.attachEvent("onBeforeIdChange",function(m,g){y(l.mixin({id:m},l.$data.linksStore.getItem(g))),h.sync_link(l.$data.linksStore.getItem(g))}),h.attachEvent("onFilterItem",function(m,g){if(!l.config.show_links)return!1;var p=_(g.source),k=_(g.target);return!(!p||!k||l._isAllowedUnscheduledTask(l.getTask(g.source))||l._isAllowedUnscheduledTask(l.getTask(g.target)))&&l.callEvent("onBeforeLinkDisplay",[m,g])}),c={},l.attachEvent("onBeforeTaskDelete",function(m,g){return c[m]=pe.getSubtreeLinks(l,m),!0}),l.attachEvent("onAfterTaskDelete",function(m,g){c[m]&&l.$data.linksStore.silent(function(){for(var p in c[m])l.isLinkExists(p)&&l.$data.linksStore.removeItem(p),y(c[m][p]);c[m]=null})}),l.attachEvent("onAfterLinkDelete",function(m,g){l.isTaskExists(g.source)&&l.refreshTask(g.source),l.isTaskExists(g.target)&&l.refreshTask(g.target)}),l.attachEvent("onParse",v),b({source:h,target:l,events:{onItemLoading:"onLinkLoading",onBeforeAdd:"onBeforeLinkAdd",onAfterAdd:"onAfterLinkAdd",onBeforeUpdate:"onBeforeLinkUpdate",onAfterUpdate:"onAfterLinkUpdate",onBeforeDelete:"onBeforeLinkDelete",onAfterDelete:"onAfterLinkDelete",onIdChange:"onLinkIdChange"}}),b({source:u,target:l,events:{onItemLoading:"onTaskLoading",onBeforeAdd:"onBeforeTaskAdd",onAfterAdd:"onAfterTaskAdd",onBeforeUpdate:"onBeforeTaskUpdate",onAfterUpdate:"onAfterTaskUpdate",onBeforeDelete:"onBeforeTaskDelete",onAfterDelete:"onAfterTaskDelete",onIdChange:"onTaskIdChange",onBeforeItemMove:"onBeforeTaskMove",onAfterItemMove:"onAfterTaskMove",onFilterItem:"onBeforeTaskDisplay",onItemOpen:"onTaskOpened",onItemClose:"onTaskClosed",onBeforeSelect:"onBeforeTaskSelected",onAfterSelect:"onTaskSelected",onAfterUnselect:"onTaskUnselected"}}),l.$data={tasksStore:u,linksStore:h},h.sync_link=function(m){if(l.isTaskExists(m.source)){var g=l.getTask(m.source);g.$source=g.$source||[],f(m.id,g.$source)&&g.$source.push(m.id)}if(l.isTaskExists(m.target)){var p=l.getTask(m.target);p.$target=p.$target||[],f(m.id,p.$target)&&p.$target.push(m.id)}}}(n),n.dataProcessor=ai,n.createDataProcessor=si,function(l){l.ext||(l.ext={});for(var d=[oi,li,ui,hi,_i,gi,fi,pi,mi,yi],c=0;c<d.length;c++)d[c]&&d[c](l);const{getAutoSchedulingConfig:u}=function(h){function _(){return{enabled:!1,apply_constraints:!1,gap_behavior:"preserve",descendant_links:!1,schedule_on_parse:!0,move_projects:!0,use_progress:!1,schedule_from_end:!1,project_constraint:!1,show_constraints:!1}}return{getDefaultAutoSchedulingConfig:_,getAutoSchedulingConfig:function(){const f=h.config;if(typeof f.auto_scheduling=="object"){const y={enabled:!1,apply_constraints:!1,gap_behavior:"preserve",descendant_links:!1,schedule_on_parse:!0,move_projects:!0,use_progress:!1,schedule_from_end:!1,project_constraint:!1,show_constraints:!1,...f.auto_scheduling};return y.mode&&(y.apply_constraints=y.mode==="constraints",delete y.mode),y.strict!==void 0&&(y.gap_behavior=y.strict?"compress":"preserve",delete y.strict),y.move_asap_tasks!==void 0&&(y.gap_behavior=y.move_asap_tasks?"compress":"preserve",delete y.move_asap_tasks),y}return{enabled:!1,apply_constraints:!1,gap_behavior:"preserve",descendant_links:!1,schedule_on_parse:!0,move_projects:!0,use_progress:!1,schedule_from_end:!1,project_constraint:!1,show_constraints:!1,enabled:!!f.auto_scheduling,apply_constraints:f.auto_scheduling_compatibility??!1,gap_behavior:f.auto_scheduling_strict!==!0?"preserve":"compress",descendant_links:f.auto_scheduling_descendant_links??!1,schedule_on_parse:f.auto_scheduling_initial??!0,move_projects:f.auto_scheduling_move_projects??!0,use_progress:f.auto_scheduling_use_progress??!1,schedule_from_end:f.schedule_from_end??!1,project_constraint:f.auto_scheduling_project_constraint??!1,show_constraints:!1}}}}(l);l._getAutoSchedulingConfig=u}(n),function(l){l.getGridColumn=function(d){for(var c=l.config.columns,u=0;u<c.length;u++)if(c[u].name==d)return c[u];return null},l.getGridColumns=function(){return l.config.columns.slice()}}(n),function(l){l.isReadonly=function(d){return typeof d!="number"&&typeof d!="string"||!l.isTaskExists(d)||(d=l.getTask(d)),(!d||!d[this.config.editable_property])&&(d&&d[this.config.readonly_property]||this.config.readonly)}}(n),bi(n),function(l){var d=new rn(l),c=new on(d);R(l,Ei(d,c))}(n),Di(n),function(l){l.getTaskType=function(d){return"task"}}(n),function(l){function d(){return l._cached_functions.update_if_changed(l),l._cached_functions.active||l._cached_functions.activate(),!0}l._cached_functions={cache:{},mode:!1,critical_path_mode:!1,wrap_methods:function(u,h){if(h._prefetch_originals)for(var _ in h._prefetch_originals)h[_]=h._prefetch_originals[_];for(h._prefetch_originals={},_=0;_<u.length;_++)this.prefetch(u[_],h)},prefetch:function(u,h){var _=h[u];if(_){var f=this;h._prefetch_originals[u]=_,h[u]=function(){for(var y=new Array(arguments.length),v=0,b=arguments.length;v<b;v++)y[v]=arguments[v];if(f.active){var m=f.get_arguments_hash(Array.prototype.slice.call(y));f.cache[u]||(f.cache[u]={});var g=f.cache[u];if(f.has_cached_value(g,m))return f.get_cached_value(g,m);var p=_.apply(this,y);return f.cache_value(g,m,p),p}return _.apply(this,y)}}return _},cache_value:function(u,h,_){this.is_date(_)&&(_=new Date(_)),u[h]=_},has_cached_value:function(u,h){return u.hasOwnProperty(h)},get_cached_value:function(u,h){var _=u[h];return this.is_date(_)&&(_=new Date(_)),_},is_date:function(u){return u&&u.getUTCDate},get_arguments_hash:function(u){for(var h=[],_=0;_<u.length;_++)h.push(this.stringify_argument(u[_]));return"("+h.join(";")+")"},stringify_argument:function(u){return(u.id?u.id:this.is_date(u)?u.valueOf():u)+""},activate:function(){this.clear(),this.active=!0},deactivate:function(){this.clear(),this.active=!1},clear:function(){this.cache={}},setup:function(u){var h=[],_=["_isProjectEnd","_getProjectEnd","_getSlack"];this.mode=="auto"?u.config.highlight_critical_path&&(h=_):this.mode===!0&&(h=_),this.wrap_methods(h,u)},update_if_changed:function(u){(this.critical_path_mode!=u.config.highlight_critical_path||this.mode!==u.config.optimize_render)&&(this.critical_path_mode=u.config.highlight_critical_path,this.mode=u.config.optimize_render,this.setup(u))}},l.attachEvent("onBeforeGanttRender",d),l.attachEvent("onBeforeDataRender",d),l.attachEvent("onBeforeSmartRender",function(){d()}),l.attachEvent("onBeforeParse",d),l.attachEvent("onDataRender",function(){l._cached_functions.deactivate()});var c=null;l.attachEvent("onSmartRender",function(){c&&clearTimeout(c),c=setTimeout(function(){l._cached_functions.deactivate()},1e3)}),l.attachEvent("onBeforeGanttReady",function(){return l._cached_functions.update_if_changed(l),!0})}(n),Ai(n),function(l){l.destructor=function(){for(var d in this.clearAll(),this.callEvent("onDestroy",[]),this._getDatastores().forEach(function(c){c.destructor()}),this.$root&&delete this.$root.gantt,this._eventRemoveAll&&this._eventRemoveAll(),this.$layout&&this.$layout.destructor(),this.resetLightbox&&this.resetLightbox(),this.ext.inlineEditors&&this.ext.inlineEditors.destructor&&this.ext.inlineEditors.destructor(),this._dp&&this._dp.destructor&&this._dp.destructor(),this.$services.destructor(),this.detachAllEvents(),this)d.indexOf("$")===0&&delete this[d];this.$destroyed=!0}}(n);var o=new Xi({en:Bi,ar:Ii,be:Mi,ca:Ni,cn:Li,cs:Ri,da:Pi,de:Hi,el:Oi,es:zi,fa:ji,fi:Wi,fr:Fi,he:Vi,hr:Ui,hu:qi,id:Gi,it:Yi,jp:Ji,kr:Ki,nb:Zi,nl:Qi,no:ta,pl:ea,pt:na,ro:ia,ru:aa,si:sa,sk:ra,sv:oa,tr:la,ua:da});return n.i18n={addLocale:o.addLocale,setLocale:function(l){if(typeof l=="string"){var d=o.getLocale(l);d||(d=o.getLocale("en")),n.locale=d}else if(l)if(n.locale)for(var c in l)l[c]&&typeof l[c]=="object"?(n.locale[c]||(n.locale[c]={}),n.mixin(n.locale[c],l[c],!0)):n.locale[c]=l[c];else n.locale=l;const u=n.locale.labels;u.gantt_save_btn=u.gantt_save_btn||u.icon_save,u.gantt_cancel_btn=u.gantt_cancel_btn||u.icon_cancel,u.gantt_delete_btn=u.gantt_delete_btn||u.icon_delete},getLocale:o.getLocale},n.i18n.setLocale("en"),n}function ha(t){var n="data-dhxbox",e=null;function i(m,g){var p=m.callback;y.hide(m.box),e=m.box=null,p&&p(g)}function a(m){if(e){var g=m.which||m.keyCode,p=!1;if(v.keyboard){if(g==13||g==32){var k=m.target||m.srcElement;Z(k).indexOf("gantt_popup_button")>-1&&k.click?k.click():(i(e,!0),p=!0)}g==27&&(i(e,!1),p=!0)}return p?(m.preventDefault&&m.preventDefault(),!(m.cancelBubble=!0)):void 0}}var s=bt(t.$root)||document;function r(m){r.cover||(r.cover=document.createElement("div"),r.cover.onkeydown=a,r.cover.className="dhx_modal_cover",document.body.appendChild(r.cover)),r.cover.style.display=m?"inline-block":"none"}function o(m,g,p){return"<div "+t._waiAria.messageButtonAttrString(m)+" class='gantt_popup_button "+("gantt_"+g.toLowerCase().replace(/ /g,"_")+"_button")+"' data-result='"+p+"' result='"+p+"' ><div>"+m+"</div></div>"}function l(){for(var m=[].slice.apply(arguments,[0]),g=0;g<m.length;g++)if(m[g])return m[g]}function d(m,g,p){var k=m.tagName?m:function($,T,S){var C=document.createElement("div"),E=ot();t._waiAria.messageModalAttr(C,E),C.className=" gantt_modal_box gantt-"+$.type,C.setAttribute(n,1);var D="";if($.width&&(C.style.width=$.width),$.height&&(C.style.height=$.height),$.title&&(D+='<div class="gantt_popup_title">'+$.title+"</div>"),D+='<div class="gantt_popup_text" id="'+E+'"><span>'+($.content?"":$.text)+'</span></div><div  class="gantt_popup_controls">',T&&(D+=o(l($.ok,t.locale.labels.message_ok,"OK"),"ok",!0)),S&&(D+=o(l($.cancel,t.locale.labels.message_cancel,"Cancel"),"cancel",!1)),$.buttons)for(var A=0;A<$.buttons.length;A++){var M=$.buttons[A];D+=typeof M=="object"?o(M.label,M.css||"gantt_"+M.label.toLowerCase()+"_button",M.value||A):o(M,M,A)}if(D+="</div>",C.innerHTML=D,$.content){var I=$.content;typeof I=="string"&&(I=document.getElementById(I)),I.style.display=="none"&&(I.style.display=""),C.childNodes[$.title?1:0].appendChild(I)}return C.onclick=function(N){var L=N.target||N.srcElement;if(L.className||(L=L.parentNode),dt(L,".gantt_popup_button")){var B=L.getAttribute("data-result");i($,B=B=="true"||B!="false"&&B)}},$.box=C,(T||S)&&(e=$),C}(m,g,p);m.hidden||r(!0),document.body.appendChild(k);var x=Math.abs(Math.floor(((window.innerWidth||document.documentElement.offsetWidth)-k.offsetWidth)/2)),w=Math.abs(Math.floor(((window.innerHeight||document.documentElement.offsetHeight)-k.offsetHeight)/2));return m.position=="top"?k.style.top="-3px":k.style.top=w+"px",k.style.left=x+"px",k.onkeydown=a,y.focus(k),m.hidden&&y.hide(k),t.callEvent("onMessagePopup",[k]),k}function c(m){return d(m,!0,!1)}function u(m){return d(m,!0,!0)}function h(m){return d(m)}function _(m,g,p){return typeof m!="object"&&(typeof g=="function"&&(p=g,g=""),m={text:m,type:g,callback:p}),m}function f(m,g,p,k){return typeof m!="object"&&(m={text:m,type:g,expire:p,id:k}),m.id=m.id||ot(),m.expire=m.expire||v.expire,m}t.event(s,"keydown",a,!0);var y=function(){var m=_.apply(this,arguments);return m.type=m.type||"alert",h(m)};y.hide=function(m){for(;m&&m.getAttribute&&!m.getAttribute(n);)m=m.parentNode;m&&(m.parentNode.removeChild(m),r(!1),t.callEvent("onAfterMessagePopup",[m]))},y.focus=function(m){setTimeout(function(){var g=At(m);g.length&&g[0].focus&&g[0].focus()},1)};var v=function(m,g,p,k){switch((m=f.apply(this,arguments)).type=m.type||"info",m.type.split("-")[0]){case"alert":return c(m);case"confirm":return u(m);case"modalbox":return h(m);default:return function(x){v.area||(v.area=document.createElement("div"),v.area.className="gantt_message_area",v.area.style[v.position]="5px"),J(v.area,document.body)||document.body.appendChild(v.area),v.hide(x.id);var w=document.createElement("div");return w.innerHTML="<div>"+x.text+"</div>",w.className="gantt-info gantt-"+x.type,w.onclick=function(){v.hide(x.id),x=null},t._waiAria.messageInfoAttr(w),v.position=="bottom"&&v.area.firstChild?v.area.insertBefore(w,v.area.firstChild):v.area.appendChild(w),x.expire>0&&(v.timers[x.id]=window.setTimeout(function(){v&&v.hide(x.id)},x.expire)),v.pull[x.id]=w,w=null,x.id}(m)}};v.seed=new Date().valueOf(),v.uid=ot,v.expire=4e3,v.keyboard=!0,v.position="top",v.pull={},v.timers={},v.hideAll=function(){for(var m in v.pull)v.hide(m)},v.hide=function(m){var g=v.pull[m];g&&g.parentNode&&(window.setTimeout(function(){g.parentNode.removeChild(g),g=null},2e3),g.className+=" hidden",v.timers[m]&&window.clearTimeout(v.timers[m]),delete v.pull[m])};var b=[];return t.attachEvent("onMessagePopup",function(m){b.push(m)}),t.attachEvent("onAfterMessagePopup",function(m){for(var g=0;g<b.length;g++)b[g]===m&&(b.splice(g,1),g--)}),t.attachEvent("onDestroy",function(){r.cover&&r.cover.parentNode&&r.cover.parentNode.removeChild(r.cover);for(var m=0;m<b.length;m++)b[m].parentNode&&b[m].parentNode.removeChild(b[m]);b=null,v.area&&v.area.parentNode&&v.area.parentNode.removeChild(v.area),v=null}),{alert:function(){var m=_.apply(this,arguments);return m.type=m.type||"confirm",c(m)},confirm:function(){var m=_.apply(this,arguments);return m.type=m.type||"alert",u(m)},message:v,modalbox:y}}function cn(t,n){var e=this.$config[t];return e?(e.$extendedConfig||(e.$extendedConfig=!0,Object.setPrototypeOf(e,n)),e):n}function _a(t,n){var e,i,a;R(t,(e=n,{$getConfig:function(){return i||(i=e?e.$getConfig():this.$gantt.config),this.$config.config?cn.call(this,"config",i):i},$getTemplates:function(){return a||(a=e?e.$getTemplates():this.$gantt.templates),this.$config.templates?cn.call(this,"templates",a):a}}))}const ga=function(t){var n={},e={};function i(a,s,r,o){var l=n[a];if(!l||!l.create)return!1;a!="resizer"||r.mode||(o.$config.cols?r.mode="x":r.mode="y"),a!="viewcell"||r.view!="scrollbar"||r.scroll||(o.$config.cols?r.scroll="y":r.scroll="x"),(r=K(r)).id||e[r.view]||(r.id=r.view),r.id&&!r.css&&(r.css=r.id+"_cell");var d=new l.create(s,r,this,t);return l.configure&&l.configure(d),_a(d,o),d.$id||(d.$id=r.id||t.uid()),d.$parent||typeof s!="object"||(d.$parent=s),d.$config||(d.$config=r),e[d.$id]&&(d.$id=t.uid()),e[d.$id]=d,d}return{initUI:function(a,s){var r="cell";return a.view?r="viewcell":a.resizer?r="resizer":a.rows||a.cols?r="layout":a.views&&(r="multiview"),i.call(this,r,null,a,s)},reset:function(){e={}},registerView:function(a,s,r){n[a]={create:s,configure:r}},createView:i,getView:function(a){return e[a]}}};var fa=function(t){return function(n){var e={click:{},doubleclick:{},contextMenu:{}};function i(h,_,f,y){e[h][_]||(e[h][_]=[]),e[h][_].push({handler:f,root:y})}function a(h){h=h||window.event;var _=n.locate(h),f=r(h,e.click),y=!0;if(_!==null?y=!n.checkEvent("onTaskClick")||n.callEvent("onTaskClick",[_,h]):n.callEvent("onEmptyClick",[h]),y){if(!o(f,h,_))return;switch(h.target.nodeName){case"SELECT":case"INPUT":return}_&&n.getTask(_)&&!n._multiselect&&n.config.select_task&&n.selectTask(_)}}function s(h){var _=(h=h||window.event).target||h.srcElement,f=n.locate(_),y=n.locate(_,n.config.link_attribute),v=!n.checkEvent("onContextMenu")||n.callEvent("onContextMenu",[f,y,h]);return v||(h.preventDefault?h.preventDefault():h.returnValue=!1),v}function r(h,_){for(var f=h.target||h.srcElement,y=[];f;){var v=t.getClassName(f);if(v){v=v.split(" ");for(var b=0;b<v.length;b++)if(v[b]&&_[v[b]])for(var m=_[v[b]],g=0;g<m.length;g++)m[g].root&&!t.isChildOf(f,m[g].root)||y.push(m[g].handler)}f=f.parentNode}return y}function o(h,_,f){for(var y=!0,v=0;v<h.length;v++){var b=h[v].call(n,_,f,_.target||_.srcElement);y=y&&!(b!==void 0&&b!==!0)}return y}function l(h){h=h||window.event;var _=n.locate(h),f=r(h,e.doubleclick),y=!n.checkEvent("onTaskDblClick")||_===null||n.callEvent("onTaskDblClick",[_,h]);if(y){if(!o(f,h,_))return;_!==null&&n.getTask(_)&&y&&n.config.details_on_dblclick&&!n.isReadonly(_)&&n.showLightbox(_)}}function d(h){if(n.checkEvent("onMouseMove")){var _=n.locate(h);n._last_move_event=h,n.callEvent("onMouseMove",[_,h])}}var c=n._createDomEventScope();function u(h){c.detachAll(),h&&(c.attach(h,"click",a),c.attach(h,"dblclick",l),c.attach(h,"mousemove",d),c.attach(h,"contextmenu",s))}return{reset:u,global:function(h,_,f){i(h,_,f,null)},delegate:i,detach:function(h,_,f,y){if(e[h]&&e[h][_]){for(var v=e[h],b=v[_],m=0;m<b.length;m++)b[m].root==y&&(b.splice(m,1),m--);b.length||delete v[_]}},callHandler:function(h,_,f,y){var v=e[h][_];if(v)for(var b=0;b<v.length;b++)(f||v[b].root)&&v[b].root!==f||v[b].handler.apply(this,y)},onDoubleClick:l,onMouseMove:d,onContextMenu:s,onClick:a,destructor:function(){u(),e=null,c=null}}}}(Be);const pa={init:fa};function un(t,n,e){return!!n&&!(n.left>t.x_end||n.left+n.width<t.x)&&!(n.top>t.y_end||n.top+n.height<t.y)}function Lt(t){return t.config.smart_rendering&&t._smart_render}function Kt(t,n,e){return{top:n.getItemTop(t.id),height:n.getItemHeight(t.id),left:0,right:1/0}}function mt(t,n,e,i,a){var s=n.getItemIndexByTopPosition(a.y)||0,r=n.getItemIndexByTopPosition(a.y_end)||i.count(),o=Math.max(0,s-1),l=Math.min(i.count(),r+1);const d=[];if(t.config.keyboard_navigation&&t.getSelectedId()){let c=t.getTask(t.getSelectedId());c.$expanded_branch&&!c.$split_subtask&&d.push(t.getSelectedId())}if(t.$ui.getView("grid")&&t.ext.inlineEditors&&t.ext.inlineEditors.getState().id){let c=t.ext.inlineEditors.getState().id;i.exists(c)&&d.push(c)}return{start:o,end:l,ids:d}}var ma=function(t){var n=function(e){var i={},a={};function s(o){var l=null;return typeof o.view=="string"?l=e.$ui.getView(o.view):o.view&&(l=o.view),l}function r(o,l,d){if(a[o])return a[o];l.renderer||e.assert(!1,"Invalid renderer call");var c=null,u=null,h=null,_=null,f=null;typeof l.renderer=="function"?(c=l.renderer,h=Kt):(c=l.renderer.render,u=l.renderer.update,_=l.renderer.onrender,l.renderer.isInViewPort?f=l.renderer.isInViewPort:h=l.renderer.getRectangle,h||h===null||(h=Kt));var y=l.filter;return d&&d.setAttribute(e.config.layer_attribute,!0),a[o]={render_item:function(v,b,m,g,p){if(b=b||d,!y||y(v)){var k=g||s(l),x=p||(k?k.$getConfig():null),w=m;!w&&x&&x.smart_rendering&&(w=k.getViewPort());var $=null;!Lt(e)&&(h||f)&&w?(f?f(v,w,k,x,e):un(w,h(v,k,x,e)))&&($=c.call(e,v,k,x,w)):$=c.call(e,v,k,x,w),this.append(v,$,b);var T=b.nodeType==11;_&&!T&&$&&_.call(e,v,$,k)}else this.remove_item(v.id)},clear:function(v){this.rendered=i[o]={},l.append||this.clear_container(v)},clear_container:function(v){(v=v||d)&&(v.innerHTML="")},get_visible_range:function(v){var b,m,g=s(l),p=g?g.$getConfig():null;return p&&p.smart_rendering&&(b=g.getViewPort()),g&&b&&(typeof l.renderer=="function"?m=mt(e,g,0,v,b):l.renderer&&l.renderer.getVisibleRange&&(m=l.renderer.getVisibleRange(e,g,p,v,b))),m||(m={start:0,end:v.count()}),m},prepare_data:function(v){if(l.renderer&&l.renderer.prepareData)return l.renderer.prepareData(v,e,l)},render_items:function(v,b){b=b||d;var m=document.createDocumentFragment();this.clear(b);var g=null,p=s(l),k=p?p.$getConfig():null;k&&k.smart_rendering&&(g=p.getViewPort());for(var x=0,w=v.length;x<w;x++)this.render_item(v[x],m,g,p,k);b.appendChild(m,b);var $={};v.forEach(function(C){$[C.id]=C});var T={};if(_){var S={};for(var x in this.rendered)T[x]||(S[x]=this.rendered[x],_.call(e,$[x],this.rendered[x],p))}},update_items:function(v,b){var m=s(l),g=m?m.$getConfig():null;if(m&&m.$getConfig().smart_rendering&&!Lt(e)&&this.rendered&&(h||f)){b=b||d;var p=document.createDocumentFragment(),k=null;m&&(k=m.getViewPort());var x={};v.forEach(function(M){x[M.id]=M});var w={},$={};for(var T in this.rendered)$[T]=!0,w[T]=!0;for(var S={},C=(T=0,v.length);T<C;T++){var E=v[T],D=this.rendered[E.id];$[E.id]=!1,D&&D.parentNode?(f?f(E,k,m,g,e):un(k,h(E,m,g,e)))?(u&&u.call(e,E,D,m,g,k),this.restore(E,p)):$[E.id]=!0:(S[v[T].id]=!0,this.render_item(v[T],p,k,m,g))}for(var T in $)$[T]&&this.hide(T);if(p.childNodes.length&&b.appendChild(p,b),_){var A={};for(var T in this.rendered)w[T]&&!S[T]||(A[T]=this.rendered[T],_.call(e,x[T],this.rendered[T],m))}}},append:function(v,b,m){this.rendered&&(b?(this.rendered[v.id]&&this.rendered[v.id].parentNode?this.replace_item(v.id,b):m.appendChild(b),this.rendered[v.id]=b):this.rendered[v.id]&&this.remove_item(v.id))},replace_item:function(v,b){var m=this.rendered[v];m&&m.parentNode&&m.parentNode.replaceChild(b,m),this.rendered[v]=b},remove_item:function(v){this.hide(v),delete this.rendered[v]},hide:function(v){var b=this.rendered[v];b&&b.parentNode&&b.parentNode.removeChild(b),delete this.rendered[v]},restore:function(v,b){var m=this.rendered[v.id];m?m.parentNode||this.append(v,m,b||d):this.render_item(v,b||d)},change_id:function(v,b){this.rendered[b]=this.rendered[v],delete this.rendered[v]},rendered:i[o],node:d,destructor:function(){this.clear(),delete a[o],delete i[o]}},a[o]}return{getRenderer:r,clearRenderers:function(){for(var o in a)r(o).destructor()}}}(t);return{createGroup:function(e,i,a,s){var r={tempCollection:[],renderers:{},container:e,filters:[],getLayers:function(){this._add();var o=[];for(var l in this.renderers)o.push(this.renderers[l]);return o},getLayer:function(o){return this.renderers[o]},_add:function(o){o&&(o.id=o.id||ot(),this.tempCollection.push(o));const l=this.container(),d=this.tempCollection;for(let c=0;c<d.length;c++){if(o=d[c],!(this.container()||o&&o.container&&o.container.isConnected))continue;let u=o.container,h=o.id,_=o.topmost;if(!u.parentNode)if(_)l.appendChild(u);else{let f=i?i():l.firstChild;f&&f.parentNode==l?l.insertBefore(u,f):l.appendChild(u)}this.renderers[h]=n.getRenderer(h,o,u),s&&s(o,t),this.tempCollection.splice(c,1),c--}},addLayer:function(o){if(o){typeof o=="function"&&(o={renderer:o}),o.filter===void 0?o.filter=hn(a||[]):o.filter instanceof Array&&(o.filter.push(a),o.filter=hn(o.filter)),o.container||(o.container=document.createElement("div"));var l=this;o.requestUpdate=function(){t.config.smart_rendering&&!Lt(t)&&l.renderers[o.id]&&l.onUpdateRequest(l.renderers[o.id])}}return this._add(o),o?o.id:void 0},onUpdateRequest:function(o){},eachLayer:function(o){for(var l in this.renderers)o(this.renderers[l])},removeLayer:function(o){this.renderers[o]&&(this.renderers[o].destructor(),delete this.renderers[o])},clear:function(){for(var o in this.renderers)this.renderers[o].destructor();this.renderers={}}};return t.attachEvent("onDestroy",function(){r.clear(),r=null}),r}}};function hn(t){return t instanceof Array||(t=Array.prototype.slice.call(arguments,0)),function(n){for(var e=!0,i=0,a=t.length;i<a;i++){var s=t[i];s&&(e=e&&s(n.id,n)!==!1)}return e}}function _n(t,n,e){if(!t.start_date||!t.end_date)return null;var i=n.posFromDate(t.start_date,n._getPositioningContext?n._getPositioningContext(t):null),a=n.posFromDate(t.end_date,n._getPositioningContext?n._getPositioningContext(t):null),s=Math.min(i,a)-200,r=Math.max(i,a)+200;return{top:n.getItemTop(t.id),height:n.getItemHeight(t.id),left:s,width:r-s}}function gn(){var t=[],n=!1;function e(){t=[],n=!1}function i(s,r,o){r.$getConfig(),s.getVisibleItems().forEach(function(l){var d=function(c,u,h,_){if(!_.isTaskExists(c.source)||!_.isTaskExists(c.target))return null;var f=_n(_.getTask(c.source),u),y=_n(_.getTask(c.target),u);if(!f||!y)return null;var v=100,b=Math.min(f.left,y.left)-v,m=Math.max(f.left+f.width,y.left+y.width)+v,g=Math.min(f.top,y.top)-v,p=Math.max(f.top+f.height,y.top+y.height)+v;return{top:g,height:p-g,bottom:p,left:b,width:m-b,right:m}}(l,r,0,o);d&&t.push({id:l.id,rec:d})}),t.sort(function(l,d){return l.rec.right<d.rec.right?-1:1}),n=!0}var a=!1;return function(s,r,o,l,d){(function(f){a||(a=!0,f.attachEvent("onPreFilter",e),f.attachEvent("onStoreUpdated",e),f.attachEvent("onClearAll",e),f.attachEvent("onBeforeStoreUpdate",e))})(l),n||i(l,r,s);for(var c=[],u=0;u<t.length;u++){var h=t[u],_=h.rec;_.right<d.x||_.left<d.x_end&&_.right>d.x&&_.top<d.y_end&&_.bottom>d.y&&c.push(h.id)}return{ids:c}}}function fn(t,n,e,i,a){var s=e.$gantt.getTask(t.source),r=e.$gantt.getTask(t.target),o=e.getItemTop(s.id),l=e.getItemHeight(s.id),d=e.getItemTop(r.id),c=e.getItemHeight(r.id);if(n.y>o+l&&n.y>d+c||n.y_end<d&&n.y_end<o)return!1;var u=e.posFromDate(s.start_date,e._getPositioningContext?e._getPositioningContext(t):null),h=e.posFromDate(s.end_date,e._getPositioningContext?e._getPositioningContext(t):null),_=e.posFromDate(r.start_date,e._getPositioningContext?e._getPositioningContext(t):null),f=e.posFromDate(r.end_date,e._getPositioningContext?e._getPositioningContext(t):null);if(u>h){var y=h;h=u,u=y}return _>f&&(y=f,f=_,_=y),u+=-100,h+=100,_+=-100,f+=100,!(n.x>h&&n.x>f)&&!(n.x_end<u&&n.x_end<_)}function va(t,n){if(t.view){var e=t.view;typeof e=="string"&&(e=n.$ui.getView(e)),e&&e.attachEvent&&e.attachEvent("onScroll",function(){n.$services.getService("state").getState("batchUpdate").batch_update||e.$config.$skipSmartRenderOnScroll||t.requestUpdate&&t.requestUpdate()})}}var Rt=function(){function t(n,e,i,a){n&&(this.$container=re(n),this.$parent=n),this.$config=R(e,{headerHeight:33}),this.$gantt=a,this.$domEvents=a._createDomEventScope(),this.$id=e.id||"c"+ot(),this.$name="cell",this.$factory=i,this.$externalComponent=null,st(this)}return t.prototype.destructor=function(){this.$parent=this.$container=this.$view=null,this.$gantt.$services.getService("mouseEvents").detach("click","gantt_header_arrow",this._headerClickHandler),this.$domEvents.detachAll(),this.callEvent("onDestroy",[]),this.detachAllEvents()},t.prototype.cell=function(n){return null},t.prototype.scrollTo=function(n,e){var i=this.$view;this.$config.html&&(i=this.$view.firstChild),1*n==n&&(i.scrollLeft=n),1*e==e&&(i.scrollTop=e)},t.prototype.clear=function(){this.getNode().innerHTML="",this.getNode().className="gantt_layout_content",this.getNode().style.padding="0"},t.prototype.resize=function(n){if(this.$parent)return this.$parent.resize(n);n===!1&&(this.$preResize=!0);var e=this.$container,i=e.offsetWidth,a=e.offsetHeight,s=this.getSize();e===document.body&&(i=document.body.offsetWidth,a=document.body.offsetHeight),i<s.minWidth&&(i=s.minWidth),i>s.maxWidth&&(i=s.maxWidth),a<s.minHeight&&(a=s.minHeight),a>s.maxHeight&&(a=s.maxHeight),this.setSize(i,a),this.$preResize,this.$preResize=!1},t.prototype.hide=function(){this._hide(!0),this.resize()},t.prototype.show=function(n){this._hide(!1),n&&this.$parent&&this.$parent.show(),this.resize()},t.prototype._hide=function(n){if(n===!0&&this.$view.parentNode)this.$view.parentNode.removeChild(this.$view);else if(n===!1&&!this.$view.parentNode){var e=this.$parent.cellIndex(this.$id);this.$parent.moveView(this,e)}this.$config.hidden=n},t.prototype.$toHTML=function(n,e){n===void 0&&(n=""),e=[e||"",this.$config.css||""].join(" ");var i=this.$config,a="";if(i.raw)n=typeof i.raw=="string"?i.raw:"";else{if(!n){let s=null;s=typeof i.html=="function"?i.html():i.html,this.$gantt.config.external_render&&this.$gantt.config.external_render.isElement(s)&&(this.$externalComponent=s,s=null),n="<div class='gantt_layout_content' "+(e?" class='"+e+"' ":"")+" >"+(s||"")+"</div>"}i.header&&(a="<div class='gantt_layout_header'>"+(i.canCollapse?"<div class='gantt_layout_header_arrow'></div>":"")+"<div class='gantt_layout_header_content'>"+i.header+"</div></div>")}return"<div class='gantt_layout_cell "+e+"' data-cell-id='"+this.$id+"'>"+a+n+"</div>"},t.prototype.$fill=function(n,e){this.$view=n,this.$parent=e,this.init()},t.prototype.getNode=function(){return this.$view.querySelector("gantt_layout_cell")||this.$view},t.prototype.init=function(){var n=this;this._headerClickHandler=function(e){nt(e,"data-cell-id")==n.$id&&n.toggle()},this.$gantt.$services.getService("mouseEvents").delegate("click","gantt_header_arrow",this._headerClickHandler),this.callEvent("onReady",[])},t.prototype.toggle=function(){this.$config.collapsed=!this.$config.collapsed,this.resize()},t.prototype.getSize=function(){var n={height:this.$config.height||0,width:this.$config.width||0,gravity:this.$config.gravity||1,minHeight:this.$config.minHeight||0,minWidth:this.$config.minWidth||0,maxHeight:this.$config.maxHeight||1e11,maxWidth:this.$config.maxWidth||1e11};if(this.$config.collapsed){var e=this.$config.mode==="x";n[e?"width":"height"]=n[e?"maxWidth":"maxHeight"]=this.$config.headerHeight}return n},t.prototype.getContentSize=function(){var n=this.$lastSize.contentX;n!==1*n&&(n=this.$lastSize.width);var e=this.$lastSize.contentY;return e!==1*e&&(e=this.$lastSize.height),{width:n,height:e}},t.prototype._getBorderSizes=function(){var n={top:0,right:0,bottom:0,left:0,horizontal:0,vertical:0};return this._currentBorders&&(this._currentBorders[this._borders.left]&&(n.left=1,n.horizontal++),this._currentBorders[this._borders.right]&&(n.right=1,n.horizontal++),this._currentBorders[this._borders.top]&&(n.top=1,n.vertical++),this._currentBorders[this._borders.bottom]&&(n.bottom=1,n.vertical++)),n},t.prototype.setSize=function(n,e){this.$view.style.width=n+"px",this.$view.style.height=e+"px";var i=this._getBorderSizes(),a=e-i.vertical,s=n-i.horizontal;this.$lastSize={x:n,y:e,contentX:s,contentY:a},this.$config.header?this._sizeHeader():this._sizeContent()},t.prototype._borders={left:"gantt_layout_cell_border_left",right:"gantt_layout_cell_border_right",top:"gantt_layout_cell_border_top",bottom:"gantt_layout_cell_border_bottom"},t.prototype._setBorders=function(n,e){e||(e=this);var i=e.$view;for(var a in this._borders)jt(i,this._borders[a]);typeof n=="string"&&(n=[n]);var s={};for(a=0;a<n.length;a++)wt(i,n[a]),s[n[a]]=!0;e._currentBorders=s},t.prototype._sizeContent=function(){var n=this.$view.childNodes[0];n&&n.className=="gantt_layout_content"&&(n.style.height=this.$lastSize.contentY+"px")},t.prototype._sizeHeader=function(){var n=this.$lastSize;n.contentY-=this.$config.headerHeight;var e=this.$view.childNodes[0],i=this.$view.childNodes[1],a=this.$config.mode==="x";if(this.$config.collapsed)if(i.style.display="none",a){e.className="gantt_layout_header collapsed_x",e.style.width=n.y+"px";var s=Math.floor(n.y/2-n.x/2);e.style.transform="rotate(90deg) translate("+s+"px, "+s+"px)",i.style.display="none"}else e.className="gantt_layout_header collapsed_y";else e.className=a?"gantt_layout_header":"gantt_layout_header vertical",e.style.width="auto",e.style.transform="",i.style.display="",i.style.height=n.contentY+"px";e.style.height=this.$config.headerHeight+"px"},t}();function j(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}var pn=function(t){function n(e,i,a){var s=t.apply(this,arguments)||this;return e&&(s.$root=!0),s._parseConfig(i),s.$name="layout",s}return j(n,t),n.prototype.destructor=function(){this.$container&&this.$view&&Le(this.$view);for(var e=0;e<this.$cells.length;e++)this.$cells[e].destructor();this.$cells=[],t.prototype.destructor.call(this)},n.prototype._resizeScrollbars=function(e,i){var a=!1,s=[],r=[];const o=[];function l(f){f.$parent.show(),a=!0,s.push(f)}function d(f){f.$parent.hide(),a=!0,r.push(f)}for(var c,u=0;u<i.length;u++)e[(c=i[u]).$config.scroll]?d(c):c.shouldHide()?o.push(c):c.shouldShow()?l(c):c.isVisible()?s.push(c):r.push(c);var h={};for(u=0;u<s.length;u++)s[u].$config.group&&(h[s[u].$config.group]=!0);for(o.forEach(function(f){f.$config.group&&h[f.$config.group]||d(f)}),u=0;u<r.length;u++)if((c=r[u]).$config.group&&h[c.$config.group]){l(c);for(var _=0;_<s.length;_++)if(s[_]==c){this.$gantt.$scrollbarRepaint=!0;break}}return a},n.prototype.getScrollbarsInfo=function(){const e=this.getCellsByType("scroller"),i=[];return e.forEach(a=>{let s={};const{visible:r,direction:o,size:l,scrollSize:d,position:c}=a.getScrollState();let u=a._getLinkedViews().map(h=>h.$config.id);s.id=a.$id,s.visible=r,s.boundViews=u,o==="x"?(s.x=l,s.x_inner=d,s.x_pos=c||0):(s.y=l,s.y_inner=d,s.y_pos=c||0),i.push(s)}),i},n.prototype._syncCellSizes=function(e,i){if(e){var a={};return this._eachChild(function(s){s.$config.group&&s.$name!="scrollbar"&&s.$name!="resizer"&&(a[s.$config.group]||(a[s.$config.group]=[]),a[s.$config.group].push(s))}),a[e]&&this._syncGroupSize(a[e],i),a[e]}},n.prototype._syncGroupSize=function(e,i){if(e.length)for(var a=e[0].$parent._xLayout?"width":"height",s=e[0].$parent.getNextSibling(e[0].$id)?1:-1,r=i.value,o=i.isGravity,l=0;l<e.length;l++){var d=e[l].getSize(),c=s>0?e[l].$parent.getNextSibling(e[l].$id):e[l].$parent.getPrevSibling(e[l].$id);c.$name=="resizer"&&(c=s>0?c.$parent.getNextSibling(c.$id):c.$parent.getPrevSibling(c.$id));var u=c.getSize();if(o)e[l].$config.gravity=r;else if(c[a]){var h=d.gravity+u.gravity,_=d[a]+u[a],f=h/_;e[l].$config.gravity=f*r,c.$config[a]=_-r,c.$config.gravity=h-f*r}else e[l].$config[a]=r;var y=this.$gantt.$ui.getView("grid");!y||e[l].$content!==y||y.$config.scrollable||o||(this.$gantt.config.grid_width=r)}},n.prototype.resize=function(e){var i=!1;if(this.$root&&!this._resizeInProgress&&(this.callEvent("onBeforeResize",[]),i=!0,this._resizeInProgress=!0),t.prototype.resize.call(this,!0),t.prototype.resize.call(this,!1),i){var a=[];a=(a=(a=a.concat(this.getCellsByType("viewCell"))).concat(this.getCellsByType("viewLayout"))).concat(this.getCellsByType("hostCell"));for(var s=this.getCellsByType("scroller"),r=0;r<a.length;r++)a[r].$config.hidden||a[r].setContentSize();var o=this._getAutosizeMode(this.$config.autosize),l=this._resizeScrollbars(o,s);if(this.$config.autosize&&(this.autosize(this.$config.autosize),a.forEach(function(d){const c=d.$parent,u=c.getContentSize(o);o.x&&(c.$config.$originalWidthStored||(c.$config.$originalWidthStored=!0,c.$config.$originalWidth=c.$config.width),c.$config.width=u.width),o.y&&(c.$config.$originalHeightStored||(c.$config.$originalHeightStored=!0,c.$config.$originalHeight=c.$config.height),c.$config.height=u.height)}),l=!0),l)for(this.resize(),r=0;r<a.length;r++)a[r].$config.hidden||a[r].setContentSize();this.callEvent("onResize",[])}i&&(this._resizeInProgress=!1)},n.prototype._eachChild=function(e,i){if(e(i=i||this),i.$cells)for(var a=0;a<i.$cells.length;a++)this._eachChild(e,i.$cells[a])},n.prototype.isChild=function(e){var i=!1;return this._eachChild(function(a){a!==e&&a.$content!==e||(i=!0)}),i},n.prototype.getCellsByType=function(e){var i=[];if(e===this.$name&&i.push(this),this.$content&&this.$content.$name==e&&i.push(this.$content),this.$cells)for(var a=0;a<this.$cells.length;a++){var s=n.prototype.getCellsByType.call(this.$cells[a],e);s.length&&i.push.apply(i,s)}return i},n.prototype.getNextSibling=function(e){var i=this.cellIndex(e);return i>=0&&this.$cells[i+1]?this.$cells[i+1]:null},n.prototype.getPrevSibling=function(e){var i=this.cellIndex(e);return i>=0&&this.$cells[i-1]?this.$cells[i-1]:null},n.prototype.cell=function(e){for(var i=0;i<this.$cells.length;i++){var a=this.$cells[i];if(a.$id===e)return a;var s=a.cell(e);if(s)return s}},n.prototype.cellIndex=function(e){for(var i=0;i<this.$cells.length;i++)if(this.$cells[i].$id===e)return i;return-1},n.prototype.moveView=function(e,i){if(this.$cells[i]!==e)return window.alert("Not implemented");i+=this.$config.header?1:0;var a=this.$view;i>=a.childNodes.length?a.appendChild(e.$view):a.insertBefore(e.$view,a.childNodes[i])},n.prototype._parseConfig=function(e){this.$cells=[],this._xLayout=!e.rows;for(var i=e.rows||e.cols||e.views,a=0;a<i.length;a++){var s=i[a];s.mode=this._xLayout?"x":"y";var r=this.$factory.initUI(s,this);r?(r.$parent=this,this.$cells.push(r)):(i.splice(a,1),a--)}},n.prototype.getCells=function(){return this.$cells},n.prototype.render=function(){var e=Ne(this.$container,this.$toHTML());this.$fill(e,null);const i=this.$gantt;this._eachChild(a=>{a.$externalComponent&&(i.config.external_render.renderElement(a.$externalComponent,a.$view.querySelector(".gantt_layout_content")),a.$externalComponent=null)}),this.callEvent("onReady",[]),this.resize(),this.render=this.resize},n.prototype.$fill=function(e,i){this.$view=e,this.$parent=i;for(var a=Re(e,"gantt_layout_cell"),s=a.length-1;s>=0;s--){var r=this.$cells[s];r.$fill(a[s],this),r.$config.hidden&&r.$view.parentNode.removeChild(r.$view)}},n.prototype.$toHTML=function(){for(var e=this._xLayout?"x":"y",i=[],a=0;a<this.$cells.length;a++)i.push(this.$cells[a].$toHTML());return t.prototype.$toHTML.call(this,i.join(""),(this.$root?"gantt_layout_root ":"")+"gantt_layout gantt_layout_"+e)},n.prototype.getContentSize=function(e){for(var i,a,s,r=0,o=0,l=0;l<this.$cells.length;l++)(a=this.$cells[l]).$config.hidden||(i=a.getContentSize(e),a.$config.view==="scrollbar"&&e[a.$config.scroll]&&(i.height=0,i.width=0),a.$config.resizer&&(this._xLayout?i.height=0:i.width=0),s=a._getBorderSizes(),this._xLayout?(r+=i.width+s.horizontal,o=Math.max(o,i.height+s.vertical)):(r=Math.max(r,i.width+s.horizontal),o+=i.height+s.vertical));return{width:r+=(s=this._getBorderSizes()).horizontal,height:o+=s.vertical}},n.prototype._cleanElSize=function(e){return 1*(e||"").toString().replace("px","")||0},n.prototype._getBoxStyles=function(e){var i=null,a=["width","height","paddingTop","paddingBottom","paddingLeft","paddingRight","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],s={boxSizing:(i=window.getComputedStyle?window.getComputedStyle(e,null):{width:e.clientWidth,height:e.clientHeight}).boxSizing=="border-box"};i.MozBoxSizing&&(s.boxSizing=i.MozBoxSizing=="border-box");for(var r=0;r<a.length;r++)s[a[r]]=i[a[r]]?this._cleanElSize(i[a[r]]):0;var o={horPaddings:s.paddingLeft+s.paddingRight+s.borderLeftWidth+s.borderRightWidth,vertPaddings:s.paddingTop+s.paddingBottom+s.borderTopWidth+s.borderBottomWidth,borderBox:s.boxSizing,innerWidth:s.width,innerHeight:s.height,outerWidth:s.width,outerHeight:s.height};return o.borderBox?(o.innerWidth-=o.horPaddings,o.innerHeight-=o.vertPaddings):(o.outerWidth+=o.horPaddings,o.outerHeight+=o.vertPaddings),o},n.prototype._getAutosizeMode=function(e){var i={x:!1,y:!1};return e==="xy"?i.x=i.y=!0:e==="y"||e===!0?i.y=!0:e==="x"&&(i.x=!0),i},n.prototype.autosize=function(e){var i=this._getAutosizeMode(e),a=this._getBoxStyles(this.$container),s=this.getContentSize(e),r=this.$container;i.x&&(a.borderBox&&(s.width+=a.horPaddings),r.style.width=s.width+"px"),i.y&&(a.borderBox&&(s.height+=a.vertPaddings),r.style.height=s.height+"px")},n.prototype.getSize=function(){this._sizes=[];for(var e=0,i=0,a=1e11,s=0,r=1e11,o=0,l=0;l<this.$cells.length;l++){var d=this._sizes[l]=this.$cells[l].getSize();this.$cells[l].$config.hidden||(this._xLayout?(!d.width&&d.minWidth?e+=d.minWidth:e+=d.width,a+=d.maxWidth,i+=d.minWidth,s=Math.max(s,d.height),r=Math.min(r,d.maxHeight),o=Math.max(o,d.minHeight)):(!d.height&&d.minHeight?s+=d.minHeight:s+=d.height,r+=d.maxHeight,o+=d.minHeight,e=Math.max(e,d.width),a=Math.min(a,d.maxWidth),i=Math.max(i,d.minWidth)))}var c=t.prototype.getSize.call(this);return c.maxWidth>=1e5&&(c.maxWidth=a),c.maxHeight>=1e5&&(c.maxHeight=r),c.minWidth=c.minWidth!=c.minWidth?0:c.minWidth,c.minHeight=c.minHeight!=c.minHeight?0:c.minHeight,this._xLayout?(c.minWidth+=this.$config.margin*this.$cells.length||0,c.minWidth+=2*this.$config.padding||0,c.minHeight+=2*this.$config.padding||0):(c.minHeight+=this.$config.margin*this.$cells.length||0,c.minHeight+=2*this.$config.padding||0),c},n.prototype._calcFreeSpace=function(e,i,a){var s=a?i.minWidth:i.minHeight,r=i.maxWidth,o=e;return o?(o>r&&(o=r),o<s&&(o=s),this._free-=o):((o=Math.floor(this._free/this._gravity*i.gravity))>r&&(o=r,this._free-=o,this._gravity-=i.gravity),o<s&&(o=s,this._free-=o,this._gravity-=i.gravity)),o},n.prototype._calcSize=function(e,i,a){var s=e,r=a?i.minWidth:i.minHeight,o=a?i.maxWidth:i.maxHeight;return s||(s=Math.floor(this._free/this._gravity*i.gravity)),s>o&&(s=o),s<r&&(s=r),s},n.prototype._configureBorders=function(){this.$root&&this._setBorders([this._borders.left,this._borders.top,this._borders.right,this._borders.bottom],this);for(var e=this._xLayout?this._borders.right:this._borders.bottom,i=this.$cells,a=i.length-1,s=a;s>=0;s--)if(!i[s].$config.hidden){a=s;break}for(s=0;s<i.length;s++)if(!i[s].$config.hidden){var r=s>=a,o="";!r&&i[s+1]&&i[s+1].$config.view=="scrollbar"&&(this._xLayout?r=!0:o="gantt_layout_cell_border_transparent"),this._setBorders(r?[]:[e,o],i[s])}},n.prototype._updateCellVisibility=function(){for(var e=this._visibleCells||{},i=!this._visibleCells,a={},s=null,r=[],o=0;o<this._sizes.length;o++)(s=this.$cells[o]).$config.hide_empty&&r.push(s),!i&&s.$config.hidden&&e[s.$id]?s._hide(!0):s.$config.hidden||e[s.$id]||s._hide(!1),s.$config.hidden||(a[s.$id]=!0);for(this._visibleCells=a,o=0;o<r.length;o++){var l=(s=r[o]).$cells,d=!0;l.forEach(function(c){c.$config.hidden||c.$config.resizer||(d=!1)}),s.$config.hidden=d}},n.prototype.setSize=function(e,i){this._configureBorders(),t.prototype.setSize.call(this,e,i),i=this.$lastSize.contentY,e=this.$lastSize.contentX;var a,s,r=this.$config.padding||0;this.$view.style.padding=r+"px",this._gravity=0,this._free=this._xLayout?e:i,this._free-=2*r,this._updateCellVisibility();for(var o=0;o<this._sizes.length;o++)if(!(a=this.$cells[o]).$config.hidden){var l=this.$config.margin||0;a.$name!="resizer"||l||(l=-1);var d=a.$view,c=this._xLayout?"marginRight":"marginBottom";o!==this.$cells.length-1&&(d.style[c]=l+"px",this._free-=l),s=this._sizes[o],this._xLayout?s.width||(this._gravity+=s.gravity):s.height||(this._gravity+=s.gravity)}for(o=0;o<this._sizes.length;o++)if(!(a=this.$cells[o]).$config.hidden){var u=(s=this._sizes[o]).width,h=s.height;this._xLayout?this._calcFreeSpace(u,s,!0):this._calcFreeSpace(h,s,!1)}for(o=0;o<this.$cells.length;o++)if(!(a=this.$cells[o]).$config.hidden){s=this._sizes[o];var _=void 0,f=void 0;this._xLayout?(_=this._calcSize(s.width,s,!0),f=i-2*r):(_=e-2*r,f=this._calcSize(s.height,s,!1)),a.setSize(_,f)}},n}(Rt),ka=function(t){function n(e,i,a){for(var s=t.apply(this,arguments)||this,r=0;r<s.$cells.length;r++)s.$cells[r].$config.hidden=r!==0;return s.$cell=s.$cells[0],s.$name="viewLayout",s}return j(n,t),n.prototype.cell=function(e){var i=t.prototype.cell.call(this,e);return i.$view||this.$fill(null,this),i},n.prototype.moveView=function(e){var i=this.$view;this.$cell&&(this.$cell.$config.hidden=!0,i.removeChild(this.$cell.$view)),this.$cell=e,i.appendChild(e.$view)},n.prototype.setSize=function(e,i){Rt.prototype.setSize.call(this,e,i)},n.prototype.setContentSize=function(){var e=this.$lastSize;this.$cell.setSize(e.contentX,e.contentY)},n.prototype.getSize=function(){var e=t.prototype.getSize.call(this);if(this.$cell){var i=this.$cell.getSize();if(this.$config.byMaxSize)for(var a=0;a<this.$cells.length;a++){var s=this.$cells[a].getSize();for(var r in i)i[r]=Math.max(i[r],s[r])}for(var o in e)e[o]=e[o]||i[o];e.gravity=Math.max(e.gravity,i.gravity)}return e},n}(pn),ya=function(t){function n(e,i,a){var s=t.apply(this,arguments)||this;if(i.view){i.id&&(this.$id=ot());var r=K(i);if(delete r.config,delete r.templates,this.$content=this.$factory.createView(i.view,this,r,this),!this.$content)return!1}return s.$name="viewCell",s}return j(n,t),n.prototype.destructor=function(){this.clear(),t.prototype.destructor.call(this)},n.prototype.clear=function(){if(this.$initialized=!1,this.$content){var e=this.$content.unload||this.$content.destructor;e&&e.call(this.$content)}t.prototype.clear.call(this)},n.prototype.scrollTo=function(e,i){this.$content&&this.$content.scrollTo?this.$content.scrollTo(e,i):t.prototype.scrollTo.call(this,e,i)},n.prototype._setContentSize=function(e,i){var a=this._getBorderSizes();if(typeof e=="number"){var s=e+a.horizontal;this.$config.width=s}if(typeof i=="number"){var r=i+a.vertical;this.$config.height=r}},n.prototype.setSize=function(e,i){if(t.prototype.setSize.call(this,e,i),!this.$preResize&&this.$content&&!this.$initialized){this.$initialized=!0;var a=this.$view.childNodes[0],s=this.$view.childNodes[1];s||(s=a),this.$content.init(s)}},n.prototype.setContentSize=function(){!this.$preResize&&this.$content&&this.$initialized&&this.$content.setSize(this.$lastSize.contentX,this.$lastSize.contentY)},n.prototype.getContentSize=function(){var e=t.prototype.getContentSize.call(this);if(this.$content&&this.$initialized){var i=this.$content.getSize();e.width=i.contentX===void 0?i.width:i.contentX,e.height=i.contentY===void 0?i.height:i.contentY}var a=this._getBorderSizes();return e.width+=a.horizontal,e.height+=a.vertical,e},n}(Rt),ba=function(t){var n=["altKey","shiftKey","metaKey"];function e(a,s,r,o){var l=t.apply(this,arguments)||this;this.$config=R(s,{scroll:"x"}),l._scrollHorizontalHandler=O(l._scrollHorizontalHandler,l),l._scrollVerticalHandler=O(l._scrollVerticalHandler,l),l._outerScrollVerticalHandler=O(l._outerScrollVerticalHandler,l),l._outerScrollHorizontalHandler=O(l._outerScrollHorizontalHandler,l),l._mouseWheelHandler=O(l._mouseWheelHandler,l),this.$config.hidden=!0;var d=o.config.scroll_size;return o.env.isIE&&(d+=1),this._isHorizontal()?(l.$config.height=d,l.$parent.$config.height=d):(l.$config.width=d,l.$parent.$config.width=d),this.$config.scrollPosition=0,l.$name="scroller",l}function i(a,s){if(s.push(a),a.$cells)for(var r=0;r<a.$cells.length;r++)i(a.$cells[r],s)}return j(e,t),e.prototype.init=function(a){a.innerHTML=this.$toHTML(),this.$view=a.firstChild,this.$view||this.init(),this._isVertical()?this._initVertical():this._initHorizontal(),this._initMouseWheel(),this._initLinkedViews()},e.prototype.$toHTML=function(){return"<div class='gantt_layout_cell "+(this._isHorizontal()?"gantt_hor_scroll":"gantt_ver_scroll")+"'><div style='"+(this._isHorizontal()?"width:2000px":"height:2000px")+"'></div></div>"},e.prototype._getRootParent=function(){for(var a=this.$parent;a&&a.$parent;)a=a.$parent;if(a)return a},e.prototype._eachView=function(){var a=[];return i(this._getRootParent(),a),a},e.prototype._getLinkedViews=function(){for(var a=this._eachView(),s=[],r=0;r<a.length;r++)a[r].$config&&(this._isVertical()&&a[r].$config.scrollY==this.$id||this._isHorizontal()&&a[r].$config.scrollX==this.$id)&&s.push(a[r]);return s},e.prototype._initHorizontal=function(){this.$scroll_hor=this.$view,this.$domEvents.attach(this.$view,"scroll",this._scrollHorizontalHandler)},e.prototype._initLinkedViews=function(){for(var a=this._getLinkedViews(),s=this._isVertical()?"gantt_layout_outer_scroll gantt_layout_outer_scroll_vertical":"gantt_layout_outer_scroll gantt_layout_outer_scroll_horizontal",r=0;r<a.length;r++)wt(a[r].$view||a[r].getNode(),s)},e.prototype._initVertical=function(){this.$scroll_ver=this.$view,this.$domEvents.attach(this.$view,"scroll",this._scrollVerticalHandler)},e.prototype._updateLinkedViews=function(){},e.prototype._initMouseWheel=function(){pt.isFF?this.$domEvents.attach(this._getRootParent().$view,"wheel",this._mouseWheelHandler,{passive:!1}):this.$domEvents.attach(this._getRootParent().$view,"mousewheel",this._mouseWheelHandler,{passive:!1})},e.prototype.scrollHorizontally=function(a){if(!this._scrolling){this._scrolling=!0,this.$scroll_hor.scrollLeft=a,this.$config.codeScrollLeft=a,a=this.$scroll_hor.scrollLeft;for(var s=this._getLinkedViews(),r=0;r<s.length;r++)s[r].scrollTo&&s[r].scrollTo(a,void 0);var o=this.$config.scrollPosition;this.$config.scrollPosition=a,this.callEvent("onScroll",[o,a,this.$config.scroll]),this._scrolling=!1}},e.prototype.scrollVertically=function(a){if(!this._scrolling){this._scrolling=!0,this.$scroll_ver.scrollTop=a,a=this.$scroll_ver.scrollTop;for(var s=this._getLinkedViews(),r=0;r<s.length;r++)s[r].scrollTo&&s[r].scrollTo(void 0,a);var o=this.$config.scrollPosition;this.$config.scrollPosition=a,this.callEvent("onScroll",[o,a,this.$config.scroll]),this._scrolling=!1}},e.prototype._isVertical=function(){return this.$config.scroll=="y"},e.prototype._isHorizontal=function(){return this.$config.scroll=="x"},e.prototype._scrollHorizontalHandler=function(a){if(!this._isVertical()&&!this._scrolling){if(new Date-(this._wheel_time||0)<100)return!0;var s=this.$scroll_hor.scrollLeft;this.scrollHorizontally(s),this._oldLeft=this.$scroll_hor.scrollLeft}},e.prototype._outerScrollHorizontalHandler=function(a){this._isVertical()},e.prototype.show=function(){this.$parent.show()},e.prototype.hide=function(){this.$parent.hide()},e.prototype._getScrollSize=function(){for(var a,s=0,r=0,o=this._isHorizontal(),l=this._getLinkedViews(),d=o?"scrollWidth":"scrollHeight",c=o?"contentX":"contentY",u=o?"x":"y",h=this._getScrollOffset(),_=0;_<l.length;_++)if((a=l[_])&&a.$content&&a.$content.getSize&&!a.$config.hidden){var f,y=a.$content.getSize();if(f=y.hasOwnProperty(d)?y[d]:y[c],h)y[c]>y[u]&&y[c]>s&&f>y[u]-h+2&&(s=f+(o?0:2),r=y[u]);else{var v=Math.max(y[c]-f,0);(f+=v)>Math.max(y[u]-v,0)&&f>s&&(s=f,r=y[u])}}return{outerScroll:r,innerScroll:s}},e.prototype.scroll=function(a){this._isHorizontal()?this.scrollHorizontally(a):this.scrollVertically(a)},e.prototype.getScrollState=function(){return{visible:this.isVisible(),direction:this.$config.scroll,size:this.$config.outerSize,scrollSize:this.$config.scrollSize||0,position:this.$config.scrollPosition||0}},e.prototype.setSize=function(a,s){t.prototype.setSize.apply(this,arguments);var r=this._getScrollSize(),o=(this._isVertical()?s:a)-this._getScrollOffset()+(this._isHorizontal()?1:0);r.innerScroll&&o>r.outerScroll&&(r.innerScroll+=o-r.outerScroll),this.$config.scrollSize=r.innerScroll,this.$config.width=a,this.$config.height=s,this._setScrollSize(r.innerScroll)},e.prototype.isVisible=function(){return!(!this.$parent||!this.$parent.$view.parentNode)},e.prototype.shouldShow=function(){var a=this._getScrollSize();return!(!a.innerScroll&&this.$parent&&this.$parent.$view.parentNode)&&!(!a.innerScroll||this.$parent&&this.$parent.$view.parentNode)},e.prototype.shouldHide=function(){return!(this._getScrollSize().innerScroll||!this.$parent||!this.$parent.$view.parentNode)},e.prototype.toggleVisibility=function(){this.shouldHide()?this.hide():this.shouldShow()&&this.show()},e.prototype._getScaleOffset=function(a){var s=0;return!a||a.$config.view!="timeline"&&a.$config.view!="grid"||(s=a.$content.$getConfig().scale_height),s},e.prototype._getScrollOffset=function(){var a=0;if(this._isVertical()){var s=this.$parent.$parent;a=Math.max(this._getScaleOffset(s.getPrevSibling(this.$parent.$id)),this._getScaleOffset(s.getNextSibling(this.$parent.$id)))}else for(var r=this._getLinkedViews(),o=0;o<r.length;o++){var l=r[o].$parent.$cells,d=l[l.length-1];if(d&&d.$config.view=="scrollbar"&&d.$config.hidden===!1){a=d.$config.width;break}}return a||0},e.prototype._setScrollSize=function(a){var s=this._isHorizontal()?"width":"height",r=this._isHorizontal()?this.$scroll_hor:this.$scroll_ver,o=this._getScrollOffset(),l=r.firstChild;o?this._isVertical()?(this.$config.outerSize=this.$config.height-o+3,r.style.height=this.$config.outerSize+"px",r.style.top=o-1+"px",wt(r,this.$parent._borders.top),wt(r.parentNode,"gantt_task_vscroll")):(this.$config.outerSize=this.$config.width-o+1,r.style.width=this.$config.outerSize+"px"):(r.style.top="auto",jt(r,this.$parent._borders.top),jt(r.parentNode,"gantt_task_vscroll"),this.$config.outerSize=this.$config.height),l.style[s]=a+"px"},e.prototype._scrollVerticalHandler=function(a){if(!this._scrollHorizontalHandler()&&!this._scrolling){var s=this.$scroll_ver.scrollTop;s!=this._oldTop&&(this.scrollVertically(s),this._oldTop=this.$scroll_ver.scrollTop)}},e.prototype._outerScrollVerticalHandler=function(a){this._scrollHorizontalHandler()},e.prototype._checkWheelTarget=function(a){for(var s=this._getLinkedViews().concat(this),r=0;r<s.length;r++)if(J(a,s[r].$view))return!0;return!1},e.prototype._mouseWheelHandler=function(a){var s=a.target||a.srcElement;if(this._checkWheelTarget(s)){this._wheel_time=new Date;var r={},o={x:1,y:1},l=this.$gantt.config.wheel_scroll_sensitivity;typeof l=="number"&&l?o={x:l,y:l}:{}.toString.apply(l)=="[object Object]"&&(o={x:l.x,y:l.y});var d=pt.isFF,c=d?a.deltaX:a.wheelDeltaX,u=d?a.deltaY:a.wheelDelta,h=-20;if(d){const k=parseInt(navigator.userAgent.split("Firefox/")[1]);h=k<=87?a.deltaMode!==0?-40:-10:k<=90?-3:k<=96?-1.5:-1}var _=d?c*h*o.x:2*c*o.x,f=d?u*h*o.y:u*o.y,y=this.$gantt.config.horizontal_scroll_key;if(y!==!1&&n.indexOf(y)>=0&&(!a[y]||a.deltaX||a.wheelDeltaX||(_=2*f,f=0)),_&&Math.abs(_)>Math.abs(f)){if(this._isVertical())return;if(r.x||!this.$scroll_hor||!this.$scroll_hor.offsetWidth)return!0;var v=_/-40,b=this._oldLeft,m=b+30*v;if(this.scrollHorizontally(m),this.$scroll_hor.scrollLeft=m,b==this.$scroll_hor.scrollLeft)return!0;this._oldLeft=this.$scroll_hor.scrollLeft}else{if(this._isHorizontal())return;if(r.y||!this.$scroll_ver||!this.$scroll_ver.offsetHeight)return!0;v=f/-40,f===void 0&&(v=a.detail);var g=this._oldTop,p=this.$scroll_ver.scrollTop+30*v;if(this.scrollVertically(p),this.$scroll_ver.scrollTop=p,g==this.$scroll_ver.scrollTop)return!0;this._oldTop=this.$scroll_ver.scrollTop}return a.preventDefault&&a.preventDefault(),a.cancelBubble=!0,!1}},e}(Rt);function mn(t){var n={},e={},i=null,a=-1,s=null,r=function(o){var l=-1,d=-1;return{resetCache:function(){l=-1,d=-1},_getRowHeight:function(){return l===-1&&(l=o.$getConfig().row_height),l},_refreshState:function(){this.resetCache(),d=!0;var c=o.$config.rowStore;if(c)for(var u=this._getRowHeight(),h=0;h<c.fullOrder.length;h++){var _=c.getItem(c.fullOrder[h]);if(_&&_.row_height&&_.row_height!==u){d=!1;break}}},canUseSimpleCalculation:function(){return d===-1&&this._refreshState(),d},getRowTop:function(c){return o.$config.rowStore?c*this._getRowHeight():0},getItemHeight:function(c){return this._getRowHeight()},getTotalHeight:function(){return o.$config.rowStore?o.$config.rowStore.countVisible()*this._getRowHeight():0},getItemIndexByTopPosition:function(c){return o.$config.rowStore?Math.floor(c/this._getRowHeight()):0}}}(t);return{_resetTopPositionHeight:function(){n={},e={},r.resetCache()},_resetHeight:function(){var o=this.$config.rowStore,l=this.getCacheStateTotalHeight(o);s?this.shouldClearHeightCache(s,l)&&(s=l,i=null):s=l,a=-1,r.resetCache()},getRowTop:function(o){if(r.canUseSimpleCalculation())return r.getRowTop(o);var l=this.$config.rowStore;if(!l)return 0;if(e[o]!==void 0)return e[o];for(var d=l.getIndexRange(),c=0,u=0,h=0;h<d.length;h++)e[h]=c,c+=this.getItemHeight(d[h].id),h<o&&(u=c);return u},getItemTop:function(o){if(this.$config.rowStore){if(n[o]!==void 0)return n[o];var l=this.$config.rowStore;if(!l)return 0;var d=l.getIndexById(o);if(d===-1&&l.getParent&&l.exists(o)){var c=l.getParent(o);if(l.exists(c)){var u=l.getItem(c);if(this.$gantt.isSplitTask(u))return this.getItemTop(c)}}return n[o]=this.getRowTop(d),n[o]}return 0},getItemHeight:function(o){if(r.canUseSimpleCalculation())return r.getItemHeight(o);if(!i&&this.$config.rowStore&&this._fillHeightCache(this.$config.rowStore),i[o]!==void 0)return i[o];var l=this.$getConfig().row_height;if(this.$config.rowStore){var d=this.$config.rowStore;if(!d)return l;var c=d.getItem(o);return i[o]=c&&c.row_height||l}return l},_fillHeightCache:function(o){if(o){i={};var l=this.$getConfig().row_height;o.eachItem(function(d){return i[d.id]=d&&d.row_height||l})}},getCacheStateTotalHeight:function(o){var l=this.$getConfig().row_height,d={},c=[],u=0;return o&&o.eachItem(function(h){c.push(h),d[h.id]=h.row_height,u+=h.row_height||l}),{globalHeight:l,items:c,count:c.length,sumHeight:u}},shouldClearHeightCache:function(o,l){if(o.count!=l.count||o.globalHeight!=l.globalHeight||o.sumHeight!=l.sumHeight)return!0;for(var d in o.items){var c=l.items[d];if(c!==void 0&&c!=o.items[d])return!0}return!1},getTotalHeight:function(){if(r.canUseSimpleCalculation())return r.getTotalHeight();if(a!=-1)return a;if(this.$config.rowStore){var o=this.$config.rowStore;this._fillHeightCache(o);var l=this.getItemHeight.bind(this),d=o.getVisibleItems(),c=0;return d.forEach(function(u){c+=l(u.id)}),a=c,c}return 0},getItemIndexByTopPosition:function(o){if(this.$config.rowStore){if(r.canUseSimpleCalculation())return r.getItemIndexByTopPosition(o);for(var l=this.$config.rowStore,d=0;d<l.countVisible();d++){var c=this.getRowTop(d),u=this.getRowTop(d+1);if(!u){var h=l.getIdByIndex(d);u=c+this.getItemHeight(h)}if(o>=c&&o<u)return d}return l.countVisible()+2}return 0}}}const xa=function(){return{render:function(){},destroy:function(){}}};var Xt=function(t,n,e,i){this.$config=R({},n||{}),this.$scaleHelper=new qt(i),this.$gantt=i,this._posFromDateCache={},this._posFromWorkTimeCache={},this._timelineDragScroll=null,R(this,mn(this)),st(this)};Xt.prototype={init:function(t){t.innerHTML+="<div class='gantt_task' style='width:inherit;height:inherit;'></div>",this.$task=t.childNodes[0],this.$task.innerHTML="<div class='gantt_task_scale'></div><div class='gantt_data_area'></div>",this.$task_scale=this.$task.childNodes[0],this.$task_data=this.$task.childNodes[1],this.$task_data.innerHTML="<div class='gantt_task_bg'></div><div class='gantt_task_baselines'></div><div class='gantt_links_area'></div><div class='gantt_bars_area'></div><div class='gantt_task_constraints'></div><div class='gantt_task_deadlines'></div>",this.$task_bg=this.$task_data.childNodes[0],this.$task_baselines=this.$task_data.childNodes[1],this.$task_links=this.$task_data.childNodes[2],this.$task_bars=this.$task_data.childNodes[3],this.$task_constraints=this.$task_data.childNodes[4],this.$task_deadlines=this.$task_data.childNodes[5],this._tasks={col_width:0,width:[],full_width:0,trace_x:[],rendered:{}};var n=this.$getConfig(),e=n[this.$config.bind+"_attribute"],i=n[this.$config.bindLinks+"_attribute"];!e&&this.$config.bind&&(e="data-"+this.$config.bind+"-id"),!i&&this.$config.bindLinks&&(i="data-"+this.$config.bindLinks+"-id"),this.$config.item_attribute=e||null,this.$config.link_attribute=i||null;var a=this._createLayerConfig();this.$config.layers||(this.$config.layers=a.tasks),this.$config.linkLayers||(this.$config.linkLayers=a.links),this._attachLayers(this.$gantt),this.callEvent("onReady",[]),this.$gantt.ext.dragTimeline&&(this._timelineDragScroll=this.$gantt.ext.dragTimeline.create(),this._timelineDragScroll.attach(this))},setSize:function(t,n){var e=this.$getConfig();if(1*t===t&&(this.$config.width=t),1*n===n){this.$config.height=n;var i=Math.max(this.$config.height-e.scale_height);this.$task_data.style.height=i+"px"}this.refresh(),this.$task_bg.style.backgroundImage="",e.smart_rendering&&this.$config.rowStore?this.$task_bg.style.height=this.getTotalHeight()+"px":this.$task_bg.style.height="";for(var a=this._tasks,s=this.$task_data.childNodes,r=0,o=s.length;r<o;r++){var l=s[r];l.hasAttribute("data-layer")&&l.style&&(l.style.width=a.full_width+"px")}},isVisible:function(){return this.$parent&&this.$parent.$config?!this.$parent.$config.hidden:this.$task.offsetWidth},getSize:function(){var t=this.$getConfig(),n=this.$config.rowStore?this.getTotalHeight():0,e=this.isVisible()?this._tasks.full_width:0;return{x:this.isVisible()?this.$config.width:0,y:this.isVisible()?this.$config.height:0,contentX:this.isVisible()?e:0,contentY:this.isVisible()?t.scale_height+n:0,scrollHeight:this.isVisible()?n:0,scrollWidth:this.isVisible()?e:0}},scrollTo:function(t,n){if(this.isVisible()){var e=!1;this.$config.scrollTop=this.$config.scrollTop||0,this.$config.scrollLeft=this.$config.scrollLeft||0,1*n===n&&(this.$config.scrollTop=n,this.$task_data.scrollTop=this.$config.scrollTop,e=!0),1*t===t&&(this.$task.scrollLeft=t,this.$config.scrollLeft=this.$task.scrollLeft,this._refreshScales(),e=!0),e&&this.callEvent("onScroll",[this.$config.scrollLeft,this.$config.scrollTop])}},_refreshScales:function(){if(this.isVisible()&&this.$getConfig().smart_scales){var t=this.getViewPort(),n=this._scales;this.$task_scale.innerHTML=this._getScaleChunkHtml(n,t.x,t.x_end)}},getViewPort:function(){var t=this.$config.scrollLeft||0,n=this.$config.scrollTop||0,e=this.$config.height||0,i=this.$config.width||0;return{y:n,y_end:n+e,x:t,x_end:t+i,height:e,width:i}},_createLayerConfig:function(){var t=this,n=function(){return t.isVisible()};this.$gantt;var e=[{expose:!0,renderer:this.$gantt.$ui.layers.taskBar(),container:this.$task_bars,filter:[n,function(i,a){return!a.hide_bar}]}];return e.push({renderer:this.$gantt.$ui.layers.taskBg(),container:this.$task_bg,filter:[n]}),{tasks:e,links:[{expose:!0,renderer:this.$gantt.$ui.layers.link(),container:this.$task_links,filter:[n]}]}},_attachLayers:function(t){this._taskLayers=[],this._linkLayers=[];var n=this,e=this.$gantt.$services.getService("layers");if(this.$config.bind){this._bindStore();var i=e.getDataRender(this.$config.bind);i||(i=e.createDataRender({name:this.$config.bind,defaultContainer:function(){return n.$task_data}})),i.container=function(){return n.$task_data};for(var a=this.$config.layers,s=0;a&&s<a.length;s++){typeof(d=a[s])=="string"&&(d=this.$gantt.$ui.layers[d]()),(typeof d=="function"||d&&d.render&&d.update)&&(d={renderer:d}),d.view=this;var r=i.addLayer(d);this._taskLayers.push(r),d.expose&&(this._taskRenderer=i.getLayer(r))}this._initStaticBackgroundRender()}if(this.$config.bindLinks){n.$config.linkStore=n.$gantt.getDatastore(n.$config.bindLinks);var o=e.getDataRender(this.$config.bindLinks);o||(o=e.createDataRender({name:this.$config.bindLinks,defaultContainer:function(){return n.$task_data}}));var l=this.$config.linkLayers;for(s=0;l&&s<l.length;s++){var d;typeof d=="string"&&(d=this.$gantt.$ui.layers[d]()),(d=l[s]).view=this;var c=o.addLayer(d);this._taskLayers.push(c),l[s].expose&&(this._linkRenderer=o.getLayer(c))}}},_initStaticBackgroundRender:function(){var t=this,n=xa(),e=t.$config.rowStore;e&&(this._staticBgHandler=e.attachEvent("onStoreUpdated",function(i,a,s){if(i===null&&t.isVisible()){var r=t.$getConfig();if(r.static_background||r.timeline_placeholder){var o=t.$gantt.getDatastore(t.$config.bind),l=t.$task_bg_static;if(l||((l=document.createElement("div")).className="gantt_task_bg",t.$task_bg_static=l,t.$task_bg.nextSibling?t.$task_data.insertBefore(l,t.$task_bg.nextSibling):t.$task_data.appendChild(l)),o){var d=t.getTotalHeight();r.timeline_placeholder&&(d=r.timeline_placeholder.height||t.$task_data.offsetHeight||99999),n.render(l,r,t.getScale(),d,t.getItemHeight(a?a.id:null))}}else r.static_background&&t.$task_bg_static&&t.$task_bg_static.parentNode&&t.$task_bg_static.parentNode.removeChild(t.$task_bg_static)}}),this.attachEvent("onDestroy",function(){}),this._initStaticBackgroundRender=function(){})},_clearLayers:function(t){var n=this.$gantt.$services.getService("layers"),e=n.getDataRender(this.$config.bind),i=n.getDataRender(this.$config.bindLinks);if(this._taskLayers)for(var a=0;a<this._taskLayers.length;a++)e.removeLayer(this._taskLayers[a]);if(this._linkLayers)for(a=0;a<this._linkLayers.length;a++)i.removeLayer(this._linkLayers[a]);this._linkLayers=[],this._taskLayers=[]},_render_tasks_scales:function(){var c;var t=this.$getConfig(),n="",e=0,i=0,a=this.$gantt.getState();if(this.isVisible()){var s=this.$scaleHelper,r=this._getScales();i=t.scale_height;var o=this.$config.width;t.autosize!="x"&&t.autosize!="xy"||(o=Math.max(t.autosize_min_width,0));var l=s.prepareConfigs(r,t.min_column_width,o,i-1,a.min_date,a.max_date,t.rtl),d=this._tasks=l[l.length-1];if(this._scales=l,this._posFromDateCache={},this._posFromWorkTimeCache={},this._tasks.projection&&((c=this._tasks.projection)==null?void 0:c.source)==="fixedHours"){const u="timescale-projection-calendar";gantt.getCalendar(u)&&gantt.deleteCalendar(u);let{hours:h}=this._tasks.projection;gantt.addCalendar({id:u,worktime:{hours:h||gantt.getCalendar("global")._worktime.hours.slice(),days:[1,1,1,1,1,1,1]}})}n=this._getScaleChunkHtml(l,0,this.$config.width),e=d.full_width+"px",i+="px"}this.$task_scale.style.height=i,this.$task_data.style.width=this.$task_scale.style.width=e,this.$task_scale.innerHTML=n},_getScaleChunkHtml:function(t,n,e){for(var i=[],a=this.$gantt.templates.scale_row_class,s=0;s<t.length;s++){var r="gantt_scale_line",o=a(t[s]);o&&(r+=" "+o),i.push('<div class="'+r+'" style="height:'+t[s].height+"px;position:relative;line-height:"+t[s].height+'px">'+this._prepareScaleHtml(t[s],n,e,s)+"</div>")}return i.join("")},_prepareScaleHtml:function(t,n,e,i){var a=this.$getConfig(),s=this.$gantt.templates,r=[],o=null,l=null,d=t.format||t.template||t.date;typeof d=="string"&&(d=this.$gantt.date.date_to_str(d));var c=0,u=t.count;!a.smart_scales||isNaN(n)||isNaN(e)||(c=Tt(t.left,n),u=Tt(t.left,e)+1),l=t.css||function(){},!t.css&&a.inherit_scale_class&&(l=s.scale_cell_class);for(var h=c;h<u&&t.trace_x[h];h++){o=new Date(t.trace_x[h]);var _=d.call(this,o),f=t.width[h];t.height;var y=t.left[h],v="",b="",m="";if(f){v="width:"+f+"px;"+(a.smart_scales?"position:absolute;left:"+y+"px":"");const p=this.getViewPort(),k=(a.scales[i]||{}).sticky;let x="";const w=70;if(k!==!1&&f>w||k===!0){if(y<p.x&&y+f/2-w/2<p.x)x=` style='position:absolute;left: ${p.x-y+10}px;' `;else if(y+f/2+w/2>p.x_end&&f>w){let $=p.x_end-y-10,T="-100%";$<w&&($=w,T=`-${$}px`),x=` style='position:absolute;left: ${$}px;transform: translate(${T},0);' `}}m="gantt_scale_cell"+(h==t.count-1?" gantt_last_cell":""),(b=l.call(this,o))&&(m+=" "+b);var g=`<div class='${m}' ${this.$gantt._waiAria.getTimelineCellAttr(_)} style='${v}'><span ${x}>${_}</span></div>`;r.push(g)}}return r.join("")},_getPositioningContext:function(t){if(this._tasks.unit===this.$gantt.config.duration_unit||this._tasks.unit!=="day"&&this._tasks.unit!=="week"||!this._tasks.projection)return null;const{source:n}=this._tasks.projection||{};return n==="taskCalendar"?t?{calendar:gantt.getTaskCalendar(t)}:{calendar:gantt.getCalendar("global")}:n==="fixedHours"?{calendar:gantt.getCalendar("timescale-projection-calendar")}:null},dateFromPos:function(t,n){var e=this._tasks;if(t<0||t>e.full_width||!e.full_width)return null;var i=Tt(this._tasks.left,t),a=this._tasks.left[i],s=e.width[i]||e.col_width,r=0;s&&(r=(t-a)/s,e.rtl&&(r=1-r));const o=(n?n.calendar:null)||null;var l=0;r&&(l=this._getColumnDuration(e,e.trace_x[i]));const d=e.trace_x[i],c=new Date(e.trace_x[i].valueOf()+Math.round(r*l));if(!o)return c;const{start:u,end:h,duration:_,intervals:f}=this._getWorkTrimForCell(d,o);if(_<=0)return c;const y=Math.round(r*_),v=d.valueOf()+1e3*(u+y);return new Date(v)},posFromDate:function(t,n){if(!this.isVisible()||!t)return 0;if(n&&n.calendar)return this.posFromWorkTime(t,n);var e=String(t.valueOf());if(this._posFromDateCache[e]!==void 0)return this._posFromDateCache[e];var i=this.columnIndexByDate(t);this.$gantt.assert(i>=0,"Invalid day index");var a=Math.floor(i),s=i%1,r=this._tasks.left[Math.min(a,this._tasks.width.length-1)];a==this._tasks.width.length&&(r+=this._tasks.width[this._tasks.width.length-1]),s&&(a<this._tasks.width.length?r+=this._tasks.width[a]*(s%1):r+=1);var o=Math.round(r);return this._posFromDateCache[e]=o,Math.round(o)},_getWorkTrimForCell:function(t,n){const e=this._getColumnDuration(this._tasks,t),i=new Date(t.valueOf()+e);let a=null,s=null;const r=[];for(let o=new Date(t),l=0;o<i;o=this.$gantt.date.add(o,1,"day"),l++){const d=n._getWorkHours(o)||[],c=Math.round((o-t)/1e3);for(let u=0;u<d.length;u++){const h=c+d[u].start,_=c+d[u].end;r.push({start:h,end:_}),(a===null||h<a)&&(a=h),(s===null||_>s)&&(s=_)}}return a===null||s===null||s<=a?{start:0,end:0,duration:0,intervals:[]}:{start:a,end:s,duration:s-a,intervals:r}},posFromWorkTime:function(t,{calendar:n}){if(!this.isVisible()||!t)return 0;if(!n)return this.posFromDate(t);const e=(n?n.id:"")+String(t.valueOf());if(this._posFromWorkTimeCache[e]!==void 0)return this._posFromWorkTimeCache[e];const i=this.columnIndexByDate(t);this.$gantt.assert(i>=0,"Invalid day index");const a=Math.floor(i),s=a,r=this._tasks.trace_x[a];new Date(r.valueOf()+this._getColumnDuration(this._tasks,r));const{start:o,end:l,duration:d}=this._getWorkTrimForCell(t,n);if(d===0)return this.posFromDate(t);const c=(t-this._tasks.trace_x[a])/1e3;let u=0;u=c<=o?0:c>=l?1:(c-o)/d,this._tasks.rtl&&(u=1-u);const h=this._tasks.left[Math.min(s,this._tasks.width.length-1)],_=s<this._tasks.width.length?this._tasks.width[s]:this._tasks.width[this._tasks.width.length-1];return Math.round(h+_*u)},_getNextVisibleColumn:function(t,n,e){for(var i=+n[t],a=t;e[i];)i=+n[++a];return a},_getPrevVisibleColumn:function(t,n,e){for(var i=+n[t],a=t;e[i];)i=+n[--a];return a},_getClosestVisibleColumn:function(t,n,e){var i=this._getNextVisibleColumn(t,n,e);return n[i]||(i=this._getPrevVisibleColumn(t,n,e)),i},columnIndexByDate:function(t){var n=new Date(t).valueOf(),e=this._tasks.trace_x_ascending,i=this._tasks.ignore_x,a=this.$gantt.getState();if(n<=a.min_date)return this._tasks.rtl?e.length:0;if(n>=a.max_date)return this._tasks.rtl?0:e.length;var s=Tt(e,n),r=this._getClosestVisibleColumn(s,e,i),o=e[r],l=this._tasks.trace_index_transition;if(!o)return l?l[0]:0;var d=(t-e[r])/this._getColumnDuration(this._tasks,e[r]);return l?l[r]+(1-d):r+d},getItemPosition:function(t,n,e){var i,a,s;let r=n||t.start_date||t.$auto_start_date,o=e||t.end_date||t.$auto_end_date;const l=this._getPositioningContext(t);return l&&l.calendar?this._tasks.rtl?(a=this.posFromWorkTime(r,l),i=this.posFromWorkTime(o,l)):(i=this.posFromWorkTime(r,l),a=this.posFromWorkTime(o,l)):this._tasks.rtl?(a=this.posFromDate(r),i=this.posFromDate(o)):(i=this.posFromDate(r),a=this.posFromDate(o)),s=Math.max(a-i,0),{left:i,top:this.getItemTop(t.id),height:this.getBarHeight(t.id),width:s,rowHeight:this.getItemHeight(t.id)}},getBarHeight:function(t,n){var e=this.$getConfig(),i=this.$config.rowStore.getItem(t),a=i.task_height||i.bar_height||e.bar_height||e.task_height,s=this.getItemHeight(t);return a=="full"&&(a=s-(e.bar_height_padding||3)),a=Math.min(a,s),n&&(a=Math.round(a/Math.sqrt(2))),Math.max(a,0)},getScale:function(){return this._tasks},_getScales:function(){var t=this.$getConfig(),n=this.$scaleHelper,e=[n.primaryScale(t)].concat(n.getAdditionalScales(t));return n.sortScales(e),e},_getColumnDuration:function(t,n){return this.$gantt.date.add(n,t.step,t.unit)-n},_bindStore:function(){if(this.$config.bind){var t=this.$gantt.getDatastore(this.$config.bind);if(this.$config.rowStore=t,t&&!t._timelineCacheAttached){var n=this;t._timelineCacheAttached=t.attachEvent("onBeforeFilter",function(){n._resetTopPositionHeight()})}}},_unbindStore:function(){if(this.$config.bind){var t=this.$gantt.getDatastore(this.$config.bind);t&&t._timelineCacheAttached&&(t.detachEvent(t._timelineCacheAttached),t._timelineCacheAttached=!1)}},refresh:function(){this._bindStore(),this.$config.bindLinks&&(this.$config.linkStore=this.$gantt.getDatastore(this.$config.bindLinks)),this._resetTopPositionHeight(),this._resetHeight(),this._initStaticBackgroundRender(),this._render_tasks_scales()},destructor:function(){var t=this.$gantt;this._clearLayers(t),this._unbindStore(),this.$task=null,this.$task_scale=null,this.$task_data=null,this.$task_bg=null,this.$task_links=null,this.$task_bars=null,this.$gantt=null,this.$config.rowStore&&(this.$config.rowStore.detachEvent(this._staticBgHandler),this.$config.rowStore=null),this.$config.linkStore&&(this.$config.linkStore=null),this._timelineDragScroll&&(this._timelineDragScroll.destructor(),this._timelineDragScroll=null),this.callEvent("onDestroy",[]),this.detachAllEvents()}};class $a{constructor(n){this._scrollOrder=0;const{gantt:e,grid:i,dnd:a,getCurrentX:s}=n;this.$gantt=e,this.$grid=i,this._dnd=a,this.getCurrentX=s,this._scrollView=this.$gantt.$ui.getView(this.$grid.$config.scrollX),this.attachEvents()}attachEvents(){this.isScrollable()&&(this._dnd.attachEvent("onDragMove",(n,e)=>{const i=this.$grid.$grid.getBoundingClientRect(),a=i.right,s=i.left,r=this.getCurrentX(e.clientX);return r>=a-20&&(this.autoscrollRight(),this.autoscrollStart()),r<=s+20&&(this.autoscrollLeft(),this.autoscrollStart()),r<a-20&&r>s+20&&this.autoscrollStop(),!0}),this._dnd.attachEvent("onDragEnd",()=>{this.autoscrollStop()}))}autoscrollStart(){if(this._scrollOrder===0)return;const n=10*this._scrollOrder,e=this._scrollView.getScrollState();this._scrollView.scrollTo(e.position+n),setTimeout(()=>{this.autoscrollStart()},50)}autoscrollRight(){this._scrollOrder=1}autoscrollLeft(){this._scrollOrder=-1}autoscrollStop(){this._scrollOrder=0}getCorrection(){return this.isScrollable()?this._scrollView.getScrollState().position:0}isScrollable(){return!!this.$grid.$config.scrollable}}const vn="data-column-id";class wa{constructor(n,e){this._targetMarker=null,this.calculateCurrentPosition=i=>{const a=this.$grid.$grid.getBoundingClientRect(),s=a.right,r=a.left;let o=i;return o>s&&(o=s),o<r&&(o=r),o},this.$gantt=n,this.$grid=e}init(){const n=this.$gantt.$services.getService("dnd");this._dnd=new n(this.$grid.$grid_scale,{updates_per_second:60}),this._scrollableGrid=new $a({gantt:this.$gantt,grid:this.$grid,dnd:this._dnd,getCurrentX:this.calculateCurrentPosition}),this.attachEvents()}attachEvents(){this._dnd.attachEvent("onBeforeDragStart",(n,e)=>{if(this._draggedCell=this.$gantt.utils.dom.closest(e.target,".gantt_grid_head_cell"),!this._draggedCell)return;const i=this.$grid.$getConfig().columns,a=this._draggedCell.getAttribute(vn);let s,r;return i.map(function(o,l){o.name===a&&(s=o,r=l)}),this.$grid.callEvent("onBeforeColumnDragStart",[{draggedColumn:s,draggedIndex:r}])!==!1&&!(!this._draggedCell||!s)&&(this._gridConfig=this.$grid.$getConfig(),this._originAutoscroll=this.$gantt.config.autoscroll,this.$gantt.config.autoscroll=!1,!0)}),this._dnd.attachEvent("onAfterDragStart",(n,e)=>{this._draggedCell&&(this._dnd.config.column=this._draggedCell.getAttribute(vn),this._dnd.config.marker.innerHTML=this._draggedCell.outerHTML,this._dnd.config.marker.classList.add("gantt_column_drag_marker"),this._dnd.config.marker.style.height=this._gridConfig.scale_height+"px",this._dnd.config.marker.style.lineHeight=this._gridConfig.scale_height+"px",this._draggedCell.classList.add("gantt_grid_head_cell_dragged"))}),this._dnd.attachEvent("onDragMove",(n,e)=>{if(!this._draggedCell)return;this._dragX=e.clientX;const i=this.calculateCurrentPosition(e.clientX),a=this.findColumnsIndexes();return this.setMarkerPosition(i),this.drawTargetMarker(a),!0}),this._dnd.attachEvent("onDragEnd",()=>{if(!this._draggedCell)return;const n=this.findColumnsIndexes(),e=n.targetIndex,i=n.draggedIndex,a=this.$grid.$getConfig().columns,s=a[i],r=a[e];if(this.$grid.callEvent("onColumnDragMove",[{draggedColumn:s,targetColumn:r,draggedIndex:i,targetIndex:e}])===!1)return this.cleanTargetMarker(),void this.$gantt.render();this.$gantt.config.autoscroll=this._originAutoscroll,this._draggedCell.classList.remove("gantt_grid_head_cell_dragged"),this.cleanTargetMarker(),this.reorderColumns()})}reorderColumns(){const{targetIndex:n,draggedIndex:e}=this.findColumnsIndexes(),i=this.$grid.$getConfig().columns,a=i[e],s=i[n];this.$grid.callEvent("onBeforeColumnReorder",[{draggedColumn:a,targetColumn:s,draggedIndex:e,targetIndex:n}])!==!1&&n!==e&&(i.splice(e,1),i.splice(n,0,a),this.$gantt.render(),this.$grid.callEvent("onAfterColumnReorder",[{draggedColumn:a,targetColumn:s,draggedIndex:e,targetIndex:n}]))}findColumnsIndexes(){const n=this._dnd.config.column,e=this.$grid.$getConfig().columns;let i,a,s,r;const o={startX:0,endX:0};let l,d=0,c=e.length-1,u=(f,y)=>f<=y,h=f=>++f;this.$gantt.config.rtl&&(d=e.length-1,c=0,u=(f,y)=>f>=y,h=f=>--f);const _=this._dragX-this.$grid.$grid.getBoundingClientRect().left+this._scrollableGrid.getCorrection();for(let f=d;u(f,c)&&(i===void 0||a===void 0);f=h(f))e[f].hide||(o.startX=o.endX,o.endX+=e[f].width,_>=o.startX&&(_<=o.endX||!u(h(f),c))&&(i=f,s=o.startX,r=o.endX,l=(_-o.startX)/(o.endX-o.startX)),n===e[f].name&&(a=f));return{targetIndex:i,draggedIndex:a,xBefore:s,xAfter:r,columnRelativePos:l}}setMarkerPosition(n,e=10){const{marker:i}=this._dnd.config,a=this._dnd._obj.getBoundingClientRect();i.style.top=`${a.y+e}px`,i.style.left=`${n}px`}drawTargetMarker({targetIndex:n,draggedIndex:e,xBefore:i,xAfter:a,columnRelativePos:s}){let r;this._targetMarker||(this._targetMarker=document.createElement("div"),wt(this._targetMarker,"gantt_grid_target_marker"),this._targetMarker.style.display="none",this._targetMarker.style.height=`${this._gridConfig.scale_height}px`),this._targetMarker.parentNode||this.$grid.$grid_scale.appendChild(this._targetMarker),r=n>e?a:n<e?i:s>.5?a:i,this._targetMarker.style.left=`${r}px`,this._targetMarker.style.display="block"}cleanTargetMarker(){this._targetMarker&&this._targetMarker.parentNode&&this.$grid.$grid_scale.removeChild(this._targetMarker),this._targetMarker=null}}function $e(t){var n=[];return{delegate:function(e,i,a,s){n.push([e,i,a,s]),t.$services.getService("mouseEvents").delegate(e,i,a,s)},destructor:function(){for(var e=t.$services.getService("mouseEvents"),i=0;i<n.length;i++){var a=n[i];e.detach(a[0],a[1],a[2],a[3])}n=[]}}}var Zt=function(t,n,e,i){this.$config=R({},n||{}),this.$gantt=i,this.$parent=t,st(this),this.$state={},R(this,mn(this))};function we(t){if(t._delayRender&&t._delayRender.$cancelTimeout(),t.$gantt){var n=t.$gantt.$data.tasksStore,e=t.$config.rowStore,i="_attached_"+e.$config.name;t[i]&&(n.detachEvent(t[i]),t[i]=null),e.$attachedResourceViewHandler&&(e.detachEvent(e.$attachedResourceViewHandler),e.$attachedResourceViewHandler=null,n.detachEvent(e.$attachedTaskStoreHandler),e.$attachedTaskStoreHandler=null)}}Zt.prototype={init:function(t){var n=this.$gantt,e=n._waiAria.gridAttrString(),i=n._waiAria.gridDataAttrString(),a=this.$getConfig(),s=a.reorder_grid_columns||!1;this.$config.reorder_grid_columns!==void 0&&(s=this.$config.reorder_grid_columns),t.innerHTML="<div class='gantt_grid' style='height:inherit;width:inherit;' "+e+"></div>",this.$grid=t.childNodes[0],this.$grid.innerHTML="<div class='gantt_grid_scale' "+n._waiAria.gridScaleRowAttrString()+"></div><div class='gantt_grid_data' "+i+"></div>",this.$grid_scale=this.$grid.childNodes[0],this.$grid_data=this.$grid.childNodes[1];var r=a[this.$config.bind+"_attribute"];if(!r&&this.$config.bind&&(r="data-"+this.$config.bind+"-id"),this.$config.item_attribute=r||null,!this.$config.layers){var o=this._createLayerConfig();this.$config.layers=o}var l={init:function(){},doOnRender:function(){}};this._renderHeaderResizers=l.doOnRender,this._mouseDelegates=$e(n);var d=function(c,u){var h={row_before_start:c.bind(function(_,f,y){var v=u.$getConfig(),b=u.$config.rowStore;if(!nt(y,v.task_grid_row_resizer_attribute))return!1;var m=this.locate(y,v.task_grid_row_resizer_attribute),g=b.getItem(m);return u.callEvent("onBeforeRowResize",[g])!==!1&&void 0},c),row_after_start:c.bind(function(_,f,y){var v=u.$getConfig(),b=this.locate(y,v.task_grid_row_resizer_attribute);_.config.marker.innerHTML="",_.config.marker.className+=" gantt_row_grid_resize_area",_.config.marker.style.width=u.$grid.offsetWidth+"px",_.config.drag_id=b},c),row_drag_move:c.bind(function(_,f,y){var v=u.$config.rowStore,b=u.$getConfig(),m=_.config,g=m.drag_id,p=u.getItemHeight(g),k=u.getItemTop(g)-f.scrollTop,x=V(u.$grid_data),w=parseInt(m.marker.style.top,10),$=k+x.y,T=0,S=b.min_task_grid_row_height;return(T=w-$)<S&&(T=S),m.marker.style.left=x.x+"px",m.marker.style.top=$-1+"px",m.marker.style.height=Math.abs(T)+1+"px",m.marker_height=T,u.callEvent("onRowResize",[g,v.getItem(g),T+p]),!0},c),row_drag_end:c.bind(function(_,f,y){var v=u.$config.rowStore,b=_.config,m=b.drag_id,g=v.getItem(m),p=u.getItemHeight(m),k=b.marker_height;u.callEvent("onBeforeRowResizeEnd",[m,g,k])!==!1&&g.row_height!=k&&(g.row_height=k,v.updateItem(m),u.callEvent("onAfterRowResize",[m,g,p,k]),this.render())},c)};return{init:function(){var _=c.$services.getService("dnd"),f=u.$getConfig(),y=new _(u.$grid_data,{updates_per_second:60});c.defined(f.dnd_sensitivity)&&(y.config.sensitivity=f.dnd_sensitivity),y.attachEvent("onBeforeDragStart",function(v,b){return h.row_before_start(y,v,b)}),y.attachEvent("onAfterDragStart",function(v,b){return h.row_after_start(y,v,b)}),y.attachEvent("onDragMove",function(v,b){return h.row_drag_move(y,v,b)}),y.attachEvent("onDragEnd",function(v,b){return h.row_drag_end(y,v,b)})}}}(n,this);d.init(),this._addLayers(this.$gantt),this._initEvents(),s&&(this._columnDND=new wa(n,this),this._columnDND.init()),this.callEvent("onReady",[])},_validateColumnWidth:function(t,n){var e=t[n];if(e&&e!="*"){var i=this.$gantt,a=1*e;isNaN(a)?i.assert(!1,"Wrong "+n+" value of column "+t.name):t[n]=a}},setSize:function(t,n){this.$config.width=this.$state.width=t,this.$config.height=this.$state.height=n;for(var e,i=this.getGridColumns(),a=0,s=(d=this.$getConfig()).grid_elastic_columns,r=0,o=i.length;r<o;r++)this._validateColumnWidth(i[r],"min_width"),this._validateColumnWidth(i[r],"max_width"),this._validateColumnWidth(i[r],"width"),a+=1*i[r].width;if(!isNaN(a)&&this.$config.scrollable||(a=e=this._setColumnsWidth(t+1)),this.$config.scrollable&&s&&!isNaN(a)){let u="width";s=="min_width"&&(u="min_width");let h=0;i.forEach(function(_){h+=_[u]||d.min_grid_column_width});var l=Math.max(h,t);a=this._setColumnsWidth(l),e=t}this.$config.scrollable?(this.$grid_scale.style.width=a+"px",this.$grid_data.style.width=a+"px"):(this.$grid_scale.style.width="inherit",this.$grid_data.style.width="inherit"),this.$config.width-=1;var d=this.$getConfig();e!==t&&(e!==void 0?(d.grid_width=e,this.$config.width=e-1):isNaN(a)||(this._setColumnsWidth(a),d.grid_width=a,this.$config.width=a-1));var c=Math.max(this.$state.height-d.scale_height,0);this.$grid_data.style.height=c+"px",this.refresh()},getSize:function(){var t=this.$getConfig(),n=this.$config.rowStore?this.getTotalHeight():0,e=this._getGridWidth();return{x:this.$state.width,y:this.$state.height,contentX:this.isVisible()?e:0,contentY:this.isVisible()?t.scale_height+n:0,scrollHeight:this.isVisible()?n:0,scrollWidth:this.isVisible()?e:0}},_bindStore:function(){if(this.$config.bind){var t=this.$gantt.getDatastore(this.$config.bind);if(this.$config.rowStore=t,t&&!t._gridCacheAttached){var n=this;t._gridCacheAttached=t.attachEvent("onBeforeFilter",function(){n._resetTopPositionHeight()})}}},_unbindStore:function(){if(this.$config.bind){var t=this.$gantt.getDatastore(this.$config.bind);t&&t._gridCacheAttached&&(t.detachEvent(t._gridCacheAttached),t._gridCacheAttached=!1)}},refresh:function(){this._bindStore(),this._resetTopPositionHeight(),this._resetHeight(),this._initSmartRenderingPlaceholder(),this._calculateGridWidth(),this._renderGridHeader()},getViewPort:function(){var t=this.$config.scrollLeft||0,n=this.$config.scrollTop||0,e=this.$config.height||0,i=this.$config.width||0;return{y:n,y_end:n+e,x:t,x_end:t+i,height:e,width:i}},scrollTo:function(t,n){if(this.isVisible()){var e=!1;this.$config.scrollTop=this.$config.scrollTop||0,this.$config.scrollLeft=this.$config.scrollLeft||0,1*t==t&&(this.$config.scrollLeft=this.$state.scrollLeft=this.$grid.scrollLeft=t,e=!0),1*n==n&&(this.$config.scrollTop=this.$state.scrollTop=this.$grid_data.scrollTop=n,e=!0),e&&this.callEvent("onScroll",[this.$config.scrollLeft,this.$config.scrollTop])}},getColumnIndex:function(t,n){for(var e=this.$getConfig().columns,i=0,a=0;a<e.length;a++)if(n&&e[a].hide&&i++,e[a].name==t)return a-i;return null},getColumn:function(t){var n=this.getColumnIndex(t);return n===null?null:this.$getConfig().columns[n]},getGridColumns:function(){return this.$getConfig().columns.slice()},isVisible:function(){return this.$parent&&this.$parent.$config?!this.$parent.$config.hidden:this.$grid.offsetWidth},_createLayerConfig:function(){var t=this.$gantt,n=this;return[{renderer:t.$ui.layers.gridLine(),container:this.$grid_data,filter:[function(){return n.isVisible()}]},{renderer:t.$ui.layers.gridTaskRowResizer(),container:this.$grid_data,append:!0,filter:[function(){return t.config.resize_rows}]}]},_addLayers:function(t){if(this.$config.bind){this._taskLayers=[];var n=this,e=this.$gantt.$services.getService("layers"),i=e.getDataRender(this.$config.bind);i||(i=e.createDataRender({name:this.$config.bind,defaultContainer:function(){return n.$grid_data}}));for(var a=this.$config.layers,s=0;a&&s<a.length;s++){var r=a[s];r.view=this;var o=i.addLayer(r);this._taskLayers.push(o)}this._bindStore(),this._initSmartRenderingPlaceholder()}},_refreshPlaceholderOnStoreUpdate:function(t){var n=this.$getConfig(),e=this.$config.rowStore;if(e&&t===null&&this.isVisible()&&n.smart_rendering){var i;if(this.$config.scrollY){var a=this.$gantt.$ui.getView(this.$config.scrollY);a&&(i=a.getScrollState().scrollSize)}if(i||(i=e?this.getTotalHeight():0),i){this.$rowsPlaceholder&&this.$rowsPlaceholder.parentNode&&this.$rowsPlaceholder.parentNode.removeChild(this.$rowsPlaceholder);var s=this.$rowsPlaceholder=document.createElement("div");s.style.visibility="hidden",s.style.height=i+"px",s.style.width="1px",this.$grid_data.appendChild(s)}}},_initSmartRenderingPlaceholder:function(){var t=this.$config.rowStore;t&&(this._initSmartRenderingPlaceholder=function(){},this._staticBgHandler=t.attachEvent("onStoreUpdated",O(this._refreshPlaceholderOnStoreUpdate,this)))},_initEvents:function(){var t=this.$gantt;this._mouseDelegates.delegate("click","gantt_close",t.bind(function(n,e,i){var a=this.$config.rowStore;if(!a)return!0;var s=nt(n,this.$config.item_attribute);return s&&a.close(s.getAttribute(this.$config.item_attribute)),!1},this),this.$grid),this._mouseDelegates.delegate("click","gantt_open",t.bind(function(n,e,i){var a=this.$config.rowStore;if(!a)return!0;var s=nt(n,this.$config.item_attribute);return s&&a.open(s.getAttribute(this.$config.item_attribute)),!1},this),this.$grid)},_clearLayers:function(t){var n=this.$gantt.$services.getService("layers").getDataRender(this.$config.bind);if(this._taskLayers)for(var e=0;e<this._taskLayers.length;e++)n.removeLayer(this._taskLayers[e]);this._taskLayers=[]},_getColumnWidth:function(t,n,e){var i=t.min_width||n.min_grid_column_width,a=Math.max(e,i||10);return t.max_width&&(a=Math.min(a,t.max_width)),a},_checkGridColumnMinWidthLimits:function(t,n){for(var e=0,i=t.length;e<i;e++){var a=1*t[e].width;!t[e].min_width&&a<n.min_grid_column_width&&(t[e].min_width=a)}},_getGridWidthLimits:function(){for(var t=this.$getConfig(),n=this.getGridColumns(),e=0,i=0,a=0;a<n.length;a++)e+=n[a].min_width?n[a].min_width:t.min_grid_column_width,i!==void 0&&(i=n[a].max_width?i+n[a].max_width:void 0);return this._checkGridColumnMinWidthLimits(n,t),[e,i]},_setColumnsWidth:function(t,n){var e=this.$getConfig(),i=this.getGridColumns(),a=0,s=t;n=window.isNaN(n)?-1:n;for(var r=0,o=i.length;r<o;r++)a+=1*i[r].width;if(window.isNaN(a))for(this._calculateGridWidth(),a=0,r=0,o=i.length;r<o;r++)a+=1*i[r].width;var l=s-a,d=0;for(r=0;r<n+1;r++)d+=i[r].width;for(a-=d,r=n+1;r<i.length;r++){var c=i[r],u=Math.round(l*(c.width/a));l<0?c.min_width&&c.width+u<c.min_width?u=c.min_width-c.width:!c.min_width&&e.min_grid_column_width&&c.width+u<e.min_grid_column_width&&(u=e.min_grid_column_width-c.width):c.max_width&&c.width+u>c.max_width&&(u=c.max_width-c.width),a-=c.width,c.width+=u,l-=u}for(var h=l>0?1:-1;l>0&&h===1||l<0&&h===-1;){var _=l;for(r=n+1;r<i.length;r++){var f;if((f=i[r].width+h)==this._getColumnWidth(i[r],e,f)&&(l-=h,i[r].width=f),!l)break}if(_==l)break}return l&&n>-1&&(f=i[n].width+l)==this._getColumnWidth(i[n],e,f)&&(i[n].width=f),this._getColsTotalWidth()},_getColsTotalWidth:function(){for(var t=this.getGridColumns(),n=0,e=0;e<t.length;e++){var i=parseFloat(t[e].width);if(window.isNaN(i))return!1;n+=i}return n},_calculateGridWidth:function(){for(var t=this.$getConfig(),n=this.getGridColumns(),e=0,i=[],a=[],s=0;s<n.length;s++){var r=parseFloat(n[s].width);window.isNaN(r)&&(r=t.min_grid_column_width||10,i.push(s)),a[s]=r,e+=r}var o=this._getGridWidth()+1;if(t.autofit||i.length){var l=o-e;if(t.autofit&&!t.grid_elastic_columns)for(s=0;s<a.length;s++){var d=Math.round(l/(a.length-s));a[s]+=d,(c=this._getColumnWidth(n[s],t,a[s]))!=a[s]&&(d=c-a[s],a[s]=c),l-=d}else if(i.length)for(s=0;s<i.length;s++){d=Math.round(l/(i.length-s));var c,u=i[s];a[u]+=d,(c=this._getColumnWidth(n[u],t,a[u]))!=a[u]&&(d=c-a[u],a[u]=c),l-=d}for(s=0;s<a.length;s++)n[s].width=a[s]}else{var h=o!=e;this.$config.width=e-1,t.grid_width=e,h&&this.$parent._setContentSize(this.$config.width,null)}},_renderGridHeader:function(){var t=this.$gantt,n=this.$getConfig(),e=this.$gantt.locale,i=this.$gantt.templates,a=this.getGridColumns();n.rtl&&(a=a.reverse());var s=[],r=0,o=e.labels,l=n.scale_height-1;const d={};for(var c=0;c<a.length;c++){var u=c==a.length-1,h=a[c];h.name||(h.name=t.uid()+"");var _=1*h.width,f=this._getGridWidth();u&&f>r+_&&(h.width=_=f-r),r+=_;var y=t._sort&&h.name==t._sort.name?`<div data-column-id="${h.name}" class="gantt_sort gantt_${t._sort.direction}"></div>`:"",v=["gantt_grid_head_cell","gantt_grid_head_"+h.name,u?"gantt_last_cell":"",i.grid_header_class(h.name,h)].join(" "),b="width:"+(_-(u?1:0))+"px;",m=h.label||o["column_"+h.name]||o[h.name];typeof m=="function"&&(m=m.call(t,h.name,h)),m=m||"";let p=!1;t.config.external_render&&t.config.external_render.isElement(m)&&(p=!0,d[h.name]=m);var g="<div class='"+v+"' style='"+b+"' "+t._waiAria.gridScaleCellAttrString(h,m)+" data-column-id='"+h.name+"' column_id='"+h.name+"' data-column-name='"+h.name+"' data-column-index='"+c+"'>"+(p?"<div data-component-container></div>":m)+y+"</div>";s.push(g)}this.$grid_scale.style.height=n.scale_height+"px",this.$grid_scale.style.lineHeight=l+"px",this.$grid_scale.innerHTML=s.join("");for(let p in d)t.config.external_render.renderElement(d[p],this.$grid_scale.querySelector("[data-column-id='"+p+"'] [data-component-container]"));this._renderHeaderResizers&&this._renderHeaderResizers()},_getGridWidth:function(){return this.$config.width},destructor:function(){this._clearLayers(this.$gantt),this._mouseDelegates&&(this._mouseDelegates.destructor(),this._mouseDelegates=null),this._unbindStore(),this.$grid=null,this.$grid_scale=null,this.$grid_data=null,this.$gantt=null,this.$config.rowStore&&(this.$config.rowStore.detachEvent(this._staticBgHandler),this.$config.rowStore=null),this.callEvent("onDestroy",[]),this.detachAllEvents()}};const Sa=function(t){function n(e,i,a,s){return t.apply(this,arguments)||this}return j(n,t),R(n.prototype,{init:function(e){const i=this.$gantt,a=i._waiAria.gridAttrString(),s=i._waiAria.gridDataAttrString(),r=this.$getConfig();r.row_height=this._getResourceConfig().row_height?this._getResourceConfig().row_height:i.resource_table.row_height,r.reorder_grid_columns,this.$config.reorder_grid_columns!==void 0&&this.$config.reorder_grid_columns,this.$config.bind===void 0&&(this.$config.bind="temp_resource_assignment_store",this.$config.name="resource_grid_lightbox",this.$config.$id="GridRL"),e.innerHTML="<div class='gantt_grid' style='width:100%;' "+a+"></div>",this.$grid=e.childNodes[0],this.$grid.innerHTML="<div class='gantt_grid_scale' "+i._waiAria.gridScaleRowAttrString()+"></div><div class='gantt_grid_data' "+s+"></div>",this.$grid_scale=this.$grid.childNodes[0],this.$grid_data=this.$grid.childNodes[1];let o=r[this.$config.bind+"_attribute"];if(!o&&this.$config.bind&&(o="data-"+this.$config.bind+"-id"),this.$config.item_attribute=o||null,!this.$config.layers){const d=this._createLayerConfig();this.$config.layers=d}const l=Gt();this.event=l.attach,this.eventRemove=l.detach,this._eventRemoveAll=l.detachAll,this._createDomEventScope=l.extend,this._addLayers(this.$gantt),this._initEvents(),this.callEvent("onReady",[])},getColumn:function(e){const i=this.getColumnIndex(e);return i===null?null:this._getResourceColumns()[i]||null},getColumnIndex:function(e,i){const a=this._getResourceColumns();let s=0;for(let r=0;r<a.length;r++)if(i&&a[r].hide&&s++,a[r].name==e)return r-s;return null},getGridColumns:function(){const e=this._getResourceColumns(),i=[];for(let a=0;a<e.length;a++)e[a].hide||i.push(e[a]);return i},_createLayerConfig:function(){const e=this.$gantt,i=this;return[{renderer:e.$ui.layers.gridLine(),container:this.$grid_data,filter:[function(){return i.isVisible()}]},{renderer:e.$ui.layers.gridTaskRowResizer(),container:this.$grid_data,append:!0,filter:[function(){return e.config.resize_rows}]}]},_renderGridHeader:function(){const e=this.$gantt,i=this._getResourceConfig(),a=this.$gantt.locale,s=this.$getTemplates();let r=this._getResourceColumns();i.rtl&&(r=r.reverse()),i.scale_height||(i.scale_height=e.resource_table.scale_height);let o=[],l=0,d=a.labels,c=i.scale_height-1;for(let u=0;u<r.length;u++){let h=u==r.length-1,_=r[u];_.name||(_.name=e.uid()+"");let f=1*_.width,y=this._getGridWidth();h&&y>l+f&&(_.width=f=y-l),l+=f;let v=e._sort&&_.name==e._sort.name?`<div data-column-id="${_.name}" class="gantt_sort gantt_${e._sort.direction}"></div>`:"",b=["gantt_grid_head_cell","gantt_grid_head_"+_.name,h?"gantt_last_cell":"",s.grid_header_class?s.grid_header_class(_.name,_):""].join(" "),m="width:"+(f-(h?1:0))+"px;",g=_.label||d["column_"+_.name]||d[_.name];g=g||"";const p="<div class='"+b+"' style='"+m+"' "+e._waiAria.gridScaleCellAttrString(_,g)+" data-column-id='"+_.name+"' column_id='"+_.name+"' data-column-name='"+_.name+"' data-column-index='"+u+"'>"+g+v+"</div>";o.push(p)}this.$grid_scale.style.height=i.scale_height+"px",this.$grid_scale.style.lineHeight=c+"px",this.$grid_scale.style.width="inherit",this.$grid_scale.innerHTML=o.join("")},isVisible:function(){return this.$parent?!this.$parent.hidden:this.$grid.offsetWidth},_initEvents:function(){},_getResourceSection:function(){return gantt.getLightboxSection(this.$config.sectionName).section},$getTemplates:function(){return this._getResourceSection().templates||{}},_getResourceConfig:function(){return this._getResourceSection().config||gantt.resource_table},_getResourceColumns:function(){var e;return((e=this._getResourceSection().config)==null?void 0:e.columns)||gantt.resource_table.columns},destructor:function(){this._mouseDelegates&&(this._mouseDelegates.destructor(),this._mouseDelegates=null),this._unbindStore(),this.$grid=null,this.$grid_scale=null,this.$grid_data=null,this._eventRemoveAll(),gantt.ext.inlineEditorsLightbox.destructor(),this.callEvent("onDestroy",[]),this.detachAllEvents()}},!0),R(n.prototype,function(e){var i=e.prototype.init,a=e.prototype.destructor;return{init:function(){i.apply(this,arguments),this._linkToTaskStore()},destructor:function(){we(this),a.apply(this,arguments)},previousDragId:null,relevantResources:null,_linkToTaskStore:function(){if(this.$config.rowStore&&this.$gantt.$data.tasksStore){var s=this.$gantt.$data.tasksStore,r=this.$config.rowStore;we(this);var o=this,l=ce(function(){if(o.$gantt.getState().lightbox)l();else{const c=o.$config.rowStore,u=o._getRelevantResources();if(u&&c.$config.name===o.$gantt.config.resource_store){if(u=="nothing_to_repaint")return;c._quick_refresh=!0,o.relevantResources.forEach(function(h){c.refresh(h)}),c._quick_refresh=!1}else c.refresh()}},300);this._delayRender=l;var d="_attached_"+r.$config.name;o[d]||(o[d]=s.attachEvent("onStoreUpdated",function(){if(!l.$pending&&!this._skipResourceRepaint){const c=o.$gantt.getState();if(c.drag_mode=="progress")return!0;c.drag_mode&&c.drag_id&&(o.previousDragId=c.drag_id),l()}return!0})),this.$gantt.attachEvent("onDestroy",function(){return we(o),!0}),r.$attachedResourceViewHandler||(r.$attachedResourceViewHandler=r.attachEvent("onBeforeFilter",function(){return!o.$gantt.getState().lightbox&&(l.$pending&&l.$cancelTimeout(),o._updateNestedTasks(),!0)}),r.$attachedTaskStoreHandler=s.attachEvent("onAfterDelete",function(){r._mark_recompute=!0}))}},_getRelevantResources:function(){if(!this.$gantt.getTaskAssignments)return null;const s=this.$gantt.getState(),r=this.$config.rowStore;let o=[];if(s.drag_mode&&s.drag_id&&r.$config.name===this.$gantt.config.resource_store)if(this.previousDragId==s.drag_id){if(this.relevantResources)return this.relevantResources;o=this._getIdsFromAssignments(this.previousDragId)}else this.previousDragId=s.drag_id,o=this._getIdsFromAssignments(this.previousDragId);else{if(!this.previousDragId)return null;o=this._getIdsFromAssignments(this.previousDragId),this.previousDragId=null}return o.length?(o.forEach(function(l){r.eachParent&&r.eachParent(function(d){o.push(d.id)},l)}),this.relevantResources=[...new Set(o)]):this.relevantResources="nothing_to_repaint"},_getIdsFromAssignments:function(s){const r=this.$gantt,o=[],l=r.getTask(s);return r.getTaskAssignments(s).forEach(function(d){o.push(d.resource_id)}),r.isSummaryTask(l)&&r.config.drag_project&&r.eachTask(function(d){r.getTaskAssignments(d.id).forEach(function(c){o.push(c.resource_id)})},s),r.config.drag_multiple&&r.getSelectedTasks&&r.getSelectedTasks().forEach(function(d){r.getTaskAssignments(d).forEach(function(c){o.push(c.resource_id)})}),o},_updateNestedTasks:function(){var s=this.$gantt,r=s.getDatastore(s.config.resource_store);r.$config.fetchTasks&&r.silent(function(){var o=[],l={},d={};for(var c in r.eachItem(function(u){if(u.$role!="task"){var h=s.getResourceAssignments(u.id),_={};h.sort(function(f,y){const v=r.pull,b=v[`${f.task_id}_${f.resource_id}`],m=v[`${y.task_id}_${y.resource_id}`];return b&&m?b.$local_index-m.$local_index:0}),h.forEach(function(f){if(!_[f.task_id]&&s.isTaskExists(f.task_id)){_[f.task_id]=!0;var y,v=s.getTask(f.task_id);(y=r.$config.copyOnParse?s.copy(v):Object.create(v)).id=v.id+"_"+u.id,y.$task_id=v.id,y.$resource_id=u.id,y[r.$parentProperty]=u.id,y.$role="task",o.push(y),l[y.id]=!0}})}else d[u.id]=!0}),d)l[c]||r.removeItem(c);o.length&&r.parse(o)})}}}(n),!0),n}(Zt),Ta={init:function(t,n){var e=n.$gantt;e.attachEvent("onTaskClick",function(i,a){if(e._is_icon_open_click(a))return!0;var s=t.getState(),r=t.locateCell(a.target);return!r||!t.getEditorConfig(r.columnName)||(t.isVisible()&&s.id==r.id&&s.columnName==r.columnName||t.startEdit(r.id,r.columnName),!1)}),n.$config.id==="GridRL"&&(e.event(e.getLightbox(),"click",function(i){const a=e.utils.dom,s=t.getState(),r=t.locateCell(i.target);if(r&&t.getEditorConfig(r.columnName)){if(r.columnName=="duration"||r.columnName=="end"){const o=e.getDatastore("temp_resource_assignment_store").getItem(r.id);if(o&&!o.start_date)return e.message({type:"warning",text:"Specify assignment start date"}),t.hide(),!1}return t.isVisible()&&s.id==r.id&&s.columnName==r.columnName||t.startEdit(r.id,r.columnName),t.isChanged()&&t.save(),!1}if(!a.closest(i.target,".gantt_custom_button.gantt_add_resources")){if(a.closest(i.target,"[data-assignment-delete]")){const o=i.target.getAttribute("data-assignment-delete");e.confirm({text:"Resource assignment will be deleted permanently, are you sure?",cancel:"No",ok:"Delete",callback:function(l){if(l){const d=e.getDatastore("temp_resource_assignment_store");if(d.removeItem(o),d.getItems().length==0){const c=e.getLightboxSection(n.$config.sectionName),u=e.form_blocks.resource_selector,h=e._lightbox_root.querySelector("#"+c.section.id).nextSibling;u.set_value.call(e,h,[],{},c.section,!0)}e.refreshData()}}})}t.isVisible()&&t.save(),t.hide()}}),e.lightbox_events.gantt_save_btn=function(){t.save(),e._save_lightbox()}),e.attachEvent("onEmptyClick",function(){return t.isVisible()&&t.isChanged()?t.save():t.hide(),!0}),e.attachEvent("onTaskDblClick",function(i,a){var s=t.getState(),r=t.locateCell(a.target);return!r||!t.isVisible()||r.columnName!=s.columnName})},onShow:function(t,n,e){var i=e.$gantt;if(i.ext&&i.ext.keyboardNavigation&&i.ext.keyboardNavigation.attachEvent("onKeyDown",function(a,s){var r=i.constants.KEY_CODES,o=!1;return s.keyCode===r.SPACE&&t.isVisible()&&(o=!0),!o}),n.onkeydown=function(a){a=a||window.event;var s=i.constants.KEY_CODES;if(!(a.defaultPrevented||a.shiftKey&&a.keyCode!=s.TAB)){var r=!0;switch(a.keyCode){case i.keys.edit_save:t.save();break;case i.keys.edit_cancel:t.hide();break;case s.UP:case s.DOWN:t.isVisible()&&(t.hide(),r=!1);break;case s.TAB:a.shiftKey?t.editPrevCell(!0):t.editNextCell(!0);break;default:r=!1}r&&a.preventDefault()}},e.$config.id==="GridRL"){let a;n.onkeyup=function(s){s=s||window.event;var r=i.constants.KEY_CODES;s.defaultPrevented||s.shiftKey&&s.keyCode!=r.TAB||i._lightbox_id&&t.isChanged()&&t.save()},n.onwheel=function(s){i._lightbox_id&&t.isChanged()&&(clearTimeout(a),a=setTimeout(function(){t.save()},100))}}},onHide:function(){},destroy:function(){}},Ca={init:function(t,n){var e=t,i=n.$gantt,a=null,s=i.ext.keyboardNavigation;s.attachEvent("onBeforeFocus",function(r){var o=t.locateCell(r);if(clearTimeout(a),o){var l=o.columnName,d=o.id,c=e.getState();if(e.isVisible()&&c.id==d&&c.columnName===l)return!1}return!0}),s.attachEvent("onFocus",function(r){var o=t.locateCell(r),l=t.getState();return clearTimeout(a),!o||o.id==l.id&&o.columnName==l.columnName||e.isVisible()&&e.save(),!0}),t.attachEvent("onHide",function(){clearTimeout(a)}),s.attachEvent("onBlur",function(){return a=setTimeout(function(){e.save()}),!0}),i.attachEvent("onTaskDblClick",function(r,o){var l=t.getState(),d=t.locateCell(o.target);return!d||!t.isVisible()||d.columnName!=l.columnName}),i.attachEvent("onTaskClick",function(r,o){if(i._is_icon_open_click(o))return!0;var l=t.getState(),d=t.locateCell(o.target);return!d||!t.getEditorConfig(d.columnName)||(t.isVisible()&&l.id==d.id&&l.columnName==d.columnName||t.startEdit(d.id,d.columnName),!1)}),i.attachEvent("onEmptyClick",function(){return e.save(),!0}),s.attachEvent("onKeyDown",function(r,o){var l=t.locateCell(o.target),d=!!l&&t.getEditorConfig(l.columnName),c=t.getState(),u=i.constants.KEY_CODES,h=o.keyCode,_=!1;switch(h){case u.ENTER:t.isVisible()?(t.save(),o.preventDefault(),_=!0):d&&!(o.ctrlKey||o.metaKey||o.shiftKey)&&(e.startEdit(l.id,l.columnName),o.preventDefault(),_=!0);break;case u.ESC:t.isVisible()&&(t.hide(),o.preventDefault(),_=!0);break;case u.UP:case u.DOWN:break;case u.LEFT:case u.RIGHT:(d&&t.isVisible()||c.editorType==="date")&&(_=!0);break;case u.SPACE:t.isVisible()&&(_=!0),d&&!t.isVisible()&&(e.startEdit(l.id,l.columnName),o.preventDefault(),_=!0);break;case u.DELETE:d&&!t.isVisible()?(e.startEdit(l.id,l.columnName),_=!0):d&&t.isVisible()&&(_=!0);break;case u.TAB:if(t.isVisible()){o.shiftKey?t.editPrevCell(!0):t.editNextCell(!0);var f=t.getState();f.id&&s.focus({type:"taskCell",id:f.id,column:f.columnName}),o.preventDefault(),_=!0}break;default:if(t.isVisible())_=!0;else if(h>=48&&h<=57||h>95&&h<112||h>=64&&h<=91||h>185&&h<193||h>218&&h<223){var y=r.modifiers,v=y.alt||y.ctrl||y.meta||y.shift;y.alt||v&&s.getCommandHandler(r,"taskCell")||d&&!t.isVisible()&&(e.startEdit(l.id,l.columnName),_=!0)}}return!_})},onShow:function(t,n,e){},onHide:function(t,n,e){const i=e.$gantt;i&&i.focus()},destroy:function(){}};function Dt(t){var n=function(){};return n.prototype={show:function(e,i,a,s){},hide:function(){},set_value:function(e,i,a,s){this.get_input(s).value=e},get_value:function(e,i,a){return this.get_input(a).value||""},is_changed:function(e,i,a,s){var r=this.get_value(i,a,s);return r&&e&&r.valueOf&&e.valueOf?r.valueOf()!=e.valueOf():r!=e},is_valid:function(e,i,a,s){return!0},save:function(e,i,a){},get_input:function(e){return e.querySelector("input")},focus:function(e){var i=this.get_input(e);i&&(i.focus&&i.focus(),i.select&&i.select())}},n}function Ea(t){var n=Dt();function e(){return n.apply(this,arguments)||this}return j(e,n),R(e.prototype,{show:function(i,a,s,r){var o=`<div role='cell'><input type='text' name='${a.name}' title='${a.name}'></div>`;r.innerHTML=o}},!0),e}function Da(t){var n=Dt();function e(){return n.apply(this,arguments)||this}return j(e,n),R(e.prototype,{show:function(i,a,s,r){var o=s.min||0,l=s.max||100,d=`<div role='cell'><input type='number' min='${o}' max='${l}' name='${a.name}' title='${a.name}'></div>`;r.innerHTML=d,r.oninput=function(c){+c.target.value<o&&(c.target.value=o),+c.target.value>l&&(c.target.value=l)}},get_value:function(i,a,s){return this.get_input(s).value||""},is_valid:function(i,a,s,r){return!isNaN(parseInt(i,10))}},!0),e}function Aa(t){var n=Dt();function e(){return n.apply(this,arguments)||this}return j(e,n),R(e.prototype,{show:function(i,a,s,r){for(var o=`<div role='cell'><select name='${a.name}' title='${a.name}'>`,l=[],d=s.options||[],c=0;c<d.length;c++)l.push("<option value='"+s.options[c].key+"'>"+d[c].label+"</option>");o+=l.join("")+"</select></div>",r.innerHTML=o},get_input:function(i){return i.querySelector("select")}},!0),e}function Ia(t){var n=Dt(),e="%Y-%m-%d",i=null,a=null;function s(){return n.apply(this,arguments)||this}return j(s,n),R(s.prototype,{show:function(r,o,l,d){i||(i=t.date.date_to_str(e)),a||(a=t.date.str_to_date(e));var c=null,u=null;c=typeof l.min=="function"?l.min(r,o):l.min,u=typeof l.max=="function"?l.max(r,o):l.max;var h=`<div style='width:140px' role='cell'><input type='date' ${c?" min='"+i(c)+"' ":""} ${u?" max='"+i(u)+"' ":""} name='${o.name}' title='${o.name}'></div>`;d.innerHTML=h,d.oninput=function(_){_.target.value&&(c||u)&&(+t.date.str_to_date("%Y-%m-%d")(_.target.value)<+c&&(_.target.value=t.date.date_to_str("%Y-%m-%d")(c)),+t.date.str_to_date("%Y-%m-%d")(_.target.value)>+u&&(_.target.value=t.date.date_to_str("%Y-%m-%d")(u)))}},set_value:function(r,o,l,d){r&&r.getFullYear?this.get_input(d).value=i(r):this.get_input(d).value=r},is_valid:function(r,o,l,d){return!(!r||isNaN(r.getTime()))},get_value:function(r,o,l){var d;try{d=a(this.get_input(l).value||"")}catch{d=null}return d}},!0),s}function Ma(t){var n=Dt();function e(){return n.apply(this,arguments)||this}function i(l){return l.formatter||t.ext.formatters.linkFormatter()}function a(l,d){for(var c=(l||"").split(d.delimiter||","),u=0;u<c.length;u++){var h=c[u].trim();h?c[u]=h:(c.splice(u,1),u--)}return c.sort(),c}function s(l,d,c){for(var u=l.$target,h=[],_=0;_<u.length;_++){var f=c.getLink(u[_]);h.push(i(d).format(f))}return h.join((d.delimiter||",")+" ")}function r(l){return l.source+"_"+l.target+"_"+l.type+"_"+(l.lag||0)}function o(l,d,c){var u=function(v,b,m){var g=[];return[...new Set(b)].forEach(function(p){var k=i(m).parse(p);k&&(k.target=v,k.id="predecessor_generated",t.isLinkAllowed(k)&&(k.id=void 0,g.push(k)))}),g}(l.id,d,c),h={};l.$target.forEach(function(v){var b=t.getLink(v);h[r(b)]=b.id});var _=[];u.forEach(function(v){var b=r(v);h[b]?delete h[b]:_.push(v)});var f=[];for(var y in h)f.push(h[y]);return{add:_,remove:f}}return j(e,n),R(e.prototype,{show:function(l,d,c,u){var h=`<div role='cell'><input type='text' name='${d.name}' title='${d.name}'></div>`;u.innerHTML=h},hide:function(){},set_value:function(l,d,c,u){this.get_input(u).value=s(l,c.editor,t)},get_value:function(l,d,c){return a(this.get_input(c).value||"",d.editor)},save:function(l,d,c){var u=o(t.getTask(l),this.get_value(l,d,c),d.editor);(u.add.length||u.remove.length)&&t.batchUpdate(function(){u.add.forEach(function(h){t.addLink(h)}),u.remove.forEach(function(h){t.deleteLink(h)}),t.autoSchedule&&t.autoSchedule()})},is_changed:function(l,d,c,u){var h=this.get_value(d,c,u),_=a(s(l,c.editor,t),c.editor);return h.join()!==_.join()}},!0),e}function Na(t){var n=Dt();function e(){return n.apply(this,arguments)||this}function i(a){return a.formatter||t.ext.formatters.durationFormatter()}return j(e,n),R(e.prototype,{show:function(a,s,r,o){var l=`<div role='cell'><input type='text' name='${s.name}' title='${s.name}'></div>`;o.innerHTML=l},set_value:function(a,s,r,o){this.get_input(o).value=i(r.editor).format(a)},get_value:function(a,s,r){return i(s.editor).parse(this.get_input(r).value||"")}},!0),e}function La(t){return function(e,i,a){a=="keepDates"?function(s,r){r=="duration"?s.end_date=t.calculateEndDate(s):r!="end_date"&&r!="start_date"||(s.duration=t.calculateDuration(s))}(e,i):a=="keepDuration"?function(s,r){r=="end_date"?s.start_date=n(s):r!="start_date"&&r!="duration"||(s.end_date=t.calculateEndDate(s))}(e,i):function(s,r){t._getAutoSchedulingConfig().schedule_from_end?r=="end_date"||r=="duration"?s.start_date=n(s):r=="start_date"&&(s.duration=t.calculateDuration(s)):r=="start_date"||r=="duration"?s.end_date=t.calculateEndDate(s):r=="end_date"&&(s.duration=t.calculateDuration(s))}(e,i)};function n(e){return t.calculateEndDate({start_date:e.end_date,duration:-e.duration,task:e})}}function Ra(t){t.config.editor_types={text:new(Ea()),number:new(Da()),select:new(Aa()),date:new(Ia(t)),predecessor:new(Ma(t)),duration:new(Na(t))}}function Pa(t){var n=function(a){var s=null;return{setMapping:function(r){s=r},getMapping:function(){return s||(a.config.keyboard_navigation_cells&&a.ext.keyboardNavigation?Ca:Ta)}}}(t),e={};st(e);var i={init:Ra,createEditors:function(a){function s(u,h){var _=a.$getConfig(),f=function(b,m){for(var g=a.$getConfig(),p=a.getItemTop(b),k=a.getItemHeight(b),x=a.getGridColumns(),w=0,$=0,T=0,S=0;S<x.length;S++){if(x[S].name==m){T=x[S].width;break}g.rtl?$+=x[S].width:w+=x[S].width}return g.rtl?{top:p,right:$,height:k,width:T}:{top:p,left:w,height:k,width:T}}(u,h),y=document.createElement("div");y.className="gantt_grid_editor_placeholder",y.setAttribute(a.$config.item_attribute,u),y.setAttribute(a.$config.bind+"_id",u),y.setAttribute("data-column-name",h);var v=function(b,m){for(var g=b.getGridColumns(),p=0;p<g.length;p++)if(g[p].name==m)return p;return 0}(a,h);return y.setAttribute("data-column-index",v),t._waiAria.inlineEditorAttr(y),_.rtl?y.style.cssText=["top:"+f.top+"px","right:"+f.right+"px","width:"+f.width+"px","height:"+f.height+"px"].join(";"):y.style.cssText=["top:"+f.top+"px","left:"+f.left+"px","width:"+f.width+"px","height:"+f.height+"px"].join(";"),y}var r=La(t),o=[],l=[],d=null,c={_itemId:null,_columnName:null,_editor:null,_editorType:null,_placeholder:null,locateCell:function(u){if(!J(u,a.$grid))return null;var h=nt(u,a.$config.item_attribute),_=nt(u,"data-column-name");if(h&&_){var f=_.getAttribute("data-column-name");return{id:h.getAttribute(a.$config.item_attribute),columnName:f}}return null},getEditorConfig:function(u){var h=a.getColumn(u);if(h)return h.editor},init:function(){var u=n.getMapping();u.init&&u.init(this,a),!(d=a.$gantt.getDatastore(a.$config.bind))&&t.$data.tempAssignmentsStore&&(d=t.$data.tempAssignmentsStore);var h=this;o.push(d.attachEvent("onIdChange",function(_,f){h._itemId==_&&(h._itemId=f)})),o.push(d.attachEvent("onStoreUpdated",function(){a.$gantt.getState("batchUpdate").batch_update||h.isVisible()&&!d.isVisible(h._itemId)&&h.hide()})),l.push(t.attachEvent("onDataRender",function(){h._editor&&h._placeholder&&!J(h._placeholder,t.$root)&&a.$grid_data.appendChild(h._placeholder)})),this.init=function(){}},getState:function(){return{editor:this._editor,editorType:this._editorType,placeholder:this._placeholder,id:this._itemId,columnName:this._columnName}},startEdit:function(u,h){if(this.isVisible()&&this.save(),!d.exists(u))return;var _={id:u,columnName:h};if(t.isReadonly(d.getItem(u)))return void this.callEvent("onEditPrevent",[_]);if(this.callEvent("onBeforeEditStart",[_])===!1)return void this.callEvent("onEditPrevent",[_]);const f=this.show(_.id,_.columnName);f&&f.then?f.then((function(){this.setValue(),this.callEvent("onEditStart",[_])}).bind(this)):(this.setValue(),this.callEvent("onEditStart",[_]))},isVisible:function(){return t._lightbox_id?!(!this._editor||!J(this._placeholder,t._lightbox)):!(!this._editor||!J(this._placeholder,t.$root))},show:function(u,h){this.isVisible()&&this.save();var _={id:u,columnName:h},f=a.getColumn(_.columnName),y=this.getEditorConfig(f.name);if(!y)return;var v=a.$getConfig().editor_types[y.type],b=s(_.id,_.columnName);a.$grid_data.appendChild(b);const m=(function(){this._editor=v,this._placeholder=b,this._itemId=_.id,this._columnName=_.columnName,this._editorType=y.type;var p=n.getMapping();p.onShow&&p.onShow(this,b,a),b._onReMount=(function(){this.setValue()}).bind(this)}).bind(this),g=v.show(_.id,f,y,b);if(g&&g.then)return g.then(()=>{m()});m()},setValue:function(){var u,h=this.getState(),_=h.id,f=h.columnName,y=a.getColumn(f),v=d.getItem(_),b=this.getEditorConfig(f);if(b){if(t._lightbox_id){let m=d.getItem(this._itemId);b.map_to==="text"?u=t.getDatastore(t.config.resource_store).getItem(m.resource_id).text:u=b.map_to==="start_date"?v.start_date===""||v.start_date===null?t.getTask(t._lightbox_id).start_date:v.start_date:v[b.map_to]}else u=v[b.map_to];b.map_to==="auto"&&(u=d.getItem(_)),this._editor.set_value(u,_,y,this._placeholder),this.focus()}},focus:function(){this._editor.focus(this._placeholder)},getValue:function(){var u=a.getColumn(this._columnName);return this._editor.get_value(this._itemId,u,this._placeholder)},_getItemValue:function(){var u=this.getEditorConfig(this._columnName);if(u){var h;if(t._lightbox_id){let _=d.getItem(this._itemId);u.type==="select"&&u.map_to!=="mode"?h=t.getDatastore(t.config.resource_store).getItem(_.resource_id).id:h=_[u.map_to]}else h=t.getTask(this._itemId)[u.map_to];return u.map_to=="auto"&&(h=d.getItem(this._itemId)),h}},isChanged:function(){var u=a.getColumn(this._columnName),h=this._getItemValue();return this._editor.is_changed(h,this._itemId,u,this._placeholder)},hide:function(){if(this._itemId){var u=this._itemId,h=this._columnName,_=n.getMapping();_.onHide&&_.onHide(this,this._placeholder,a),this._itemId=null,this._columnName=null,this._editorType=null,this._placeholder&&(this._editor&&this._editor.hide&&this._editor.hide(this._placeholder),this._editor=null,this._placeholder.parentNode&&this._placeholder.parentNode.removeChild(this._placeholder),this._placeholder=null,this.callEvent("onEditEnd",[{id:u,columnName:h}]))}},save:function(){if(this.isVisible()&&d.exists(this._itemId)&&this.isChanged()){var u=this._itemId,h=this._columnName;if(d.exists(u)){var _=d.getItem(u),f=this.getEditorConfig(h),y={id:u,columnName:h,newValue:this.getValue(),oldValue:this._getItemValue()};if(this.callEvent("onBeforeSave",[y])!==!1&&(!this._editor.is_valid||this._editor.is_valid(y.newValue,y.id,a.getColumn(h),this._placeholder))){t._lightbox_id&&y.newValue==""&&(y.newValue=y.oldValue);var v=f.map_to,b=y.newValue;v!="auto"?(_[v]=b,r(_,v,t.config.inline_editors_date_processing),d.updateItem(u)):this._editor.save(u,a.getColumn(h),this._placeholder),this.callEvent("onSave",[y])}t._lightbox_id||this.hide()}}else this.hide()},_findEditableCell:function(u,h){var _=u,f=a.getGridColumns()[_],y=f?f.name:null;if(y){for(;y&&!this.getEditorConfig(y);)y=this._findEditableCell(u+h,h);return y}return null},getNextCell:function(u){return this._findEditableCell(a.getColumnIndex(this._columnName,!0)+u,u)},getFirstCell:function(){return this._findEditableCell(0,1)},getLastCell:function(){return this._findEditableCell(a.getGridColumns().length-1,-1)},editNextCell:function(u){var h=this.getNextCell(1);if(h){var _=this.getNextCell(1);_&&this.getEditorConfig(_)&&this.startEdit(this._itemId,_)}else if(u&&this.moveRow(1)){var f=this.moveRow(1);(h=this.getFirstCell())&&this.getEditorConfig(h)&&this.startEdit(f,h)}},editPrevCell:function(u){var h=this.getNextCell(-1);if(h){var _=this.getNextCell(-1);_&&this.getEditorConfig(_)&&this.startEdit(this._itemId,_)}else if(u&&this.moveRow(-1)){var f=this.moveRow(-1);(h=this.getLastCell())&&this.getEditorConfig(h)&&this.startEdit(f,h)}},moveRow:function(u){for(var h=u>0?t.getNext:t.getPrev,_=(h=t.bind(h,t))(this._itemId);t.isTaskExists(_)&&t.isReadonly(t.getTask(_));)_=h(_);return _},editNextRow:function(u){var h=this.getState().id;if(t.isTaskExists(h)){var _=null;_=u?this.moveRow(1):t.getNext(h),t.isTaskExists(_)&&this.startEdit(_,this._columnName)}},editPrevRow:function(u){var h=this.getState().id;if(t.isTaskExists(h)){var _=null;_=u?this.moveRow(-1):t.getPrev(h),t.isTaskExists(_)&&this.startEdit(_,this._columnName)}},detachStore:function(){o.forEach(function(u){d.detachEvent(u)}),l.forEach(function(u){t.detachEvent(u)}),o=[],l=[],d=null,this.hide()},destructor:function(){this.detachStore(),this.detachAllEvents()}};return R(c,n),R(c,e),c}};return R(i,n),R(i,e),i}function Se(t,n,e,i,a){if(!t.start_date||!t.end_date)return null;var s=e.getItemTop(t.id),r=e.getItemHeight(t.id);if(s>n.y_end||s+r<n.y)return!1;var o=e.posFromDate(t.start_date,e._getPositioningContext?e._getPositioningContext(t):null),l=e.posFromDate(t.end_date,e._getPositioningContext?e._getPositioningContext(t):null),d=Math.min(o,l)-200,c=Math.max(o,l)+200;return!(d>n.x_end||c<n.x)}function kn(t){function n(s,r,o){if(t._isAllowedUnscheduledTask(s)||!t._isTaskInTimelineLimits(s))return;var l=r.getItemPosition(s),d=o,c=r.$getTemplates(),u=t.getTaskType(s.type),h=r.getBarHeight(s.id,u==d.types.milestone),_=0;u==d.types.milestone&&(_=(h-l.height)/2);var f=Math.floor((r.getItemHeight(s.id)-h)/2);const y=t.config.baselines&&s.baselines&&s.baselines.length,v=t.config.baselines&&(t.config.baselines.render_mode=="separateRow"||t.config.baselines.render_mode=="individualRow");if(y&&v&&s.bar_height!=="full"&&s.bar_height<s.row_height)if(u===d.types.milestone){let S=r.getBarHeight(s.id,!0),C=Math.sqrt(2*S*S);f=Math.floor((C-h)/2)+2}else f=2;u==d.types.milestone&&(l.left-=Math.round(h/2),l.width=h);var b=document.createElement("div"),m=Math.round(l.width);r.$config.item_attribute&&(b.setAttribute(r.$config.item_attribute,s.id),b.setAttribute(r.$config.bind+"_id",s.id)),d.show_progress&&u!=d.types.milestone&&function(S,C,E,D,A){var M=1*S.progress||0;E=Math.max(E,0);var I=document.createElement("div"),N=Math.round(E*M);N=Math.min(E,N),I.style.width=N+"px",I.className="gantt_task_progress",I.innerHTML=A.progress_text(S.start_date,S.end_date,S),D.rtl&&(I.style.position="absolute",I.style.right="0px");var L=document.createElement("div");L.className="gantt_task_progress_wrapper",L.appendChild(I),C.appendChild(L);const B=!t.isReadonly(S),z=t.ext.dragTimeline&&t.ext.dragTimeline._isDragInProgress();if(t.config.drag_progress&&(B||z)){var H=document.createElement("div"),W=N;D.rtl&&(W=E-N),H.style.left=W+"px",H.className="gantt_task_progress_drag",H.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" width="12" height="9" viewBox="0 0 12 9" fill="none">
<path d="M5.58397 1.52543C5.78189 1.22856 6.21811 1.22856 6.41602 1.52543L10.5475 7.72265C10.769 8.05493 10.5308 8.5 10.1315 8.5L1.86852 8.5C1.46917 8.5 1.23097 8.05493 1.45249 7.72265L5.58397 1.52543Z" fill="var(--dhx-gantt-progress-handle-background)" stroke="var(--dhx-gantt-progress-handle-border)"/>
</svg>`,I.appendChild(H),C.appendChild(H)}}(s,b,m,d,c);var g=function(S,C,E){var D=document.createElement("div");return t.getTaskType(S.type)!=t.config.types.milestone?D.innerHTML=E.task_text(S.start_date,S.end_date,S):t.getTaskType(S.type)==t.config.types.milestone&&C&&(D.style.height=D.style.width=C+"px"),D.className="gantt_task_content",D}(s,m,c);b.appendChild(g);var p=function(S,C,E,D){var A=D.$getConfig(),M=[S];C&&M.push(C);var I=t.getState(),N=t.getTask(E);if(t.getTaskType(N.type)==A.types.milestone?M.push("gantt_milestone"):t.getTaskType(N.type)==A.types.project&&M.push("gantt_project"),M.push("gantt_bar_"+t.getTaskType(N.type)),t.isSummaryTask(N)&&M.push("gantt_dependent_task"),t.isSplitTask(N)&&(N.$inlineSplit&&N.$inlineSplit.length||A.open_split_tasks&&!N.$open&&N.$inlineSplit&&N.$inlineSplit.length||!A.open_split_tasks)&&M.push("gantt_split_parent"),A.select_task&&t.isSelectedTask(E)&&M.push("gantt_selected"),E==I.drag_id&&(M.push("gantt_drag_"+I.drag_mode),I.touch_drag&&M.push("gantt_touch_"+I.drag_mode)),I.link_source_id==E&&(M.push("gantt_link_source"),I.link_from_start?M.push("gantt_link_from_start"):M.push("gantt_link_from_end")),I.link_target_id==E&&M.push("gantt_link_target"),A.highlight_critical_path&&t.isCriticalTask&&t.isCriticalTask(N)&&M.push("gantt_critical_task"),I.link_landing_area&&I.link_target_id&&I.link_source_id&&I.link_target_id!=I.link_source_id&&(I.link_target_id==E||I.link_source_id==E)){var L=I.link_source_id,B=I.link_from_start,z=I.link_to_start,H="";H=t.isLinkAllowed(L,E,B,z)?z?"link_start_allow":"link_finish_allow":z?"link_start_deny":"link_finish_deny",M.push(H)}return M.join(" ")}("gantt_task_line",c.task_class(s.start_date,s.end_date,s),s.id,r);(s.color||s.progressColor||s.textColor)&&(p+=" gantt_task_inline_color"),l.width<20&&(p+=" gantt_thin_task"),b.className=p;var k=["left:"+l.left+"px","top:"+(f+l.top)+"px","height:"+h+"px","line-height:"+Math.max(h<30?h-2:h,0)+"px","width:"+m+"px"];b.style.cssText=k.join(";"),s.color&&b.style.setProperty("--dhx-gantt-task-background",s.color),s.textColor&&b.style.setProperty("--dhx-gantt-task-color",s.textColor),s.progressColor&&b.style.setProperty("--dhx-gantt-task-progress-color",s.progressColor);var x=function(S,C,E,D){var A="gantt_left "+i(!C.rtl,S),M=null;return D&&(M={type:"marginRight",value:D}),e(S,E.leftside_text,A,M)}(s,d,c,_);x&&b.appendChild(x),x=function(S,C,E,D){var A="gantt_right "+i(!!C.rtl,S),M=null;return D&&(M={type:"marginLeft",value:D}),e(S,E.rightside_text,A,M)}(s,d,c,_),x&&b.appendChild(x),t._waiAria.setTaskBarAttr(s,b);var w=t.getState();const $=!t.isReadonly(s),T=t.ext.dragTimeline&&t.ext.dragTimeline._isDragInProgress();return($||T)&&(d.drag_resize&&!t.isSummaryTask(s)&&u!=d.types.milestone&&a(b,"gantt_task_drag",s,function(S){var C=document.createElement("div");return C.className=S,C},d),d.drag_links&&d.show_links&&a(b,"gantt_link_control",s,function(S){var C=document.createElement("div");C.className=S,C.style.cssText=["height:"+h+"px","line-height:"+h+"px"].join(";");var E=document.createElement("div");E.className="gantt_link_point";var D=!1;return w.link_source_id&&d.touch&&(D=!0),E.style.display=D?"block":"",C.appendChild(E),C},d,_)),b}function e(s,r,o,l){if(!r)return null;var d=r(s.start_date,s.end_date,s);if(!d)return null;var c=document.createElement("div");return c.className="gantt_side_content "+o,c.innerHTML=d,l&&(c.style[l.type]=Math.abs(l.value)+"px"),c}function i(s,r){var o=s?{$source:[t.config.links.start_to_start],$target:[t.config.links.start_to_start,t.config.links.finish_to_start]}:{$source:[t.config.links.finish_to_start,t.config.links.finish_to_finish],$target:[t.config.links.finish_to_finish]};for(var l in o)for(var d=r[l],c=0;c<d.length;c++)for(var u=t.getLink(d[c]),h=0;h<o[l].length;h++)if(u.type==o[l][h])return"gantt_link_crossing";return""}function a(s,r,o,l,d,c){var u,h=t.getState();+o.start_date>=+h.min_date&&((u=l([r,d.rtl?"task_right":"task_left","task_start_date"].join(" "))).setAttribute("data-bind-property","start_date"),c&&(u.style.marginLeft=c+"px"),s.appendChild(u)),+o.end_date<=+h.max_date&&((u=l([r,d.rtl?"task_left":"task_right","task_end_date"].join(" "))).setAttribute("data-bind-property","end_date"),c&&(u.style.marginRight=c+"px"),s.appendChild(u))}return function(s,r,o){var l=(o=r.$getConfig()).type_renderers[t.getTaskType(s.type)],d=n;return l?l.call(t,s,function(c){return d.call(t,c,r,o)},r):d.call(t,s,r,o)}}function yn(t){return{render:kn(t),update:null,isInViewPort:Se,getVisibleRange:mt}}function Pt(){return console.error("You are trying to use a Pro feature that is not available in the GPL version."),{render:function(){},isInViewPort:function(){},getVisibleRange:function(){}}}function bn(t,n,e){return{top:n.getItemTop(t.id),height:n.getItemHeight(t.id),left:0,right:1/0}}function Qt(t,n){var e=0,i=t.left.length-1;if(n)for(var a=0;a<t.left.length;a++){var s=t.left[a];if(s<n.x&&(e=a),s>n.x_end){i=a;break}}return{start:e,end:i}}function Te(t,n,e,i){var a=n.width[t];if(a<=0)return!1;if(!i.config.smart_rendering||Lt(i))return!0;var s=n.left[t]-a,r=n.left[t]+a;return s<=e.x_end&&r>=e.x}function Ha(t,n){var e=n.config.timeline_placeholder;if(t=t||[],e&&t.filter(l=>l.id==="timeline_placeholder_task").length===0){var i=n.getState(),a=null,s=i.min_date,r=i.max_date;t.length&&(a=t[t.length-1].id);var o={start_date:s,end_date:r,row_height:e.height||0,id:"timeline_placeholder_task",unscheduled:!0,lastTaskId:a,calendar_id:e.calendar||"global",$source:[],$target:[]};t.push(o)}}function Oa(t){var n={current_pos:null,dirs:{left:"left",right:"right",up:"up",down:"down"},path:[],clear:function(){this.current_pos=null,this.path=[]},point:function(a){this.current_pos=t.copy(a)},get_lines:function(a){this.clear(),this.point(a[0]);for(var s=1;s<a.length;s++)this.line_to(a[s]);return this.get_path()},line_to:function(a){var s=t.copy(a),r=this.current_pos,o=this._get_line(r,s);this.path.push(o),this.current_pos=s},get_path:function(){return this.path},get_wrapper_sizes:function(a,s,r){var o,l=s.$getConfig().link_wrapper_width,d=a.y-l/2;switch(a.direction){case this.dirs.left:o={top:d,height:l,lineHeight:l,left:a.x-a.size-l/2,width:a.size+l};break;case this.dirs.right:o={top:d,lineHeight:l,height:l,left:a.x-l/2,width:a.size+l};break;case this.dirs.up:o={top:d-a.size,lineHeight:a.size+l,height:a.size+l,left:a.x-l/2,width:l};break;case this.dirs.down:o={top:d,lineHeight:a.size+l,height:a.size+l,left:a.x-l/2,width:l}}return o},get_line_sizes:function(a,s){var r,o=s.$getConfig(),l=o.link_line_width,d=o.link_wrapper_width,c=a.size+l;switch(a.direction){case this.dirs.left:case this.dirs.right:r={height:l,width:c,marginTop:(d-l)/2,marginLeft:(d-l)/2};break;case this.dirs.up:case this.dirs.down:r={height:c,width:l,marginTop:(d-l)/2,marginLeft:(d-l)/2}}return r},render_line:function(a,s,r,o){var l=this.get_wrapper_sizes(a,r,o),d=document.createElement("div");d.style.cssText=["top:"+l.top+"px","left:"+l.left+"px","height:"+l.height+"px","width:"+l.width+"px"].join(";"),d.className="gantt_line_wrapper";var c=this.get_line_sizes(a,r),u=document.createElement("div");return u.style.cssText=["height:"+c.height+"px","width:"+c.width+"px","margin-top:"+c.marginTop+"px","margin-left:"+c.marginLeft+"px"].join(";"),u.className="gantt_link_line_"+a.direction,d.appendChild(u),d},render_corner:function(a,s){const r=a.radius,o=s.$getConfig(),l=o.link_line_width||2,d=document.createElement("div");let c,u;return d.classList.add("gantt_link_corner"),d.classList.add(`gantt_link_corner_${a.direction.from}_${a.direction.to}`),d.style.width=`${r}px`,d.style.height=`${r}px`,a.direction.from==="right"&&a.direction.to==="down"?(c="Right",u="Top",d.style.left=a.x-o.link_line_width/2+"px",d.style.top=`${a.y}px`):a.direction.from==="down"&&a.direction.to==="right"?(c="Left",u="Bottom",d.style.left=a.x-o.link_line_width/2+"px",d.style.top=`${a.y}px`):a.direction.from==="right"&&a.direction.to==="up"?(c="Right",u="Bottom",d.style.left=a.x-o.link_line_width/2+"px",d.style.top=a.y-r+"px"):a.direction.from==="up"&&a.direction.to==="right"?(c="Left",u="Top",d.style.left=a.x-o.link_line_width/2+"px",d.style.top=a.y-r+"px"):a.direction.from==="left"&&a.direction.to==="down"?(c="Left",u="Top",d.style.left=a.x-r-o.link_line_width/2+"px",d.style.top=`${a.y}px`):a.direction.from==="down"&&a.direction.to==="left"?(c="Right",u="Bottom",d.style.left=a.x-r-o.link_line_width/2+"px",d.style.top=`${a.y}px`):a.direction.from==="left"&&a.direction.to==="up"?(c="Left",u="Bottom",d.style.left=a.x-r-o.link_line_width/2+"px",d.style.top=a.y-r+"px"):a.direction.from==="up"&&a.direction.to==="left"&&(c="Right",u="Top",d.style.left=a.x-r-o.link_line_width/2+"px",d.style.top=a.y-r+"px"),d.style[`border${u}Width`]=`${l}px`,d.style[`border${c}Width`]=`${l}px`,d.style[`border${c}Style`]="solid",d.style[`border${u}Style`]="solid",d.style[`border${u}${c}Radius`]=`${r}px`,d},render_arrow(a,s){var r=document.createElement("div"),o=a.y,l=a.x,d=s.link_arrow_size;r.style.setProperty("--dhx-gantt-icon-size",`${d}px`);var c="gantt_link_arrow gantt_link_arrow_"+a.direction;return r.style.top=o+"px",r.style.left=l+"px",r.className=c,r},_get_line:function(a,s){var r=this.get_direction(a,s),o={x:a.x,y:a.y,direction:this.get_direction(a,s)};return r==this.dirs.left||r==this.dirs.right?o.size=Math.abs(a.x-s.x):o.size=Math.abs(a.y-s.y),o},get_direction:function(a,s){return s.x<a.x?this.dirs.left:s.x>a.x?this.dirs.right:s.y>a.y?this.dirs.down:this.dirs.up}},e={path:[],clear:function(){this.path=[]},current:function(){return this.path[this.path.length-1]},point:function(a){return a?(this.path.push(t.copy(a)),a):this.current()},point_to:function(a,s,r){r=r?{x:r.x,y:r.y}:t.copy(this.point());var o=n.dirs;switch(a){case o.left:r.x-=s;break;case o.right:r.x+=s;break;case o.up:r.y-=s;break;case o.down:r.y+=s}return this.point(r)},get_points:function(a,s,r,o){var l=this.get_endpoint(a,s,r,o),d=t.config,c=l.e_y-l.y,u=l.e_x-l.x,h=n.dirs,_=s.getItemHeight(a.source);this.clear(),this.point({x:l.x,y:l.y});var f=2*d.link_arrow_size,y=this.get_line_type(a,s.$getConfig()),v=l.e_x>l.x;if(y.from_start&&y.to_start)this.point_to(h.left,f),v?(this.point_to(h.down,c),this.point_to(h.right,u)):(this.point_to(h.right,u),this.point_to(h.down,c)),this.point_to(h.right,f);else if(!y.from_start&&y.to_start)if(c!==0&&(v=l.e_x>l.x+2*f),this.point_to(h.right,f),v)u-=f,this.point_to(h.down,c),this.point_to(h.right,u);else{u-=2*f;var b=c>0?1:-1;this.point_to(h.down,b*(_/2)),this.point_to(h.right,u),this.point_to(h.down,b*(Math.abs(c)-_/2)),this.point_to(h.right,f)}else y.from_start||y.to_start?y.from_start&&!y.to_start&&(c!==0&&(v=l.e_x>l.x-2*f),this.point_to(h.left,f),v?(u+=2*f,b=c>0?1:-1,this.point_to(h.down,b*(_/2)),this.point_to(h.right,u),this.point_to(h.down,b*(Math.abs(c)-_/2)),this.point_to(h.left,f)):(u+=f,this.point_to(h.down,c),this.point_to(h.right,u))):(this.point_to(h.right,f),v?(this.point_to(h.right,u),this.point_to(h.down,c)):(this.point_to(h.down,c),this.point_to(h.right,u)),this.point_to(h.left,f));return this.path},get_line_type:function(a,s){var r=s.links,o=!1,l=!1;return a.type==r.start_to_start?o=l=!0:a.type==r.finish_to_finish?o=l=!1:a.type==r.finish_to_start?(o=!1,l=!0):a.type==r.start_to_finish?(o=!0,l=!1):t.assert(!1,"Invalid link type"),s.rtl&&(o=!o,l=!l),{from_start:o,to_start:l}},get_endpoint:function(a,s,r,o){var l=s.$getConfig(),d=this.get_line_type(a,l),c=d.from_start,u=d.to_start,h=i(r,s,l),_=i(o,s,l);return{x:c?h.left:h.left+h.width,e_x:u?_.left:_.left+_.width,y:h.top+h.rowHeight/2-1,e_y:_.top+_.rowHeight/2-1}}};function i(a,s,r){var o=s.getItemPosition(a);let l=function(f,y,v,b){let m=b||y.$task_data.scrollHeight,g=!1,p=!1;return f.eachParent(function(k){if(Et(k)){p=!0;const x=y.getItemPosition(k).rowHeight;x<m&&(m=x,g=!0)}},v.id),{maxHeight:m,shrinkHeight:g,splitChild:p}}(t,s,a),d=l.maxHeight,c=l.splitChild;const u=t.config.baselines&&(t.config.baselines.render_mode=="separateRow"||t.config.baselines.render_mode=="individualRow")&&a.baselines&&a.baselines.length;let h;l.shrinkHeight&&(o.rowHeight=d);let _=t.getTaskType(a.type)==r.types.milestone;if(_){let f=s.getBarHeight(a.id,!0);h=Math.sqrt(2*f*f),l.shrinkHeight&&d<f&&(f=d,h=d),o.left-=h/2,o.width=h}if(c)if(d>=o.height){const f=function(y,v){let b=!1;return y.eachTask(function(m){b||(b=nn(y,m))},v),b}(t,a.parent);u||f?_?(o.rowHeight=o.height+4,o.left+=(o.width-o.rowHeight+4)/2,o.width=o.rowHeight-3):o.rowHeight=o.height+6:_&&(o.left+=(h-o.height)/2)}else o.rowHeight=d+2,_&&(o.left+=(o.width-o.rowHeight+4)/2,o.width=o.rowHeight-3);else u&&(o.rowHeight=o.height+4);return o}return{render:function(a,s,r){var o=t.getTask(a.source);if(o.hide_bar)return;var l=t.getTask(a.target);if(l.hide_bar)return;var d=e.get_endpoint(a,s,o,l),c=d.e_y-d.y;if(!(d.e_x-d.x)&&!c)return null;var u=e.get_points(a,s,o,l);const h=function(v,b){const m=b.link_radius||4,g=b.link_arrow_size||6,p=[];for(let x=0;x<v.length;x++){const w=v[x],$=v[x+1];if(!$||b.link_radius<=1)p.push({type:"line",data:w});else if(w.direction!==$.direction){if(w.size<m||$.size<m){p.push({type:"line",data:w});continue}w.size-=m,p.push({type:"line",data:w});let T=w.x,S=w.y-b.link_line_width/2;switch(w.direction){case"right":T+=w.size;break;case"left":T-=w.size;break;case"down":S+=w.size;break;case"up":S-=w.size}const C={x:T,y:S,direction:{from:w.direction,to:$.direction},radius:m};switch(p.push({type:"corner",data:C}),$.direction){case"right":$.x+=m,$.size-=m;break;case"left":$.x-=m,$.size-=m;break;case"down":$.y+=m,$.size-=m;break;case"up":$.y-=m,$.size-=m}}else p.push({type:"line",data:w})}const k=v[v.length-1];if(k.direction==="right"||k.direction==="left"){k.size-=3*g/4;let x=k.direction==="right"?k.x+k.size:k.x-k.size-g/2,w=k.y-b.link_line_width/2-g/2+1;k.direction==="left"?(w-=1,x-=2):x-=1;const $={x,y:w,size:g,direction:k.direction};p.push({type:"line",data:k}),p.push({type:"arrow",data:$})}else p.push({type:"line",data:k});return p}(n.get_lines(u,s).filter(v=>v.size>0),r),_=function(v,b,m,g){const p=document.createElement("div");return v.forEach(k=>{let x;k.type==="line"?x=n.render_line(k.data,null,b,m.source):k.type==="corner"?x=n.render_corner(k.data,b):k.type==="arrow"&&(x=n.render_arrow(k.data,g)),p.appendChild(x)}),p}(h,s,a,r);var f="gantt_task_link";a.color&&(f+=" gantt_link_inline_color");var y=t.templates.link_class?t.templates.link_class(a):"";return y&&(f+=" "+y),r.highlight_critical_path&&t.isCriticalLink&&t.isCriticalLink(a)&&(f+=" gantt_critical_link"),_.className=f,s.$config.link_attribute&&(_.setAttribute(s.$config.link_attribute,a.id),_.setAttribute("link_id",a.id)),a.color&&_.style.setProperty("--dhx-gantt-link-background",a.color),t._waiAria.linkAttr(a,_),_},update:null,isInViewPort:fn,getVisibleRange:gn()}}function Ba(t,n,e,i,a){if(a.$ui.getView("grid")&&(a.config.keyboard_navigation&&a.getSelectedId()||a.ext.inlineEditors&&a.ext.inlineEditors.getState().id))return!!t.$expanded_branch;var s=e.getItemTop(t.id),r=e.getItemHeight(t.id);return!(s>n.y_end||s+r<n.y)}function za(t){let n={};return t.$data.tasksStore.attachEvent("onStoreUpdated",function(){n={}}),function(e,i,a,s){const r=e.id+"_"+i+"_"+a.unit+"_"+a.step;let o;return o=n[r]?n[r]:n[r]=function(l,d,c,u){let h,_=!1,f={};t.config.process_resource_assignments&&d===t.config.resource_property?(h=l.$role=="task"?t.getResourceAssignments(l.$resource_id,l.$task_id):t.getResourceAssignments(l.id),_=!0):h=l.$role=="task"?[]:t.getTaskBy(d,l.id),f=function($,T,S){const C=T.unit,E=T.step,D={},A={};for(let M=0;M<$.length;M++){const I=$[M];let N=I;if(S&&(N=t.getTask(I.task_id)),N.unscheduled)continue;let L=I.start_date||N.start_date,B=I.end_date||N.end_date;S&&(I.start_date&&(L=new Date(Math.max(I.start_date.valueOf(),N.start_date.valueOf()))),I.end_date&&(B=new Date(Math.min(I.end_date.valueOf(),N.end_date.valueOf()))),I.mode&&I.mode=="fixedDates"&&(L=I.start_date,B=I.end_date));let z=Tt(T.trace_x,L.valueOf()),H=new Date(T.trace_x[z]||t.date[C+"_start"](new Date(L))),W=new Date(Math.min(L.valueOf(),H.valueOf())),P=t.config.work_time?t.getTaskCalendar(N):t;for(A[P.id]={};W<B;){const q=A[P.id],F=W.valueOf();W=t.date.add(W,E,C),q[F]!==!1&&(D[F]||(D[F]={tasks:[],assignments:[]}),D[F].tasks.push(N),S&&D[F].assignments.push(I))}}return D}(h,c,_);const y=c.unit,v=c.step,b=[];let m,g,p,k,x;const w=u.$getConfig();for(let $=0;$<c.trace_x.length;$++)m=new Date(c.trace_x[$]),g=t.date.add(m,v,y),x=f[m.valueOf()]||{},p=x.tasks||[],k=x.assignments||[],p.length||w.resource_render_empty_cells?b.push({start_date:m,end_date:g,tasks:p,assignments:k}):b.push(null);return b}(e,i,a,s),o}}const ja={init:function(t,n){var e=t.$services.getService("dnd");if(n.$config.bind&&t.getDatastore(n.$config.bind)){var i=new e(n.$grid_data,{updates_per_second:60});t.defined(n.$getConfig().dnd_sensitivity)&&(i.config.sensitivity=n.$getConfig().dnd_sensitivity),i.attachEvent("onBeforeDragStart",t.bind(function(o,l){var d=a(l);if(!d||(t.hideQuickInfo&&t.hideQuickInfo(),dt(l.target,".gantt_grid_editor_placeholder")))return!1;var c=d.getAttribute(n.$config.item_attribute);if(r(c))return!1;var u=s().getItem(c);return!t.isReadonly(u)&&(i.config.initial_open_state=u.$open,!!t.callEvent("onRowDragStart",[c,l.target||l.srcElement,l])&&void 0)},t)),i.attachEvent("onAfterDragStart",t.bind(function(o,l){var d=a(l);i.config.marker.innerHTML=d.outerHTML;var c=i.config.marker.firstChild;c&&(c.style.position="static"),i.config.id=d.getAttribute(n.$config.item_attribute);var u=s(),h=u.getItem(i.config.id);i.config.index=u.getBranchIndex(i.config.id),i.config.parent=h.parent,h.$open=!1,h.$transparent=!0,this.refreshData()},t)),i.lastTaskOfLevel=function(o){for(var l=null,d=s().getItems(),c=0,u=d.length;c<u;c++)d[c].$level==o&&(l=d[c]);return l?l.id:null},i._getGridPos=t.bind(function(o){var l=V(n.$grid_data),d=l.x+n.$grid.scrollLeft,c=o.pos.y-10,u=n.getItemHeight(i.config.id);c<l.y&&(c=l.y);var h=n.getTotalHeight();c>l.y+h-u&&(c=l.y+h-u);const _=l.y+l.height;return c>_-u&&(c=_-u),l.x=d,l.y=c,l},t),i._getTargetY=t.bind(function(o){var l=V(n.$grid_data),d=n.$state.scrollTop||0,c=t.$grid_data.getBoundingClientRect().height+d,u=o.pageY-l.y+d;return u>c?u=c:u<d&&(u=d),u},t),i._getTaskByY=t.bind(function(o,l){var d=s();o=o||0;var c=n.getItemIndexByTopPosition(o);return(c=l<c?c-1:c)>d.countVisible()-1?null:d.getIdByIndex(c)},t),i.attachEvent("onDragMove",t.bind(function(o,l){var d=t.$grid_data.getBoundingClientRect(),c=d.height+d.y+(n.$state.scrollTop||0)+window.scrollY,u=i.config,h=i._getGridPos(l);t._waiAria.reorderMarkerAttr(u.marker);var _=n.$getConfig(),f=s();h.y<c?u.marker.style.top=h.y+"px":u.marker.style.top=c+"px",u.marker.style.left=h.x+10+"px";const y=V(t.$root);h.width>y.width&&(u.marker.style.width=y.width-10-2+"px",u.marker.style.overflow="hidden");var v=f.getItem(i.config.id),b=i._getTargetY(l),m=i._getTaskByY(b,f.getIndexById(v.id));function g(D,A){return!f.isChildOf(p.id,A.id)&&(D.$level==A.$level||_.order_branch_free)}if(f.exists(m)||(m=i.lastTaskOfLevel(_.order_branch_free?v.$level:0))==i.config.id&&(m=null),f.exists(m)){var p=f.getItem(m),k=n.getItemTop(p.id),x=n.getItemHeight(p.id);if(k+x/2<b){var w=f.getIndexById(p.id),$=f.getNext(p.id),T=f.getItem($);if(r($)){var S=f.getPrev(T.id);T=f.getItem(S)}if(T){if(T.id==v.id)return _.order_branch_free&&f.isChildOf(v.id,p.id)&&f.getChildren(p.id).length==1?void f.move(v.id,f.getBranchIndex(p.id)+1,f.getParent(p.id)):void 0;p=T}else if($=f.getIdByIndex(w),T=f.getItem($),r($)&&(S=f.getPrev(T.id),T=f.getItem(S)),g(T,v)&&T.id!=v.id)return void f.move(v.id,-1,f.getParent(T.id))}else if(_.order_branch_free&&p.id!=v.id&&g(p,v)&&!r(p.id)){if(!f.hasChild(p.id))return p.$open=!0,void f.move(v.id,-1,p.id);if(f.getIndexById(p.id)||x/3<b)return}w=f.getIndexById(p.id),S=f.getIdByIndex(w-1);for(var C=f.getItem(S),E=1;(!C||C.id==p.id)&&w-E>=0;)S=f.getIdByIndex(w-E),C=f.getItem(S),E++;if(v.id==p.id||r(p.id))return;g(p,v)&&v.id!=p.id?f.move(v.id,0,0,p.id):p.$level!=v.$level-1||f.getChildren(p.id).length?C&&g(C,v)&&v.id!=C.id&&f.move(v.id,-1,f.getParent(C.id)):f.move(v.id,0,p.id)}return!0},t)),i.attachEvent("onDragEnd",t.bind(function(){var o=s(),l=o.getItem(i.config.id);l.$transparent=!1,l.$open=i.config.initial_open_state,this.callEvent("onBeforeRowDragEnd",[i.config.id,i.config.parent,i.config.index])===!1?(o.move(i.config.id,i.config.index,i.config.parent),l.$drop_target=null):this.callEvent("onRowDragEnd",[i.config.id,l.$drop_target]),t.render(),this.refreshData()},t))}function a(o){return nt(o,n.$config.item_attribute)}function s(){return t.getDatastore(n.$config.bind)}function r(o){return It(o,t,s())}}},et={createDropTargetObject:function(t){var n={targetParent:null,targetIndex:0,targetId:null,child:!1,nextSibling:!1,prevSibling:!1};return t&&R(n,t,!0),n},nextSiblingTarget:function(t,n,e){var i=this.createDropTargetObject();return i.targetId=n,i.nextSibling=!0,i.targetParent=e.getParent(i.targetId),i.targetIndex=e.getBranchIndex(i.targetId),(e.getParent(t)!=i.targetParent||i.targetIndex<e.getBranchIndex(t))&&(i.targetIndex+=1),i},prevSiblingTarget:function(t,n,e){var i=this.createDropTargetObject();return i.targetId=n,i.prevSibling=!0,i.targetParent=e.getParent(i.targetId),i.targetIndex=e.getBranchIndex(i.targetId),e.getParent(t)==i.targetParent&&i.targetIndex>e.getBranchIndex(t)&&(i.targetIndex-=1),i},firstChildTarget:function(t,n,e){var i=this.createDropTargetObject();return i.targetId=n,i.targetParent=i.targetId,i.targetIndex=0,i.child=!0,i},lastChildTarget:function(t,n,e){var i=e.getChildren(n),a=this.createDropTargetObject();return a.targetId=i[i.length-1],a.targetParent=n,a.targetIndex=i.length,a.nextSibling=!0,a}};function xn(t,n,e,i,a){for(var s=n;i.exists(s);){var r=i.calculateItemLevel(i.getItem(s));if((r===e||r===e-1)&&i.getBranchIndex(s)>-1)break;s=a?i.getPrev(s):i.getNext(s)}return i.exists(s)?i.calculateItemLevel(i.getItem(s))===e?a?et.nextSiblingTarget(t,s,i):et.prevSiblingTarget(t,s,i):et.firstChildTarget(t,s,i):null}function Ce(t,n,e,i){return xn(t,n,e,i,!0)}function $n(t,n,e,i){return xn(t,n,e,i,!1)}function wn(t,n,e,i,a,s){var r;if(n!==a.$getRootId()){var o=a.getItem(n),l=a.calculateItemLevel(o);if(l===s){var d=a.getPrevSibling(n);e<.5&&!d?r=et.prevSiblingTarget(t,n,a):(e<.5&&(n=d),r=et.nextSiblingTarget(t,n,a))}else if(l>s)a.eachParent(function(f){a.calculateItemLevel(f)===s&&(n=f.id)},o),r=Ce(t,n,s,a);else{var c=Ce(t,n,s,a),u=$n(t,n,s,a);r=e<.5?c:u}}else{var h=a.$getRootId(),_=a.getChildren(h);r=et.createDropTargetObject(),r=_.length&&i>=0?Ce(t,function(f){for(var y=f.getNext();f.exists(y);){var v=f.getNext(y);if(!f.exists(v))return y;y=v}return null}(a),s,a):$n(t,h,s,a)}return r}function Sn(t,n){var e=V(n.$grid_data);return t.x+=e.x+n.$grid.scrollLeft,t.y+=e.y-n.$grid_data.scrollTop,t}function Ee(t,n,e=0){const i=V(t.$root);return n>i.width&&(n=i.width-e-2),n}const Tn={removeLineHighlight:function(t){t.markerLine&&t.markerLine.parentNode&&t.markerLine.parentNode.removeChild(t.markerLine),t.markerLine=null},highlightPosition:function(t,n,e){var i=function(s,r){var o=V(r.$grid_data),l=at(s,r.$grid_data),d=o.x+r.$grid.scrollLeft,c=l.y-10,u=r.getItemHeight(s.targetId);c<o.y&&(c=o.y);var h=r.getTotalHeight();return c>o.y+h-u&&(c=o.y+h-u),o.x=d,o.y=c,o.width=Ee(r.$gantt,o.width,9),o}(t,e);n.marker.style.left=i.x+9+"px",n.marker.style.width=i.width+"px",n.marker.style.overflow="hidden";var a=n.markerLine;a||((a=document.createElement("div")).className="gantt_drag_marker gantt_grid_dnd_marker",a.innerHTML="<div class='gantt_grid_dnd_marker_line'></div>",a.style.pointerEvents="none"),t.child?function(s,r,o){var l=s.targetParent,d=Sn({x:0,y:o.getItemTop(l)},o),c=o.$grid_data.getBoundingClientRect().bottom+window.scrollY;let u=Ee(o.$gantt,o.$grid_data.offsetWidth);r.innerHTML="<div class='gantt_grid_dnd_marker_folder'></div>",r.style.width=u+"px",r.style.top=d.y+"px",r.style.left=d.x+"px",r.style.height=o.getItemHeight(l)+"px",d.y>c&&(r.style.top=c+"px")}(t,a,e):function(s,r,o){var l=function(u,h){var _=h.$config.rowStore,f={x:0,y:0},y=h.$grid_data.querySelector(".gantt_tree_indent"),v=15,b=0;y&&(v=y.offsetWidth);var m=40;if(u.targetId!==_.$getRootId()){var g=h.getItemTop(u.targetId),p=h.getItemHeight(u.targetId);if(b=_.exists(u.targetId)?_.calculateItemLevel(_.getItem(u.targetId)):0,u.prevSibling)f.y=g;else if(u.nextSibling){var k=0;_.eachItem(function(x){_.getIndexById(x.id)!==-1&&k++},u.targetId),f.y=g+p+k*p}else f.y=g+p,b+=1}return f.x=m+b*v,f.width=Ee(h.$gantt,Math.max(h.$grid_data.offsetWidth-f.x,0),f.x),Sn(f,h)}(s,o),d=o.$grid_data.getBoundingClientRect().bottom+window.scrollY;r.innerHTML="<div class='gantt_grid_dnd_marker_line'></div>",r.style.left=l.x+"px",r.style.height="4px";var c=l.y-2;r.style.top=c+"px",r.style.width=l.width+"px",c>d&&(r.style.top=d+"px")}(t,a,e),n.markerLine||(document.body.appendChild(a),n.markerLine=a)}},Wa={init:function(t,n){var e=t.$services.getService("dnd");if(n.$config.bind&&t.getDatastore(n.$config.bind)){var i=new e(n.$grid_data,{updates_per_second:60});t.defined(n.$getConfig().dnd_sensitivity)&&(i.config.sensitivity=n.$getConfig().dnd_sensitivity),i.attachEvent("onBeforeDragStart",t.bind(function(o,l){var d=a(l);if(!d||(t.hideQuickInfo&&t.hideQuickInfo(),dt(l.target,".gantt_grid_editor_placeholder")))return!1;var c=d.getAttribute(n.$config.item_attribute),u=n.$config.rowStore.getItem(c);return!t.isReadonly(u)&&!s(c)&&(i.config.initial_open_state=u.$open,!!t.callEvent("onRowDragStart",[c,l.target||l.srcElement,l])&&void 0)},t)),i.attachEvent("onAfterDragStart",t.bind(function(o,l){var d=a(l);i.config.marker.innerHTML=d.outerHTML;var c=i.config.marker.firstChild;c&&(i.config.marker.style.opacity=.4,c.style.position="static",c.style.pointerEvents="none"),i.config.id=d.getAttribute(n.$config.item_attribute);var u=n.$config.rowStore,h=u.getItem(i.config.id);i.config.level=u.calculateItemLevel(h),i.config.drop_target=et.createDropTargetObject({targetParent:u.getParent(h.id),targetIndex:u.getBranchIndex(h.id),targetId:h.id,nextSibling:!0}),h.$open=!1,h.$transparent=!0,this.refreshData()},t)),i.attachEvent("onDragMove",t.bind(function(o,l){var d=r(l);return d&&t.callEvent("onBeforeRowDragMove",[i.config.id,d.targetParent,d.targetIndex])!==!1||(d=et.createDropTargetObject(i.config.drop_target)),Tn.highlightPosition(d,i.config,n),i.config.drop_target=d,t._waiAria.reorderMarkerAttr(i.config.marker),this.callEvent("onRowDragMove",[i.config.id,d.targetParent,d.targetIndex]),!0},t)),i.attachEvent("onDragEnd",t.bind(function(){var o=n.$config.rowStore,l=o.getItem(i.config.id);Tn.removeLineHighlight(i.config),l.$transparent=!1,l.$open=i.config.initial_open_state;var d=i.config.drop_target;this.callEvent("onBeforeRowDragEnd",[i.config.id,d.targetParent,d.targetIndex])===!1?l.$drop_target=null:(o.move(i.config.id,d.targetIndex,d.targetParent),t.render(),this.callEvent("onRowDragEnd",[i.config.id,d.targetParent,d.targetIndex])),o.refresh(l.id)},t))}function a(o){return nt(o,n.$config.item_attribute)}function s(o){return It(o,t,t.getDatastore(n.$config.bind))}function r(o){var l,d=function(f){var y=at(f,n.$grid_data).y,v=n.$config.rowStore;document.doctype||(y+=window.scrollY),y=y||0;var b=n.$state.scrollTop||0,m=t.$grid_data.getBoundingClientRect().height+b+window.scrollY,g=b,p=n.getItemIndexByTopPosition(n.$state.scrollTop);if(v.exists(p)||(p=v.countVisible()-1),p<0)return v.$getRootId();var k=v.getIdByIndex(p),x=n.$state.scrollTop/n.getItemHeight(k),w=x-Math.floor(x);w>.1&&w<.9&&(m-=n.getItemHeight(k)*w,g+=n.getItemHeight(k)*(1-w));const $=V(n.$grid_data),T=$.y+$.height,S=i.config.marker.offsetHeight;y+S+window.scrollY>=m&&(i.config.marker.style.top=T-S+"px"),y>=m?y=m:y<=g&&(y=g,i.config.marker.style.top=$.y+"px");var C=n.getItemIndexByTopPosition(y);if(C>v.countVisible()-1||C<0)return v.$getRootId();var E=v.getIdByIndex(C);return s(E)?v.getPrevSibling(E):v.getIdByIndex(C)}(o),c=null,u=n.$config.rowStore,h=!n.$getConfig().order_branch_free,_=at(o,n.$grid_data).y;return document.doctype||(_+=window.scrollY),d!==u.$getRootId()&&(c=(_-n.getItemTop(d))/n.getItemHeight(d)),h?(l=wn(i.config.id,d,c,_,u,i.config.level))&&l.targetParent&&s(l.targetParent)&&(d=u.getPrevSibling(l.targetParent),l=wn(i.config.id,d,c,_,u,i.config.level)):l=function(f,y,v,b,m){var g;if(y!==m.$getRootId())g=v<.25?et.prevSiblingTarget(f,y,m):!(v>.6)||m.hasChild(y)&&m.getItem(y).$open?et.firstChildTarget(f,y,m):et.nextSiblingTarget(f,y,m);else{var p=m.$getRootId();g=m.hasChild(p)&&b>=0?et.lastChildTarget(f,p,m):et.firstChildTarget(f,p,m)}return g}(i.config.id,d,c,_,u),l}}};var Fa=function(t){return{onCreated:function(n){n.$config=R(n.$config,{bind:"task"}),n.$config.id=="grid"&&(this.extendGantt(n),t.ext.inlineEditors=t.ext._inlineEditors.createEditors(n),t.ext.inlineEditors.init()),this._mouseDelegates=$e(t)},onInitialized:function(n){var e=n.$getConfig();e.order_branch&&(e.order_branch=="marker"?Wa.init(n.$gantt,n):ja.init(n.$gantt,n)),this.initEvents(n,t),n.$config.id=="grid"&&this.extendDom(n)},onDestroyed:function(n){n.$config.id=="grid"&&t.ext.inlineEditors.detachStore(),this.clearEvents(n,t)},initEvents:function(n,e){this._mouseDelegates.delegate("click","gantt_row",e.bind(function(i,a,s){const r=n.$getConfig();if(a!==null){const o=this.getTask(a);if(r.scroll_on_click){const l=!e._is_icon_open_click(i),d=e.$ui.getView("timeline");l&&d&&this.showDate(o.start_date)}e.callEvent("onTaskRowClick",[a,s])}},e),n.$grid),this._mouseDelegates.delegate("click","gantt_grid_head_cell",e.bind(function(i,a,s){var r=s.getAttribute("data-column-id");if(e.callEvent("onGridHeaderClick",[r,i])){var o=n.$getConfig();if(r!="add"){if(o.sort&&r){for(var l,d=r,c=0;c<o.columns.length;c++)if(o.columns[c].name==r){l=o.columns[c];break}if(l&&l.sort!==void 0&&l.sort!==!0&&!(d=l.sort))return;var u=this._sort&&this._sort.direction&&this._sort.name==r?this._sort.direction:"desc";u=u=="desc"?"asc":"desc",this._sort={name:r,direction:u},this.sort(d,u=="desc")}}else e.$services.getService("mouseEvents").callHandler("click","gantt_add",n.$grid,[i,o.root_id])}},e),n.$grid),this._mouseDelegates.delegate("click","gantt_add",e.bind(function(i,a,s){if(!n.$getConfig().readonly)return this.createTask({},a||e.config.root_id),!1},e),n.$grid)},clearEvents:function(n,e){this._mouseDelegates.destructor(),this._mouseDelegates=null},extendDom:function(n){t.$grid=n.$grid,t.$grid_scale=n.$grid_scale,t.$grid_data=n.$grid_data},extendGantt:function(n){t.getGridColumns=t.bind(n.getGridColumns,n),n.attachEvent("onColumnResizeStart",function(){return t.callEvent("onColumnResizeStart",arguments)}),n.attachEvent("onColumnResize",function(){return t.callEvent("onColumnResize",arguments)}),n.attachEvent("onColumnResizeEnd",function(){return t.callEvent("onColumnResizeEnd",arguments)}),n.attachEvent("onColumnResizeComplete",function(e,i){t.config.grid_width=i}),n.attachEvent("onBeforeRowResize",function(){return t.callEvent("onBeforeRowResize",arguments)}),n.attachEvent("onRowResize",function(){return t.callEvent("onRowResize",arguments)}),n.attachEvent("onBeforeRowResizeEnd",function(){return t.callEvent("onBeforeRowResizeEnd",arguments)}),n.attachEvent("onAfterRowResize",function(){return t.callEvent("onAfterRowResize",arguments)})}}};const Va={createTaskDND:function(){var t;return{extend:function(n){n.roundTaskDates=function(e){t.round_task_dates(e)}},init:function(n,e){return t=function(i,a){var s=a.$services;return{drag:null,dragMultiple:{},_events:{before_start:{},before_finish:{},after_finish:{}},_handlers:{},init:function(){this._domEvents=a._createDomEventScope(),this.clear_drag_state();var r=a.config.drag_mode;this.set_actions(),s.getService("state").registerProvider("tasksDnd",O(function(){return{drag_id:this.drag?this.drag.id:void 0,drag_mode:this.drag?this.drag.mode:void 0,drag_from_start:this.drag?this.drag.left:void 0}},this));var o={before_start:"onBeforeTaskDrag",before_finish:"onBeforeTaskChanged",after_finish:"onAfterTaskDrag"};for(var l in this._events)for(var d in r)this._events[l][d]=o[l];this._handlers[r.move]=this._move,this._handlers[r.resize]=this._resize,this._handlers[r.progress]=this._resize_progress},set_actions:function(){var r=i.$task_data;this._domEvents.attach(r,"mousemove",a.bind(function(o){this.on_mouse_move(o)},this)),this._domEvents.attach(r,"mousedown",a.bind(function(o){this.on_mouse_down(o)},this)),this._domEvents.attach(document.body,"mouseup",a.bind(function(o){this.on_mouse_up(o)},this))},_getPositioningContext:function(r){return i._getPositioningContext?i._getPositioningContext(r):null},clear_drag_state:function(){this.drag={id:null,mode:null,pos:null,start_x:null,start_y:null,obj:null,left:null},this.dragMultiple={}},_resize:function(r,o,l){var d=i.$getConfig(),c=this._drag_task_coords(r,l);l.left?(r.start_date=a.dateFromPos(c.start+o,this._getPositioningContext(r)),r.start_date||(r.start_date=new Date(a.getState().min_date))):(r.end_date=a.dateFromPos(c.end+o,this._getPositioningContext(r)),r.end_date||(r.end_date=new Date(a.getState().max_date)));var u=this._calculateMinDuration(d.min_duration,d.duration_unit);r.end_date-r.start_date<d.min_duration&&(l.left?r.start_date=a.calculateEndDate(r.end_date,-u,d.duration_unit,r):r.end_date=a.calculateEndDate(r.start_date,u,d.duration_unit,r)),a._init_task_timing(r)},_calculateMinDuration:function(r,o){return Math.ceil(r/{minute:6e4,hour:36e5,day:864e5,week:6048e5,month:24192e5,year:31356e6}[o])},_resize_progress:function(r,o,l){var d=this._drag_task_coords(r,l),c=i.$getConfig().rtl?d.start-l.pos.x:l.pos.x-d.start,u=Math.max(0,c);r.progress=Math.min(1,u/Math.abs(d.end-d.start))},_find_max_shift:function(r,o){var l;for(var d in r){var c=r[d],u=a.getTask(c.id);if(!u.unscheduled){var h=this._drag_task_coords(u,c),_=a.posFromDate(new Date(a.getState().min_date),this._getPositioningContext(u)),f=a.posFromDate(new Date(a.getState().max_date),this._getPositioningContext(u));if(h.end+o>f){var y=f-h.end;(y<l||l===void 0)&&(l=y)}else if(h.start+o<_){var v=_-h.start;(v>l||l===void 0)&&(l=v)}}}return l},_move:function(r,o,l,d){var c=this._drag_task_coords(r,l),u=null,h=null;d?(u=new Date(+l.obj.start_date+d),h=new Date(+l.obj.end_date+d)):(u=a.dateFromPos(c.start+o,this._getPositioningContext(r)),h=a.dateFromPos(c.end+o,this._getPositioningContext(r))),u?h?(r.start_date=u,r.end_date=h):(r.end_date=new Date(a.getState().max_date),r.start_date=a.dateFromPos(a.posFromDate(r.end_date)-(c.end-c.start),this._getPositioningContext(r))):(r.start_date=new Date(a.getState().min_date),r.end_date=a.dateFromPos(a.posFromDate(r.start_date)+(c.end-c.start),this._getPositioningContext(r)))},_drag_task_coords:function(r,o){return{start:o.obj_s_x=o.obj_s_x||a.posFromDate(r.start_date,this._getPositioningContext(r)),end:o.obj_e_x=o.obj_e_x||a.posFromDate(r.end_date,this._getPositioningContext(r))}},_mouse_position_change:function(r,o){var l=r.x-o.x,d=r.y-o.y;return Math.sqrt(l*l+d*d)},_is_number:function(r){return!isNaN(parseFloat(r))&&isFinite(r)},on_mouse_move:function(r){if(this.drag.start_drag){var o=at(r,a.$task_data),l=this.drag.start_drag.start_x,d=this.drag.start_drag.start_y;(Date.now()-this.drag.timestamp>50||this._is_number(l)&&this._is_number(d)&&this._mouse_position_change({x:l,y:d},o)>20)&&this._start_dnd(r)}if(this.drag.mode){if(!Xe(this,40))return;this._update_on_move(r)}},_update_item_on_move:function(r,o,l,d,c,u){var h=a.getTask(o),_=a.mixin({},h),f=a.mixin({},h);this._handlers[l].apply(this,[f,r,d,u]),a.mixin(h,f,!0),a.callEvent("onTaskDrag",[h.id,l,f,_,c]),a.mixin(h,f,!0),a.refreshTask(o)},_update_on_move:function(r){var o=this.drag,l=i.$getConfig();if(o.mode){var d=at(r,i.$task_data);if(o.pos&&o.pos.x==d.x)return;o.pos=d;const m=a.getTask(o.id);var c=a.dateFromPos(d.x,this._getPositioningContext(m));if(!c||isNaN(c.getTime()))return;var u=d.x-o.start_x;if(this._handlers[o.mode]){if(o.mode===l.drag_mode.move){var h={};this._isMultiselect()&&a.getSelectedTasks().indexOf(o.id)>=0&&(h=this.dragMultiple);var _=!1;if(a.isSummaryTask(m)&&a.config.drag_project){var f={};f[o.id]=K(o),_=!0,h=R(f,this.dragMultiple)}var y=this._find_max_shift(h,u);let g;if(y!==void 0&&(u=y),this._update_item_on_move(u,o.id,o.mode,o,r),y===void 0){const p=a.posFromDate(o.obj.start_date,this._getPositioningContext(o.obj)),k=a.posFromDate(o.obj.end_date,this._getPositioningContext(o.obj));if(o.handle_offset===void 0){const w=k-p,$=o.start_x-p;o.handle_offset=$/w}let x=p+Math.abs(k-p)*o.handle_offset;g=c-a.dateFromPos(x,this._getPositioningContext(o.obj))}for(var v in h){var b=h[v];_&&b.id!=o.id&&(a._bulk_dnd=!0),this._update_item_on_move(u,b.id,b.mode,b,r,g)}a._bulk_dnd=!1}else this._update_item_on_move(u,o.id,o.mode,o,r);a._update_parents(o.id)}}},on_mouse_down:function(r,o){if(r.button!=2||r.button===void 0){var l=i.$getConfig(),d=a.locate(r),c=null;if(a.isTaskExists(d)&&(c=a.getTask(d)),!a.isReadonly(c)&&!this.drag.mode){this.clear_drag_state();var u=Z(o=o||r.target||r.srcElement),h=this._get_drag_mode(u,o);if(!u||!h)return o.parentNode?this.on_mouse_down(r,o.parentNode):void 0;if(h)if(h.mode&&h.mode!=l.drag_mode.ignore&&l["drag_"+h.mode]){if(d=a.locate(o),c=a.copy(a.getTask(d)||{}),a.isReadonly(c))return this.clear_drag_state(),!1;if(a.isSummaryTask(c)&&c.auto_scheduling!==!1&&!l.drag_project&&h.mode!=l.drag_mode.progress)return void this.clear_drag_state();h.id=d;var _=at(r,a.$task_data);h.start_x=_.x,h.start_y=_.y,h.obj=c,this.drag.start_drag=h,this.drag.timestamp=Date.now()}else this.clear_drag_state();else if(a.checkEvent("onMouseDown")&&a.callEvent("onMouseDown",[u.split(" ")[0]])&&o.parentNode)return this.on_mouse_down(r,o.parentNode)}}},_fix_dnd_scale_time:function(r,o){var l=i.$getConfig(),d=a.getScale().unit,c=a.getScale().step;function u(_){if(a.config.correct_work_time){var f=i.$getConfig();a.isWorkTime(_.start_date,void 0,_)||(_.start_date=a.calculateEndDate({start_date:_.start_date,duration:-1,unit:f.duration_unit,task:_}))}}l.round_dnd_dates||(d="minute",c=l.time_step);const h=i._getPositioningContext(r);o.mode==l.drag_mode.resize?o.left?(r.start_date=a.roundDate({date:r.start_date,unit:d,step:c}),h&&h.calendar&&(r.start_date=h.calendar.getClosestWorkTime({date:r.start_date,dir:"future"})),u(r)):(r.end_date=a.roundDate({date:r.end_date,unit:d,step:c}),h&&h.calendar&&(r.end_date=h.calendar.getClosestWorkTime({date:r.end_date})),function(_){if(a.config.correct_work_time){var f=i.$getConfig();a.isWorkTime(new Date(_.end_date-1),void 0,_)||(_.end_date=a.calculateEndDate({start_date:_.end_date,duration:1,unit:f.duration_unit,task:_}))}}(r)):o.mode==l.drag_mode.move&&(r.start_date=a.roundDate({date:r.start_date,unit:d,step:c}),h&&h.calendar&&(r.start_date=h.calendar.getClosestWorkTime({date:r.start_date,dir:"future"})),u(r),r.end_date=a.calculateEndDate(r))},_fix_working_times:function(r,o){var l=i.$getConfig();(o=o||{mode:l.drag_mode.move}).mode==l.drag_mode.resize?o.left?r.start_date=a.getClosestWorkTime({date:r.start_date,dir:"future",task:r}):r.end_date=a.getClosestWorkTime({date:r.end_date,dir:"past",task:r}):o.mode==l.drag_mode.move&&a.correctTaskWorkTime(r)},_finalize_mouse_up:function(r,o,l,d){var c=a.getTask(r);if(o.work_time&&o.correct_work_time&&this._fix_working_times(c,l),this._fix_dnd_scale_time(c,l),this._fireEvent("before_finish",l.mode,[r,l.mode,a.copy(l.obj),d])){var u=r;a._init_task_timing(c),this.clear_drag_state(),a.updateTask(c.id),this._fireEvent("after_finish",l.mode,[u,l.mode,d])}else if(this.clear_drag_state(),r==l.id&&(l.obj._dhx_changed=!1,a.mixin(c,l.obj,!0)),a.refreshTask(c.id),c.$level>100){let h=!1;a.eachParent(function(_){if(!h&&_.type===a.config.types.project){const f={start_date:_.start_date,end_date:_.end_date};a.resetProjectDates(_),+f.start_date==+_.start_date&&+f.end_date==+_.end_date||(h=!0)}},c.id),h&&a.refreshData()}else a.eachParent(function(h){if(h.type===a.config.types.project){const _={start_date:h.start_date,end_date:h.end_date};a.resetProjectDates(h),+_.start_date==+h.start_date&&+_.end_date==+h.end_date||a.refreshTask(h.id)}},c.id)},on_mouse_up:function(r){var o=this.drag;if(o.mode&&o.id){var l=i.$getConfig(),d=a.getTask(o.id),c=this.dragMultiple,u=!1,h=0;o.mode===l.drag_mode.move&&(a.isSummaryTask(d)&&l.drag_project||this._isMultiselect())&&(u=!0,h=Object.keys(c).length);var _=function(){if(u)for(var f in c)c[f].id!=o.id&&this._finalize_mouse_up(c[f].id,l,c[f],r);this._finalize_mouse_up(o.id,l,o,r)};u&&h>10?a.batchUpdate((function(){_.call(this)}).bind(this)):_.call(this)}this.clear_drag_state()},_get_drag_mode:function(r,o){var l=i.$getConfig().drag_mode,d={mode:null,left:null};switch((r||"").split(" ")[0]){case"gantt_task_line":case"gantt_task_content":d.mode=l.move;break;case"gantt_task_drag":d.mode=l.resize;var c=o.getAttribute("data-bind-property");d.left=c=="start_date";break;case"gantt_task_progress_drag":d.mode=l.progress;break;case"gantt_link_control":case"gantt_link_point":d.mode=l.ignore;break;default:d=null}return d},_start_dnd:function(r){var o=this.drag=this.drag.start_drag;delete o.start_drag;var l=i.$getConfig(),d=o.id;if(l["drag_"+o.mode]&&a.callEvent("onBeforeDrag",[d,o.mode,r])&&this._fireEvent("before_start",o.mode,[d,o.mode,r])){delete o.start_drag;var c=a.getTask(d);if(a.isReadonly(c))return void this.clear_drag_state();if(this._isMultiselect()){var u=a.getSelectedTasks();u.indexOf(o.id)>=0&&xt(u,a.bind(function(h){var _=a.getTask(h);a.isSummaryTask(_)&&a.config.drag_project&&o.mode==l.drag_mode.move&&this._addSubtasksToDragMultiple(_.id),this.dragMultiple[h]=a.mixin({id:_.id,obj:a.copy(_)},this.drag)},this))}a.isSummaryTask(c)&&a.config.drag_project&&o.mode==l.drag_mode.move&&this._addSubtasksToDragMultiple(c.id),a.callEvent("onTaskDragStart",[])}else this.clear_drag_state()},_fireEvent:function(r,o,l){a.assert(this._events[r],"Invalid stage:{"+r+"}");var d=this._events[r][o];return a.assert(d,"Unknown after drop mode:{"+o+"}"),a.assert(l,"Invalid event arguments"),!a.checkEvent(d)||a.callEvent(d,l)},round_task_dates:function(r){var o=this.drag,l=i.$getConfig();o||(o={mode:l.drag_mode.move}),this._fix_dnd_scale_time(r,o)},destructor:function(){this._domEvents.detachAll()},_isMultiselect:function(){return a.config.drag_multiple&&!!(a.getSelectedTasks&&a.getSelectedTasks().length>0)},_addSubtasksToDragMultiple:function(r){a.eachTask(function(o){this.dragMultiple[o.id]=a.mixin({id:o.id,obj:a.copy(o)},this.drag)},r,this)}}}(n,e),n._tasks_dnd=t,t.init(e)},destructor:function(){t&&(t.destructor(),t=null)}}}};var Ua=function(t,n){var e,i,a,s,r;function o(){return{link_source_id:s,link_target_id:i,link_from_start:r,link_to_start:a,link_landing_area:e}}var l=n.$services,d=l.getService("state"),c=l.getService("dnd");d.registerProvider("linksDnD",o);var u="gantt_link_point",h="gantt_link_control",_=new c(t.$task_bars,{sensitivity:0,updates_per_second:60,mousemoveContainer:n.$root,selector:"."+u,preventDefault:!0});function f(g,p){var k,x=_.getPosition(g),w=function(A){var M=0,I=0;return A&&(M=A.offsetWidth||0,I=A.offsetHeight||0),{width:M,height:I}}(p),$={right:(k=n.$root).offsetWidth,bottom:k.offsetHeight},T=n.config.tooltip_offset_x||10,S=n.config.tooltip_offset_y||10,C=n.config.scroll_size||18,E=n.$container.getBoundingClientRect().y+window.scrollY,D={y:x.y+S,x:x.x+T,bottom:x.y+w.height+S+C,right:x.x+w.width+T+C};return D.bottom>$.bottom+E&&(D.y=$.bottom+E-w.height-S),D.right>$.right&&(D.x=$.right-w.width-T),D}function y(g){var p=o();p.link_source_id&&p.link_target_id&&n.isLinkAllowed(p.link_source_id,p.link_target_id,p.link_from_start,p.link_to_start);var k="<div class='"+n.templates.drag_link_class(p.link_source_id,p.link_from_start,p.link_target_id,p.link_to_start)+"'>"+n.templates.drag_link(p.link_source_id,p.link_from_start,p.link_target_id,p.link_to_start)+"</div>";g.innerHTML=k}function v(){s=r=i=null,a=!0}function b(g,p,k,x){var w=function(){return _._direction&&_._direction.parentNode||(_._direction=document.createElement("div"),t.$task_links.appendChild(_._direction)),_._direction}(),$=o(),T=["gantt_link_direction"];n.templates.link_direction_class&&T.push(n.templates.link_direction_class($.link_source_id,$.link_from_start,$.link_target_id,$.link_to_start));var S=Math.sqrt(Math.pow(k-g,2)+Math.pow(x-p,2));if(S=Math.max(0,S-3)){w.className=T.join(" ");var C=(x-p)/(k-g),E=Math.atan(C);m(g,k,p,x)==2?E+=Math.PI:m(g,k,p,x)==3&&(E-=Math.PI);var D=Math.sin(E),A=Math.cos(E),M=Math.round(p),I=Math.round(g),N=["-webkit-transform: rotate("+E+"rad)","-moz-transform: rotate("+E+"rad)","-ms-transform: rotate("+E+"rad)","-o-transform: rotate("+E+"rad)","transform: rotate("+E+"rad)","width:"+Math.round(S)+"px"];if(window.navigator.userAgent.indexOf("MSIE 8.0")!=-1){N.push('-ms-filter: "'+function(z,H){return"progid:DXImageTransform.Microsoft.Matrix(M11 = "+H+",M12 = -"+z+",M21 = "+z+",M22 = "+H+",SizingMethod = 'auto expand')"}(D,A)+'"');var L=Math.abs(Math.round(g-k)),B=Math.abs(Math.round(x-p));switch(m(g,k,p,x)){case 1:M-=B;break;case 2:I-=L,M-=B;break;case 3:I-=L}}N.push("top:"+M+"px"),N.push("left:"+I+"px"),w.style.cssText=N.join(";")}}function m(g,p,k,x){return p>=g?x<=k?1:4:x<=k?2:3}_.attachEvent("onBeforeDragStart",n.bind(function(g,p){var k=p.target||p.srcElement;if(v(),n.getState("tasksDnd").drag_id)return!1;if(ft(k,u)){ft(k,"task_start_date")&&(r=!0);var x=n.locate(p);s=x;var w=n.getTask(x);return n.isReadonly(w)?(v(),!1):(this._dir_start={x:_.config.original_element_sizes.x+_.config.original_element_sizes.width/2,y:_.config.original_element_sizes.y+_.config.original_element_sizes.height/2},!0)}return!1},this)),_.attachEvent("onAfterDragStart",n.bind(function(g,p){n.config.touch&&n.refreshData(),y(_.config.marker)},this)),_.attachEvent("onDragMove",n.bind(function(g,p){var k=_.config,x=f(p,k.marker);(function(A,M){A.style.left=M.x+"px",A.style.top=M.y+"px"})(k.marker,x);var w=!!ft(p,h),$=i,T=e,S=a,C=n.locate(p),E=!0;if(J(yt(p),n.$root)||(w=!1,C=null),w&&(E=!ft(p,"task_end_date"),w=!!C),i=C,e=w,a=E,w){const A=ft(p,h).querySelector(`.${u}`);if(A){const M=Pe(A,t.$task_bg);this._dir_end={x:M.x+A.offsetWidth/2,y:M.y+A.offsetHeight/2}}}else this._dir_end=at(p,t.$task_data),n.env.isEdge&&(this._dir_end.y+=window.scrollY);var D=!(T==w&&$==C&&S==E);return D&&($&&n.refreshTask($,!1),C&&n.refreshTask(C,!1)),D&&y(k.marker),b(this._dir_start.x,this._dir_start.y,this._dir_end.x,this._dir_end.y),!0},this)),_.attachEvent("onDragEnd",n.bind(function(){var g=o();if(g.link_source_id&&g.link_target_id&&g.link_source_id!=g.link_target_id){var p=n._get_link_type(g.link_from_start,g.link_to_start),k={source:g.link_source_id,target:g.link_target_id,type:p};k.type&&n.isLinkAllowed(k)&&n.callEvent("onLinkCreated",[k])&&n.addLink(k)}v(),n.config.touch?n.refreshData():(g.link_source_id&&n.refreshTask(g.link_source_id,!1),g.link_target_id&&n.refreshTask(g.link_target_id,!1)),_._direction&&(_._direction.parentNode&&_._direction.parentNode.removeChild(_._direction),_._direction=null)},this)),n.attachEvent("onGanttRender",n.bind(function(){_._direction&&b(this._dir_start.x,this._dir_start.y,this._dir_end.x,this._dir_end.y)},this))};const qa=function(){return{init:Ua}};var Ga=function(t){var n=t.$services;return{onCreated:function(e){var i=e.$config;i.bind=U(i.bind)?i.bind:"task",i.bindLinks=U(i.bindLinks)?i.bindLinks:"link",e._linksDnD=qa(),e._tasksDnD=Va.createTaskDND(),e._tasksDnD.extend(e),this._mouseDelegates=$e(t)},onInitialized:function(e){this._attachDomEvents(t),this._attachStateProvider(t,e),e._tasksDnD.init(e,t),e._linksDnD.init(e,t),e.$config.id=="timeline"&&this.extendDom(e)},onDestroyed:function(e){this._clearDomEvents(t),this._clearStateProvider(t),e._tasksDnD&&e._tasksDnD.destructor()},extendDom:function(e){t.$task=e.$task,t.$task_scale=e.$task_scale,t.$task_data=e.$task_data,t.$task_bg=e.$task_bg,t.$task_links=e.$task_links,t.$task_bars=e.$task_bars},_clearDomEvents:function(){this._mouseDelegates.destructor(),this._mouseDelegates=null},_attachDomEvents:function(e){function i(a,s){if(a&&this.callEvent("onLinkDblClick",[a,s])){var r=this.getLink(a);if(this.isReadonly(r))return;var o=this.locale.labels.link+" "+this.templates.link_description(this.getLink(a))+" "+this.locale.labels.confirm_link_deleting;window.setTimeout(function(){e._delete_link_confirm({link:r,message:o,title:"",callback:function(){e.deleteLink(a)}})},this.config.touch?300:1)}}this._mouseDelegates.delegate("click","gantt_task_link",e.bind(function(a,s){var r=this.locate(a,this.config.link_attribute);r&&this.callEvent("onLinkClick",[r,a])},e),this.$task),this._mouseDelegates.delegate("click","gantt_scale_cell",e.bind(function(a,s){var r=at(a,e.$task_data),o=e.dateFromPos(r.x),l=Math.floor(e.columnIndexByDate(o)),d=e.getScale().trace_x[l];e.callEvent("onScaleClick",[a,d])},e),this.$task),this._mouseDelegates.delegate("doubleclick","gantt_task_link",e.bind(function(a,s,r){s=this.locate(a,e.config.link_attribute),i.call(this,s,a)},e),this.$task),this._mouseDelegates.delegate("doubleclick","gantt_link_point",e.bind(function(a,s,r){s=this.locate(a);var o=this.getTask(s),l=null;return r.parentNode&&Z(r.parentNode)&&(l=Z(r.parentNode).indexOf("_left")>-1?o.$target[0]:o.$source[0]),l&&i.call(this,l,a),!1},e),this.$task)},_attachStateProvider:function(e,i){var a=i;n.getService("state").registerProvider("tasksTimeline",function(){return{scale_unit:a._tasks?a._tasks.unit:void 0,scale_step:a._tasks?a._tasks.step:void 0}})},_clearStateProvider:function(){n.getService("state").unregisterProvider("tasksTimeline")}}},Ya=function(t){return{getVerticalScrollbar:function(){return t.$ui.getView("scrollVer")},getHorizontalScrollbar:function(){return t.$ui.getView("scrollHor")},_legacyGridResizerClass:function(n){for(var e=n.getCellsByType("resizer"),i=0;i<e.length;i++){var a=e[i],s=!1,r=a.$parent.getPrevSibling(a.$id);if(r&&r.$config&&r.$config.id==="grid")s=!0;else{var o=a.$parent.getNextSibling(a.$id);o&&o.$config&&o.$config.id==="grid"&&(s=!0)}s&&(a.$config.css=(a.$config.css?a.$config.css+" ":"")+"gantt_grid_resize_wrap")}},onCreated:function(n){var e=!0;this._legacyGridResizerClass(n),n.attachEvent("onBeforeResize",function(){var i=t.$ui.getView("timeline");i&&(i.$config.hidden=i.$parent.$config.hidden=!t.config.show_chart);var a=t.$ui.getView("grid");if(a){var s=a._getColsTotalWidth(),r=!t.config.show_grid||!t.config.grid_width||s===0;if(e&&!r&&s!==!1&&(t.config.grid_width=s),a.$config.hidden=a.$parent.$config.hidden=r,!a.$config.hidden){var o=a._getGridWidthLimits();if(o[0]&&t.config.grid_width<o[0]&&(t.config.grid_width=o[0]),o[1]&&t.config.grid_width>o[1]&&(t.config.grid_width=o[1]),i&&t.config.show_chart){if(a.$config.width=t.config.grid_width-1,!a.$config.scrollable&&a.$config.scrollY&&t.$root.offsetWidth){var l=a.$gantt.$layout.$container.offsetWidth,d=t.$ui.getView(a.$config.scrollY).$config.width,c=l-(a.$config.width+d)-4;c<0&&(a.$config.width+=c,t.config.grid_width+=c)}if(e)a.$parent.$config.width=t.config.grid_width,a.$parent.$config.group&&t.$layout._syncCellSizes(a.$parent.$config.group,{value:a.$parent.$config.width,isGravity:!1});else if(i&&!J(i.$task,n.$view)){if(!a.$config.original_grid_width){var u=t.skins[t.skin];u&&u.config&&u.config.grid_width?a.$config.original_grid_width=u.config.grid_width:a.$config.original_grid_width=0}t.config.grid_width=a.$config.original_grid_width,a.$parent.$config.width=t.config.grid_width}else a.$parent._setContentSize(a.$config.width,null),t.$layout._syncCellSizes(a.$parent.$config.group,{value:t.config.grid_width,isGravity:!1})}else i&&J(i.$task,n.$view)&&(a.$config.original_grid_width=t.config.grid_width),e||(a.$parent.$config.width=0)}e=!1}}),this._initScrollStateEvents(n)},_initScrollStateEvents:function(n){t._getVerticalScrollbar=this.getVerticalScrollbar,t._getHorizontalScrollbar=this.getHorizontalScrollbar;var e=this.getVerticalScrollbar(),i=this.getHorizontalScrollbar();e&&e.attachEvent("onScroll",function(a,s,r){var o=t.getScrollState();t.callEvent("onGanttScroll",[o.x,a,o.x,s])}),i&&i.attachEvent("onScroll",function(a,s,r){var o=t.getScrollState();t.callEvent("onGanttScroll",[a,o.y,s,o.y]);var l=t.$ui.getView("grid");l&&l.$grid_data&&!l.$config.scrollable&&(l.$grid_data.style.left=l.$grid.scrollLeft+"px",l.$grid_data.scrollLeft=l.$grid.scrollLeft)}),n.attachEvent("onResize",function(){e&&!t.$scroll_ver&&(t.$scroll_ver=e.$scroll_ver),i&&!t.$scroll_hor&&(t.$scroll_hor=i.$scroll_hor)})},_findGridResizer:function(n,e){for(var i,a=n.getCellsByType("resizer"),s=!0,r=0;r<a.length;r++){var o=a[r];o._getSiblings();var l=o._behind,d=o._front;if(l&&l.$content===e||l.isChild&&l.isChild(e)){i=o,s=!0;break}if(d&&d.$content===e||d.isChild&&d.isChild(e)){i=o,s=!1;break}}return{resizer:i,gridFirst:s}},onInitialized:function(n){var e=t.$ui.getView("grid"),i=this._findGridResizer(n,e);if(i.resizer){var a,s=i.gridFirst,r=i.resizer;if(r.$config.mode!=="x")return;r.attachEvent("onResizeStart",function(o,l){var d=t.$ui.getView("grid"),c=d?d.$parent:null;if(c){var u=d._getGridWidthLimits();d.$config.scrollable||(c.$config.minWidth=u[0]),c.$config.maxWidth=u[1]}return a=s?o:l,t.callEvent("onGridResizeStart",[a])}),r.attachEvent("onResize",function(o,l){var d=s?o:l;return t.callEvent("onGridResize",[a,d])}),r.attachEvent("onResizeEnd",function(o,l,d,c){var u=s?o:l,h=s?d:c,_=t.$ui.getView("grid"),f=_?_.$parent:null;f&&(f.$config.minWidth=void 0);var y=t.callEvent("onGridResizeEnd",[u,h]);return y&&h!==0&&(t.config.grid_width=h),y})}},onDestroyed:function(n){}}};const Ja={init:function(t){function n(s,r){var o=r(t);o.onCreated&&o.onCreated(s),s.attachEvent("onReady",function(){o.onInitialized&&o.onInitialized(s)}),s.attachEvent("onDestroy",function(){o.onDestroyed&&o.onDestroyed(s)})}var e=ga(t);e.registerView("cell",Rt),e.registerView("resizer",null),e.registerView("scrollbar",ba),e.registerView("layout",pn,function(s){(s.$config?s.$config.id:null)==="main"&&n(s,Ya)}),e.registerView("viewcell",ya),e.registerView("multiview",ka),e.registerView("timeline",Xt,function(s){(s.$config?s.$config.id:null)!=="timeline"&&s.$config.bind!="task"||n(s,Ga)}),e.registerView("grid",Zt,function(s){(s.$config?s.$config.id:null)!=="grid"&&s.$config.bind!="task"||n(s,Fa)}),e.registerView("resourceGrid",Zt),e.registerView("GridRL",Sa),e.registerView("resourceTimeline",Xt),e.registerView("resourceHistogram",Xt);var i=function(s){var r=ma(s);return{getDataRender:function(o){return s.$services.getService("layer:"+o)||null},createDataRender:function(o){var l=o.name,d=o.defaultContainer,c=o.defaultContainerSibling,u=r.createGroup(d,c,function(h,_){if(!u.filters)return!0;for(var f=0;f<u.filters.length;f++)if(u.filters[f](h,_)===!1)return!1},va);return s.$services.setService("layer:"+l,function(){return u}),s.attachEvent("onGanttReady",function(){u.addLayer()}),u},init:function(){var o=this.createDataRender({name:"task",defaultContainer:function(){return s.$task_data?s.$task_data:s.$ui.getView("timeline")?s.$ui.getView("timeline").$task_data:void 0},defaultContainerSibling:function(){return s.$task_links?s.$task_links:s.$ui.getView("timeline")?s.$ui.getView("timeline").$task_links:void 0},filter:function(d){}},s),l=this.createDataRender({name:"link",defaultContainer:function(){return s.$task_data?s.$task_data:s.$ui.getView("timeline")?s.$ui.getView("timeline").$task_data:void 0}},s);return{addTaskLayer:function(d){const c=mt;return typeof d=="function"?d={renderer:{render:d,getVisibleRange:c}}:d.renderer&&!d.renderer.getVisibleRange&&(d.renderer.getVisibleRange=c),d.view="timeline",o.addLayer(d)},_getTaskLayers:function(){return o.getLayers()},removeTaskLayer:function(d){o.removeLayer(d)},_clearTaskLayers:function(){o.clear()},addLinkLayer:function(d){const c=gn();return typeof d=="function"?d={renderer:{render:d,getVisibleRange:c}}:d.renderer&&!d.renderer.getVisibleRange&&(d.renderer.getVisibleRange=c),d.view="timeline",d&&d.renderer&&(d.renderer.getRectangle||d.renderer.isInViewPort||(d.renderer.isInViewPort=fn)),l.addLayer(d)},_getLinkLayers:function(){return l.getLayers()},removeLinkLayer:function(d){l.removeLayer(d)},_clearLinkLayers:function(){l.clear()}}}}}(t),a=Pa(t);return t.ext.inlineEditors=a,t.ext._inlineEditors=a,a.init(t),{factory:e,mouseEvents:pa.init(t),layersApi:i.init(),render:{gridLine:function(){return function(s){return{render:function(r,o,l,d){for(var c=o.getGridColumns(),u=o.$getTemplates(),h=o.$config.rowStore,_=[],f=0;f<c.length;f++){var y,v,b,m=f==c.length-1,g=c[f];g.name=="add"?(v="<div "+(T=s._waiAria.gridAddButtonAttrString(g))+" class='gantt_add'></div>",b=""):(tt(v=g.template?g.template(r):r[g.name])&&(v=u.date_grid(v,r,g.name)),v==null&&(v=""),b=v,v="<div class='gantt_tree_content'>"+v+"</div>");var p="gantt_cell"+(m?" gantt_last_cell":""),k=[];if(g.tree){p+=" gantt_cell_tree";for(var x=0;x<r.$level;x++)k.push(u.grid_indent(r));!h.hasChild(r.id)||s.isSplitTask(r)&&!s.config.open_split_tasks?(k.push(u.grid_blank(r)),k.push(u.grid_file(r))):(k.push(u.grid_open(r)),k.push(u.grid_folder(r)))}var w="width:"+(g.width-(m?1:0))+"px;";if(this.defined(g.align)){var $={right:"flex-end",left:"flex-start",center:"center"}[g.align];w+="text-align:"+g.align+";justify-content:"+$+";"}var T=s._waiAria.gridCellAttrString(g,b,r);k.push(v),y="<div class='"+p+"' data-column-index='"+f+"' data-column-name='"+g.name+"' style='"+w+"' "+T+">"+k.join("")+"</div>",_.push(y)}switch(p="",h.$config.name){case"task":p=s.getGlobalTaskIndex(r.id)%2==0?"":" odd";break;case"resource":p=h.visibleOrder.indexOf(r.id)%2==0?"":" odd"}if(p+=r.$transparent?" gantt_transparent":"",p+=r.$dataprocessor_class?" "+r.$dataprocessor_class:"",u.grid_row_class){var S=u.grid_row_class.call(s,r.start_date,r.end_date,r);S&&(p+=" "+S)}h.isSelected(r.id)&&(p+=" gantt_selected");var C=document.createElement("div");C.className="gantt_row"+p+" gantt_row_"+s.getTaskType(r.type);var E=o.getItemHeight(r.id);return C.style.height=E+"px",C.style.lineHeight=E+"px",l.smart_rendering&&(C.style.position="absolute",C.style.left="0px",C.style.top=o.getItemTop(r.id)+"px"),o.$config.item_attribute&&(C.setAttribute(o.$config.item_attribute,r.id),C.setAttribute(o.$config.bind+"_id",r.id)),s._waiAria.taskRowAttr(r,C),C.innerHTML=_.join(""),C},update:null,getRectangle:Kt,isInViewPort:Ba,getVisibleRange:mt,onrender:function(r,o,l){for(var d=l.getGridColumns(),c=0;c<d.length;c++){var u=d[c];if(u.onrender){var h=o.querySelector(`[data-column-name="${u.name}"]`);if(h){var _=u.onrender(r,h);if(_&&typeof _=="string")h.innerHTML=_;else if(_&&typeof _=="object"&&s.config.external_render){var f=s.config.external_render;f.isElement(_)&&f.renderElement(_,h)}}}}}}}(t)},taskBg:function(){return function(s){var r={},o={};function l(_,f){return!(!r[_.id][f]||!r[_.id][f].parentNode)}function d(_,f){r[_]&&r[_][f]&&r[_][f].parentNode&&r[_][f].parentNode.removeChild(r[_][f])}function c(_){var f,y=_.$getTemplates();return y.task_cell_class!==void 0?(f=y.task_cell_class,(console.warn||console.log)("gantt.templates.task_cell_class template is deprecated and will be removed soon. Please use gantt.templates.timeline_cell_class instead.")):f=y.timeline_cell_class,f}function u(_){return _.$getTemplates().timeline_cell_content}function h(_,f,y,v,b,m,g,p){var k=_.width[f],x="";if(Te(f,_,v,s)){var w=m(y,_.trace_x[f]),$="";if(g&&($=g(y,_.trace_x[f])),p.static_background){var T=!(!w&&!$);if(!p.static_background_cells||!T)return null}if(r[y.id][f])return o[y.id][f]=f,r[y.id][f];var S=document.createElement("div");return S.style.width=k+"px",x="gantt_task_cell"+(f==b-1?" gantt_last_cell":""),w&&(x+=" "+w),S.className=x,$&&(S.innerHTML=$),S.style.position="absolute",S.style.left=_.left[f]+"px",r[y.id][f]=S,o[y.id][f]=f,S}return null}return{render:function(_,f,y,v){var b=f.$getTemplates(),m=f.getScale(),g=m.count;if(y.static_background&&!y.static_background_cells)return null;var p,k=document.createElement("div"),x=c(f),w=u(f);if(p=v&&y.smart_rendering&&!Lt(s)?Qt(m,v.x):{start:0,end:g-1},y.show_task_cells){r[_.id]={},o[_.id]={};for(var $=p.start;$<=p.end;$++){var T=h(m,$,_,v,g,x,w,y);T&&k.appendChild(T)}}const S=f.$config.rowStore,C=S.getIndexById(_.id)%2!=0;var E=b.task_row_class(_.start_date,_.end_date,_),D="gantt_task_row"+(C?" odd":"")+(E?" "+E:"");if(S.isSelected(_.id)&&(D+=" gantt_selected"),k.className=D,y.smart_rendering?(k.style.position="absolute",k.style.top=f.getItemTop(_.id)+"px",k.style.width="100%"):k.style.position="relative",k.style.height=f.getItemHeight(_.id)+"px",_.id=="timeline_placeholder_task"){var A=0;_.lastTaskId&&(A=f.getItemTop(_.lastTaskId)+f.getItemHeight(_.lastTaskId));var M=(_.row_height||f.$task_data.offsetHeight)-A;M<0&&(M=0),y.smart_rendering&&(k.style.top=A+"px"),k.style.height=M+"px"}return f.$config.item_attribute&&(k.setAttribute(f.$config.item_attribute,_.id),k.setAttribute(f.$config.bind+"_id",_.id)),k},update:function(_,f,y,v,b){var m=y.getScale(),g=m.count,p=c(y),k=u(y);if(v.show_task_cells){r[_.id]||(r[_.id]={}),o[_.id]||(o[_.id]={});var x=Qt(m,b);for(var w in o[_.id]){var $=o[_.id][w];(Number($)<x.start||Number($)>x.end)&&d(_.id,$)}o[_.id]={};for(var T=x.start;T<=x.end;T++){var S=h(m,T,_,b,g,p,k,v);!S&&l(_,T)?d(_.id,T):S&&!S.parentNode&&f.appendChild(S)}}},getRectangle:bn,getVisibleRange:mt,prepareData:Ha}}(t)},taskBar:function(){return yn(t)},timedProjectBar:function(){return yn(t)},taskRollupBar:function(){return function(s){const r=kn(s),o={};function l(u,h,_,f,y){let v=!0;return f.smart_rendering&&(v=Se(u,h,_)),v}function d(u,h,_,f){const y=s.copy(s.getTask(h.id));if(y.$rendered_at=u.id,s.callEvent("onBeforeRollupTaskDisplay",[y.id,y,u.id])===!1)return;const v=r(y,_);if(!v)return;const b=_.getBarHeight(u.id,h.type==s.config.types.milestone),m=Math.floor((_.getItemHeight(u.id)-b)/2);return v.style.top=f.top+m+"px",v.classList.add("gantt_rollup_child"),v.setAttribute("data-rollup-parent-id",u.id),v}function c(u,h){return u+"_"+h}return{render:function(u,h,_,f){if(u.rollup!==!1&&u.$rollup&&u.$rollup.length){const y=document.createElement("div"),v=s.getTaskPosition(u);return f&&(f.y=0,f.y_end=s.$task_bg.scrollHeight),u.$rollup.forEach(function(b){if(!s.isTaskExists(b))return;const m=s.getTask(b);if(!l(m,f,h,_))return;const g=d(u,m,h,v);g?(o[c(m.id,u.id)]=g,y.appendChild(g)):o[c(m.id,u.id)]=!1}),y}return!1},update:function(u,h,_,f,y){const v=document.createElement("div"),b=s.getTaskPosition(u);y.y=0,y.y_end=s.$task_bg.scrollHeight,u.$rollup.forEach(function(m){const g=s.getTask(m),p=c(g.id,u.id);let k=l(g,y,_,f);if(k!==!!o[p])if(k){const x=d(u,g,_,b);o[p]=x||!1}else o[p]=!1;o[p]&&v.appendChild(o[p]),h.innerHTML="",h.appendChild(v)})},isInViewPort:Se,getVisibleRange:mt}}(t)},taskSplitBar:function(){return Pt()},taskConstraints:function(){return Pt()},taskDeadline:function(){return Pt()},taskBaselines:function(){return Pt()},link:function(){return Oa(t)},resourceRow:function(){return function(s){var r=za(s),o={};function l(c,u,h,_,f){var y=h.resource_cell_class(u.start_date,u.end_date,c,u.tasks,u.assignments),v=h.resource_cell_value(u.start_date,u.end_date,c,u.tasks,u.assignments),b=f.getItemHeight(c.id)-1;if(y||v){var m=f.getItemPosition(c,u.start_date,u.end_date),g=document.createElement("div");return g.setAttribute(f.$config.item_attribute,c.id),g.className=["gantt_resource_marker",y].join(" "),g.style.cssText=["left:"+m.left+"px","width:"+m.width+"px","height:"+b+"px","line-height:"+b+"px","top:"+m.top+"px"].join(";"),v&&(g.innerHTML=v),g}return null}function d(c,u){o[c]&&o[c][u]&&o[c][u].parentNode&&o[c][u].parentNode.removeChild(o[c][u])}return{render:function(c,u,h,_){var f=u.$getTemplates(),y=u.getScale(),v=r(c,h.resource_property,u.getScale(),u),b=!!_,m=[];o[c.id]={};for(var g=Qt(y,_),p=g.start;p<=g.end;p++){var k=v[p];if(k&&(!b||Te(p,y,_,s))){var x=l(c,k,f,0,u);x&&(m.push(x),o[c.id][p]=x)}}var w=null;if(m.length){w=document.createElement("div");for(var $=0;$<m.length;$++)w.appendChild(m[$])}return w},update:function(c,u,h,_,f){var y=h.$getTemplates(),v=h.getScale(),b=r(c,_.resource_property,h.getScale(),h),m=Qt(v,f),g={};if(o&&o[c.id])for(var p in o[c.id])g[p]=p;for(var k=m.start;k<=m.end;k++){var x=b[k];if(g[k]=!1,x)if(Te(k,v,f,s))if(o[c.id]&&o[c.id][k])o[c.id]&&o[c.id][k]&&!o[c.id][k].parentNode&&u.appendChild(o[c.id][k]);else{var w=l(c,x,y,0,h);w&&(u.appendChild(w),o[c.id][k]=w)}else d(c.id,k)}for(var p in g)g[p]!==!1&&d(c.id,p)},getRectangle:bn,getVisibleRange:mt}}(t)},resourceHistogram:function(){return Pt()},gridTaskRowResizer:function(){return function(s){return{render:function(r,o,l){var d=o.$getConfig(),c=document.createElement("div");return c.className="gantt_task_grid_row_resize_wrap",c.style.top=o.getItemTop(r.id)+o.getItemHeight(r.id)+"px",c.innerHTML="<div class='gantt_task_grid_row_resize' role='cell'></div>",c.setAttribute(d.task_grid_row_resizer_attribute,r.id),s._waiAria.rowResizerAttr(c),c},update:null,getRectangle:Kt,getVisibleRange:mt}}(t)}},layersService:{getDataRender:function(s){return i.getDataRender(s,t)},createDataRender:function(s){return i.createDataRender(s,t)}}}}};function De(t,n){const e=getComputedStyle(n.$root).getPropertyValue("--dhx-gantt-theme");let i,a=!!e;if(a)i=e;else{var s=n.skin;if(i=s,!s||t)for(var r=document.getElementsByTagName("link"),o=0;o<r.length;o++){var l=r[o].href.match("dhtmlxgantt_([a-z_]+).css");if(l&&(n.skins[l[1]]||!s)){i=l[1];break}}}n._theme_info={theme:i,cssVarTheme:a},n.skin=i||"terrace";var d=n.skins[n.skin]||n.skins.terrace;(function(h,_,f){for(var y in _)(h[y]===void 0||f)&&(h[y]=_[y])})(n.config,d.config,t),a||(n.config.link_radius=1);var c=n.getGridColumns();for(c[1]&&!n.defined(c[1].width)&&(c[1].width=d._second_column_width),c[2]&&!n.defined(c[2].width)&&(c[2].width=d._third_column_width),o=0;o<c.length;o++){var u=c[o];u.name=="add"&&(u.width||(u.width=44),n.defined(u.min_width)&&n.defined(u.max_width)||(u.min_width=u.min_width||u.width,u.max_width=u.max_width||u.width),u.min_width&&(u.min_width=+u.min_width),u.max_width&&(u.max_width=+u.max_width),u.width&&(u.width=+u.width,u.width=u.min_width&&u.min_width>u.width?u.min_width:u.width,u.width=u.max_width&&u.max_width<u.width?u.max_width:u.width))}d.config.task_height&&(n.config.task_height=d.config.task_height||"full"),d.config.bar_height&&(n.config.bar_height=d.config.bar_height||"full"),d._lightbox_template&&(n._lightbox_template=d._lightbox_template),d._redefine_lightbox_buttons&&(n.config.buttons_right=d._redefine_lightbox_buttons.buttons_right,n.config.buttons_left=d._redefine_lightbox_buttons.buttons_left),n.resetLightbox()}function Ka(t){var n=null,e=!1,i=null,a={started:!1},s={};function r(_){return _&&J(_,t.$root)&&_.offsetHeight}function o(){var _=!!document.querySelector(".gantt_drag_marker"),f=!!document.querySelector(".gantt_drag_marker.gantt_grid_resize_area")||!!document.querySelector(".gantt_drag_marker.gantt_row_grid_resize_area"),y=!!document.querySelector(".gantt_link_direction"),v=t.getState(),b=v.autoscroll;return e=_&&!f&&!y,!(!v.drag_mode&&!_||f)||b}function l(_){if(i&&(clearTimeout(i),i=null),_){var f=t.config.autoscroll_speed;f&&f<10&&(f=10),i=setTimeout(function(){n=setInterval(u,f||50)},t.config.autoscroll_delay||10)}}function d(_){_?(l(!0),a.started||(a.x=s.x,a.y=s.y,a.started=!0)):(n&&(clearInterval(n),n=null),l(!1),a.started=!1)}function c(_){var f=o();if(!n&&!i||f||d(!1),!t.config.autoscroll||!f)return!1;s={x:_.clientX,y:_.clientY},_.type=="touchmove"&&(s.x=_.targetTouches[0].clientX,s.y=_.targetTouches[0].clientY),!n&&f&&d(!0)}function u(){if(!o())return d(!1),!1;var _=r(t.$task)?t.$task:r(t.$grid)?t.$grid:t.$root;if(_){var f=!1;[".gantt_drag_marker.gantt_grid_resize_area",".gantt_drag_marker .gantt_row.gantt_row_task",".gantt_drag_marker.gantt_grid_dnd_marker"].forEach(function(E){f=f||!!document.querySelector(E)}),f&&(_=t.$grid);var y=V(_),v=s.x-y.x,b=s.y-y.y+window.scrollY,m=e?0:h(v,y.width,a.x-y.x),g=h(b,y.height,a.y-y.y+window.scrollY),p=t.getScrollState(),k=p.y,x=p.inner_height,w=p.height,$=p.x,T=p.inner_width,S=p.width;(g&&!x||g<0&&!k||g>0&&k+x>=w+2)&&(g=0),(m&&!T||m<0&&!$||m>0&&$+T>=S)&&(m=0);var C=t.config.autoscroll_step;C&&C<2&&(C=2),g*=C||30,((m*=C||30)||g)&&function(E,D){var A=t.getScrollState(),M=null,I=null;E&&(M=A.x+E,M=Math.min(A.width,M),M=Math.max(0,M)),D&&(I=A.y+D,I=Math.min(A.height,I),I=Math.max(0,I)),t.scrollTo(M,I)}(m,g)}}function h(_,f,y){return _-50<0&&_<y?-1:_>f-50&&_>y?1:0}t.attachEvent("onGanttReady",function(){if(!Y(t)){var _=bt(t.$root)||document.body;t.eventRemove(_,"mousemove",c),t.event(_,"mousemove",c),t.eventRemove(_,"touchmove",c),t.event(_,"touchmove",c),t.eventRemove(_,"pointermove",c),t.event(_,"pointermove",c)}}),t.attachEvent("onDestroy",function(){d(!1)})}var Ae,Ie;typeof window<"u"&&window.jQuery&&(Ae=window.jQuery,Ie=[],Ae.fn.dhx_gantt=function(t){if(typeof(t=t||{})!="string"){var n=[];return this.each(function(){if(this&&this.getAttribute)if(this.gantt||window.gantt.$root==this)n.push(typeof this.gantt=="object"?this.gantt:window.gantt);else{var e=window.gantt.$container&&window.Gantt?window.Gantt.getGanttInstance():window.gantt;for(var i in t)i!="data"&&(e.config[i]=t[i]);e.init(this),t.data&&e.parse(t.data),n.push(e)}}),n.length===1?n[0]:n}if(Ie[t])return Ie[t].apply(this,[]);Ae.error("Method "+t+" does not exist on jQuery.dhx_gantt")}),typeof window<"u"&&window.dhtmlx&&(window.dhtmlx.attaches||(window.dhtmlx.attaches={}),window.dhtmlx.attaches.attachGantt=function(t,n,e){var i=document.createElement("DIV");e=e||window.gantt,i.id="gantt_"+e.uid(),i.style.width="100%",i.style.height="100%",i.cmp="grid",document.body.appendChild(i),this.attachObject(i.id),this.dataType="gantt",this.dataObj=e;var a=this.vs[this.av];return a.grid=e,e.init(i.id,t,n),i.firstChild.style.border="none",a.gridId=i.id,a.gridObj=i,this.vs[this._viewRestore()].grid}),typeof window<"u"&&window.dhtmlXCellObject!==void 0&&(window.dhtmlXCellObject.prototype.attachGantt=function(t,n,e){e=e||window.gantt;var i=document.createElement("DIV");return i.id="gantt_"+e.uid(),i.style.width="100%",i.style.height="100%",i.cmp="grid",document.body.appendChild(i),this.attachObject(i.id),this.dataType="gantt",this.dataObj=e,e.init(i.id,t,n),i.firstChild.style.border="none",i=null,this.callEvent("_onContentAttach",[]),this.dataObj});const Xa=["ctrlKey","altKey","shiftKey","metaKey"],Za=[[{unit:"month",date:"%M",step:1},{unit:"day",date:"%d",step:1}],[{unit:"day",date:"%d %M",step:1}],[{unit:"day",date:"%d %M",step:1},{unit:"hour",date:"%H:00",step:8}],[{unit:"day",date:"%d %M",step:1},{unit:"hour",date:"%H:00",step:1}]];class Qa{constructor(n){this.zoomIn=()=>{const e=this.getCurrentLevel()-1;e<0||this.setLevel(e)},this.zoomOut=()=>{const e=this.getCurrentLevel()+1;e>this._levels.length-1||this.setLevel(e)},this.getCurrentLevel=()=>this._activeLevelIndex,this.getLevels=()=>this._levels,this.setLevel=e=>{const i=this._getZoomIndexByName(e);i===-1&&this.$gantt.assert(i!==-1,"Invalid zoom level for gantt.ext.zoom.setLevel. "+e+" is not an expected value."),this._setLevel(i,0)},this._getZoomIndexByName=e=>{let i=-1;if(typeof e=="string"){if(!isNaN(Number(e))&&this._levels[Number(e)])i=Number(e);else for(let a=0;a<this._levels.length;a++)if(this._levels[a].name===e){i=a;break}}else i=e;return i},this._getVisibleDate=()=>{if(!this.$gantt.$task)return null;const e=this.$gantt.getScrollState().x,i=this.$gantt.$task.offsetWidth;this._visibleDate=this.$gantt.dateFromPos(e+i/2)},this._setLevel=(e,i)=>{this._activeLevelIndex=e;const a=this.$gantt,s=a.copy(this._levels[this._activeLevelIndex]),r=a.copy(s);if(delete r.name,a.mixin(a.config,r,!0),["resourceTimeline","resourceHistogram"].forEach(function(o){const l=a.$ui.getView(o);if(l){const d=l.$getConfig();d.fixed_scales||a.mixin(d,r,!0)}}),a.$root&&a.$task){if(i){const o=this.$gantt.dateFromPos(i+this.$gantt.getScrollState().x);this.$gantt.render();const l=this.$gantt.posFromDate(o);this.$gantt.scrollTo(l-i)}else{const o=this.$gantt.$task.offsetWidth;this._visibleDate||this._getVisibleDate();const l=this._visibleDate;this.$gantt.render();const d=this.$gantt.posFromDate(l);this.$gantt.scrollTo(d-o/2)}this.callEvent("onAfterZoom",[this._activeLevelIndex,s])}},this._attachWheelEvent=e=>{const i=pt.isFF?"wheel":"mousewheel";let a;a=typeof e.element=="function"?e.element():e.element,a&&this._domEvents.attach(a,i,this.$gantt.bind(function(s){if(this._useKey&&(Xa.indexOf(this._useKey)<0||!s[this._useKey]))return!1;if(typeof this._handler=="function")return this._handler.apply(this,[s]),!0},this),{passive:!1})},this._defaultHandler=e=>{const i=this.$gantt.$task.getBoundingClientRect().x,a=e.clientX-i;let s=!1;(this.$gantt.env.isFF?-40*e.deltaY:e.wheelDelta)>0&&(s=!0),e.preventDefault(),e.stopPropagation(),this._setScaleSettings(s,a)},this._setScaleDates=()=>{this._initialStartDate&&this._initialEndDate&&(this.$gantt.config.start_date=this._initialStartDate,this.$gantt.config.end_date=this._initialEndDate)},this.$gantt=n,this._domEvents=this.$gantt._createDomEventScope()}init(n){this.$gantt.env.isNode||(this._initialStartDate=n.startDate,this._initialEndDate=n.endDate,this._activeLevelIndex=n.activeLevelIndex?n.activeLevelIndex:0,this._levels=this._mapScales(n.levels||Za),this._handler=n.handler||this._defaultHandler,this._minColumnWidth=n.minColumnWidth||60,this._maxColumnWidth=n.maxColumnWidth||240,this._widthStep=n.widthStep||3/8*n.minColumnWidth,this._useKey=n.useKey,this._initialized||(st(this),this.$gantt.attachEvent("onGanttScroll",()=>{this._getVisibleDate()})),this._domEvents.detachAll(),n.trigger==="wheel"&&(this.$gantt.$root?this._attachWheelEvent(n):this.$gantt.attachEvent("onGanttLayoutReady",()=>{this.$gantt.attachEvent("onGanttRender",()=>{this._attachWheelEvent(n)},{once:!0})})),this._initialized=!0,this.setLevel(this._activeLevelIndex))}_mapScales(n){return n.map(e=>Array.isArray(e)?{scales:e}:e)}_setScaleSettings(n,e){n?this._stepUp(e):this._stepDown(e)}_stepUp(n){if(this._activeLevelIndex>=this._levels.length-1)return;let e=this._activeLevelIndex;if(this._setScaleDates(),this._widthStep){let i=this.$gantt.config.min_column_width+this._widthStep;i>this._maxColumnWidth&&(i=this._minColumnWidth,e++),this.$gantt.config.min_column_width=i}else e++;this._setLevel(e,n)}_stepDown(n){if(this._activeLevelIndex<1)return;let e=this._activeLevelIndex;if(this._setScaleDates(),this._widthStep){let i=this.$gantt.config.min_column_width-this._widthStep;i<this._minColumnWidth&&(i=this._maxColumnWidth,e--),this.$gantt.config.min_column_width=i}else e--;this._setLevel(e,n)}}function ts(t){function n(){t.config.touch!="force"&&(t.config.touch=t.config.touch&&(navigator.userAgent.indexOf("Mobile")!=-1||navigator.userAgent.indexOf("iPad")!=-1||navigator.userAgent.indexOf("Android")!=-1||navigator.userAgent.indexOf("Touch")!=-1)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1),t.config.touch&&(!t.env.isIE||window.navigator.maxTouchPoints?t._touch_events(["touchmove","touchstart","touchend"],function(s){return s.touches&&s.touches.length>1?null:s.touches[0]?{target:s.target,pageX:s.touches[0].pageX,pageY:s.touches[0].pageY,clientX:s.touches[0].clientX,clientY:s.touches[0].clientY}:s},function(s){return s.defaultPrevented}):window.PointerEvent&&t._touch_events(["pointermove","pointerdown","pointerup"],function(s){return s.pointerType=="mouse"?null:s},function(s){return!s||s.pointerType=="mouse"}))}function e(s){var r=s.$config.scrollX?t.$ui.getView(s.$config.scrollX):null,o=s.$config.scrollY?t.$ui.getView(s.$config.scrollY):null,l={x:null,y:null};return r&&r.getScrollState().visible&&(l.x=r.$view.scrollLeft),o&&o.getScrollState().visible&&(l.y=o.$view.scrollTop),l}function i(){var s;return t.$ui.getView("timeline")&&(s=t.$ui.getView("timeline")._tasks_dnd),s}t.config.touch_drag=75,t.config.touch=!0,t.config.touch_feedback=!0,t.config.touch_feedback_duration=1,t._prevent_touch_scroll=!1,t._touch_feedback=function(){t.config.touch_feedback&&navigator.vibrate&&navigator.vibrate(t.config.touch_feedback_duration)},t.attachEvent("onGanttReady",function(){t.$container&&n()}),t.attachEvent("onGanttLayoutReady",function(){t.$container&&t.attachEvent("onGanttRender",n,{once:!0})});var a=[];t._touch_events=function(s,r,o){var l,d=0,c=!1,u=!1,h=null,_=null,f=null,y=null,v=[],b=null;let m={};for(var g=0;g<a.length;g++)t.eventRemove(a[g][0],a[g][1],a[g][2]);(a=[]).push([t.$container,s[0],function(k){var x=i();if(!o(k)&&c){f&&clearTimeout(f);var w=r(k);if(x&&(x.drag.id||x.drag.start_drag))return x.on_mouse_move(w),k.preventDefault&&k.preventDefault(),k.cancelBubble=!0,!1;if(!t._prevent_touch_scroll){if(w&&h){var $=h.pageX-w.pageX,T=h.pageY-w.pageY;if(!u&&(Math.abs($)>5||Math.abs(T)>5)&&(u=!0,d=0,l=b?e(b):t.getScrollState()),u){var S,C=l.x+$,E=l.y+T;if(b?(function(D,A,M){var I=D.$config.scrollX?t.$ui.getView(D.$config.scrollX):null,N=D.$config.scrollY?t.$ui.getView(D.$config.scrollY):null;I&&I.scrollTo(A,null),N&&N.scrollTo(null,M)}(b,C,E),S=e(b)):(t.scrollTo(C,E),S=t.getScrollState()),l.x!=S.x&&T>2*$||l.y!=S.y&&$>2*T)return p(k)}}return p(k)}return!0}}]);try{document.addEventListener("touchmove",function(k){t._touch_drag&&p(k)},{passive:!1})}catch{console.warn("Cannot prevent touch event for the page drag")}for(a.push([this.$container,"contextmenu",function(k){if(c)return p(k)}]),a.push([this.$container,s[1],function(k){if(m=k.touches.length,document&&document.body&&document.body.classList.add("gantt_touch_active"),!o(k))if(k.touches&&k.touches.length>1)c=!1;else{h=r(k),b=function(w){for(var $=t.$layout.getCellsByType("viewCell"),T=0;T<$.length;T++){var S=$[T].$view.getBoundingClientRect();if(w.clientX>=S.left&&w.clientX<=S.right&&w.clientY<=S.bottom&&w.clientY>=S.top)return $[T]}}(h),t._locate_css(h,"gantt_hor_scroll")||t._locate_css(h,"gantt_ver_scroll")||(c=!0);var x=i();f=setTimeout(function(){var w=t.locate(h);x&&w&&!t._locate_css(h,"gantt_link_control")&&!t._locate_css(h,"gantt_grid_data")&&(x.on_mouse_down(h),x.drag&&x.drag.start_drag&&(function($){const T=t._getTaskLayers();let S=t.getTask($);if(S){let C=t.isTaskVisible($);if(C){y=$;for(let E=0;E<T.length;E++)if(S=T[E].rendered[$],S&&S.getAttribute(t.config.task_attribute)&&S.getAttribute(t.config.task_attribute)==$){const D=S.cloneNode(!0);v.push(S),T[E].rendered[$]=D,S.style.display="none",D.className+=" gantt_drag_move ",S.parentNode.appendChild(D)}}else if(S.$split_subtask){let E=S.$rendered_parent;if(C=t.isTaskVisible(E),!C)return;y=$;for(let D=0;D<T.length;D++){const A=T[D].rendered[E];let M;if(A&&A.childNodes&&(M=A.querySelector(`[${t.config.task_attribute}="${S.id}"]`)),M){const I=M.cloneNode(!0);M.parentNode.appendChild(I),t.$task_bars.appendChild(M),M.style.display="none",v.push(M),M=null}}}}}(w),x._start_dnd(h),t._touch_drag=!0,t.refreshTask(w),t._touch_feedback())),f=null},t.config.touch_drag)}}]),a.push([this.$container,s[2],function(k){if(document&&document.body&&document.body.classList.remove("gantt_touch_active"),!o(k)){f&&clearTimeout(f),t._touch_drag=!1,c=!1;var x=r(k),w=i();if(w&&w.on_mouse_up(x),y&&t.isTaskExists(y)&&(t.refreshTask(y),v.length&&(v.forEach(function(T){T.parentNode&&T.parentNode.removeChild(T)}),t._touch_feedback())),c=u=!1,v=[],y=null,h&&d){var $=new Date;const T=m<=1,S=_&&_.target.innerHTML==h.target.innerHTML;$-d<500&&T&&S?(t.$services.getService("mouseEvents").onDoubleClick(h),p(k)):(d=$,_=h)}else d=new Date}}]),g=0;g<a.length;g++)t.event(a[g][0],a[g][1],a[g][2]);function p(k){return k&&k.preventDefault&&k.cancelable&&k.preventDefault(),k.cancelBubble=!0,!1}}}function te(){console.log("Method is not implemented.")}function Ht(){}function ht(t){return Ht}Ht.prototype.render=te,Ht.prototype.set_value=te,Ht.prototype.get_value=te,Ht.prototype.focus=te;var Cn={getHtmlSelect:function(t,n,e){var i="",a=this;return xt(t=t||[],function(s){var r=[{key:"value",value:s.key}];e==s.key&&(r[r.length]={key:"selected",value:"selected"}),s.attributes&&(r=r.concat(s.attributes)),i+=a.getHtmlOption({innerHTML:s.label},r)}),Ot("select",{innerHTML:i},n)},getHtmlOption:function(t,n){return Ot("option",t,n)},getHtmlButton:function(t,n){return Ot("button",t,n)},getHtmlDiv:function(t,n){return Ot("div",t,n)},getHtmlLabel:function(t,n){return Ot("label",t,n)},getHtmlInput:function(t){return"<input"+En(t||[])+">"}};function Ot(t,n,e){return n=n||[],"<"+t+En(e||[])+">"+(n.innerHTML||"")+"</"+t+">"}function En(t){var n="";return xt(t,function(e){n+=" "+e.key+"='"+e.value+"'"}),n}function ee(t){const n=ht();function e(){return n.apply(this,arguments)||this}return j(e,n),e.prototype.render=function(i){const a=i.height?`height:${i.height}px;`:"";let s=`<div class='gantt_cal_ltext gantt_section_${i.name}' ${a?`style='${a}'`:""}>`;return s+=Cn.getHtmlSelect(i.options,[{key:"style",value:"width:100%;"},{key:"title",value:i.name}]),s+="</div>",s},e.prototype.set_value=function(i,a,s,r){var o=i.firstChild;!o._dhx_onchange&&r.onchange&&(o.onchange=r.onchange,o._dhx_onchange=!0),a===void 0&&(a=(o.options[0]||{}).value),o.value=a||""},e.prototype.get_value=function(i){return i.firstChild.value},e.prototype.focus=function(i){var a=i.firstChild;t._focus(a,!0)},e}function es(t){var n=ee(t);function e(){return n.apply(this,arguments)||this}function i(a,s){var r=[],o=[];s&&(r=t.getTaskByTime(),a.allow_root&&r.unshift({id:t.config.root_id,text:a.root_label||""}),r=function(u,h,_){var f=h.filter||function(){return!0};u=u.slice(0);for(var y=0;y<u.length;y++){var v=u[y];(v.id==_||t.isChildOf(v.id,_)||f(v.id,v)===!1)&&(u.splice(y,1),y--)}return u}(r,a,s),a.sort&&r.sort(a.sort));for(var l=a.template||t.templates.task_text,d=0;d<r.length;d++){var c=l.apply(t,[r[d].start_date,r[d].end_date,r[d]]);c===void 0&&(c=""),o.push({key:r[d].id,label:c})}return a.options=o,a.map_to=a.map_to||"parent",t.form_blocks.select.render.apply(this,arguments)}return j(e,n),e.prototype.render=function(a){return i(a,!1)},e.prototype.set_value=function(a,s,r,o){s===0&&(s="0"),!r.id&&t.getState().lightbox&&(r.id=t.getLightboxValues().id);var l=document.createElement("div");l.innerHTML=i(o,r.id);var d=l.removeChild(l.firstChild);return a.onselect=null,a.parentNode.replaceChild(d,a),t.form_blocks.select.set_value.apply(t,[d,s,r,o])},e}function ns(t){const n=ht(),e={resourcesValues:{},filter:{},eventsInitialized:{},gridID:null,resource_filter_value:null,initialValues:[],newValues:[]},i={type:"select",map_to:"resource_id",options:t.serverList("resourceOptions")},a=t.date.date_to_str("%d-%m-%Y");function s(){return n.apply(this,arguments)||this}function r(o){return e.filter[o.id]}return t.resource_table={scale_height:35,row_height:35,columns:[{name:"resource",label:"Resource",align:"center",width:80,editor:i,template:function(o){const l=t.getDatastore(t.config.resource_store).getItem(o.resource_id);return l?l.text:"Unassigned"}},{name:"hours/Day",label:"Hours/Day",align:"center",width:70,editor:{type:"number",map_to:"value",min:0,max:100},template:function(o){return o.value?+o.value:""}},{name:"start",label:"Start",align:"center",width:100,template:function(o){return o.start_date?a(o.start_date):""}},{name:"end",label:"End",align:"center",width:100,template:function(o){return o.end_date?a(o.end_date):""}},{name:"duration",label:"Duration",align:"center",width:80,template:function(o){return o.duration?`${o.duration} day${o.duration==1?"":"s"}`:""}},{name:"delete",label:"Delete",align:"center",width:80,template:function(o){return`<div data-assignment-id='${o.id}' data-assignment-delete='${o.id}' class='dhx_gantt_icon dhx_gantt_icon_delete'></div>`}}],resource_default_assignment:{duration:null,value:8,start_date:null,end_date:null,mode:"default"}},t.attachEvent("onAfterLightbox",function(){for(var o in e.filter)e.filter[o].input.value="",e.filter[o].filterApplied=!1;e.resourcesValues={},e.eventsInitialized={},e.resource_filter_value=null,e.gridID=null,e.initialValues=[],e.newValues=[]}),j(s,n),s.prototype.render=function(o){let l;var d;return o.options||(o.options=t.serverList("resourceOptions")),o.map_to&&o.map_to!="resource_selector"&&o.map_to!="auto"||(o.map_to=t.config.resource_property),l=`<div${isNaN(o.height)?"":" style='height:auto;'"} class='gantt_section_${o.name}' data-section-name='${o.name}'>`,l+=(d=o.index,`<div class='gantt_resource_selector_filter_wrapper gantt_cal_lsection' data-section-name='${o.name}'>
						<div class='gantt_cal_ltext gantt_resources_filter'>
							<label class="dhx_gantt_icon dhx_gantt_icon_search">
								<input type='text' class='gantt_resources_filter_input' placeholder='${t.locale.labels.resources_filter_placeholder||"Search..."}' tab-index="-1"> 
							<label>
						</div>
						<div role='button' aria-label='Add Assignment' class='gantt_custom_button gantt_add_resources' data-index='${d}'><div class='gantt_custom_button_add_resources gantt_add'></div><div class='gantt_custom_button_label'>${t.locale.labels.resources_add_button}</div>
						</div>
					</div>`),l+="</div>",l+=`<div class="resources_section_placeholder" style='display:none;'>${t.locale.labels.resources_section_placeholder}</div>`,l},s.prototype.button_click=function(o,l,d,c){const u=d.getAttribute("data-section-name")||c.getAttribute("data-section-name"),h=document.querySelector("[data-resource-selector-section]"),_=document.querySelector(".resources_section_placeholder"),f=document.querySelector(`.gantt_section_${u} .gantt_resource_selector_filter_wrapper`),y=document.querySelector(`.gantt_section_${u} .gantt_grid`);if(h.style.display="none",t.callEvent("onSectionButton",[t._lightbox_id,d])!==!1&&l.closest(".gantt_custom_button.gantt_add_resources")){_.style.display="none";const v=t.getDatastore("temp_resource_assignment_store");v&&v.getItems().length==0&&(f.style.display="flex",y.style.display="block"),function(b){let m;const g=t.getTask(t._lightbox_id),p=t.getTaskAssignments(g.id);if(p.length)m=p[0].resource_id;else{const w=t.serverList("resourceOptions");if(!w.length)throw new Error(`There is no any resources in resource store, please check your data:
					https://docs.dhtmlx.com/gantt/desktop__resource_management.html#assigningresources`);m=w[0].id}const k=t.getDatastore("temp_resource_assignment_store"),x=(t.getLightboxSection(b).section.config??t.resource_table).resource_default_assignment??t.resource_table.resource_default_assignment;k.addItem({resource_id:m,task_id:g.id,duration:x.duration??t.calculateDuration(g),value:x.value,start_date:x.start_date??g.start_date,end_date:x.end_date??g.end_date,mode:x.mode}),t.refreshData()}(u),function(b){const m=b.querySelectorAll(".gantt_row.gantt_row_task");if(m){const g=m[m.length-1].querySelector(".gantt_cell");if(g){const{id:p,columnName:k}=t.ext.inlineEditorsLightbox.locateCell(g);p&&k&&t.ext.inlineEditorsLightbox.startEdit(p,k)}}}(c)}},s.prototype.set_value=function(o,l,d,c,u){let h=document.querySelector("[data-resource-selector-section]"),_=document.querySelector(".resources_section_placeholder");if(function(y){e.initialValues=[],e.newValues=[];const v=t.$data.assignmentsStore.find(function(b){return b.task_id==y.id});for(let b=0;b<v.length;b++)e.initialValues[b]={resource_id:v[b].resource_id,value:v[b].value,id:v[b].id}}(d),!u){(function(b,m,g,p){if(t.$ui.getView("GridRL")&&!e.gridID&&t.$ui.getView("GridRL").destructor(),!e.gridID){const k=document.createElement("div");k.classList.add("gantt_resource_selector_grid");const x=t.createDatastore({name:"temp_resource_assignment_store",initItem:function(D){return D.id||(D.id=t.uid()),D}});t.$data.tempAssignmentsStore=x;const w={...t.config.layout,id:"GridRL",sectionName:p.name},$=t.$ui.createView("GridRL",t.$root,w);$.init(k);const T=t._lightbox.offsetWidth-(t.config.wide_form?150:0);$.setSize(T,"auto"),t.ext.inlineEditorsLightbox=t.ext._inlineEditors.createEditors($),t.ext.inlineEditorsLightbox.init(),e.gridID=$.$id,b.appendChild(k);const S=t.getDatastore(t.config.resource_assignment_store),C=[];S.eachItem(function(D){D.task_id&&D.task_id==g.id&&C.push(D)});const E=structuredClone(C);x.parse(E)}t.$data.tempAssignmentsStore.attachEvent("onFilterItem",function(k,x){return x.task_id==g.id&&(!e.resource_filter_value||t.getDatastore(t.config.resource_store).getItem(x.resource_id).text.toLowerCase().indexOf(e.resource_filter_value)>-1)}),t.refreshData()})(o,0,d,c),function(b,m){if(!e.filter[m.id]){var g=b.querySelector(".gantt_resources_filter"),p=g.querySelector(".gantt_resources_filter_input");e.filter[m.id]={container:g,input:p,filterApplied:!1}}e.filter[m.id]}(o,c),function(b,m,g,p){if(e.eventsInitialized[g.id])return;var k=function(S){var C,E,D;x(g,b);var A=r(g);D=A.input,E=D.value.trim(),e.resource_filter_value=E.toLowerCase(),A.filterApplied=!!E,t.getState().lightbox&&(m=t.getLightboxValues()),C=function(I,N,L){var B,z=t.copy(I);if(L===""){z.resources=[];let H=e.newValues.map(W=>W.resource_id);if(H&&H.length>0)for(let W=0;W<H.length;W++){let P=t.getDatastore(t.config.resource_store).getItem(H[W]);P&&z.resources.push(P)}return z}return B=function(H){if(H.text.toLowerCase().indexOf(L.toLowerCase())>=0)return H},z.resources=function(H){let W=[];const P=t.getDatastore("temp_resource_assignment_store"),q=P.find(function(F){return F.task_id==H.id});for(let F=0;F<q.length;F++){let G=t.getDatastore(t.config.resource_store).getItem(q[F].resource_id);G&&W.push(G)}return W}(N,I.options),z.resources=function(H,W){var P=[];if(H.filter)return H.filter(W);for(var q=0;q<H.length;q++)W(H[q],q)&&(P[P.length]=H[q]);return P}(z.resources,B),z}(g,m,E);var M=m[g.map_to];p.form_blocks.resource_selector.set_value(b,M,m,C)};function x(S,C){var E=".gantt_resource_amount_input",D=C.querySelectorAll(E);e.resourcesValues[S.id]=e.resourcesValues[S.id]||{};for(var A=0;A<D.length;A++){var M=D[A].getAttribute("data-item-id"),I=D[A].getAttribute("data-assignment-id");D[A].disabled?delete e.resourcesValues[S.id][M]:e.resourcesValues[S.id][M]={value:D[A].value,id:I}}}w=k,$=100,T=!1,k=function(){T||(w.apply(null,arguments),T=!0,setTimeout(function(){T=!1},$))},r(g).container.addEventListener("keyup",k),r(g).container.addEventListener("input",k,!0),r(g).container.addEventListener("change",k,!0),e.eventsInitialized[g.id]=!0;var w,$,T}(o,l,c,this),h.style.display="none";let y=document.querySelector(`.gantt_section_${c.name} .gantt_grid`),v=document.querySelector(`.gantt_section_${c.name} .gantt_resource_selector_filter_wrapper`);y.style.display="none",v.style.display="none"}const f=t.getDatastore("temp_resource_assignment_store");if(f){let y=document.querySelector(`.gantt_section_${c.name} .gantt_resource_selector_filter_wrapper`),v=document.querySelector(`.gantt_section_${c.name} .gantt_grid`);f.getItems().length==0?(h.style.display=="none"&&(h.style.display="flex"),y.style.display="none",v.style.display="none",_.style.display="block"):(y.style.display="flex",v.style.display="block",_.style.display="none")}t._center_lightbox(t.getLightbox())},s.prototype.get_value=function(o,l,d,c){const u=t.getDatastore("temp_resource_assignment_store").find(function(h){return h.task_id==l.id});for(let h=0;h<u.length;h++)e.newValues[h]={resource_id:u[h].resource_id.toString(),value:u[h].value,id:u[h].id,start_date:u[h].start_date,end_date:u[h].end_date,duration:u[h].duration,mode:u[h].mode,delay:u[h].delay};return c=="save"?e.newValues:e.initialValues},s}function is(t){var n=function(){const g=ht();function p(){return g.apply(this,arguments)||this}return j(p,g),p.prototype.render=function(k){let x=k.height?`${k.height}px`:"";return`<div class='gantt_cal_ltext gantt_cal_template gantt_section_${k.name}' ${x?`style='height:${x};'`:""}></div>`},p.prototype.set_value=function(k,x){k.innerHTML=x||""},p.prototype.get_value=function(k){return k.innerHTML||""},p.prototype.focus=function(){},p}(),e=function(g){const p=ht();function k(){return p.apply(this,arguments)||this}return j(k,p),k.prototype.render=function(x){const w=(x.height||"130")+"px",$=x.placeholder?`placeholder='${x.placeholder}'`:"";return`<div class='gantt_cal_ltext gantt_section_${x.name}' style='height:${w};' ${$}><textarea></textarea></div>`},k.prototype.set_value=function(x,w){g.form_blocks.textarea._get_input(x).value=w||""},k.prototype.get_value=function(x){return g.form_blocks.textarea._get_input(x).value},k.prototype.focus=function(x){var w=g.form_blocks.textarea._get_input(x);g._focus(w,!0)},k.prototype._get_input=function(x){return x.querySelector("textarea")},k}(t),i=function(g){const p=ht();function k(){return p.apply(this,arguments)||this}return j(k,p),k.prototype.render=function(x){var w=g.form_blocks.getTimePicker.call(this,x);let $="gantt_section_time";x.name!=="time"&&($+=" gantt_section_"+x.name);var T="<div style='padding-top:0px;font-size:inherit;text-align:center;' class='"+$+"'>";return T+=w,x.single_date?(w=g.form_blocks.getTimePicker.call(this,x,!0),T+="<span></span>"):T+="<span class='gantt_section_time_spacer'> &nbsp;&ndash;&nbsp; </span>",(T+=w)+"</div>"},k.prototype.set_value=function(x,w,$,T){var S=T,C=x.getElementsByTagName("select"),E=T._time_format_order;if(S.auto_end_date)for(var D=function(){I=new Date(C[E[2]].value,C[E[1]].value,C[E[0]].value,0,0),N=g.calculateEndDate({start_date:I,duration:1,task:$}),g.form_blocks._fill_lightbox_select(C,E.size,N,E,S)},A=0;A<4;A++)C[A].onchange=D;var M=g._resolve_default_mapping(T);typeof M=="string"&&(M={start_date:M});var I=$[M.start_date]||new Date,N=$[M.end_date]||g.calculateEndDate({start_date:I,duration:1,task:$});g.form_blocks._fill_lightbox_select(C,0,I,E,S),g.form_blocks._fill_lightbox_select(C,E.size,N,E,S)},k.prototype.get_value=function(x,w,$){var T,S=x.getElementsByTagName("select"),C=$._time_format_order;return T=g.form_blocks.getTimePickerValue(S,$),typeof g._resolve_default_mapping($)=="string"?T:{start_date:T,end_date:function(E,D,A){var M=g.form_blocks.getTimePickerValue(E,$,D.size);return M<=A&&($.autofix_end!==!1||$.single_date)?g.date.add(A,g._get_timepicker_step(),"minute"):M}(S,C,T)}},k.prototype.focus=function(x){g._focus(x.getElementsByTagName("select")[0])},k}(t),a=ee(t),s=function(g){var p=ht();function k(){return p.apply(this,arguments)||this}return j(k,p),k.prototype.render=function(x){const w=x.height?`height:${x.height}px;`:"";let $=`<div class='gantt_cal_ltext gantt_cal_lcheckbox gantt_section_${x.name}' ${w?`style='${w}'`:""}>`;if(x.options&&x.options.length)for(var T=0;T<x.options.length;T++)$+="<label><input type='checkbox' value='"+x.options[T].key+"' name='"+x.name+"'>"+x.options[T].label+"</label>";else x.single_value=!0,$+="<label><input type='checkbox' name='"+x.name+"'></label>";return $+="</div>",$},k.prototype.set_value=function(x,w,$,T){var S=Array.prototype.slice.call(x.querySelectorAll("input[type=checkbox]"));!x._dhx_onchange&&T.onchange&&(x.onchange=T.onchange,x._dhx_onchange=!0),T.single_value?S[0].checked=!!w:xt(S,function(C){C.checked=!!w&&w.indexOf(C.value)>=0})},k.prototype.get_value=function(x,w,$){return $.single_value?x.querySelector("input[type=checkbox]").checked:function(T,S){if(T.map)return T.map(S);for(var C=T.slice(),E=[],D=0;D<C.length;D++)E.push(S(C[D],D));return E}(Array.prototype.slice.call(x.querySelectorAll("input[type=checkbox]:checked")),function(T){return T.value})},k.prototype.focus=function(x){g._focus(x.querySelector("input[type=checkbox]"))},k}(t),r=function(g){const p=ht();function k(){return p.apply(this,arguments)||this}return j(k,p),k.prototype.render=function(x){const w=x.height?`${x.height}px`:"";let $=`<div class='gantt_cal_ltext gantt_cal_lradio gantt_section_${x.name}' ${w?`style='height:${w};'`:""}>`;if(x.options&&x.options.length)for(var T=0;T<x.options.length;T++)$+="<label><input type='radio' value='"+x.options[T].key+"' name='"+x.name+"'>"+x.options[T].label+"</label>";return $+="</div>",$},k.prototype.set_value=function(x,w,$,T){var S;T.options&&T.options.length&&(S=x.querySelector("input[type=radio][value='"+w+"']")||x.querySelector("input[type=radio][value='"+T.default_value+"']"))&&(!x._dhx_onchange&&T.onchange&&(x.onchange=T.onchange,x._dhx_onchange=!0),S.checked=!0)},k.prototype.get_value=function(x,w){var $=x.querySelector("input[type=radio]:checked");return $?$.value:""},k.prototype.focus=function(x){g._focus(x.querySelector("input[type=radio]"))},k}(t),o=function(g){var p=ht();function k(){return p.apply(this,arguments)||this}function x(T){return T.formatter||new Mt}function w(T,S){var C=T.getElementsByTagName("select"),E=S._time_format_order,D=0,A=0;if(g.defined(E[3])){var M=C[E[3]],I=parseInt(M.value,10);isNaN(I)&&M.hasAttribute("data-value")&&(I=parseInt(M.getAttribute("data-value"),10)),D=Math.floor(I/60),A=I%60}return new Date(C[E[2]].value,C[E[1]].value,C[E[0]].value,D,A)}function $(T,S){var C=T.getElementsByTagName("input")[1];return(C=x(S).parse(C.value))&&!window.isNaN(C)||(C=1),C<0&&(C*=-1),C}return j(k,p),k.prototype.render=function(T){var S="<div class='gantt_time_selects'>"+g.form_blocks.getTimePicker.call(this,T)+"</div>",C=" "+g.locale.labels[g.config.duration_unit+"s"]+" ",E=T.single_date?" style='display:none'":"",D=T.readonly?" disabled='disabled'":"",A=g._waiAria.lightboxDurationInputAttrString(T),M="gantt_duration_value";T.formatter&&(C="",M+=" gantt_duration_value_formatted");var I="<div class='gantt_duration' "+E+"><div class='gantt_duration_inputs'><input type='button' class='gantt_duration_dec' value=''"+D+"><input type='text' value='5days' class='"+M+"'"+D+" "+A+"><input type='button' class='gantt_duration_inc' value='+'"+D+"></div><div class='gantt_duration_end_date'>"+C+"<span></span></div></div></div>";let N="gantt_section_time gantt_section_duration";return T.name!=="time"&&(N+=" gantt_section_"+T.name),"<div style='padding-top:0px;font-size:inherit;' class='"+N+"'>"+S+" "+I+"</div>"},k.prototype.set_value=function(T,S,C,E){var D,A,M,I,N=T.getElementsByTagName("select"),L=T.getElementsByTagName("input"),B=L[1],z=[L[0],L[2]],H=T.getElementsByTagName("span")[0],W=E._time_format_order;function P(){var F=w.call(g,T,E),G=$.call(g,T,E),vt=g.calculateEndDate({start_date:F,duration:G,task:C}),Bt=g.templates.task_end_date||g.templates.task_date;H.innerHTML=Bt(vt)}function q(F){var G=B.value;G=x(E).parse(G),window.isNaN(G)&&(G=0),(G+=F)<1&&(G=1),B.value=x(E).format(G),P()}z[0].onclick=g.bind(function(){q(-1*g.config.duration_step)},this),z[1].onclick=g.bind(function(){q(1*g.config.duration_step)},this),N[0].onchange=P,N[1].onchange=P,N[2].onchange=P,N[3]&&(N[3].onchange=P),B.onkeydown=g.bind(function(F){var G;return(G=(F=F||window.event).charCode||F.keyCode||F.which)==g.constants.KEY_CODES.DOWN?(q(-1*g.config.duration_step),!1):G==g.constants.KEY_CODES.UP?(q(1*g.config.duration_step),!1):void window.setTimeout(P,1)},this),B.onchange=g.bind(P,this),typeof(D=g._resolve_default_mapping(E))=="string"&&(D={start_date:D}),A=C[D.start_date]||new Date,M=C[D.end_date]||g.calculateEndDate({start_date:A,duration:1,task:C}),I=Math.round(C[D.duration])||g.calculateDuration({start_date:A,end_date:M,task:C}),I=x(E).format(I),g.form_blocks._fill_lightbox_select(N,0,A,W,E),B.value=I,P()},k.prototype.get_value=function(T,S,C){var E=w(T,C),D=$(T,C),A=g.calculateEndDate({start_date:E,duration:D,task:S});return typeof g._resolve_default_mapping(C)=="string"?E:{start_date:E,end_date:A,duration:D}},k.prototype.focus=function(T){g._focus(T.getElementsByTagName("select")[0])},k}(t),l=es(t),d=ee(t),c=function(g){var p=ht();function k(){return p.apply(this,arguments)||this}function x($){return!$||$===g.config.constraint_types.ASAP||$===g.config.constraint_types.ALAP}function w($,T){for(var S=x(T),C=0;C<$.length;C++)$[C].disabled=S}return j(k,p),k.prototype.render=function($){const T=$.height?`height:${$.height}px;`:"";let S=`<div class='gantt_cal_ltext gantt_section_${$.name}' ${T?`style='${T}'`:""}>`;var C=[];for(var E in g.config.constraint_types)C.push({key:g.config.constraint_types[E],label:g.locale.labels[g.config.constraint_types[E]]});return $.options=$.options||C,S+="<span data-constraint-type-select>"+Cn.getHtmlSelect($.options,[{key:"data-type",value:"constraint-type"}])+"</span>",S+="<label data-constraint-time-select>"+(g.locale.labels.constraint_date||"Constraint date")+": "+g.form_blocks.getTimePicker.call(this,$)+"</label>",S+="</div>",S},k.prototype.set_value=function($,T,S,C){var E=$.querySelector("[data-constraint-type-select] select"),D=$.querySelectorAll("[data-constraint-time-select] select"),A=C._time_format_order,M=g._resolve_default_mapping(C);E._eventsInitialized||(E.addEventListener("change",function(L){w(D,L.target.value)}),E._eventsInitialized=!0);var I=S[M.constraint_date]||new Date;g.form_blocks._fill_lightbox_select(D,0,I,A,C);var N=S[M.constraint_type]||g.getConstraintType(S);E.value=N,w(D,N)},k.prototype.get_value=function($,T,S){var C=$.querySelector("[data-constraint-type-select] select"),E=$.querySelectorAll("[data-constraint-time-select] select"),D=C.value,A=null;return x(D)||(A=g.form_blocks.getTimePickerValue(E,S)),{constraint_type:D,constraint_date:A}},k.prototype.focus=function($){g._focus($.querySelector("select"))},k}(t),u=function(g){const p=ee(g);function k(){return p.apply(this,arguments)||this}return j(k,p),k.prototype.render=function(x){var w=g.config.types,$=g.locale.labels,T=[],S=x.filter||function(D,A){return!w.placeholder||A!==w.placeholder};for(var C in w)!S(C,w[C])==0&&T.push({key:w[C],label:$["type_"+C]});x.options=T;var E=x.onchange;return x.onchange=function(){g._lightbox_current_type=this.value,g.changeLightboxType(this.value),typeof E=="function"&&E.apply(this,arguments)},p.prototype.render.apply(this,arguments)},k}(t),h=function(g){var p=ht();function k(){return p.apply(this,arguments)||this}function x(S){return S.formatter||new Mt}function w(S,C,E,D){const A="<div class='gantt_time_selects'>"+g.form_blocks.getTimePicker.call(g,D)+"</div>";let M=" "+g.locale.labels[g.config.duration_unit+"s"]+" ";const I=D.single_date?" style='display:none'":"",N=D.readonly?" disabled='disabled'":"",L=g._waiAria.lightboxDurationInputAttrString(D),B=g.locale.labels.baselines_remove_button;let z="gantt_duration_value";D.formatter&&(M="",z+=" gantt_duration_value_formatted");const H="<div class='gantt_duration' "+I+"><div class='gantt_duration_inputs'><input type='button' class='gantt_duration_dec' value='-'"+N+"><input type='text' value='5days' class='"+z+"'"+N+" "+L+"><input type='button' class='gantt_duration_inc' value='+'"+N+"></div><div class='gantt_duration_end_date'>"+M+"<span></span></div></div></div>",W=`<div><div class='baseline_delete_button gantt_custom_button dhx_gantt_icon dhx_gantt_icon_delete' aria-label='${B}'></div></div>`,P=document.createElement("div");P.className="gantt_section_time gantt_section_duration",P.setAttribute("data-baseline-id",C.id),P.innerHTML=A+H+W+"<br>",S.appendChild(P);var q,F,G,vt=P.getElementsByTagName("select"),Bt=P.getElementsByTagName("input"),zt=Bt[1],An=[Bt[0],Bt[2]],ss=P.getElementsByTagName("span")[0],rs=D._time_format_order;function kt(){var gt=$.call(g,P,D),X=T.call(g,P,D),os=g.calculateEndDate({start_date:gt,duration:X,task:E}),ls=g.templates.task_end_date||g.templates.task_date;ss.innerHTML=ls(os)}function se(gt){var X=zt.value;X=x(D).parse(X),window.isNaN(X)&&(X=0),(X+=gt)<1&&(X=1),zt.value=x(D).format(X),kt()}P.querySelector(".baseline_delete_button").onclick=function(gt){const X=P.parentNode;P.innerHTML="",P.remove(),X.innerHTML===""&&(X.innerHTML=g.locale.labels.baselines_section_placeholder)},An[0].onclick=g.bind(function(){se(-1*g.config.duration_step)},g),An[1].onclick=g.bind(function(){se(1*g.config.duration_step)},g),vt[0].onchange=kt,vt[1].onchange=kt,vt[2].onchange=kt,vt[3]&&(vt[3].onchange=kt),zt.onkeydown=g.bind(function(gt){var X;return(X=(gt=gt||window.event).charCode||gt.keyCode||gt.which)==g.constants.KEY_CODES.DOWN?(se(-1*g.config.duration_step),!1):X==g.constants.KEY_CODES.UP?(se(1*g.config.duration_step),!1):void window.setTimeout(kt,1)},g),zt.onchange=g.bind(kt,g),g._resolve_default_mapping(D),q=C.start_date||new Date,F=C.end_date||g.calculateEndDate({start_date:q,duration:1,task:E}),G=g.calculateDuration({start_date:q,end_date:F,task:E}),G=x(D).format(G),g.form_blocks._fill_lightbox_select(vt,0,q,rs,D),zt.value=G,kt()}function $(S,C){var E=S.getElementsByTagName("select"),D=C._time_format_order,A=0,M=0;if(g.defined(D[3])){var I=E[D[3]],N=parseInt(I.value,10);isNaN(N)&&I.hasAttribute("data-value")&&(N=parseInt(I.getAttribute("data-value"),10)),A=Math.floor(N/60),M=N%60}return new Date(E[D[2]].value,E[D[1]].value,E[D[0]].value,A,M)}function T(S,C){var E=S.getElementsByTagName("input")[1];return(E=x(C).parse(E.value))&&!window.isNaN(E)||(E=1),E<0&&(E*=-1),E}return j(k,p),k.prototype.render=function(S){return`<div style='height: ${S.height||110}px; font-size:inherit;' class='gantt_section_baselines'></div>`},k.prototype.set_value=function(S,C,E,D){E.baselines?(S.innerHTML="",E.baselines.forEach(A=>{w(S,A,E,D)})):S.innerHTML=g.locale.labels.baselines_section_placeholder},k.prototype.get_value=function(S,C,E){const D=[];return S.querySelectorAll("[data-baseline-id]").forEach(A=>{const M=A.dataset.baselineId;let I,N=g.getDatastore("baselines").getItem(M);I=N?g.copy(N):{id:g.uid(),task_id:C.id,text:"Baseline 1"},I.start_date=$(A,E),I.duration=T(A,E),I.end_date=g.calculateEndDate({start_date:I.start_date,duration:I.duration,task:C}),D.push(I)}),D},k.prototype.button_click=function(S,C,E,D){if(g.callEvent("onSectionButton",[g._lightbox_id,E])!==!1&&(C.closest(".gantt_custom_button.gantt_remove_baselines")&&(D.innerHTML=g.locale.labels.baselines_section_placeholder),C.closest(".gantt_custom_button.gantt_add_baselines"))){D.innerHTML==g.locale.labels.baselines_section_placeholder&&(D.innerHTML="");const A=g.getTask(g._lightbox_id);w(D,{id:g.uid(),task_id:A.id,start_date:A.start_date,end_date:A.end_date},A,g._get_typed_lightbox_config()[S])}},k.prototype.focus=function(S){g._focus(S.getElementsByTagName("select")[0])},k}(t),_=ns(t);t._lightbox_methods={},t._lightbox_template="<div class='gantt_cal_ltitle'><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='gantt_title'></span></div><div class='gantt_cal_larea'></div>",t._lightbox_template=`<div class='gantt_cal_ltitle'><div class="dhx_cal_ltitle_descr"><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='dhx_title'></span>
</div>
<div class="gantt_cal_ltitle_controls">
	<a class="gantt_cal_ltitle_close_btn dhx_gantt_icon dhx_gantt_icon_close"></a>

</div></div><div class='gantt_cal_larea'></div>`,t._lightbox_root=t.$root,t.$services.getService("state").registerProvider("lightbox",function(){return{lightbox:t._lightbox_id}}),t.showLightbox=function(g){var p=this.getTask(g);if(this.callEvent("onBeforeLightbox",[g])){var k=this.getLightbox(this.getTaskType(p.type));this.showCover(k),this._fill_lightbox(g,k),this._setLbPosition(k),this._waiAria.lightboxVisibleAttr(k),this.callEvent("onLightbox",[g])}else t.isTaskExists(g)&&t.getTask(g).$new&&this.$data.tasksStore._updateOrder()},t._get_timepicker_step=function(){if(this.config.round_dnd_dates){var g;if(function(k){var x=k.$ui.getView("timeline");return!(!x||!x.isVisible())}(this)){var p=t.getScale();g=Ft(p.unit)*p.step/60}return(!g||g>=1440)&&(g=this.config.time_step),g}return this.config.time_step},t.getLabel=function(g,p){for(var k=this._get_typed_lightbox_config(),x=0;x<k.length;x++)if(k[x].map_to==g){for(var w=k[x].options,$=0;$<w.length;$++)if(w[$].key==p)return w[$].label}return""},t.updateCollection=function(g,p){p=p.slice(0);var k=t.serverList(g);if(!k)return!1;k.splice(0,k.length),k.push.apply(k,p||[]),t.resetLightbox()},t.getLightboxType=function(){return this.getTaskType(this._lightbox_type)},t.getLightbox=function(g){var p,k,x,w,$,T="";if(t.config.csp===!0||t.env.isSalesforce?t._lightbox_root=t.$root:t._lightbox_root=document.body,g===void 0&&(g=this.getLightboxType()),!this._lightbox||this.getLightboxType()!=this.getTaskType(g)){this._lightbox_type=this.getTaskType(g),p=document.createElement("div"),T="gantt_cal_light",k=this._is_lightbox_timepicker(),t.config.wide_form&&(T+=" gantt_cal_light_wide"),k&&(T+=" gantt_cal_light_full"),p.className=T,p.style.visibility="hidden",x=this._lightbox_template,x+="<div class='gantt_cal_lcontrols'>",x+=v(this.config.buttons_left),x+="<div class='gantt_cal_lcontrols_push_right'></div>",x+=v(this.config.buttons_right),x+="</div>",p.innerHTML=x,t._waiAria.lightboxAttr(p),t.config.drag_lightbox&&(p.firstChild.onmousedown=t._ready_to_dnd,p.firstChild.addEventListener("touchstart",function(C){t._ready_to_dnd(C.touches[0])}),p.firstChild.onselectstart=function(){return!1},p.firstChild.style.cursor="pointer",t._init_dnd_events()),this._lightbox&&this.resetLightbox(),f(),this._cover.insertBefore(p,this._cover.firstChild),this._lightbox=p,w=this._get_typed_lightbox_config(g),x=this._render_sections(w);var S=($=p.querySelector("div.gantt_cal_larea")).style.overflow;$.style.overflow="hidden",$.innerHTML=x,function(C){var E,D,A,M,I,N;for(N=0;N<C.length;N++)E=C[N],A=t._lightbox_root.querySelector("#"+E.id),E.id&&A&&(D=A.querySelector("label"),(M=A.nextSibling)&&(I=M.querySelector("input, select, textarea"))&&(I.id=I.id||"input_"+t.uid(),E.inputId=I.id,D.setAttribute("for",E.inputId)))}(w),$.style.overflow=S,this._init_lightbox_events(this),p.style.display="none",p.style.visibility="visible"}return this._lightbox},t._render_sections=function(g){for(var p="",k=0;k<g.length;k++){var x=this.form_blocks[g[k].type];if(x){g[k].id="area_"+this.uid();var w=g[k].hidden?" style='display:none'":"",$="";g[k].button&&($="<div class='gantt_custom_button' data-index='"+k+"'><div class='gantt_custom_button_"+g[k].button+"'></div><div class='gantt_custom_button_label'>"+this.locale.labels["button_"+g[k].button]+"</div></div>"),g[k].type=="baselines"&&($="<div class='gantt_custom_button gantt_remove_baselines' data-index='"+k+"'><div class='gantt_custom_button_delete_baselines'></div><div class='gantt_custom_button_label'>"+this.locale.labels.baselines_remove_all_button+"</div></div><div class='gantt_custom_button gantt_add_baselines' data-index='"+k+"'><div class='gantt_custom_button_add_baseline'></div><div class='gantt_custom_button_label'>"+this.locale.labels.baselines_add_button+"</div></div>"),g[k].type=="resource_selector"&&(g[k].index=k,$=`<div class='gantt_custom_button gantt_add_resources' data-index='${k}' data-resource-selector-section='${k}' data-section-name='${g.name}'><div class='gantt_custom_button_add_resources gantt_add'></div><div class='gantt_custom_button_label'>${this.locale.labels.resources_add_button}</div></div>`),this.config.wide_form&&(p+="<div class='gantt_wrap_section' "+w+">"),p+="<div id='"+g[k].id+"' class='gantt_cal_lsection'><label>"+$+(g[k].label||this.locale.labels["section_"+g[k].name]||g[k].name)+"</label></div>"+x.render.call(this,g[k]),p+="</div>"}}return p},t._center_lightbox=function(g){t._setLbPosition(g)},t._setLbPosition=function(g){if(!g)return;const p=t._lightbox_root||t.$root;g.style.top=Math.max(p.offsetHeight/2-g.offsetHeight/2,0)+"px",g.style.left=Math.max(p.offsetWidth/2-g.offsetWidth/2,0)+"px"},t.showCover=function(g){g&&(g.style.display="block",this._setLbPosition(g)),f(),this._cover.style.display=""};const f=function(){t._cover||(t._cover=document.createElement("div"),t._cover.className="gantt_cal_cover",t._cover.style.display="none",t.event(t._cover,"mousemove",t._move_while_dnd),t.event(t._cover,"mouseup",t._finish_dnd),(t._lightbox_root||t.$root).appendChild(t._cover))};function y(g){for(var p in this.config.types)if(this.config.types[p]==g)return p;return"task"}function v(g,p){var k,x,w="";for(x=0;x<g.length;x++)k=t.config._migrate_buttons[g[x]]?t.config._migrate_buttons[g[x]]:g[x],w+="<div "+t._waiAria.lightboxButtonAttrString(k)+" class='gantt_btn_set gantt_left_btn_set "+k+"_set'><div dhx_button='1' data-dhx-button='1' class='"+k+"'></div><div>"+t.locale.labels[k]+"</div></div>";return w}function b(g){var p,k;return g.time_format?g.time_format:(k=["%d","%m","%Y"],Ft((p=t.getScale())?p.unit:t.config.duration_unit)<Ft("day")&&k.push("%H:%i"),k)}function m(g,p,k){var x,w,$,T,S,C,E="";switch(k.timeFormat[p]){case"%Y":for(g._time_format_order[2]=p,g._time_format_order.size++,g.year_range&&(isNaN(g.year_range)?g.year_range.push&&($=g.year_range[0],T=g.year_range[1]):x=g.year_range),x=x||10,w=w||Math.floor(x/2),$=$||k.date.getFullYear()-w,T=T||t.getState().max_date.getFullYear()+w,S=$;S<=T;S++)E+="<option value='"+S+"'>"+S+"</option>";break;case"%m":for(g._time_format_order[1]=p,g._time_format_order.size++,S=0;S<12;S++)E+="<option value='"+S+"'>"+t.locale.date.month_full[S]+"</option>";break;case"%d":for(g._time_format_order[0]=p,g._time_format_order.size++,S=1;S<32;S++)E+="<option value='"+S+"'>"+S+"</option>";break;case"%H:%i":for(g._time_format_order[3]=p,g._time_format_order.size++,S=k.first,C=k.date.getDate(),g._time_values=[];S<k.last;)E+="<option value='"+S+"'>"+t.templates.time_picker(k.date)+"</option>",g._time_values.push(S),k.date.setTime(k.date.valueOf()+60*t._get_timepicker_step()*1e3),S=24*(k.date.getDate()!=C?1:0)*60+60*k.date.getHours()+k.date.getMinutes()}return E}t._init_lightbox_events=function(){t.lightbox_events={},t.lightbox_events.gantt_save_btn=function(){t._save_lightbox()},t.lightbox_events.gantt_delete_btn=function(){t._lightbox_current_type=null,t.callEvent("onLightboxDelete",[t._lightbox_id])&&(t.isTaskExists(t._lightbox_id)?t.$click.buttons.delete(t._lightbox_id):t.hideLightbox())},t.lightbox_events.gantt_cancel_btn=function(){t._cancel_lightbox()},t.lightbox_events.default=function(g,p){if(p.getAttribute("data-dhx-button"))t.callEvent("onLightboxButton",[p.className,p,g]);else{var k,x,w=Z(p);if(w.indexOf("gantt_custom_button")!=-1)if(w.indexOf("gantt_custom_button_")!=-1)for(k=p.parentNode.getAttribute("data-index"),x=p;x&&Z(x).indexOf("gantt_cal_lsection")==-1;)x=x.parentNode;else k=p.getAttribute("data-index"),x=p.closest(".gantt_cal_lsection"),p=p.firstChild;var $=t._get_typed_lightbox_config();k&&(k*=1,t.form_blocks[$[1*k].type].button_click(k,p,x,x.nextSibling))}},this.event(t.getLightbox(),"click",function(g){g.target.closest(".gantt_cal_ltitle_close_btn")&&t._cancel_lightbox();var p=yt(g),k=Z(p);return k||(k=Z(p=p.previousSibling)),p&&k&&k.indexOf("gantt_btn_set")===0&&(k=Z(p=p.firstChild)),!(!p||!k)&&(t.defined(t.lightbox_events[p.className])?t.lightbox_events[p.className]:t.lightbox_events.default)(g,p)}),t.getLightbox().onkeydown=function(g){var p=g||window.event,k=g.target||g.srcElement,x=Z(k).indexOf("gantt_btn_set")>-1;switch((g||p).keyCode){case t.constants.KEY_CODES.SPACE:if((g||p).shiftKey)return;x&&k.click&&k.click();break;case t.keys.edit_save:if((g||p).shiftKey)return;x&&k.click?k.click():t._save_lightbox();break;case t.keys.edit_cancel:t._cancel_lightbox()}}},t._cancel_lightbox=function(){var g=this.getLightboxValues("cancel");t._lightbox_current_type=null,this.callEvent("onLightboxCancel",[this._lightbox_id,g.$new]),t.isTaskExists(g.id)&&g.$new&&(this.silent(function(){t.$data.tasksStore.removeItem(g.id),t._update_flags(g.id,null)}),this.refreshData()),this.hideLightbox()},t._save_lightbox=function(){var g=this.getLightboxValues("save");t._lightbox_current_type=null,this.callEvent("onLightboxSave",[this._lightbox_id,g,!!g.$new])&&(t.$data.tasksStore._skipTaskRecalculation="lightbox",g.$new?(delete g.$new,this.addTask(g,g.parent,this.getTaskIndex(g.id))):this.isTaskExists(g.id)&&(this.mixin(this.getTask(g.id),g,!0),this.refreshTask(g.id),this.updateTask(g.id)),t.$data.tasksStore._skipTaskRecalculation=!1,this.refreshData(),this.hideLightbox())},t._resolve_default_mapping=function(g){var p=g.map_to;return{time:!0,time_optional:!0,duration:!0,duration_optional:!0}[g.type]?g.map_to=="auto"?p={start_date:"start_date",end_date:"end_date",duration:"duration"}:typeof g.map_to=="string"&&(p={start_date:g.map_to}):g.type==="constraint"&&(g.map_to&&typeof g.map_to!="string"||(p={constraint_type:"constraint_type",constraint_date:"constraint_date"})),p},t.getLightboxValues=function(g){let p={};t.isTaskExists(this._lightbox_id)&&(p=this.mixin({},this.getTask(this._lightbox_id)));const k=[...this._get_typed_lightbox_config()].sort((x,w)=>x.name==="time"?1:w.name==="time"?-1:0);for(let x=0;x<k.length;x++){let w=t._lightbox_root.querySelector("#"+k[x].id);w=w&&w.nextSibling;let $=this.form_blocks[k[x].type];if(!$)continue;let T=$.get_value.call(this,w,p,k[x],g),S=t._resolve_default_mapping(k[x]);if(typeof S=="string"&&S!="auto")p[S]=T;else if(typeof S=="object")for(let C in S)S[C]&&(p[S[C]]=T[C])}return t._lightbox_current_type&&(p.type=t._lightbox_current_type),p},t.hideLightbox=function(){var g=this.getLightbox();g&&(g.style.display="none"),this._waiAria.lightboxHiddenAttr(g),this._lightbox_id=null,this.hideCover(g),this.resetLightbox(),this.callEvent("onAfterLightbox",[])},t.hideCover=function(g){g&&(g.style.display="none"),this._cover&&this._cover.parentNode.removeChild(this._cover),this._cover=null},t.resetLightbox=function(){t._lightbox&&!t._custom_lightbox&&t._lightbox.remove(),t._lightbox=null},t._set_lightbox_values=function(g,p){var k=g,x=p.getElementsByTagName("span"),w=[];t.templates.lightbox_header?(w.push(""),w.push(t.templates.lightbox_header(k.start_date,k.end_date,k)),x[1].innerHTML="",x[2].innerHTML=t.templates.lightbox_header(k.start_date,k.end_date,k)):(w.push(this.templates.task_time(k.start_date,k.end_date,k)),w.push(String(this.templates.task_text(k.start_date,k.end_date,k)||"").substr(0,70)),x[1].innerHTML=this.templates.task_time(k.start_date,k.end_date,k),x[2].innerHTML=String(this.templates.task_text(k.start_date,k.end_date,k)||"").substr(0,70)),x[1].innerHTML=w[0],x[2].innerHTML=w[1],t._waiAria.lightboxHeader(p,w.join(" "));for(var $=this._get_typed_lightbox_config(this.getLightboxType()),T=0;T<$.length;T++){var S=$[T];if(this.form_blocks[S.type]){var C=t._lightbox_root.querySelector("#"+S.id).nextSibling,E=this.form_blocks[S.type],D=t._resolve_default_mapping($[T]),A=this.defined(k[D])?k[D]:S.default_value;E.set_value.call(t,C,A,k,S),S.focus&&E.focus.call(t,C)}}t.isTaskExists(g.id)&&(t._lightbox_id=g.id)},t._fill_lightbox=function(g,p){var k=this.getTask(g);this._set_lightbox_values(k,p)},t.getLightboxSection=function(g){for(var p=this._get_typed_lightbox_config(),k=0;k<p.length&&p[k].name!=g;k++);var x=p[k];if(!x)return null;this._lightbox||this.getLightbox();var w=t._lightbox_root.querySelector("#"+x.id),$=w.nextSibling,T={section:x,header:w,node:$,getValue:function(C){return t.form_blocks[x.type].get_value.call(t,$,C||{},x)},setValue:function(C,E){return t.form_blocks[x.type].set_value.call(t,$,C,E||{},x)}},S=this._lightbox_methods["get_"+x.type+"_control"];return S?S(T):T},t._lightbox_methods.get_template_control=function(g){return g.control=g.node,g},t._lightbox_methods.get_select_control=function(g){return g.control=g.node.getElementsByTagName("select")[0],g},t._lightbox_methods.get_textarea_control=function(g){return g.control=g.node.getElementsByTagName("textarea")[0],g},t._lightbox_methods.get_time_control=function(g){return g.control=g.node.getElementsByTagName("select"),g},t._init_dnd_events=function(){var g=t._lightbox_root;this.event(g,"mousemove",t._move_while_dnd),this.event(g,"mouseup",t._finish_dnd),this.event(g,"touchmove",function(p){t._move_while_dnd(p.touches[0])}),this.event(g,"touchend",function(p){t._finish_dnd(p.touches[0])})},t._move_while_dnd=function(g){if(t._dnd_start_lb){document.gantt_unselectable||(t._lightbox_root.className+=" gantt_unselectable",document.gantt_unselectable=!0);var p=t.getLightbox(),k=[g.pageX,g.pageY];p.style.top=t._lb_start[1]+k[1]-t._dnd_start_lb[1]+"px",p.style.left=t._lb_start[0]+k[0]-t._dnd_start_lb[0]+"px"}},t._ready_to_dnd=function(g){var p=t.getLightbox();t._lb_start=[p.offsetLeft,p.offsetTop],t._dnd_start_lb=[g.pageX,g.pageY]},t._finish_dnd=function(){t._lb_start&&(t._lb_start=t._dnd_start_lb=!1,t._lightbox_root.className=t._lightbox_root.className.replace(" gantt_unselectable",""),document.gantt_unselectable=!1)},t._focus=function(g,p){if(g&&g.focus&&!t.config.touch)try{p&&g.select&&g.select(),g.focus()}catch{}},t.form_blocks={getTimePicker:function(g,p){var k,x,w,$="",T=this.config,S={first:0,last:1440,date:this.date.date_part(new Date(t._min_date.valueOf())),timeFormat:b(g)};for(g._time_format_order={size:0},t.config.limit_time_select&&(S.first=60*T.first_hour,S.last=60*T.last_hour+1,S.date.setHours(T.first_hour)),k=0;k<S.timeFormat.length;k++)k>0&&($+=" "),(x=m(g,k,S))&&(w=t._waiAria.lightboxSelectAttrString(S.timeFormat[k]),$+="<select "+(g.readonly?"disabled='disabled'":"")+(p?" style='display:none' ":"")+w+">"+x+"</select>");return $},getTimePickerValue:function(g,p,k){var x,w=p._time_format_order,$=0,T=0,S=k||0;return t.defined(w[3])&&(x=parseInt(g[w[3]+S].value,10),$=Math.floor(x/60),T=x%60),new Date(g[w[2]+S].value,g[w[1]+S].value,g[w[0]+S].value,$,T)},_fill_lightbox_select:function(g,p,k,x){if(g[p+x[0]].value=k.getDate(),g[p+x[1]].value=k.getMonth(),g[p+x[2]].value=k.getFullYear(),t.defined(x[3])){var w=60*k.getHours()+k.getMinutes();w=Math.round(w/t._get_timepicker_step())*t._get_timepicker_step();var $=g[p+x[3]];$.value=w,$.setAttribute("data-value",w)}},template:new n,textarea:new e,select:new a,time:new i,duration:new o,parent:new l,radio:new r,checkbox:new s,resources:new d,constraint:new c,baselines:new h,typeselect:new u,resource_selector:new _},t._is_lightbox_timepicker=function(){for(var g=this._get_typed_lightbox_config(),p=0;p<g.length;p++)if(g[p].name=="time"&&g[p].type=="time")return!0;return!1},t._delete_task_confirm=function({task:g,message:p,title:k,callback:x,ok:w}){t._simple_confirm(p,k,x,w)},t._delete_link_confirm=function({link:g,message:p,title:k,callback:x,ok:w}){t._simple_confirm(p,k,x,w)},t._simple_confirm=function(g,p,k,x){if(!g)return k();var w={text:g};p&&(w.title=p),x&&(w.ok=x),k&&(w.callback=function($){$&&k()}),t.confirm(w)},t._get_typed_lightbox_config=function(g){g===void 0&&(g=this.getLightboxType());var p=y.call(this,g);return t.config.lightbox[p+"_sections"]?t.config.lightbox[p+"_sections"]:t.config.lightbox.sections},t._silent_redraw_lightbox=function(g){var p=this.getLightboxType();if(this.getState().lightbox){var k=this.getState().lightbox,x=this.getLightboxValues(),w=this.copy(this.getTask(k));this.resetLightbox();var $=this.mixin(w,x,!0),T=this.getLightbox(g||void 0);this._set_lightbox_values($,T),this.showCover(T)}else this.resetLightbox(),this.getLightbox(g||void 0);this.callEvent("onLightboxChange",[p,this.getLightboxType()])}}function as(t){if(!pt.isNode){t.utils={arrayFind:Pn,dom:Be};var n=Gt();t.event=n.attach,t.eventRemove=n.detach,t._eventRemoveAll=n.detachAll,t._createDomEventScope=n.extend,R(t,ha(t));var e=Ja.init(t);t.$ui=e.factory,t.$ui.layers=e.render,t.$mouseEvents=e.mouseEvents,t.$services.setService("mouseEvents",function(){return t.$mouseEvents}),t.mixin(t,e.layersApi),function(i){delete i.addTaskLayer,delete i.addLinkLayer}(t),t.$services.setService("layers",function(){return e.layersService}),t.mixin(t,function(){function i(u){return u.$ui.getView("timeline")}function a(u){return u.$ui.getView("grid")}function s(u){var h=i(u);if(h&&!h.$config.hidden)return h;var _=a(u);return _&&!_.$config.hidden?_:null}function r(u){var h=null,_=!1;return[".gantt_drag_marker.gantt_grid_resize_area",".gantt_drag_marker .gantt_row.gantt_row_task",".gantt_drag_marker.gantt_grid_dnd_marker"].forEach(function(f){_=_||!!document.querySelector(f)}),(h=_?a(u):s(u))?l(u,h,"scrollY"):null}function o(u){var h=s(u);return h&&h.id!="grid"?l(u,h,"scrollX"):null}function l(u,h,_){var f=h.$config[_];return u.$ui.getView(f)}var d="DEFAULT_VALUE";function c(u,h,_,f){var y=u(this);return y&&y.isVisible()?y[h].apply(y,_):f?f():d}return{getColumnIndex:function(u){var h=c.call(this,a,"getColumnIndex",[u]);return h===d?0:h},dateFromPos:function(u){var h=c.call(this,i,"dateFromPos",Array.prototype.slice.call(arguments));return h===d?this.getState().min_date:h},posFromDate:function(u){var h=c.call(this,i,"posFromDate",Array.prototype.slice.call(arguments));return h===d?0:h},getRowTop:function(u){var h=this,_=c.call(h,i,"getRowTop",[u],function(){return c.call(h,a,"getRowTop",[u])});return _===d?0:_},getTaskTop:function(u){var h=this,_=c.call(h,i,"getItemTop",[u],function(){return c.call(h,a,"getItemTop",[u])});return _===d?0:_},getTaskPosition:function(u,h,_){var f=c.call(this,i,"getItemPosition",[u,h,_]);return f===d?{left:0,top:this.getTaskTop(u.id),height:this.getTaskBarHeight(u.id),width:0}:f},getTaskBarHeight:function(u,h){var _=this,f=c.call(_,i,"getBarHeight",[u,h],function(){return c.call(_,a,"getItemHeight",[u])});return f===d?0:f},getTaskHeight:function(u){var h=this,_=c.call(h,i,"getItemHeight",[u],function(){return c.call(h,a,"getItemHeight",[u])});return _===d?0:_},columnIndexByDate:function(u){var h=c.call(this,i,"columnIndexByDate",[u]);return h===d?0:h},roundTaskDates:function(){c.call(this,i,"roundTaskDates",[])},getScale:function(){var u=c.call(this,i,"getScale",[]);return u===d?null:u},getTaskNode:function(u){var h=i(this);if(h&&h.isVisible()){var _=h._taskRenderer.rendered[u];if(!_){var f=h.$config.item_attribute;_=h.$task_bars.querySelector("["+f+"='"+u+"']")}return _||null}return null},getLinkNode:function(u){var h=i(this);return h.isVisible()?h._linkRenderer.rendered[u]:null},scrollTo:function(u,h){var _=r(this),f=o(this),y={position:0},v={position:0};_&&(v=_.getScrollState()),f&&(y=f.getScrollState());var b=f&&1*u==u,m=_&&1*h==h;if(b&&m)for(var g=_._getLinkedViews(),p=f._getLinkedViews(),k=[],x=0;x<g.length;x++)for(var w=0;w<p.length;w++)g[x].$config.id&&p[w].$config.id&&g[x].$config.id===p[w].$config.id&&k.push(g[x].$config.id);b&&(k&&k.forEach((function(S){this.$ui.getView(S).$config.$skipSmartRenderOnScroll=!0}).bind(this)),f.scroll(u),k&&k.forEach((function(S){this.$ui.getView(S).$config.$skipSmartRenderOnScroll=!1}).bind(this))),m&&_.scroll(h);var $={position:0},T={position:0};_&&($=_.getScrollState()),f&&(T=f.getScrollState()),this.callEvent("onGanttScroll",[y.position,v.position,T.position,$.position])},showDate:function(u){var h=this.posFromDate(u),_=Math.max(h-this.config.task_scroll_offset,0);this.scrollTo(_)},showTask:function(u){var h=this.getTaskPosition(this.getTask(u)),_=h.left;this.config.rtl&&(_=h.left+h.width);var f,y=Math.max(_-this.config.task_scroll_offset,0),v=this._scroll_state().y;f=v?h.top-(v-this.getTaskBarHeight(u))/2:h.top,this.scrollTo(y,f);var b=a(this),m=i(this);b&&m&&b.$config.scrollY!=m.$config.scrollY&&l(this,b,"scrollY").scrollTo(null,f)},_scroll_state:function(){var u={x:!1,y:!1,x_pos:0,y_pos:0,scroll_size:this.config.scroll_size+1,x_inner:0,y_inner:0},h=r(this),_=o(this);if(_){var f=_.getScrollState();f.visible&&(u.x=f.size,u.x_inner=f.scrollSize),u.x_pos=f.position||0}if(h){var y=h.getScrollState();y.visible&&(u.y=y.size,u.y_inner=y.scrollSize),u.y_pos=y.position||0}return u},getScrollState:function(){var u=this._scroll_state();return{x:u.x_pos,y:u.y_pos,inner_width:u.x,inner_height:u.y,width:u.x_inner,height:u.y_inner}},getLayoutView:function(u){return this.$ui.getView(u)},scrollLayoutCell:function(u,h,_){const f=this.$ui.getView(u);if(!f)return!1;if(h!==null){const y=this.$ui.getView(f.$config.scrollX);y&&y.scrollTo(h,null)}if(_!==null){const y=this.$ui.getView(f.$config.scrollY);y&&y.scrollTo(null,_)}}}}()),function(i){i.resetSkin||(i.resetSkin=function(){this.skin="",De(!0,this)},i.skins={},i.attachEvent("onGanttLayoutReady",function(){De(!1,this),s()})),i._addThemeClass=function(){document.documentElement.setAttribute("data-gantt-theme",i.skin)},i.setSkin=function(r){const o=this.skin!==r;this.skin=r,i._addThemeClass(),s(),i.$root&&(De(!o,i),this.render())};let a=null;function s(){const r=i.$root;a&&clearInterval(a),r&&(a=setInterval(()=>{const o=getComputedStyle(r).getPropertyValue("--dhx-gantt-theme");o&&o!==i.skin&&i.setSkin(o)},100))}i.attachEvent("onDestroy",function(){clearInterval(a)})}(t),function(i){i.skins.skyblue={config:{grid_width:370,row_height:27,bar_height_padding:4,scale_height:27,link_line_width:1,link_arrow_size:8,link_radius:2,lightbox_additional_height:75},_second_column_width:95,_third_column_width:80}}(t),function(i){i.skins.dark={config:{grid_width:390,row_height:36,scale_height:36,link_line_width:2,link_arrow_size:12,bar_height_padding:9,lightbox_additional_height:75},_second_column_width:100,_third_column_width:70}}(t),function(i){i.skins.meadow={config:{grid_width:380,row_height:27,scale_height:30,link_line_width:2,link_arrow_size:10,bar_height_padding:4,lightbox_additional_height:72},_second_column_width:95,_third_column_width:80}}(t),function(i){i.skins.terrace={config:{grid_width:390,row_height:36,scale_height:36,link_line_width:2,link_arrow_size:12,bar_height_padding:9,lightbox_additional_height:75},_second_column_width:100,_third_column_width:70}}(t),function(i){i.skins.broadway={config:{grid_width:390,row_height:35,scale_height:35,link_line_width:1,link_arrow_size:9,bar_height_padding:4,lightbox_additional_height:86},_second_column_width:100,_third_column_width:80,_lightbox_template:"<div class='gantt_cal_ltitle'><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='gantt_title'></span><div class='gantt_cancel_btn'></div></div><div class='gantt_cal_larea'></div>",_config_buttons_left:{},_config_buttons_right:{gantt_delete_btn:"icon_delete",gantt_save_btn:"icon_save"}}}(t),function(i){i.skins.material={config:{grid_width:411,row_height:34,scale_height:36,link_line_width:2,link_arrow_size:12,bar_height_padding:9,lightbox_additional_height:80},_second_column_width:110,_third_column_width:75,_redefine_lightbox_buttons:{buttons_left:["dhx_delete_btn"],buttons_right:["dhx_cancel_btn","dhx_save_btn"]}},i.attachEvent("onAfterTaskDrag",function(a){var s=i.getTaskNode(a);s&&(s.className+=" gantt_drag_animation",setTimeout(function(){var r=s.className.indexOf(" gantt_drag_animation");r>-1&&(s.className=s.className.slice(0,r))},200))})}(t),function(i){i.skins.contrast_black={config:{grid_width:390,row_height:35,scale_height:35,link_line_width:2,link_arrow_size:12,lightbox_additional_height:75},_second_column_width:100,_third_column_width:80}}(t),function(i){i.skins.contrast_white={config:{grid_width:390,row_height:35,scale_height:35,link_line_width:2,link_arrow_size:12,lightbox_additional_height:75},_second_column_width:100,_third_column_width:80}}(t),function(i){i.ext||(i.ext={});for(var a=[Ka,null,null],s=0;s<a.length;s++)a[s]&&a[s](i);i.ext.zoom=new Qa(i)}(t),ts(t),is(t),function(i){i._extend_to_optional=function(a){var s=a,r={render:s.render,focus:s.focus,set_value:function(o,l,d,c){var u=i._resolve_default_mapping(c);if(!d[u.start_date]||u.start_date=="start_date"&&this._isAllowedUnscheduledTask(d)){r.disable(o,c);var h={};for(var _ in u)h[u[_]]=d[_];return s.set_value.call(i,o,l,h,c)}return r.enable(o,c),s.set_value.call(i,o,l,d,c)},get_value:function(o,l,d){return d.disabled?{start_date:null}:s.get_value.call(i,o,l,d)},update_block:function(o,l){if(i.callEvent("onSectionToggle",[i._lightbox_id,l]),o.style.display=l.disabled?"none":"",l.button){var d=o.previousSibling.querySelector(".gantt_custom_button_label"),c=i.locale.labels,u=l.disabled?c[l.name+"_enable_button"]:c[l.name+"_disable_button"];d.innerHTML=u}},disable:function(o,l){l.disabled=!0,r.update_block(o,l)},enable:function(o,l){l.disabled=!1,r.update_block(o,l)},button_click:function(o,l,d,c){if(i.callEvent("onSectionButton",[i._lightbox_id,d])!==!1){var u=i._get_typed_lightbox_config()[o];u.disabled?r.enable(c,u):r.disable(c,u)}}};return r},i.form_blocks.duration_optional=i._extend_to_optional(i.form_blocks.duration),i.form_blocks.time_optional=i._extend_to_optional(i.form_blocks.time)}(t),function(i){var a=new RegExp(`<(?:.|
)*?>`,"gm"),s=new RegExp(" +","gm");function r(c){return(c+"").replace(a," ").replace(s," ")}var o=new RegExp("'","gm");function l(c){return(c+"").replace(o,"&#39;")}for(var d in i._waiAria={getAttributeString:function(c){var u=[" "];for(var h in c){var _=l(r(c[h]));u.push(h+"='"+_+"'")}return u.push(" "),u.join(" ")},getTimelineCellAttr:function(c){return i._waiAria.getAttributeString({"aria-label":c})},_taskCommonAttr:function(c,u){c.start_date&&c.end_date&&(u.setAttribute("aria-label",r(i.templates.tooltip_text(c.start_date,c.end_date,c))),c.$dataprocessor_class&&u.setAttribute("aria-busy",!0))},setTaskBarAttr:function(c,u){this._taskCommonAttr(c,u),u.setAttribute("role","img"),!i.isReadonly(c)&&i.config.drag_move&&(c.id!=i.getState("tasksDnd").drag_id?u.setAttribute("aria-grabbed",!1):u.setAttribute("aria-grabbed",!0))},taskRowAttr:function(c,u){this._taskCommonAttr(c,u),!i.isReadonly(c)&&i.config.order_branch&&u.setAttribute("aria-grabbed",!1),u.setAttribute("role","row"),u.setAttribute("aria-selected",i.isSelectedTask(c.id)?"true":"false"),u.setAttribute("aria-level",c.$level+1||1),i.hasChild(c.id)&&u.setAttribute("aria-expanded",c.$open?"true":"false")},linkAttr:function(c,u){var h=i.config.links,_=c.type==h.finish_to_start||c.type==h.start_to_start,f=c.type==h.start_to_start||c.type==h.start_to_finish,y=i.locale.labels.link+" "+i.templates.drag_link(c.source,f,c.target,_);u.setAttribute("role","img"),u.setAttribute("aria-label",r(y))},gridSeparatorAttr:function(c){c.setAttribute("role","columnheader")},rowResizerAttr:function(c){c.setAttribute("role","row")},lightboxHiddenAttr:function(c){c.setAttribute("aria-hidden","true")},lightboxVisibleAttr:function(c){c.setAttribute("aria-hidden","false")},lightboxAttr:function(c){c.setAttribute("role","dialog"),c.setAttribute("aria-hidden","true"),c.firstChild.setAttribute("role","heading"),c.firstChild.setAttribute("aria-level","1")},lightboxButtonAttrString:function(c){return this.getAttributeString({role:"button","aria-label":i.locale.labels[c],tabindex:"0"})},lightboxHeader:function(c,u){c.setAttribute("aria-label",u)},lightboxSelectAttrString:function(c){var u="";switch(c){case"%Y":u=i.locale.labels.years;break;case"%m":u=i.locale.labels.months;break;case"%d":u=i.locale.labels.days;break;case"%H:%i":u=i.locale.labels.hours+i.locale.labels.minutes}return i._waiAria.getAttributeString({"aria-label":u})},lightboxDurationInputAttrString:function(c){return this.getAttributeString({"aria-label":i.locale.labels.column_duration,"aria-valuemin":"0",role:"spinbutton"})},inlineEditorAttr:function(c){c.setAttribute("role","row")},gridAttrString:function(){return[" role='treegrid'",i.config.multiselect?"aria-multiselectable='true'":"aria-multiselectable='false'"," "].join(" ")},gridScaleRowAttrString:function(){return"role='row'"},gridScaleCellAttrString:function(c,u){var h="";if(c.name=="add")h=this.getAttributeString({role:"columnheader","aria-label":i.locale.labels.new_task});else{var _={role:"columnheader","aria-label":i.config.external_render&&i.config.external_render.isElement(u)?"":u};i._sort&&i._sort.name==c.name&&(i._sort.direction=="asc"?_["aria-sort"]="ascending":_["aria-sort"]="descending"),h=this.getAttributeString(_)}return h},gridDataAttrString:function(){return"role='rowgroup'"},reorderMarkerAttr:function(c){c.setAttribute("role","grid"),c.firstChild.removeAttribute("aria-level"),c.firstChild.setAttribute("aria-grabbed","true")},gridCellAttrString:function(c,u,h){var _={role:"gridcell","aria-label":u};return c.editor&&!i.isReadonly(h)||(_["aria-readonly"]=!0),this.getAttributeString(_)},gridAddButtonAttrString:function(c){return this.getAttributeString({role:"button","aria-label":i.locale.labels.new_task})},messageButtonAttrString:function(c){return"tabindex='0' role='button' aria-label='"+c+"'"},messageInfoAttr:function(c){c.setAttribute("role","alert")},messageModalAttr:function(c,u){c.setAttribute("role","dialog"),u&&c.setAttribute("aria-labelledby",u)},quickInfoAttr:function(c){c.setAttribute("role","dialog")},quickInfoHeaderAttrString:function(){return" role='heading' aria-level='1' "},quickInfoHeader:function(c,u){c.setAttribute("aria-label",u)},quickInfoButtonAttrString:function(c){return i._waiAria.getAttributeString({role:"button","aria-label":c,tabindex:"0"})},tooltipAttr:function(c){c.setAttribute("role","tooltip")},tooltipVisibleAttr:function(c){c.setAttribute("aria-hidden","false")},tooltipHiddenAttr:function(c){c.setAttribute("aria-hidden","true")}},i._waiAria)i._waiAria[d]=function(c){return function(){return i.config.wai_aria_attributes?c.apply(this,arguments):""}}(i._waiAria[d])}(t),t.locate=function(i){var a=yt(i);if(dt(a,".gantt_task_row"))return null;var s=arguments[1]||this.config.task_attribute,r=nt(a,s);return r?r.getAttribute(s):null},t._locate_css=function(i,a,s){return ft(i,a,s)},t._locateHTML=function(i,a){return nt(i,a||this.config.task_attribute)}}t.attachEvent("onParse",function(){Y(t)||t.attachEvent("onGanttRender",function(){if(t.config.initial_scroll){var i=t.getTaskByIndex(0),a=i?i.id:t.config.root_id;t.isTaskExists(a)&&t.$task&&t.utils.dom.isChildOf(t.$task,t.$container)&&t.showTask(a)}},{once:!0})}),t.attachEvent("onBeforeGanttReady",function(){this.config.scroll_size||(this.config.scroll_size=Me()||15),Y(t)||(this._eventRemoveAll(),this.$mouseEvents.reset(),this.resetLightbox())}),t.attachEvent("onGanttReady",function(){!Y(t)&&t.config.rtl&&t.$layout.getCellsByType("viewCell").forEach(function(i){var a=i.$config.scrollX;if(a){var s=t.$ui.getView(a);s&&s.scrollTo(s.$config.scrollSize,0)}})}),t.attachEvent("onGanttReady",function(){if(!Y(t)){var i=t.plugins(),a={auto_scheduling:t.autoSchedule,click_drag:t.ext.clickDrag,critical_path:t.isCriticalTask,drag_timeline:t.ext.dragTimeline,export_api:t.exportToPDF,fullscreen:t.ext.fullscreen,grouping:t.groupBy,keyboard_navigation:t.ext.keyboardNavigation,marker:t.addMarker,multiselect:t.eachSelectedTask,overlay:t.ext.overlay,quick_info:t.templates.quick_info_content,tooltip:t.ext.tooltips,undo:t.undo};for(let s in a)a[s]&&!i[s]&&console.warn(`You connected the '${s}' extension via an obsolete file. 
To fix it, you need to remove the obsolete file and connect the extension via the plugins method: https://docs.dhtmlx.com/gantt/api__gantt_plugins.html`)}})}const Dn=Q.gantt=function(t){var n=ua(t);return n.env.isNode||(as(n),function(e){e.load=function(i,a,s){this._load_url=i,this.assert(arguments.length,"Invalid load arguments");var r="json",o=null;return arguments.length>=3?(r=a,o=s):typeof arguments[1]=="string"?r=arguments[1]:typeof arguments[1]=="function"&&(o=arguments[1]),this._load_type=r,this.callEvent("onLoadStart",[i,r]),this.ajax.get(i,e.bind(function(l){this.on_load(l,r),this.callEvent("onLoadEnd",[i,r]),typeof o=="function"&&o.call(this)},this))}}(n)),n}(qn);$t.default=Dn,$t.gantt=Dn,Object.defineProperties($t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=dhtmlxgantt.js.map
