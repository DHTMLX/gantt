/*!
 * @license
 * 
 * dhtmlxGantt v.5.1.0 Stardard
 * This software is covered by GPL license. You also can obtain Commercial or Enterprise license to use it in non-GPL project - please contact sales@dhtmlx.com. Usage without proper license is prohibited.
 * 
 * (c) Dinamenta, UAB.
 * 
 */
!function(t){function e(a){if(n[a])return n[a].exports;var i=n[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,a){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:a})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=23)}({23:function(t,e,n){t.exports=n(24)},24:function(t,e){gantt.config.smart_rendering=!0,gantt._smart_render={getViewPort:function(){var t=gantt.$ui.getView("timeline").getSize(),e=gantt.getScrollState();return{y:e.y,y_end:e.y+t.y}},getScrollSizes:function(){var t=gantt.getScrollState();return t.x=t.x||0,t.y=t.y||gantt.getVisibleTaskCount()*gantt.config.row_height,t},isInViewPort:function(t,e){return!!(t.y<e.y_end&&t.y_end>e.y)},isTaskDisplayed:function(t,e){return this.isInViewPort(this.getTaskPosition(t),this.getViewPort())},isLinkDisplayed:function(t,e){return this.isInViewPort(this.getLinkPosition(t,e),this.getViewPort())},getTaskPosition:function(t){var e=gantt.getTaskTop(t);return{y:e,y_end:e+gantt.config.row_height}},getLinkPosition:function(t,e){var n=gantt.getTaskTop(e.source),a=gantt.getTaskTop(e.target);return{y:Math.min(n,a),y_end:Math.max(n,a)+gantt.config.row_height}},getRange:function(t){t=t||0;for(var e=this.getViewPort(),n=Math.floor(Math.max(0,e.y)/gantt.config.row_height)-t,a=Math.ceil(Math.max(0,e.y_end)/gantt.config.row_height)+t,i=gantt.$data.tasksStore.getIndexRange(n,a),r=[],s=0;s<i.length;s++)r.push(i[s].id);return r},_redrawItems:function(t,e){for(var n={},a=0;a<e.length;a++)n[e[a].id]=!0;for(var i={},r=0;r<t.length;r++){var s=t[r];for(var o in s.rendered)if(n[o]){var c=s.rendered[o];c&&c.parentNode&&(i[o]=!0)}else s.hide(o);for(var a=0;a<e.length;a++)i[e[a].id]||s.restore(e[a])}},_getVisibleTasks:function(){for(var t=this.getRange(),e=[],n=0;n<t.length;n++){var a=gantt.getTask(t[n]);a.$index=n,gantt.resetProjectDates(a),e.push(a)}return e},_getVisibleLinks:function(){for(var t=[],e=gantt.$data.linksStore.getIndexRange(),n=0;n<e.length;n++)this.isLinkDisplayed(e[n].id,e[n])&&t.push(e[n]);return t},_recalculateLinkedProjects:function(t){for(var e={},n=0;n<t.length;n++)e[t[n].source]=!0,e[t[n].target]=!0;for(var n in e)gantt.isTaskExists(n)&&gantt.resetProjectDates(gantt.getTask(n))},updateRender:function(){gantt.callEvent("onBeforeSmartRender",[]);var t=this._getVisibleTasks(),e=this._getVisibleLinks();this._recalculateLinkedProjects(e);var n=gantt.$services.getService("layers"),a=n.getDataRender("task"),i=n.getDataRender("link");this._redrawItems(a.getLayers(),t),this._redrawItems(i.getLayers(),e),gantt.callEvent("onSmartRender",[])},cached:{},_takeFromCache:function(t,e,n){this.cached[n]||(this.cached[n]=null);var a=this.cached[n];return void 0!==t?(a||(a=this.cached[n]={}),void 0===a[t]&&(a[t]=e(t)),a[t]):(a||(a=e()),a)},initCache:function(){for(var t=["getLinkPosition","getTaskPosition","isTaskDisplayed","isLinkDisplayed","getViewPort","getScrollSizes"],e=0;e<t.length;e++){var n=t[e],a=gantt.bind(this[n],this);this[n]=function(t,e){return function(n){return this._takeFromCache(n,t,e)}}(a,n)}this.invalidateCache(),this.initCache=function(){}},invalidateCache:function(){function t(){r.cached.getViewPort=null,r.cached.getScrollSizes=null,r.cached.isTaskDisplayed=null,r.cached.isLinkDisplayed=null}function e(){r.cached.isTaskDisplayed=null,r.cached.isLinkDisplayed=null,r.cached.getLinkPosition=null,r.cached.getTaskPosition=null}function n(){t(),e()}function a(t){r.cached.isTaskDisplayed&&(r.cached.isTaskDisplayed[t]=void 0),r.cached.getTaskPosition&&(r.cached.getTaskPosition[t]=void 0)}function i(t){r.cached.isLinkDisplayed&&(r.cached.isLinkDisplayed[t]=void 0),r.cached.getLinkPosition&&(r.cached.getLinkPosition[t]=void 0)}var r=this;gantt.attachEvent("onClear",function(){n()}),gantt.attachEvent("onParse",function(){n()}),gantt.attachEvent("onAfterLinkUpdate",i),gantt.attachEvent("onAfterTaskAdd",n),gantt.attachEvent("onAfterTaskDelete",n),gantt.attachEvent("onAfterTaskUpdate",a),gantt.attachEvent("onGanttScroll",t),gantt.attachEvent("onDataRender",n),this.invalidateCache=function(){}}},gantt.attachEvent("onGanttScroll",function(t,e,n,a){if(gantt.config.smart_rendering&&(e!=a||t==n)){gantt._smart_render.getRange();gantt._smart_render.updateRender()}}),gantt.attachEvent("onDataRender",function(){gantt.config.smart_rendering&&gantt._smart_render.updateRender()}),function(){var t=gantt.attachEvent("onGanttReady",function(){var e=gantt.$services.getService("layers");e.getDataRender("task").filters.push(function(t,e){return!gantt.config.smart_rendering||!!gantt._smart_render.isTaskDisplayed(t,e)}),e.getDataRender("link").filters.push(function(t,e){return!gantt.config.smart_rendering||!!gantt._smart_render.isLinkDisplayed(t,e)}),gantt.detachEvent(t)})}()}});
//# sourceMappingURL=dhtmlxgantt_smart_rendering.js.map